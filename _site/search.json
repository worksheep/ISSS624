[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "ISSS624",
    "section": "",
    "text": "This is a website about ISSS624, taught by a interesting professor who is very nice to us"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1_Test/data/geospatial/MPSZ-2019.html",
    "href": "Take-home_Ex/Take-home_Ex1_Test/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html",
    "href": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html",
    "title": "Take-home_Ex1",
    "section": "",
    "text": "Everyday, many of us take buses to various destination. Some of us take a shuttle bus to MRT station to transit, some change bus reach their destination, and some have direct bus to their destination.\nLet us analyse how Singaporeans tend to transit using bus using LTA data “Passenger Volume by Origin Destination Bus Stops” downloaded from LTA DataMall"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#lets-take-a-look-at-the-singapore-map",
    "href": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#lets-take-a-look-at-the-singapore-map",
    "title": "Take-home_Ex1",
    "section": "Let’s take a look at the Singapore Map",
    "text": "Let’s take a look at the Singapore Map\nThis is the basemap of Singapore gotten from OneMap\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;% st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n#WGS84 SVY21\n#CRS coordinate representation system for Singapore is 3414\n\n\nplot(mpsz)\n\n\n\n\nmerging all into 1 singapore map. However, the subzones seem to have some small overlap. Given our usecase, actually we don’t need it to be so precise, so we can do a further simplication via st_simplify (note: this come at a cost of precision)\n\nsgp &lt;- st_union(mpsz$geometry)\nplot(sgp)\n\n\n\n\n\n# Simplify the geometry\nsgp_simple &lt;- st_simplify(sgp, dTolerance = 100)\nplot(sgp_simple)"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#where-are-our-busstops",
    "href": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#where-are-our-busstops",
    "title": "Take-home_Ex1",
    "section": "Where are our busstops",
    "text": "Where are our busstops\nThe busstops\nremember to exclude area that transport do not serve, e.g. central reserve, make the value missing to depict correctly\nIdentify Hotspot, then no need to use contiuity matrix LISA only need local moran I, high-high, low-low, outliers\nEmerging Hot Spot - Gi* values, not the 1 without the star\nneed to create hexagon with the sf package. there are advantage, there are some busstop that are at the fringe of causeway, so it is outside. So to catch all the busstop including the edge then we need to calculate, there are missing hexagon there\n  legend.width = \n#  frame = TRUE) +\ntm_borders(alpha - 0.5) +\ntm_compass(type = \"8star\", size = 2)+\ntm_grid(alpha = 0.2)+\ntm_credits(\"Source: LTA DataMall\",\n           position = c(\"left\",\"bottom\"))"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/data/geospatial/MPSZ-2019.html",
    "href": "In-class_Ex/In-class_Ex3/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex1/data/geospatial/MPSZ-2019.html",
    "href": "In-class_Ex/In-class_Ex1/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex3/data/geospatial/MPSZ-2019.html",
    "href": "Hands-on_Ex/Hands-on_Ex3/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html",
    "title": "Hands-on_Ex2c",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#getting-started",
    "title": "Hands-on_Ex2c",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#import-data",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#import-data",
    "title": "Hands-on_Ex2c",
    "section": "Import Data",
    "text": "Import Data\n\nImport basemap\nHunan\n\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\worksheep\\ISSS624\\Hands-on_Ex\\Hands-on_Ex2c\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\nImport metadata\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\n\n\nJoining the data together\n\nhunan &lt;- left_join(hunan,hunan2012) %&gt;%\n  select(1:4, 7, 15)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#visualising",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#visualising",
    "title": "Hands-on_Ex2c",
    "section": "Visualising",
    "text": "Visualising\n\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal quantile classification\")\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#calculating-spatial-weight",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#calculating-spatial-weight",
    "title": "Hands-on_Ex2c",
    "section": "Calculating Spatial Weight",
    "text": "Calculating Spatial Weight\n\nwm_q &lt;- poly2nb(hunan, \n                queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\n\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#global-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#global-spatial-autocorrelation",
    "title": "Hands-on_Ex2c",
    "section": "Global Spatial Autocorrelation",
    "text": "Global Spatial Autocorrelation\n\nMaron’s I test\n\nmoran.test(hunan$GDPPC, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  hunan$GDPPC  \nweights: rswm_q    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\n\nMonte Carlo Moran’s I\n\nset.seed(1234)\nbperm= moran.mc(hunan$GDPPC, \n                listw=rswm_q, \n                nsim=999, \n                zero.policy = TRUE, \n                na.action=na.omit)\nbperm\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n\nVisualising\n\nmean(bperm$res[1:999])\n\n[1] -0.01504572\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.004371574\n\n\n\nsummary(bperm$res[1:999])\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 \n\n\n\nhist(bperm$res, \n     freq=TRUE, \n     breaks=20, \n     xlab=\"Simulated Moran's I\")\nabline(v=0, \n       col=\"red\") \n\n\n\n\n\n\n\nGeary’s C test\n\ngeary.test(hunan$GDPPC, listw=rswm_q)\n\n\n    Geary C test under randomisation\n\ndata:  hunan$GDPPC \nweights: rswm_q \n\nGeary C statistic standard deviate = 3.6108, p-value = 0.0001526\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n        0.6907223         1.0000000         0.0073364 \n\n\n\nMonte Carlo Geary’s C\n\nset.seed(1234)\nbperm=geary.mc(hunan$GDPPC, \n               listw=rswm_q, \n               nsim=999)\nbperm\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  hunan$GDPPC \nweights: rswm_q \nnumber of simulations + 1: 1000 \n\nstatistic = 0.69072, observed rank = 1, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n\nVisualising\n\nmean(bperm$res[1:999])\n\n[1] 1.004402\n\n\n\nsummary(bperm$res[1:999])\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 \n\n\n\nhist(bperm$res, freq=TRUE, breaks=20, xlab=\"Simulated Geary c\")\nabline(v=1, col=\"red\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#spatial-correlogram",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#spatial-correlogram",
    "title": "Hands-on_Ex2c",
    "section": "Spatial Correlogram",
    "text": "Spatial Correlogram\n\nMoran’s I Correlogram\n\nMI_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"I\", \n                          style=\"W\")\nplot(MI_corr)\n\n\n\n\n\nprint(MI_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Moran's I\n         estimate expectation   variance standard deviate Pr(I) two sided    \n1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***\n2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***\n3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *  \n4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015    \n5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***\n6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nGeary’s C Correlogram\n\nGC_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"C\", \n                          style=\"W\")\nplot(GC_corr)\n\n\n\n\n\nprint(GC_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Geary's C\n        estimate expectation  variance standard deviate Pr(I) two sided    \n1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***\n2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***\n3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612    \n4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128    \n5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***\n6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#cluster-and-outlier-analysis",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#cluster-and-outlier-analysis",
    "title": "Hands-on_Ex2c",
    "section": "Cluster and Outlier Analysis",
    "text": "Cluster and Outlier Analysis\n\nComputing local Moran’s I\n\nfips &lt;- order(hunan$County)\nlocalMI &lt;- localmoran(hunan$GDPPC, rswm_q)\nhead(localMI)\n\n            Ii          E.Ii       Var.Ii        Z.Ii Pr(z != E(Ii))\n1 -0.001468468 -2.815006e-05 4.723841e-04 -0.06626904      0.9471636\n2  0.025878173 -6.061953e-04 1.016664e-02  0.26266425      0.7928094\n3 -0.011987646 -5.366648e-03 1.133362e-01 -0.01966705      0.9843090\n4  0.001022468 -2.404783e-07 5.105969e-06  0.45259801      0.6508382\n5  0.014814881 -6.829362e-05 1.449949e-03  0.39085814      0.6959021\n6 -0.038793829 -3.860263e-04 6.475559e-03 -0.47728835      0.6331568\n\n\n\nprintCoefmat(data.frame(\n  localMI[fips,], \n  row.names=hunan$County[fips]),\n  check.names=FALSE)\n\n                       Ii        E.Ii      Var.Ii        Z.Ii Pr.z....E.Ii..\nAnhua         -2.2493e-02 -5.0048e-03  5.8235e-02 -7.2467e-02         0.9422\nAnren         -3.9932e-01 -7.0111e-03  7.0348e-02 -1.4791e+00         0.1391\nAnxiang       -1.4685e-03 -2.8150e-05  4.7238e-04 -6.6269e-02         0.9472\nBaojing        3.4737e-01 -5.0089e-03  8.3636e-02  1.2185e+00         0.2230\nChaling        2.0559e-02 -9.6812e-04  2.7711e-02  1.2932e-01         0.8971\nChangning     -2.9868e-05 -9.0010e-09  1.5105e-07 -7.6828e-02         0.9388\nChangsha       4.9022e+00 -2.1348e-01  2.3194e+00  3.3590e+00         0.0008\nChengbu        7.3725e-01 -1.0534e-02  2.2132e-01  1.5895e+00         0.1119\nChenxi         1.4544e-01 -2.8156e-03  4.7116e-02  6.8299e-01         0.4946\nCili           7.3176e-02 -1.6747e-03  4.7902e-02  3.4200e-01         0.7324\nDao            2.1420e-01 -2.0824e-03  4.4123e-02  1.0297e+00         0.3032\nDongan         1.5210e-01 -6.3485e-04  1.3471e-02  1.3159e+00         0.1882\nDongkou        5.2918e-01 -6.4461e-03  1.0748e-01  1.6338e+00         0.1023\nFenghuang      1.8013e-01 -6.2832e-03  1.3257e-01  5.1198e-01         0.6087\nGuidong       -5.9160e-01 -1.3086e-02  3.7003e-01 -9.5104e-01         0.3416\nGuiyang        1.8240e-01 -3.6908e-03  3.2610e-02  1.0305e+00         0.3028\nGuzhang        2.8466e-01 -8.5054e-03  1.4152e-01  7.7931e-01         0.4358\nHanshou        2.5878e-02 -6.0620e-04  1.0167e-02  2.6266e-01         0.7928\nHengdong       9.9964e-03 -4.9063e-04  6.7742e-03  1.2742e-01         0.8986\nHengnan        2.8064e-02 -3.2160e-04  3.7597e-03  4.6294e-01         0.6434\nHengshan      -5.8201e-03 -3.0437e-05  5.1076e-04 -2.5618e-01         0.7978\nHengyang       6.2997e-02 -1.3046e-03  2.1865e-02  4.3486e-01         0.6637\nHongjiang      1.8790e-01 -2.3019e-03  3.1725e-02  1.0678e+00         0.2856\nHuarong       -1.5389e-02 -1.8667e-03  8.1030e-02 -4.7503e-02         0.9621\nHuayuan        8.3772e-02 -8.5569e-04  2.4495e-02  5.4072e-01         0.5887\nHuitong        2.5997e-01 -5.2447e-03  1.1077e-01  7.9685e-01         0.4255\nJiahe         -1.2431e-01 -3.0550e-03  5.1111e-02 -5.3633e-01         0.5917\nJianghua       2.8651e-01 -3.8280e-03  8.0968e-02  1.0204e+00         0.3076\nJiangyong      2.4337e-01 -2.7082e-03  1.1746e-01  7.1800e-01         0.4728\nJingzhou       1.8270e-01 -8.5106e-04  2.4363e-02  1.1759e+00         0.2396\nJinshi        -1.1988e-02 -5.3666e-03  1.1334e-01 -1.9667e-02         0.9843\nJishou        -2.8680e-01 -2.6305e-03  4.4028e-02 -1.3543e+00         0.1756\nLanshan        6.3334e-02 -9.6365e-04  2.0441e-02  4.4972e-01         0.6529\nLeiyang        1.1581e-02 -1.4948e-04  2.5082e-03  2.3422e-01         0.8148\nLengshuijiang -1.7903e+00 -8.2129e-02  2.1598e+00 -1.1623e+00         0.2451\nLi             1.0225e-03 -2.4048e-07  5.1060e-06  4.5260e-01         0.6508\nLianyuan      -1.4672e-01 -1.8983e-03  1.9145e-02 -1.0467e+00         0.2952\nLiling         1.3774e+00 -1.5097e-02  4.2601e-01  2.1335e+00         0.0329\nLinli          1.4815e-02 -6.8294e-05  1.4499e-03  3.9086e-01         0.6959\nLinwu         -2.4621e-03 -9.0703e-06  1.9258e-04 -1.7676e-01         0.8597\nLinxiang       6.5904e-02 -2.9028e-03  2.5470e-01  1.3634e-01         0.8916\nLiuyang        3.3688e+00 -7.7502e-02  1.5180e+00  2.7972e+00         0.0052\nLonghui        8.0801e-01 -1.1377e-02  1.5538e-01  2.0787e+00         0.0376\nLongshan       7.5663e-01 -1.1100e-02  3.1449e-01  1.3690e+00         0.1710\nLuxi           1.8177e-01 -2.4855e-03  3.4249e-02  9.9561e-01         0.3194\nMayang         2.1852e-01 -5.8773e-03  9.8049e-02  7.1663e-01         0.4736\nMiluo          1.8704e+00 -1.6927e-02  2.7925e-01  3.5715e+00         0.0004\nNan           -9.5789e-03 -4.9497e-04  6.8341e-03 -1.0988e-01         0.9125\nNingxiang      1.5607e+00 -7.3878e-02  8.0012e-01  1.8274e+00         0.0676\nNingyuan       2.0910e-01 -7.0884e-03  8.2306e-02  7.5356e-01         0.4511\nPingjiang     -9.8964e-01 -2.6457e-03  5.6027e-02 -4.1698e+00         0.0000\nQidong         1.1806e-01 -2.1207e-03  2.4747e-02  7.6396e-01         0.4449\nQiyang         6.1966e-02 -7.3374e-04  8.5743e-03  6.7712e-01         0.4983\nRucheng       -3.6992e-01 -8.8999e-03  2.5272e-01 -7.1814e-01         0.4727\nSangzhi        2.5053e-01 -4.9470e-03  6.8000e-02  9.7972e-01         0.3272\nShaodong      -3.2659e-02 -3.6592e-05  5.0546e-04 -1.4510e+00         0.1468\nShaoshan       2.1223e+00 -5.0227e-02  1.3668e+00  1.8583e+00         0.0631\nShaoyang       5.9499e-01 -1.1253e-02  1.3012e-01  1.6807e+00         0.0928\nShimen        -3.8794e-02 -3.8603e-04  6.4756e-03 -4.7729e-01         0.6332\nShuangfeng     9.2835e-03 -2.2867e-03  3.1516e-02  6.5174e-02         0.9480\nShuangpai      8.0591e-02 -3.1366e-04  8.9838e-03  8.5358e-01         0.3933\nSuining        3.7585e-01 -3.5933e-03  4.1870e-02  1.8544e+00         0.0637\nTaojiang      -2.5394e-01 -1.2395e-03  1.4477e-02 -2.1002e+00         0.0357\nTaoyuan        1.4729e-02 -1.2039e-04  8.5103e-04  5.0903e-01         0.6107\nTongdao        4.6482e-01 -6.9870e-03  1.9879e-01  1.0582e+00         0.2900\nWangcheng      4.4220e+00 -1.1067e-01  1.3596e+00  3.8873e+00         0.0001\nWugang         7.1003e-01 -7.8144e-03  1.0710e-01  2.1935e+00         0.0283\nXiangtan       2.4530e-01 -3.6457e-04  3.2319e-03  4.3213e+00         0.0000\nXiangxiang     2.6271e-01 -1.2703e-03  2.1290e-02  1.8092e+00         0.0704\nXiangyin       5.4525e-01 -4.7442e-03  7.9236e-02  1.9539e+00         0.0507\nXinhua         1.1810e-01 -6.2649e-03  8.6001e-02  4.2409e-01         0.6715\nXinhuang       1.5725e-01 -4.1820e-03  3.6648e-01  2.6667e-01         0.7897\nXinning        6.8928e-01 -9.6674e-03  2.0328e-01  1.5502e+00         0.1211\nXinshao        5.7578e-02 -8.5932e-03  1.1769e-01  1.9289e-01         0.8470\nXintian       -7.4050e-03 -5.1493e-03  1.0877e-01 -6.8395e-03         0.9945\nXupu           3.2406e-01 -5.7468e-03  5.7735e-02  1.3726e+00         0.1699\nYanling       -6.9021e-02 -5.9211e-04  9.9306e-03 -6.8667e-01         0.4923\nYizhang       -2.6844e-01 -2.2463e-03  4.7588e-02 -1.2202e+00         0.2224\nYongshun       6.3064e-01 -1.1350e-02  1.8830e-01  1.4795e+00         0.1390\nYongxing       4.3411e-01 -9.0735e-03  1.5088e-01  1.1409e+00         0.2539\nYou            7.8750e-02 -7.2728e-03  1.2116e-01  2.4714e-01         0.8048\nYuanjiang      2.0004e-04 -1.7760e-04  2.9798e-03  6.9181e-03         0.9945\nYuanling       8.7298e-03 -2.2981e-06  2.3221e-05  1.8121e+00         0.0700\nYueyang        4.1189e-02 -1.9768e-04  2.3113e-03  8.6085e-01         0.3893\nZhijiang       1.0476e-01 -7.8123e-04  1.3100e-02  9.2214e-01         0.3565\nZhongfang     -2.2685e-01 -2.1455e-03  3.5927e-02 -1.1855e+00         0.2358\nZhuzhou        3.2864e-01 -5.2432e-04  7.2391e-03  3.8688e+00         0.0001\nZixing        -7.6849e-01 -8.8210e-02  9.4057e-01 -7.0144e-01         0.4830\n\n\n\n\nMapping local Moran’s I\n\nhunan.localMI &lt;- cbind(hunan,localMI) %&gt;%\n  rename(Pr.Ii = Pr.z....E.Ii..)\n\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\",\n          palette = \"RdBu\",\n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\nlocalMI.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Ii\", \n          style = \"pretty\", \n          title = \"local moran statistics\") +\n  tm_borders(alpha = 0.5)\n\npvalue.map &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"Pr.Ii\", \n          breaks=c(-Inf, 0.001, 0.01, 0.05, 0.1, Inf),\n          palette=\"-Blues\", \n          title = \"local Moran's I p-values\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(localMI.map, pvalue.map, asp=1, ncol=2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#creating-a-lisa-cluster-map",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#creating-a-lisa-cluster-map",
    "title": "Hands-on_Ex2c",
    "section": "Creating a LISA Cluster Map",
    "text": "Creating a LISA Cluster Map\n\nScatter Plot\n\nnci &lt;- moran.plot(hunan$GDPPC, rswm_q,\n                  labels=as.character(hunan$County), \n                  xlab=\"GDPPC 2012\", \n                  ylab=\"Spatially Lag GDPPC 2012\")\n\n\n\n\n\nhunan$Z.GDPPC &lt;- scale(hunan$GDPPC) %&gt;% \n  as.vector \n\n\nnci2 &lt;- moran.plot(hunan$Z.GDPPC, rswm_q,\n                   labels=as.character(hunan$County),\n                   xlab=\"z-GDPPC 2012\", \n                   ylab=\"Spatially Lag z-GDPPC 2012\")\n\n\n\n\n\n\nPreparing Map Classes\n\nquadrant &lt;- vector(mode=\"numeric\",length=nrow(localMI))\n\n\nhunan$lag_GDPPC &lt;- lag.listw(rswm_q, hunan$GDPPC)\nDV &lt;- hunan$lag_GDPPC - mean(hunan$lag_GDPPC)     \n\n\nLM_I &lt;- localMI[,1] - mean(localMI[,1])    \n\n\nsignif &lt;- 0.05       \n\n\nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4      \n\n\nquadrant[localMI[,5]&gt;signif] &lt;- 0\n\nor we can combine the code as per below\nquadrant &lt;- vector(mode=\"numeric\",length=nrow(localMI))\nhunan$lag_GDPPC &lt;- lag.listw(rswm_q, hunan$GDPPC)\nDV &lt;- hunan$lag_GDPPC - mean(hunan$lag_GDPPC)     \nLM_I &lt;- localMI[,1]   \nsignif &lt;- 0.05       \nquadrant[DV &lt;0 & LM_I&gt;0] &lt;- 1\nquadrant[DV &gt;0 & LM_I&lt;0] &lt;- 2\nquadrant[DV &lt;0 & LM_I&lt;0] &lt;- 3  \nquadrant[DV &gt;0 & LM_I&gt;0] &lt;- 4    \nquadrant[localMI[,5]&gt;signif] &lt;- 0\n\n\nPlotting LISA Map\n\nhunan.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\ntm_shape(hunan.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\n\n\n\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\n\nhunan.localMI$quadrant &lt;- quadrant\ncolors &lt;- c(\"#ffffff\", \"#2c7bb6\", \"#abd9e9\", \"#fdae61\", \"#d7191c\")\nclusters &lt;- c(\"insignificant\", \"low-low\", \"low-high\", \"high-low\", \"high-high\")\n\nLISAmap &lt;- tm_shape(hunan.localMI) +\n  tm_fill(col = \"quadrant\", \n          style = \"cat\", \n          palette = colors[c(sort(unique(quadrant)))+1], \n          labels = clusters[c(sort(unique(quadrant)))+1],\n          popup.vars = c(\"\")) +\n  tm_view(set.zoom.limits = c(11,17)) +\n  tm_borders(alpha=0.5)\n\ntmap_arrange(gdppc, LISAmap, \n             asp=1, ncol=2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#hot-cold-spot-area-analysis",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#hot-cold-spot-area-analysis",
    "title": "Hands-on_Ex2c",
    "section": "Hot & Cold Spot Area Analysis",
    "text": "Hot & Cold Spot Area Analysis\n\nCentroid\n\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\n\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\n\ncoords &lt;- cbind(longitude, latitude)\n\n\n\nDetermine the cut-off disance\n\n#coords &lt;- coordinates(hunan)\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\n\n\nComputing fixed distance weight matrix\n\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\n\nwm62_lw &lt;- nb2listw(wm_d62, style = 'B')\nsummary(wm62_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \nLink number distribution:\n\n 1  2  3  4  5  6 \n 6 15 14 26 20  7 \n6 least connected regions:\n6 15 30 32 56 65 with 1 link\n7 most connected regions:\n21 28 35 45 50 52 82 with 6 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1   S2\nB 88 7744 324 648 5440"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#computing-adaptive-distance-weight-matrix",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#computing-adaptive-distance-weight-matrix",
    "title": "Hands-on_Ex2c",
    "section": "Computing adaptive distance weight matrix",
    "text": "Computing adaptive distance weight matrix\nusing only k-nearest neighbour instead of all\n\nknn &lt;- knn2nb(knearneigh(coords, k=8))\nknn\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 704 \nPercentage nonzero weights: 9.090909 \nAverage number of links: 8 \nNon-symmetric neighbours list\n\n\n\nknn_lw &lt;- nb2listw(knn, style = 'B')\nsummary(knn_lw)\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 704 \nPercentage nonzero weights: 9.090909 \nAverage number of links: 8 \nNon-symmetric neighbours list\nLink number distribution:\n\n 8 \n88 \n88 least connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 8 links\n88 most connected regions:\n1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 with 8 links\n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 704 1300 23014"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#computing-gi-statistics",
    "href": "Hands-on_Ex/Hands-on_Ex2c/Hands-on_Ex2c.html#computing-gi-statistics",
    "title": "Hands-on_Ex2c",
    "section": "Computing Gi statistics",
    "text": "Computing Gi statistics\n\nfips &lt;- order(hunan$County)\ngi.fixed &lt;- localG(hunan$GDPPC, wm62_lw)\ngi.fixed\n\n [1]  0.436075843 -0.265505650 -0.073033665  0.413017033  0.273070579\n [6] -0.377510776  2.863898821  2.794350420  5.216125401  0.228236603\n[11]  0.951035346 -0.536334231  0.176761556  1.195564020 -0.033020610\n[16]  1.378081093 -0.585756761 -0.419680565  0.258805141  0.012056111\n[21] -0.145716531 -0.027158687 -0.318615290 -0.748946051 -0.961700582\n[26] -0.796851342 -1.033949773 -0.460979158 -0.885240161 -0.266671512\n[31] -0.886168613 -0.855476971 -0.922143185 -1.162328599  0.735582222\n[36] -0.003358489 -0.967459309 -1.259299080 -1.452256513 -1.540671121\n[41] -1.395011407 -1.681505286 -1.314110709 -0.767944457 -0.192889342\n[46]  2.720804542  1.809191360 -1.218469473 -0.511984469 -0.834546363\n[51] -0.908179070 -1.541081516 -1.192199867 -1.075080164 -1.631075961\n[56] -0.743472246  0.418842387  0.832943753 -0.710289083 -0.449718820\n[61] -0.493238743 -1.083386776  0.042979051  0.008596093  0.136337469\n[66]  2.203411744  2.690329952  4.453703219 -0.340842743 -0.129318589\n[71]  0.737806634 -1.246912658  0.666667559  1.088613505 -0.985792573\n[76]  1.233609606 -0.487196415  1.626174042 -1.060416797  0.425361422\n[81] -0.837897118 -0.314565243  0.371456331  4.424392623 -0.109566928\n[86]  1.364597995 -1.029658605 -0.718000620\nattr(,\"internals\")\n               Gi      E(Gi)        V(Gi)        Z(Gi) Pr(z != E(Gi))\n [1,] 0.064192949 0.05747126 2.375922e-04  0.436075843   6.627817e-01\n [2,] 0.042300020 0.04597701 1.917951e-04 -0.265505650   7.906200e-01\n [3,] 0.044961480 0.04597701 1.933486e-04 -0.073033665   9.417793e-01\n [4,] 0.039475779 0.03448276 1.461473e-04  0.413017033   6.795941e-01\n [5,] 0.049767939 0.04597701 1.927263e-04  0.273070579   7.847990e-01\n [6,] 0.008825335 0.01149425 4.998177e-05 -0.377510776   7.057941e-01\n [7,] 0.050807266 0.02298851 9.435398e-05  2.863898821   4.184617e-03\n [8,] 0.083966739 0.04597701 1.848292e-04  2.794350420   5.200409e-03\n [9,] 0.115751554 0.04597701 1.789361e-04  5.216125401   1.827045e-07\n[10,] 0.049115587 0.04597701 1.891013e-04  0.228236603   8.194623e-01\n[11,] 0.045819180 0.03448276 1.420884e-04  0.951035346   3.415864e-01\n[12,] 0.049183846 0.05747126 2.387633e-04 -0.536334231   5.917276e-01\n[13,] 0.048429181 0.04597701 1.924532e-04  0.176761556   8.596957e-01\n[14,] 0.034733752 0.02298851 9.651140e-05  1.195564020   2.318667e-01\n[15,] 0.011262043 0.01149425 4.945294e-05 -0.033020610   9.736582e-01\n[16,] 0.065131196 0.04597701 1.931870e-04  1.378081093   1.681783e-01\n[17,] 0.027587075 0.03448276 1.385862e-04 -0.585756761   5.580390e-01\n[18,] 0.029409313 0.03448276 1.461397e-04 -0.419680565   6.747188e-01\n[19,] 0.061466754 0.05747126 2.383385e-04  0.258805141   7.957856e-01\n[20,] 0.057656917 0.05747126 2.371303e-04  0.012056111   9.903808e-01\n[21,] 0.066518379 0.06896552 2.820326e-04 -0.145716531   8.841452e-01\n[22,] 0.045599896 0.04597701 1.928108e-04 -0.027158687   9.783332e-01\n[23,] 0.030646753 0.03448276 1.449523e-04 -0.318615290   7.500183e-01\n[24,] 0.035635552 0.04597701 1.906613e-04 -0.748946051   4.538897e-01\n[25,] 0.032606647 0.04597701 1.932888e-04 -0.961700582   3.362000e-01\n[26,] 0.035001352 0.04597701 1.897172e-04 -0.796851342   4.255374e-01\n[27,] 0.012746354 0.02298851 9.812587e-05 -1.033949773   3.011596e-01\n[28,] 0.061287917 0.06896552 2.773884e-04 -0.460979158   6.448136e-01\n[29,] 0.014277403 0.02298851 9.683314e-05 -0.885240161   3.760271e-01\n[30,] 0.009622875 0.01149425 4.924586e-05 -0.266671512   7.897221e-01\n[31,] 0.014258398 0.02298851 9.705244e-05 -0.886168613   3.755267e-01\n[32,] 0.005453443 0.01149425 4.986245e-05 -0.855476971   3.922871e-01\n[33,] 0.043283712 0.05747126 2.367109e-04 -0.922143185   3.564539e-01\n[34,] 0.020763514 0.03448276 1.393165e-04 -1.162328599   2.451020e-01\n[35,] 0.081261843 0.06896552 2.794398e-04  0.735582222   4.619850e-01\n[36,] 0.057419907 0.05747126 2.338437e-04 -0.003358489   9.973203e-01\n[37,] 0.013497133 0.02298851 9.624821e-05 -0.967459309   3.333145e-01\n[38,] 0.019289310 0.03448276 1.455643e-04 -1.259299080   2.079223e-01\n[39,] 0.025996272 0.04597701 1.892938e-04 -1.452256513   1.464303e-01\n[40,] 0.016092694 0.03448276 1.424776e-04 -1.540671121   1.233968e-01\n[41,] 0.035952614 0.05747126 2.379439e-04 -1.395011407   1.630124e-01\n[42,] 0.031690963 0.05747126 2.350604e-04 -1.681505286   9.266481e-02\n[43,] 0.018750079 0.03448276 1.433314e-04 -1.314110709   1.888090e-01\n[44,] 0.015449080 0.02298851 9.638666e-05 -0.767944457   4.425202e-01\n[45,] 0.065760689 0.06896552 2.760533e-04 -0.192889342   8.470456e-01\n[46,] 0.098966900 0.05747126 2.326002e-04  2.720804542   6.512325e-03\n[47,] 0.085415780 0.05747126 2.385746e-04  1.809191360   7.042128e-02\n[48,] 0.038816536 0.05747126 2.343951e-04 -1.218469473   2.230456e-01\n[49,] 0.038931873 0.04597701 1.893501e-04 -0.511984469   6.086619e-01\n[50,] 0.055098610 0.06896552 2.760948e-04 -0.834546363   4.039732e-01\n[51,] 0.033405005 0.04597701 1.916312e-04 -0.908179070   3.637836e-01\n[52,] 0.043040784 0.06896552 2.829941e-04 -1.541081516   1.232969e-01\n[53,] 0.011297699 0.02298851 9.615920e-05 -1.192199867   2.331829e-01\n[54,] 0.040968457 0.05747126 2.356318e-04 -1.075080164   2.823388e-01\n[55,] 0.023629663 0.04597701 1.877170e-04 -1.631075961   1.028743e-01\n[56,] 0.006281129 0.01149425 4.916619e-05 -0.743472246   4.571958e-01\n[57,] 0.063918654 0.05747126 2.369553e-04  0.418842387   6.753313e-01\n[58,] 0.070325003 0.05747126 2.381374e-04  0.832943753   4.048765e-01\n[59,] 0.025947288 0.03448276 1.444058e-04 -0.710289083   4.775249e-01\n[60,] 0.039752578 0.04597701 1.915656e-04 -0.449718820   6.529132e-01\n[61,] 0.049934283 0.05747126 2.334965e-04 -0.493238743   6.218439e-01\n[62,] 0.030964195 0.04597701 1.920248e-04 -1.083386776   2.786368e-01\n[63,] 0.058129184 0.05747126 2.343319e-04  0.042979051   9.657182e-01\n[64,] 0.046096514 0.04597701 1.932637e-04  0.008596093   9.931414e-01\n[65,] 0.012459080 0.01149425 5.008051e-05  0.136337469   8.915545e-01\n[66,] 0.091447733 0.05747126 2.377744e-04  2.203411744   2.756574e-02\n[67,] 0.049575872 0.02298851 9.766513e-05  2.690329952   7.138140e-03\n[68,] 0.107907212 0.04597701 1.933581e-04  4.453703219   8.440175e-06\n[69,] 0.019616151 0.02298851 9.789454e-05 -0.340842743   7.332220e-01\n[70,] 0.032923393 0.03448276 1.454032e-04 -0.129318589   8.971056e-01\n[71,] 0.030317663 0.02298851 9.867859e-05  0.737806634   4.606320e-01\n[72,] 0.019437582 0.03448276 1.455870e-04 -1.246912658   2.124295e-01\n[73,] 0.055245460 0.04597701 1.932838e-04  0.666667559   5.049845e-01\n[74,] 0.074278054 0.05747126 2.383538e-04  1.088613505   2.763244e-01\n[75,] 0.013269580 0.02298851 9.719982e-05 -0.985792573   3.242349e-01\n[76,] 0.049407829 0.03448276 1.463785e-04  1.233609606   2.173484e-01\n[77,] 0.028605749 0.03448276 1.455139e-04 -0.487196415   6.261191e-01\n[78,] 0.039087662 0.02298851 9.801040e-05  1.626174042   1.039126e-01\n[79,] 0.031447120 0.04597701 1.877464e-04 -1.060416797   2.889550e-01\n[80,] 0.064005294 0.05747126 2.359641e-04  0.425361422   6.705732e-01\n[81,] 0.044606529 0.05747126 2.357330e-04 -0.837897118   4.020885e-01\n[82,] 0.063700493 0.06896552 2.801427e-04 -0.314565243   7.530918e-01\n[83,] 0.051142205 0.04597701 1.933560e-04  0.371456331   7.102977e-01\n[84,] 0.102121112 0.04597701 1.610278e-04  4.424392623   9.671399e-06\n[85,] 0.021901462 0.02298851 9.843172e-05 -0.109566928   9.127528e-01\n[86,] 0.064931813 0.04597701 1.929430e-04  1.364597995   1.723794e-01\n[87,] 0.031747344 0.04597701 1.909867e-04 -1.029658605   3.031703e-01\n[88,] 0.015893319 0.02298851 9.765131e-05 -0.718000620   4.727569e-01\nattr(,\"cluster\")\n [1] Low  Low  High High High High High High High Low  Low  High Low  Low  Low \n[16] High High High High Low  High High Low  Low  High Low  Low  Low  Low  Low \n[31] Low  Low  Low  High Low  Low  Low  Low  Low  Low  High Low  Low  Low  Low \n[46] High High Low  Low  Low  Low  High Low  Low  Low  Low  Low  High Low  Low \n[61] Low  Low  Low  High High High Low  High Low  Low  High Low  High High Low \n[76] High Low  Low  Low  Low  Low  Low  High High Low  High Low  Low \nLevels: Low High\nattr(,\"gstari\")\n[1] FALSE\nattr(,\"call\")\nlocalG(x = hunan$GDPPC, listw = wm62_lw)\nattr(,\"class\")\n[1] \"localG\"\n\n\n\nhunan.gi &lt;- cbind(hunan, as.matrix(gi.fixed)) %&gt;%\n  rename(gstat_fixed = as.matrix.gi.fixed.)\n\n\nMapping Gi values with fixed distance weights\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\n\nGimap &lt;-tm_shape(hunan.gi) +\n  tm_fill(col = \"gstat_fixed\", \n          style = \"pretty\",\n          palette=\"-RdBu\",\n          title = \"local Gi\") +\n  tm_borders(alpha = 0.5)\n\ntmap_arrange(gdppc, Gimap, asp=1, ncol=2)\n\n\n\n\n\n\nMapping Gi values with adaptive distance weights\n\nfips &lt;- order(hunan$County)\ngi.adaptive &lt;- localG(hunan$GDPPC, knn_lw)\nhunan.gi &lt;- cbind(hunan, as.matrix(gi.adaptive)) %&gt;%\n  rename(gstat_adaptive = as.matrix.gi.adaptive.)\n\n\ngdppc&lt;- qtm(hunan, \"GDPPC\")\n\nGimap &lt;- tm_shape(hunan.gi) + \n  tm_fill(col = \"gstat_adaptive\", \n          style = \"pretty\", \n          palette=\"-RdBu\", \n          title = \"local Gi\") + \n  tm_borders(alpha = 0.5)\n\ntmap_arrange(gdppc, \n             Gimap, \n             asp=1, \n             ncol=2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html",
    "href": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html",
    "title": "Hands-on_Ex2a",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse, knitr)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#getting-started",
    "title": "Hands-on_Ex2a",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse, knitr)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#import-data",
    "href": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#import-data",
    "title": "Hands-on_Ex2a",
    "section": "Import Data",
    "text": "Import Data\n\nImport basemap\nHunan\n\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\worksheep\\ISSS624\\Hands-on_Ex\\Hands-on_Ex2a\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\nImport metadata\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\n\n\nJoining the data together\n\nhunan_allmerged &lt;- left_join(hunan,hunan2012)\n\n\nhunan &lt;- hunan_allmerged %&gt;% select(1:4,7,15)\n\nthis is the previous code given by prof, but i wanted to split it up to see what the dataset is\nhunan &lt;- left_join(hunan,hunan2012)%&gt;% select(1:4, 7, 15)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#visualisation",
    "href": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#visualisation",
    "title": "Hands-on_Ex2a",
    "section": "Visualisation",
    "text": "Visualisation\n\nGDP Per Capita 2012\n\nbasemap &lt;- tm_shape(hunan) +\n  tm_polygons() +\n  tm_text(\"NAME_3\", size=0.5)\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#find-my-neighbour",
    "href": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#find-my-neighbour",
    "title": "Hands-on_Ex2a",
    "section": "Find my Neighbour",
    "text": "Find my Neighbour\n\nUsing Queen\n\nwm_q &lt;- poly2nb(hunan, queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\n30 is xinhuang 85 is xiangtan\n\nwm_q[[30]]\n\n[1] 33\n\n\n\nhunan$County[c(30,33)]\n\n[1] \"Xinhuang\" \"Zhijiang\"\n\n\n\nnb2 &lt;- wm_q[[85]]\nhunan$County[c(85,nb2)]\n\n [1] \"Taoyuan\"  \"Anxiang\"  \"Hanshou\"  \"Jinshi\"   \"Linli\"    \"Shimen\"  \n [7] \"Yuanling\" \"Anhua\"    \"Nan\"      \"Cili\"     \"Sangzhi\"  \"Taojiang\"\n\n\n\nhunan$NAME_3[c(2,3,4,57,85)]\n\n[1] \"Hanshou\" \"Jinshi\"  \"Li\"      \"Nan\"     \"Taoyuan\"\n\n\nQ: i want to colour the map differently. i\n\n# Set the colors\nhighlight_color &lt;- \"red\"\nneighbors_color &lt;- \"blue\"\nother_color &lt;- \"grey\"\n\n# Create a new column in your data for the colors\nhunan$colors &lt;- other_color\n\n# Set the color for the county and its neighbors\nhunan$colors[85] &lt;- highlight_color\nhunan$colors[nb2] &lt;- neighbors_color\n\n# Plot the map\ntm_shape(hunan) +\n  tm_fill(col = \"colors\") +\n  tm_borders() + \n  tm_text(\"County\", size=0.5)\n\n\n\n\n\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n[1] 20981 34592 24473 21311 22879\n\n\n\nstr(wm_q)\n\nList of 88\n $ : int [1:5] 2 3 4 57 85\n $ : int [1:5] 1 57 58 78 85\n $ : int [1:4] 1 4 5 85\n $ : int [1:4] 1 3 5 6\n $ : int [1:4] 3 4 6 85\n $ : int [1:5] 4 5 69 75 85\n $ : int [1:4] 67 71 74 84\n $ : int [1:7] 9 46 47 56 78 80 86\n $ : int [1:6] 8 66 68 78 84 86\n $ : int [1:8] 16 17 19 20 22 70 72 73\n $ : int [1:3] 14 17 72\n $ : int [1:5] 13 60 61 63 83\n $ : int [1:4] 12 15 60 83\n $ : int [1:3] 11 15 17\n $ : int [1:4] 13 14 17 83\n $ : int [1:5] 10 17 22 72 83\n $ : int [1:7] 10 11 14 15 16 72 83\n $ : int [1:5] 20 22 23 77 83\n $ : int [1:6] 10 20 21 73 74 86\n $ : int [1:7] 10 18 19 21 22 23 82\n $ : int [1:5] 19 20 35 82 86\n $ : int [1:5] 10 16 18 20 83\n $ : int [1:7] 18 20 38 41 77 79 82\n $ : int [1:5] 25 28 31 32 54\n $ : int [1:5] 24 28 31 33 81\n $ : int [1:4] 27 33 42 81\n $ : int [1:3] 26 29 42\n $ : int [1:5] 24 25 33 49 54\n $ : int [1:3] 27 37 42\n $ : int 33\n $ : int [1:8] 24 25 32 36 39 40 56 81\n $ : int [1:8] 24 31 50 54 55 56 75 85\n $ : int [1:5] 25 26 28 30 81\n $ : int [1:3] 36 45 80\n $ : int [1:6] 21 41 47 80 82 86\n $ : int [1:6] 31 34 40 45 56 80\n $ : int [1:4] 29 42 43 44\n $ : int [1:4] 23 44 77 79\n $ : int [1:5] 31 40 42 43 81\n $ : int [1:6] 31 36 39 43 45 79\n $ : int [1:6] 23 35 45 79 80 82\n $ : int [1:7] 26 27 29 37 39 43 81\n $ : int [1:6] 37 39 40 42 44 79\n $ : int [1:4] 37 38 43 79\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:3] 8 47 86\n $ : int [1:5] 8 35 46 80 86\n $ : int [1:5] 50 51 52 53 55\n $ : int [1:4] 28 51 52 54\n $ : int [1:5] 32 48 52 54 55\n $ : int [1:3] 48 49 52\n $ : int [1:5] 48 49 50 51 54\n $ : int [1:3] 48 55 75\n $ : int [1:6] 24 28 32 49 50 52\n $ : int [1:5] 32 48 50 53 75\n $ : int [1:7] 8 31 32 36 78 80 85\n $ : int [1:6] 1 2 58 64 76 85\n $ : int [1:5] 2 57 68 76 78\n $ : int [1:4] 60 61 87 88\n $ : int [1:4] 12 13 59 61\n $ : int [1:7] 12 59 60 62 63 77 87\n $ : int [1:3] 61 77 87\n $ : int [1:4] 12 61 77 83\n $ : int [1:2] 57 76\n $ : int 76\n $ : int [1:5] 9 67 68 76 84\n $ : int [1:4] 7 66 76 84\n $ : int [1:5] 9 58 66 76 78\n $ : int [1:3] 6 75 85\n $ : int [1:3] 10 72 73\n $ : int [1:3] 7 73 74\n $ : int [1:5] 10 11 16 17 70\n $ : int [1:5] 10 19 70 71 74\n $ : int [1:6] 7 19 71 73 84 86\n $ : int [1:6] 6 32 53 55 69 85\n $ : int [1:7] 57 58 64 65 66 67 68\n $ : int [1:7] 18 23 38 61 62 63 83\n $ : int [1:7] 2 8 9 56 58 68 85\n $ : int [1:7] 23 38 40 41 43 44 45\n $ : int [1:8] 8 34 35 36 41 45 47 56\n $ : int [1:6] 25 26 31 33 39 42\n $ : int [1:5] 20 21 23 35 41\n $ : int [1:9] 12 13 15 16 17 18 22 63 77\n $ : int [1:6] 7 9 66 67 74 86\n $ : int [1:11] 1 2 3 5 6 32 56 57 69 75 ...\n $ : int [1:9] 8 9 19 21 35 46 47 74 84\n $ : int [1:4] 59 61 62 88\n $ : int [1:2] 59 87\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language poly2nb(pl = hunan, queen = TRUE)\n - attr(*, \"type\")= chr \"queen\"\n - attr(*, \"sym\")= logi TRUE\n\n\n\n\nUsing Rook\ngenerate the neighbour list\n\nwm_r &lt;- poly2nb(hunan, queen=FALSE)\nsummary(wm_r)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 440 \nPercentage nonzero weights: 5.681818 \nAverage number of links: 5 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 10 \n 2  2 12 20 21 14 11  3  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 10 links\n\n\n\nlongitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[1]])\n\n\nlatitude &lt;- map_dbl(hunan$geometry, ~st_centroid(.x)[[2]])\n\n\ncoords &lt;- cbind(longitude, latitude)\n\n\nhead(coords)\n\n     longitude latitude\n[1,]  112.1531 29.44362\n[2,]  112.0372 28.86489\n[3,]  111.8917 29.47107\n[4,]  111.7031 29.74499\n[5,]  111.6138 29.49258\n[6,]  111.0341 29.79863"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#plotting",
    "href": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#plotting",
    "title": "Hands-on_Ex2a",
    "section": "Plotting",
    "text": "Plotting\n\nQueen\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col= \"red\")\n\n\n\n\n\n\nRook\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")\n\n\n\n\n\npar(mfrow=c(1,2))\nplot(hunan$geometry, border=\"lightgrey\", main=\"Queen Contiguity\")\nplot(wm_q, coords, pch = 19, cex = 0.6, add = TRUE, col= \"red\")\nplot(hunan$geometry, border=\"lightgrey\", main=\"Rook Contiguity\")\nplot(wm_r, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#distance-based-neighbour",
    "href": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#distance-based-neighbour",
    "title": "Hands-on_Ex2a",
    "section": "Distance Based Neighbour",
    "text": "Distance Based Neighbour\n\n#coords &lt;- coordinates(hunan)\nk1 &lt;- knn2nb(knearneigh(coords))\nk1dists &lt;- unlist(nbdists(k1, coords, longlat = TRUE))\nsummary(k1dists)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  24.79   32.57   38.01   39.07   44.52   61.79 \n\n\n\nwm_d62 &lt;- dnearneigh(coords, 0, 62, longlat = TRUE)\nwm_d62\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 324 \nPercentage nonzero weights: 4.183884 \nAverage number of links: 3.681818 \n\n\nAns: the 3.68… refer to the av number of neighbour each county has that is within a distance of 62km\n\nstr(wm_d62)\n\nList of 88\n $ : int [1:5] 3 4 5 57 64\n $ : int [1:4] 57 58 78 85\n $ : int [1:4] 1 4 5 57\n $ : int [1:3] 1 3 5\n $ : int [1:4] 1 3 4 85\n $ : int 69\n $ : int [1:2] 67 84\n $ : int [1:4] 9 46 47 78\n $ : int [1:4] 8 46 68 84\n $ : int [1:4] 16 22 70 72\n $ : int [1:3] 14 17 72\n $ : int [1:5] 13 60 61 63 83\n $ : int [1:4] 12 15 60 83\n $ : int [1:2] 11 17\n $ : int 13\n $ : int [1:4] 10 17 22 83\n $ : int [1:3] 11 14 16\n $ : int [1:3] 20 22 63\n $ : int [1:5] 20 21 73 74 82\n $ : int [1:5] 18 19 21 22 82\n $ : int [1:6] 19 20 35 74 82 86\n $ : int [1:4] 10 16 18 20\n $ : int [1:3] 41 77 82\n $ : int [1:4] 25 28 31 54\n $ : int [1:4] 24 28 33 81\n $ : int [1:4] 27 33 42 81\n $ : int [1:2] 26 29\n $ : int [1:6] 24 25 33 49 52 54\n $ : int [1:2] 27 37\n $ : int 33\n $ : int [1:2] 24 36\n $ : int 50\n $ : int [1:5] 25 26 28 30 81\n $ : int [1:3] 36 45 80\n $ : int [1:6] 21 41 46 47 80 82\n $ : int [1:5] 31 34 45 56 80\n $ : int [1:2] 29 42\n $ : int [1:3] 44 77 79\n $ : int [1:4] 40 42 43 81\n $ : int [1:3] 39 45 79\n $ : int [1:5] 23 35 45 79 82\n $ : int [1:5] 26 37 39 43 81\n $ : int [1:3] 39 42 44\n $ : int [1:2] 38 43\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:5] 8 9 35 47 86\n $ : int [1:5] 8 35 46 80 86\n $ : int [1:5] 50 51 52 53 55\n $ : int [1:4] 28 51 52 54\n $ : int [1:6] 32 48 51 52 54 55\n $ : int [1:4] 48 49 50 52\n $ : int [1:6] 28 48 49 50 51 54\n $ : int [1:2] 48 55\n $ : int [1:5] 24 28 49 50 52\n $ : int [1:4] 48 50 53 75\n $ : int 36\n $ : int [1:5] 1 2 3 58 64\n $ : int [1:5] 2 57 64 66 68\n $ : int [1:3] 60 87 88\n $ : int [1:4] 12 13 59 61\n $ : int [1:5] 12 60 62 63 87\n $ : int [1:4] 61 63 77 87\n $ : int [1:5] 12 18 61 62 83\n $ : int [1:4] 1 57 58 76\n $ : int 76\n $ : int [1:5] 58 67 68 76 84\n $ : int [1:2] 7 66\n $ : int [1:4] 9 58 66 84\n $ : int [1:2] 6 75\n $ : int [1:3] 10 72 73\n $ : int [1:2] 73 74\n $ : int [1:3] 10 11 70\n $ : int [1:4] 19 70 71 74\n $ : int [1:5] 19 21 71 73 86\n $ : int [1:2] 55 69\n $ : int [1:3] 64 65 66\n $ : int [1:3] 23 38 62\n $ : int [1:2] 2 8\n $ : int [1:4] 38 40 41 45\n $ : int [1:5] 34 35 36 45 47\n $ : int [1:5] 25 26 33 39 42\n $ : int [1:6] 19 20 21 23 35 41\n $ : int [1:4] 12 13 16 63\n $ : int [1:4] 7 9 66 68\n $ : int [1:2] 2 5\n $ : int [1:4] 21 46 47 74\n $ : int [1:4] 59 61 62 88\n $ : int [1:2] 59 87\n - attr(*, \"class\")= chr \"nb\"\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language dnearneigh(x = coords, d1 = 0, d2 = 62, longlat = TRUE)\n - attr(*, \"dnn\")= num [1:2] 0 62\n - attr(*, \"bounds\")= chr [1:2] \"GE\" \"LE\"\n - attr(*, \"nbtype\")= chr \"distance\"\n - attr(*, \"sym\")= logi TRUE\n\n\n\ntable(hunan$County, card(wm_d62))\n\n               \n                1 2 3 4 5 6\n  Anhua         1 0 0 0 0 0\n  Anren         0 0 0 1 0 0\n  Anxiang       0 0 0 0 1 0\n  Baojing       0 0 0 0 1 0\n  Chaling       0 0 1 0 0 0\n  Changning     0 0 1 0 0 0\n  Changsha      0 0 0 1 0 0\n  Chengbu       0 1 0 0 0 0\n  Chenxi        0 0 0 1 0 0\n  Cili          0 1 0 0 0 0\n  Dao           0 0 0 1 0 0\n  Dongan        0 0 1 0 0 0\n  Dongkou       0 0 0 1 0 0\n  Fenghuang     0 0 0 1 0 0\n  Guidong       0 0 1 0 0 0\n  Guiyang       0 0 0 1 0 0\n  Guzhang       0 0 0 0 0 1\n  Hanshou       0 0 0 1 0 0\n  Hengdong      0 0 0 0 1 0\n  Hengnan       0 0 0 0 1 0\n  Hengshan      0 0 0 0 0 1\n  Hengyang      0 0 0 0 0 1\n  Hongjiang     0 0 0 0 1 0\n  Huarong       0 0 0 1 0 0\n  Huayuan       0 0 0 1 0 0\n  Huitong       0 0 0 1 0 0\n  Jiahe         0 0 0 0 1 0\n  Jianghua      0 0 1 0 0 0\n  Jiangyong     0 1 0 0 0 0\n  Jingzhou      0 1 0 0 0 0\n  Jinshi        0 0 0 1 0 0\n  Jishou        0 0 0 0 0 1\n  Lanshan       0 0 0 1 0 0\n  Leiyang       0 0 0 1 0 0\n  Lengshuijiang 0 0 1 0 0 0\n  Li            0 0 1 0 0 0\n  Lianyuan      0 0 0 0 1 0\n  Liling        0 1 0 0 0 0\n  Linli         0 0 0 1 0 0\n  Linwu         0 0 0 1 0 0\n  Linxiang      1 0 0 0 0 0\n  Liuyang       0 1 0 0 0 0\n  Longhui       0 0 1 0 0 0\n  Longshan      0 1 0 0 0 0\n  Luxi          0 0 0 0 1 0\n  Mayang        0 0 0 0 0 1\n  Miluo         0 0 0 0 1 0\n  Nan           0 0 0 0 1 0\n  Ningxiang     0 0 0 1 0 0\n  Ningyuan      0 0 0 0 1 0\n  Pingjiang     0 1 0 0 0 0\n  Qidong        0 0 1 0 0 0\n  Qiyang        0 0 1 0 0 0\n  Rucheng       0 1 0 0 0 0\n  Sangzhi       0 1 0 0 0 0\n  Shaodong      0 0 0 0 1 0\n  Shaoshan      0 0 0 0 1 0\n  Shaoyang      0 0 0 1 0 0\n  Shimen        1 0 0 0 0 0\n  Shuangfeng    0 0 0 0 0 1\n  Shuangpai     0 0 0 1 0 0\n  Suining       0 0 0 0 1 0\n  Taojiang      0 1 0 0 0 0\n  Taoyuan       0 1 0 0 0 0\n  Tongdao       0 1 0 0 0 0\n  Wangcheng     0 0 0 1 0 0\n  Wugang        0 0 1 0 0 0\n  Xiangtan      0 0 0 1 0 0\n  Xiangxiang    0 0 0 0 1 0\n  Xiangyin      0 0 0 1 0 0\n  Xinhua        0 0 0 0 1 0\n  Xinhuang      1 0 0 0 0 0\n  Xinning       0 1 0 0 0 0\n  Xinshao       0 0 0 0 0 1\n  Xintian       0 0 0 0 1 0\n  Xupu          0 1 0 0 0 0\n  Yanling       0 0 1 0 0 0\n  Yizhang       1 0 0 0 0 0\n  Yongshun      0 0 0 1 0 0\n  Yongxing      0 0 0 1 0 0\n  You           0 0 0 1 0 0\n  Yuanjiang     0 0 0 0 1 0\n  Yuanling      1 0 0 0 0 0\n  Yueyang       0 0 1 0 0 0\n  Zhijiang      0 0 0 0 1 0\n  Zhongfang     0 0 0 1 0 0\n  Zhuzhou       0 0 0 0 1 0\n  Zixing        0 0 1 0 0 0\n\n\n\nn_comp &lt;- n.comp.nb(wm_d62)\nn_comp$nc\n\n[1] 1\n\n\n\ntable(n_comp$comp.id)\n\n\n 1 \n88 \n\n\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(wm_d62, coords, add=TRUE)\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08)\n\n\n\n\n\npar(mfrow=c(1,2))\nplot(hunan$geometry, border=\"lightgrey\", main=\"1st nearest neighbours\")\nplot(k1, coords, add=TRUE, col=\"red\", length=0.08)\nplot(hunan$geometry, border=\"lightgrey\", main=\"Distance link\")\nplot(wm_d62, coords, add=TRUE, pch = 19, cex = 0.6)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#finding-k-nearest-neighbour",
    "href": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#finding-k-nearest-neighbour",
    "title": "Hands-on_Ex2a",
    "section": "Finding K nearest neighbour",
    "text": "Finding K nearest neighbour\n\nknn6 &lt;- knn2nb(knearneigh(coords, k=6))\nknn6\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 528 \nPercentage nonzero weights: 6.818182 \nAverage number of links: 6 \nNon-symmetric neighbours list\n\n\n\nstr(knn6)\n\nList of 88\n $ : int [1:6] 2 3 4 5 57 64\n $ : int [1:6] 1 3 57 58 78 85\n $ : int [1:6] 1 2 4 5 57 85\n $ : int [1:6] 1 3 5 6 69 85\n $ : int [1:6] 1 3 4 6 69 85\n $ : int [1:6] 3 4 5 69 75 85\n $ : int [1:6] 9 66 67 71 74 84\n $ : int [1:6] 9 46 47 78 80 86\n $ : int [1:6] 8 46 66 68 84 86\n $ : int [1:6] 16 19 22 70 72 73\n $ : int [1:6] 10 14 16 17 70 72\n $ : int [1:6] 13 15 60 61 63 83\n $ : int [1:6] 12 15 60 61 63 83\n $ : int [1:6] 11 15 16 17 72 83\n $ : int [1:6] 12 13 14 17 60 83\n $ : int [1:6] 10 11 17 22 72 83\n $ : int [1:6] 10 11 14 16 72 83\n $ : int [1:6] 20 22 23 63 77 83\n $ : int [1:6] 10 20 21 73 74 82\n $ : int [1:6] 18 19 21 22 23 82\n $ : int [1:6] 19 20 35 74 82 86\n $ : int [1:6] 10 16 18 19 20 83\n $ : int [1:6] 18 20 41 77 79 82\n $ : int [1:6] 25 28 31 52 54 81\n $ : int [1:6] 24 28 31 33 54 81\n $ : int [1:6] 25 27 29 33 42 81\n $ : int [1:6] 26 29 30 37 42 81\n $ : int [1:6] 24 25 33 49 52 54\n $ : int [1:6] 26 27 37 42 43 81\n $ : int [1:6] 26 27 28 33 49 81\n $ : int [1:6] 24 25 36 39 40 54\n $ : int [1:6] 24 31 50 54 55 56\n $ : int [1:6] 25 26 28 30 49 81\n $ : int [1:6] 36 40 41 45 56 80\n $ : int [1:6] 21 41 46 47 80 82\n $ : int [1:6] 31 34 40 45 56 80\n $ : int [1:6] 26 27 29 42 43 44\n $ : int [1:6] 23 43 44 62 77 79\n $ : int [1:6] 25 40 42 43 44 81\n $ : int [1:6] 31 36 39 43 45 79\n $ : int [1:6] 23 35 45 79 80 82\n $ : int [1:6] 26 27 37 39 43 81\n $ : int [1:6] 37 39 40 42 44 79\n $ : int [1:6] 37 38 39 42 43 79\n $ : int [1:6] 34 36 40 41 79 80\n $ : int [1:6] 8 9 35 47 78 86\n $ : int [1:6] 8 21 35 46 80 86\n $ : int [1:6] 49 50 51 52 53 55\n $ : int [1:6] 28 33 48 51 52 54\n $ : int [1:6] 32 48 51 52 54 55\n $ : int [1:6] 28 48 49 50 52 54\n $ : int [1:6] 28 48 49 50 51 54\n $ : int [1:6] 48 50 51 52 55 75\n $ : int [1:6] 24 28 49 50 51 52\n $ : int [1:6] 32 48 50 52 53 75\n $ : int [1:6] 32 34 36 78 80 85\n $ : int [1:6] 1 2 3 58 64 68\n $ : int [1:6] 2 57 64 66 68 78\n $ : int [1:6] 12 13 60 61 87 88\n $ : int [1:6] 12 13 59 61 63 87\n $ : int [1:6] 12 13 60 62 63 87\n $ : int [1:6] 12 38 61 63 77 87\n $ : int [1:6] 12 18 60 61 62 83\n $ : int [1:6] 1 3 57 58 68 76\n $ : int [1:6] 58 64 66 67 68 76\n $ : int [1:6] 9 58 67 68 76 84\n $ : int [1:6] 7 65 66 68 76 84\n $ : int [1:6] 9 57 58 66 78 84\n $ : int [1:6] 4 5 6 32 75 85\n $ : int [1:6] 10 16 19 22 72 73\n $ : int [1:6] 7 19 73 74 84 86\n $ : int [1:6] 10 11 14 16 17 70\n $ : int [1:6] 10 19 21 70 71 74\n $ : int [1:6] 19 21 71 73 84 86\n $ : int [1:6] 6 32 50 53 55 69\n $ : int [1:6] 58 64 65 66 67 68\n $ : int [1:6] 18 23 38 61 62 63\n $ : int [1:6] 2 8 9 46 58 68\n $ : int [1:6] 38 40 41 43 44 45\n $ : int [1:6] 34 35 36 41 45 47\n $ : int [1:6] 25 26 28 33 39 42\n $ : int [1:6] 19 20 21 23 35 41\n $ : int [1:6] 12 13 15 16 22 63\n $ : int [1:6] 7 9 66 68 71 74\n $ : int [1:6] 2 3 4 5 56 69\n $ : int [1:6] 8 9 21 46 47 74\n $ : int [1:6] 59 60 61 62 63 88\n $ : int [1:6] 59 60 61 62 63 87\n - attr(*, \"region.id\")= chr [1:88] \"1\" \"2\" \"3\" \"4\" ...\n - attr(*, \"call\")= language knearneigh(x = coords, k = 6)\n - attr(*, \"sym\")= logi FALSE\n - attr(*, \"type\")= chr \"knn\"\n - attr(*, \"knn-k\")= num 6\n - attr(*, \"class\")= chr \"nb\"\n\n\n\nplot(hunan$geometry, border=\"lightgrey\")\nplot(knn6, coords, pch = 19, cex = 0.6, add = TRUE, col = \"red\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#weights-based",
    "href": "Hands-on_Ex/Hands-on_Ex2a/Hands-on_Ex2a.html#weights-based",
    "title": "Hands-on_Ex2a",
    "section": "Weights based",
    "text": "Weights based\ni am finding the distance between the centroid between each pair of neighbours identified using the queen method. Thereafter we inverse the distance\n\ndist &lt;- nbdists(wm_q, coords, longlat = TRUE)\nids &lt;- lapply(dist, function(x) 1/(x))\nids\n\n[[1]]\n[1] 0.01535405 0.03916350 0.01820896 0.02807922 0.01145113\n\n[[2]]\n[1] 0.01535405 0.01764308 0.01925924 0.02323898 0.01719350\n\n[[3]]\n[1] 0.03916350 0.02822040 0.03695795 0.01395765\n\n[[4]]\n[1] 0.01820896 0.02822040 0.03414741 0.01539065\n\n[[5]]\n[1] 0.03695795 0.03414741 0.01524598 0.01618354\n\n[[6]]\n[1] 0.015390649 0.015245977 0.021748129 0.011883901 0.009810297\n\n[[7]]\n[1] 0.01708612 0.01473997 0.01150924 0.01872915\n\n[[8]]\n[1] 0.02022144 0.03453056 0.02529256 0.01036340 0.02284457 0.01500600 0.01515314\n\n[[9]]\n[1] 0.02022144 0.01574888 0.02109502 0.01508028 0.02902705 0.01502980\n\n[[10]]\n[1] 0.02281552 0.01387777 0.01538326 0.01346650 0.02100510 0.02631658 0.01874863\n[8] 0.01500046\n\n[[11]]\n[1] 0.01882869 0.02243492 0.02247473\n\n[[12]]\n[1] 0.02779227 0.02419652 0.02333385 0.02986130 0.02335429\n\n[[13]]\n[1] 0.02779227 0.02650020 0.02670323 0.01714243\n\n[[14]]\n[1] 0.01882869 0.01233868 0.02098555\n\n[[15]]\n[1] 0.02650020 0.01233868 0.01096284 0.01562226\n\n[[16]]\n[1] 0.02281552 0.02466962 0.02765018 0.01476814 0.01671430\n\n[[17]]\n[1] 0.01387777 0.02243492 0.02098555 0.01096284 0.02466962 0.01593341 0.01437996\n\n[[18]]\n[1] 0.02039779 0.02032767 0.01481665 0.01473691 0.01459380\n\n[[19]]\n[1] 0.01538326 0.01926323 0.02668415 0.02140253 0.01613589 0.01412874\n\n[[20]]\n[1] 0.01346650 0.02039779 0.01926323 0.01723025 0.02153130 0.01469240 0.02327034\n\n[[21]]\n[1] 0.02668415 0.01723025 0.01766299 0.02644986 0.02163800\n\n[[22]]\n[1] 0.02100510 0.02765018 0.02032767 0.02153130 0.01489296\n\n[[23]]\n[1] 0.01481665 0.01469240 0.01401432 0.02246233 0.01880425 0.01530458 0.01849605\n\n[[24]]\n[1] 0.02354598 0.01837201 0.02607264 0.01220154 0.02514180\n\n[[25]]\n[1] 0.02354598 0.02188032 0.01577283 0.01949232 0.02947957\n\n[[26]]\n[1] 0.02155798 0.01745522 0.02212108 0.02220532\n\n[[27]]\n[1] 0.02155798 0.02490625 0.01562326\n\n[[28]]\n[1] 0.01837201 0.02188032 0.02229549 0.03076171 0.02039506\n\n[[29]]\n[1] 0.02490625 0.01686587 0.01395022\n\n[[30]]\n[1] 0.02090587\n\n[[31]]\n[1] 0.02607264 0.01577283 0.01219005 0.01724850 0.01229012 0.01609781 0.01139438\n[8] 0.01150130\n\n[[32]]\n[1] 0.01220154 0.01219005 0.01712515 0.01340413 0.01280928 0.01198216 0.01053374\n[8] 0.01065655\n\n[[33]]\n[1] 0.01949232 0.01745522 0.02229549 0.02090587 0.01979045\n\n[[34]]\n[1] 0.03113041 0.03589551 0.02882915\n\n[[35]]\n[1] 0.01766299 0.02185795 0.02616766 0.02111721 0.02108253 0.01509020\n\n[[36]]\n[1] 0.01724850 0.03113041 0.01571707 0.01860991 0.02073549 0.01680129\n\n[[37]]\n[1] 0.01686587 0.02234793 0.01510990 0.01550676\n\n[[38]]\n[1] 0.01401432 0.02407426 0.02276151 0.01719415\n\n[[39]]\n[1] 0.01229012 0.02172543 0.01711924 0.02629732 0.01896385\n\n[[40]]\n[1] 0.01609781 0.01571707 0.02172543 0.01506473 0.01987922 0.01894207\n\n[[41]]\n[1] 0.02246233 0.02185795 0.02205991 0.01912542 0.01601083 0.01742892\n\n[[42]]\n[1] 0.02212108 0.01562326 0.01395022 0.02234793 0.01711924 0.01836831 0.01683518\n\n[[43]]\n[1] 0.01510990 0.02629732 0.01506473 0.01836831 0.03112027 0.01530782\n\n[[44]]\n[1] 0.01550676 0.02407426 0.03112027 0.01486508\n\n[[45]]\n[1] 0.03589551 0.01860991 0.01987922 0.02205991 0.02107101 0.01982700\n\n[[46]]\n[1] 0.03453056 0.04033752 0.02689769\n\n[[47]]\n[1] 0.02529256 0.02616766 0.04033752 0.01949145 0.02181458\n\n[[48]]\n[1] 0.02313819 0.03370576 0.02289485 0.01630057 0.01818085\n\n[[49]]\n[1] 0.03076171 0.02138091 0.02394529 0.01990000\n\n[[50]]\n[1] 0.01712515 0.02313819 0.02551427 0.02051530 0.02187179\n\n[[51]]\n[1] 0.03370576 0.02138091 0.02873854\n\n[[52]]\n[1] 0.02289485 0.02394529 0.02551427 0.02873854 0.03516672\n\n[[53]]\n[1] 0.01630057 0.01979945 0.01253977\n\n[[54]]\n[1] 0.02514180 0.02039506 0.01340413 0.01990000 0.02051530 0.03516672\n\n[[55]]\n[1] 0.01280928 0.01818085 0.02187179 0.01979945 0.01882298\n\n[[56]]\n[1] 0.01036340 0.01139438 0.01198216 0.02073549 0.01214479 0.01362855 0.01341697\n\n[[57]]\n[1] 0.028079221 0.017643082 0.031423501 0.029114131 0.013520292 0.009903702\n\n[[58]]\n[1] 0.01925924 0.03142350 0.02722997 0.01434859 0.01567192\n\n[[59]]\n[1] 0.01696711 0.01265572 0.01667105 0.01785036\n\n[[60]]\n[1] 0.02419652 0.02670323 0.01696711 0.02343040\n\n[[61]]\n[1] 0.02333385 0.01265572 0.02343040 0.02514093 0.02790764 0.01219751 0.02362452\n\n[[62]]\n[1] 0.02514093 0.02002219 0.02110260\n\n[[63]]\n[1] 0.02986130 0.02790764 0.01407043 0.01805987\n\n[[64]]\n[1] 0.02911413 0.01689892\n\n[[65]]\n[1] 0.02471705\n\n[[66]]\n[1] 0.01574888 0.01726461 0.03068853 0.01954805 0.01810569\n\n[[67]]\n[1] 0.01708612 0.01726461 0.01349843 0.01361172\n\n[[68]]\n[1] 0.02109502 0.02722997 0.03068853 0.01406357 0.01546511\n\n[[69]]\n[1] 0.02174813 0.01645838 0.01419926\n\n[[70]]\n[1] 0.02631658 0.01963168 0.02278487\n\n[[71]]\n[1] 0.01473997 0.01838483 0.03197403\n\n[[72]]\n[1] 0.01874863 0.02247473 0.01476814 0.01593341 0.01963168\n\n[[73]]\n[1] 0.01500046 0.02140253 0.02278487 0.01838483 0.01652709\n\n[[74]]\n[1] 0.01150924 0.01613589 0.03197403 0.01652709 0.01342099 0.02864567\n\n[[75]]\n[1] 0.011883901 0.010533736 0.012539774 0.018822977 0.016458383 0.008217581\n\n[[76]]\n[1] 0.01352029 0.01434859 0.01689892 0.02471705 0.01954805 0.01349843 0.01406357\n\n[[77]]\n[1] 0.014736909 0.018804247 0.022761507 0.012197506 0.020022195 0.014070428\n[7] 0.008440896\n\n[[78]]\n[1] 0.02323898 0.02284457 0.01508028 0.01214479 0.01567192 0.01546511 0.01140779\n\n[[79]]\n[1] 0.01530458 0.01719415 0.01894207 0.01912542 0.01530782 0.01486508 0.02107101\n\n[[80]]\n[1] 0.01500600 0.02882915 0.02111721 0.01680129 0.01601083 0.01982700 0.01949145\n[8] 0.01362855\n\n[[81]]\n[1] 0.02947957 0.02220532 0.01150130 0.01979045 0.01896385 0.01683518\n\n[[82]]\n[1] 0.02327034 0.02644986 0.01849605 0.02108253 0.01742892\n\n[[83]]\n[1] 0.023354289 0.017142433 0.015622258 0.016714303 0.014379961 0.014593799\n[7] 0.014892965 0.018059871 0.008440896\n\n[[84]]\n[1] 0.01872915 0.02902705 0.01810569 0.01361172 0.01342099 0.01297994\n\n[[85]]\n [1] 0.011451133 0.017193502 0.013957649 0.016183544 0.009810297 0.010656545\n [7] 0.013416965 0.009903702 0.014199260 0.008217581 0.011407794\n\n[[86]]\n[1] 0.01515314 0.01502980 0.01412874 0.02163800 0.01509020 0.02689769 0.02181458\n[8] 0.02864567 0.01297994\n\n[[87]]\n[1] 0.01667105 0.02362452 0.02110260 0.02058034\n\n[[88]]\n[1] 0.01785036 0.02058034\n\n\n\nrswm_q &lt;- nb2listw(wm_q, style=\"W\", zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147\n\n\nrswm_q &lt;- nb2listw(wm_q, style=\"B\", zero.policy = TRUE)\nrswm_q\nalthough the style B and W seem to give the same\n\nrswm_q$weights[10]\n\n[[1]]\n[1] 0.125 0.125 0.125 0.125 0.125 0.125 0.125 0.125\n\n\n\nrswm_ids &lt;- nb2listw(wm_q, glist=ids, style=\"B\", zero.policy=TRUE)\nrswm_ids\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn       S0        S1     S2\nB 88 7744 8.786867 0.3776535 3.8137\n\n\n\nrswm_ids$weights[1]\n\n[[1]]\n[1] 0.01535405 0.03916350 0.01820896 0.02807922 0.01145113\n\n\n\nAverage Neighbour GDP Per Capita\n\nGDPPC.lag &lt;- lag.listw(rswm_q, hunan$GDPPC)\nGDPPC.lag\n\n [1] 24847.20 22724.80 24143.25 27737.50 27270.25 21248.80 43747.00 33582.71\n [9] 45651.17 32027.62 32671.00 20810.00 25711.50 30672.33 33457.75 31689.20\n[17] 20269.00 23901.60 25126.17 21903.43 22718.60 25918.80 20307.00 20023.80\n[25] 16576.80 18667.00 14394.67 19848.80 15516.33 20518.00 17572.00 15200.12\n[33] 18413.80 14419.33 24094.50 22019.83 12923.50 14756.00 13869.80 12296.67\n[41] 15775.17 14382.86 11566.33 13199.50 23412.00 39541.00 36186.60 16559.60\n[49] 20772.50 19471.20 19827.33 15466.80 12925.67 18577.17 14943.00 24913.00\n[57] 25093.00 24428.80 17003.00 21143.75 20435.00 17131.33 24569.75 23835.50\n[65] 26360.00 47383.40 55157.75 37058.00 21546.67 23348.67 42323.67 28938.60\n[73] 25880.80 47345.67 18711.33 29087.29 20748.29 35933.71 15439.71 29787.50\n[81] 18145.00 21617.00 29203.89 41363.67 22259.09 44939.56 16902.00 16930.00\n\n\n\nnb1 &lt;- wm_q[[1]]\nnb1 &lt;- hunan$GDPPC[nb1]\nnb1\n\n[1] 20981 34592 24473 21311 22879\n\n\n\nlag.list &lt;- list(hunan$NAME_3, lag.listw(rswm_q, hunan$GDPPC))\nlag.res &lt;- as.data.frame(lag.list)\ncolnames(lag.res) &lt;- c(\"NAME_3\", \"lag GDPPC\")\nhunan &lt;- left_join(hunan,lag.res)\n\n\nhead(hunan)\n\nSimple feature collection with 6 features and 8 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 110.4922 ymin: 28.61762 xmax: 112.3013 ymax: 30.12812\nGeodetic CRS:  WGS 84\n   NAME_2  ID_3  NAME_3   ENGTYPE_3  County GDPPC colors lag GDPPC\n1 Changde 21098 Anxiang      County Anxiang 23667   blue  24847.20\n2 Changde 21100 Hanshou      County Hanshou 20981   blue  22724.80\n3 Changde 21101  Jinshi County City  Jinshi 34592   blue  24143.25\n4 Changde 21102      Li      County      Li 24473   grey  27737.50\n5 Changde 21103   Linli      County   Linli 25554   blue  27270.25\n6 Changde 21104  Shimen      County  Shimen 27137   blue  21248.80\n                        geometry\n1 POLYGON ((112.0625 29.75523...\n2 POLYGON ((112.2288 29.11684...\n3 POLYGON ((111.8927 29.6013,...\n4 POLYGON ((111.3731 29.94649...\n5 POLYGON ((111.6324 29.76288...\n6 POLYGON ((110.8825 30.11675...\n\n\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_gdppc &lt;- qtm(hunan, \"lag GDPPC\")\ntmap_arrange(gdppc, lag_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\nSum of Neighbour\ni will say that the main diff is the previous 1 favour rich neighbour, while this favour more neighbour\n\nb_weights &lt;- lapply(wm_q, function(x) 0*x + 1)\nb_weights2 &lt;- nb2listw(wm_q, \n                       glist = b_weights, \n                       style = \"B\")\nb_weights2\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0  S1    S2\nB 88 7744 448 896 10224\n\n\n\nlag_sum &lt;- list(hunan$NAME_3, lag.listw(b_weights2, hunan$GDPPC))\nlag.res &lt;- as.data.frame(lag_sum)\ncolnames(lag.res) &lt;- c(\"NAME_3\", \"lag_sum GDPPC\")\n\n\nlag.res\n\n          NAME_3 lag_sum GDPPC\n1        Anxiang        124236\n2        Hanshou        113624\n3         Jinshi         96573\n4             Li        110950\n5          Linli        109081\n6         Shimen        106244\n7        Liuyang        174988\n8      Ningxiang        235079\n9      Wangcheng        273907\n10         Anren        256221\n11       Guidong         98013\n12         Jiahe        104050\n13         Linwu        102846\n14       Rucheng         92017\n15       Yizhang        133831\n16      Yongxing        158446\n17        Zixing        141883\n18     Changning        119508\n19      Hengdong        150757\n20       Hengnan        153324\n21      Hengshan        113593\n22       Leiyang        129594\n23        Qidong        142149\n24        Chenxi        100119\n25     Zhongfang         82884\n26       Huitong         74668\n27      Jingzhou         43184\n28        Mayang         99244\n29       Tongdao         46549\n30      Xinhuang         20518\n31          Xupu        140576\n32      Yuanling        121601\n33      Zhijiang         92069\n34 Lengshuijiang         43258\n35    Shuangfeng        144567\n36        Xinhua        132119\n37       Chengbu         51694\n38        Dongan         59024\n39       Dongkou         69349\n40       Longhui         73780\n41      Shaodong         94651\n42       Suining        100680\n43        Wugang         69398\n44       Xinning         52798\n45       Xinshao        140472\n46      Shaoshan        118623\n47    Xiangxiang        180933\n48       Baojing         82798\n49     Fenghuang         83090\n50       Guzhang         97356\n51       Huayuan         59482\n52        Jishou         77334\n53      Longshan         38777\n54          Luxi        111463\n55      Yongshun         74715\n56         Anhua        174391\n57           Nan        150558\n58     Yuanjiang        122144\n59      Jianghua         68012\n60       Lanshan         84575\n61      Ningyuan        143045\n62     Shuangpai         51394\n63       Xintian         98279\n64       Huarong         47671\n65      Linxiang         26360\n66         Miluo        236917\n67     Pingjiang        220631\n68      Xiangyin        185290\n69          Cili         64640\n70       Chaling         70046\n71        Liling        126971\n72       Yanling        144693\n73           You        129404\n74       Zhuzhou        284074\n75       Sangzhi        112268\n76       Yueyang        203611\n77        Qiyang        145238\n78      Taojiang        251536\n79      Shaoyang        108078\n80      Lianyuan        238300\n81     Hongjiang        108870\n82      Hengyang        108085\n83       Guiyang        262835\n84      Changsha        248182\n85       Taoyuan        244850\n86      Xiangtan        404456\n87           Dao         67608\n88     Jiangyong         33860\n\n\n\nhunan &lt;- left_join(hunan, lag.res)\n\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\nlag_sum_gdppc &lt;- qtm(hunan, \"lag_sum GDPPC\")\ntmap_arrange(gdppc, lag_sum_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\nSpatial Window Average\n\nwm_qs &lt;- include.self(wm_q)\n\n\nwm_qs[[1]]\n\n[1]  1  2  3  4 57 85\n\n\n\nwm_qs &lt;- nb2listw(wm_qs)\nwm_qs\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 30.90265 357.5308\n\n\n\nlag_w_avg_gpdpc &lt;- lag.listw(wm_qs, \n                             hunan$GDPPC)\nlag_w_avg_gpdpc\n\n [1] 24650.50 22434.17 26233.00 27084.60 26927.00 22230.17 47621.20 37160.12\n [9] 49224.71 29886.89 26627.50 22690.17 25366.40 25825.75 30329.00 32682.83\n[17] 25948.62 23987.67 25463.14 21904.38 23127.50 25949.83 20018.75 19524.17\n[25] 18955.00 17800.40 15883.00 18831.33 14832.50 17965.00 17159.89 16199.44\n[33] 18764.50 26878.75 23188.86 20788.14 12365.20 15985.00 13764.83 11907.43\n[41] 17128.14 14593.62 11644.29 12706.00 21712.29 43548.25 35049.00 16226.83\n[49] 19294.40 18156.00 19954.75 18145.17 12132.75 18419.29 14050.83 23619.75\n[57] 24552.71 24733.67 16762.60 20932.60 19467.75 18334.00 22541.00 26028.00\n[65] 29128.50 46569.00 47576.60 36545.50 20838.50 22531.00 42115.50 27619.00\n[73] 27611.33 44523.29 18127.43 28746.38 20734.50 33880.62 14716.38 28516.22\n[81] 18086.14 21244.50 29568.80 48119.71 22310.75 43151.60 17133.40 17009.33\n\n\n\nlag.list.wm_qs &lt;- list(hunan$NAME_3, lag.listw(wm_qs, hunan$GDPPC))\nlag_wm_qs.res &lt;- as.data.frame(lag.list.wm_qs)\ncolnames(lag_wm_qs.res) &lt;- c(\"NAME_3\", \"lag_window_avg GDPPC\")\n\n\nhunan &lt;- left_join(hunan, lag_wm_qs.res)\n\n\nhunan %&gt;%\n  select(\"County\", \n         \"lag GDPPC\", \n         \"lag_window_avg GDPPC\") %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\nCounty\nlag GDPPC\nlag_window_avg GDPPC\ngeometry\n\n\n\n\nAnxiang\n24847.20\n24650.50\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n22724.80\n22434.17\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n24143.25\n26233.00\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n27737.50\n27084.60\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n27270.25\n26927.00\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n21248.80\n22230.17\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n43747.00\n47621.20\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n33582.71\n37160.12\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n45651.17\n49224.71\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n32027.62\n29886.89\nPOLYGON ((113.1757 26.82734…\n\n\nGuidong\n32671.00\n26627.50\nPOLYGON ((114.1799 26.20117…\n\n\nJiahe\n20810.00\n22690.17\nPOLYGON ((112.4425 25.74358…\n\n\nLinwu\n25711.50\n25366.40\nPOLYGON ((112.5914 25.55143…\n\n\nRucheng\n30672.33\n25825.75\nPOLYGON ((113.6759 25.87578…\n\n\nYizhang\n33457.75\n30329.00\nPOLYGON ((113.2621 25.68394…\n\n\nYongxing\n31689.20\n32682.83\nPOLYGON ((113.3169 26.41843…\n\n\nZixing\n20269.00\n25948.62\nPOLYGON ((113.7311 26.16259…\n\n\nChangning\n23901.60\n23987.67\nPOLYGON ((112.6144 26.60198…\n\n\nHengdong\n25126.17\n25463.14\nPOLYGON ((113.1056 27.21007…\n\n\nHengnan\n21903.43\n21904.38\nPOLYGON ((112.7599 26.98149…\n\n\nHengshan\n22718.60\n23127.50\nPOLYGON ((112.607 27.4689, …\n\n\nLeiyang\n25918.80\n25949.83\nPOLYGON ((112.9996 26.69276…\n\n\nQidong\n20307.00\n20018.75\nPOLYGON ((111.7818 27.0383,…\n\n\nChenxi\n20023.80\n19524.17\nPOLYGON ((110.2624 28.21778…\n\n\nZhongfang\n16576.80\n18955.00\nPOLYGON ((109.9431 27.72858…\n\n\nHuitong\n18667.00\n17800.40\nPOLYGON ((109.9419 27.10512…\n\n\nJingzhou\n14394.67\n15883.00\nPOLYGON ((109.8186 26.75842…\n\n\nMayang\n19848.80\n18831.33\nPOLYGON ((109.795 27.98008,…\n\n\nTongdao\n15516.33\n14832.50\nPOLYGON ((109.9294 26.46561…\n\n\nXinhuang\n20518.00\n17965.00\nPOLYGON ((109.227 27.43733,…\n\n\nXupu\n17572.00\n17159.89\nPOLYGON ((110.7189 28.30485…\n\n\nYuanling\n15200.12\n16199.44\nPOLYGON ((110.9652 28.99895…\n\n\nZhijiang\n18413.80\n18764.50\nPOLYGON ((109.8818 27.60661…\n\n\nLengshuijiang\n14419.33\n26878.75\nPOLYGON ((111.5307 27.81472…\n\n\nShuangfeng\n24094.50\n23188.86\nPOLYGON ((112.263 27.70421,…\n\n\nXinhua\n22019.83\n20788.14\nPOLYGON ((111.3345 28.19642…\n\n\nChengbu\n12923.50\n12365.20\nPOLYGON ((110.4455 26.69317…\n\n\nDongan\n14756.00\n15985.00\nPOLYGON ((111.4531 26.86812…\n\n\nDongkou\n13869.80\n13764.83\nPOLYGON ((110.6622 27.37305…\n\n\nLonghui\n12296.67\n11907.43\nPOLYGON ((110.985 27.65983,…\n\n\nShaodong\n15775.17\n17128.14\nPOLYGON ((111.9054 27.40254…\n\n\nSuining\n14382.86\n14593.62\nPOLYGON ((110.389 27.10006,…\n\n\nWugang\n11566.33\n11644.29\nPOLYGON ((110.9878 27.03345…\n\n\nXinning\n13199.50\n12706.00\nPOLYGON ((111.0736 26.84627…\n\n\nXinshao\n23412.00\n21712.29\nPOLYGON ((111.6013 27.58275…\n\n\nShaoshan\n39541.00\n43548.25\nPOLYGON ((112.5391 27.97742…\n\n\nXiangxiang\n36186.60\n35049.00\nPOLYGON ((112.4549 28.05783…\n\n\nBaojing\n16559.60\n16226.83\nPOLYGON ((109.7015 28.82844…\n\n\nFenghuang\n20772.50\n19294.40\nPOLYGON ((109.5239 28.19206…\n\n\nGuzhang\n19471.20\n18156.00\nPOLYGON ((109.8968 28.74034…\n\n\nHuayuan\n19827.33\n19954.75\nPOLYGON ((109.5647 28.61712…\n\n\nJishou\n15466.80\n18145.17\nPOLYGON ((109.8375 28.4696,…\n\n\nLongshan\n12925.67\n12132.75\nPOLYGON ((109.6337 29.62521…\n\n\nLuxi\n18577.17\n18419.29\nPOLYGON ((110.1067 28.41835…\n\n\nYongshun\n14943.00\n14050.83\nPOLYGON ((110.0003 29.29499…\n\n\nAnhua\n24913.00\n23619.75\nPOLYGON ((111.6034 28.63716…\n\n\nNan\n25093.00\n24552.71\nPOLYGON ((112.3232 29.46074…\n\n\nYuanjiang\n24428.80\n24733.67\nPOLYGON ((112.4391 29.1791,…\n\n\nJianghua\n17003.00\n16762.60\nPOLYGON ((111.6461 25.29661…\n\n\nLanshan\n21143.75\n20932.60\nPOLYGON ((112.2286 25.61123…\n\n\nNingyuan\n20435.00\n19467.75\nPOLYGON ((112.0715 26.09892…\n\n\nShuangpai\n17131.33\n18334.00\nPOLYGON ((111.8864 26.11957…\n\n\nXintian\n24569.75\n22541.00\nPOLYGON ((112.2578 26.0796,…\n\n\nHuarong\n23835.50\n26028.00\nPOLYGON ((112.9242 29.69134…\n\n\nLinxiang\n26360.00\n29128.50\nPOLYGON ((113.5502 29.67418…\n\n\nMiluo\n47383.40\n46569.00\nPOLYGON ((112.9902 29.02139…\n\n\nPingjiang\n55157.75\n47576.60\nPOLYGON ((113.8436 29.06152…\n\n\nXiangyin\n37058.00\n36545.50\nPOLYGON ((112.9173 28.98264…\n\n\nCili\n21546.67\n20838.50\nPOLYGON ((110.8822 29.69017…\n\n\nChaling\n23348.67\n22531.00\nPOLYGON ((113.7666 27.10573…\n\n\nLiling\n42323.67\n42115.50\nPOLYGON ((113.5673 27.94346…\n\n\nYanling\n28938.60\n27619.00\nPOLYGON ((113.9292 26.6154,…\n\n\nYou\n25880.80\n27611.33\nPOLYGON ((113.5879 27.41324…\n\n\nZhuzhou\n47345.67\n44523.29\nPOLYGON ((113.2493 28.02411…\n\n\nSangzhi\n18711.33\n18127.43\nPOLYGON ((110.556 29.40543,…\n\n\nYueyang\n29087.29\n28746.38\nPOLYGON ((113.343 29.61064,…\n\n\nQiyang\n20748.29\n20734.50\nPOLYGON ((111.5563 26.81318…\n\n\nTaojiang\n35933.71\n33880.62\nPOLYGON ((112.0508 28.67265…\n\n\nShaoyang\n15439.71\n14716.38\nPOLYGON ((111.5013 27.30207…\n\n\nLianyuan\n29787.50\n28516.22\nPOLYGON ((111.6789 28.02946…\n\n\nHongjiang\n18145.00\n18086.14\nPOLYGON ((110.1441 27.47513…\n\n\nHengyang\n21617.00\n21244.50\nPOLYGON ((112.7144 26.98613…\n\n\nGuiyang\n29203.89\n29568.80\nPOLYGON ((113.0811 26.04963…\n\n\nChangsha\n41363.67\n48119.71\nPOLYGON ((112.9421 28.03722…\n\n\nTaoyuan\n22259.09\n22310.75\nPOLYGON ((112.0612 29.32855…\n\n\nXiangtan\n44939.56\n43151.60\nPOLYGON ((113.0426 27.8942,…\n\n\nDao\n16902.00\n17133.40\nPOLYGON ((111.498 25.81679,…\n\n\nJiangyong\n16930.00\n17009.33\nPOLYGON ((111.3659 25.39472…\n\n\n\n\n\n\nw_avg_gdppc &lt;- qtm(hunan, \"lag_window_avg GDPPC\")\ntmap_arrange(lag_gdppc, w_avg_gdppc, asp=1, ncol=2)\n\n\n\n\n\n\nSpatial Window Sum\n\nwm_qs &lt;- include.self(wm_q)\nwm_qs\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\n\n\nb_weights &lt;- lapply(wm_qs, function(x) 0*x + 1)\nb_weights[1]\n\n[[1]]\n[1] 1 1 1 1 1 1\n\n\n\nb_weights2 &lt;- nb2listw(wm_qs, \n                       glist = b_weights, \n                       style = \"B\")\nb_weights2\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 536 \nPercentage nonzero weights: 6.921488 \nAverage number of links: 6.090909 \n\nWeights style: B \nWeights constants summary:\n   n   nn  S0   S1    S2\nB 88 7744 536 1072 14160\n\n\n\nw_sum_gdppc &lt;- list(hunan$NAME_3, lag.listw(b_weights2, hunan$GDPPC))\nw_sum_gdppc\n\n[[1]]\n [1] \"Anxiang\"       \"Hanshou\"       \"Jinshi\"        \"Li\"           \n [5] \"Linli\"         \"Shimen\"        \"Liuyang\"       \"Ningxiang\"    \n [9] \"Wangcheng\"     \"Anren\"         \"Guidong\"       \"Jiahe\"        \n[13] \"Linwu\"         \"Rucheng\"       \"Yizhang\"       \"Yongxing\"     \n[17] \"Zixing\"        \"Changning\"     \"Hengdong\"      \"Hengnan\"      \n[21] \"Hengshan\"      \"Leiyang\"       \"Qidong\"        \"Chenxi\"       \n[25] \"Zhongfang\"     \"Huitong\"       \"Jingzhou\"      \"Mayang\"       \n[29] \"Tongdao\"       \"Xinhuang\"      \"Xupu\"          \"Yuanling\"     \n[33] \"Zhijiang\"      \"Lengshuijiang\" \"Shuangfeng\"    \"Xinhua\"       \n[37] \"Chengbu\"       \"Dongan\"        \"Dongkou\"       \"Longhui\"      \n[41] \"Shaodong\"      \"Suining\"       \"Wugang\"        \"Xinning\"      \n[45] \"Xinshao\"       \"Shaoshan\"      \"Xiangxiang\"    \"Baojing\"      \n[49] \"Fenghuang\"     \"Guzhang\"       \"Huayuan\"       \"Jishou\"       \n[53] \"Longshan\"      \"Luxi\"          \"Yongshun\"      \"Anhua\"        \n[57] \"Nan\"           \"Yuanjiang\"     \"Jianghua\"      \"Lanshan\"      \n[61] \"Ningyuan\"      \"Shuangpai\"     \"Xintian\"       \"Huarong\"      \n[65] \"Linxiang\"      \"Miluo\"         \"Pingjiang\"     \"Xiangyin\"     \n[69] \"Cili\"          \"Chaling\"       \"Liling\"        \"Yanling\"      \n[73] \"You\"           \"Zhuzhou\"       \"Sangzhi\"       \"Yueyang\"      \n[77] \"Qiyang\"        \"Taojiang\"      \"Shaoyang\"      \"Lianyuan\"     \n[81] \"Hongjiang\"     \"Hengyang\"      \"Guiyang\"       \"Changsha\"     \n[85] \"Taoyuan\"       \"Xiangtan\"      \"Dao\"           \"Jiangyong\"    \n\n[[2]]\n [1] 147903 134605 131165 135423 134635 133381 238106 297281 344573 268982\n[11] 106510 136141 126832 103303 151645 196097 207589 143926 178242 175235\n[21] 138765 155699 160150 117145 113730  89002  63532 112988  59330  35930\n[31] 154439 145795 112587 107515 162322 145517  61826  79925  82589  83352\n[41] 119897 116749  81510  63530 151986 174193 210294  97361  96472 108936\n[51]  79819 108871  48531 128935  84305 188958 171869 148402  83813 104663\n[61] 155742  73336 112705  78084  58257 279414 237883 219273  83354  90124\n[71] 168462 165714 165668 311663 126892 229971 165876 271045 117731 256646\n[81] 126603 127467 295688 336838 267729 431516  85667  51028\n\n\n\nw_sum_gdppc.res &lt;- as.data.frame(w_sum_gdppc)\ncolnames(w_sum_gdppc.res) &lt;- c(\"NAME_3\", \"w_sum GDPPC\")\n\n\nhunan &lt;- left_join(hunan, w_sum_gdppc.res)\n\n\nhunan %&gt;%\n  select(\"County\", \"lag_sum GDPPC\", \"w_sum GDPPC\") %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\nCounty\nlag_sum GDPPC\nw_sum GDPPC\ngeometry\n\n\n\n\nAnxiang\n124236\n147903\nPOLYGON ((112.0625 29.75523…\n\n\nHanshou\n113624\n134605\nPOLYGON ((112.2288 29.11684…\n\n\nJinshi\n96573\n131165\nPOLYGON ((111.8927 29.6013,…\n\n\nLi\n110950\n135423\nPOLYGON ((111.3731 29.94649…\n\n\nLinli\n109081\n134635\nPOLYGON ((111.6324 29.76288…\n\n\nShimen\n106244\n133381\nPOLYGON ((110.8825 30.11675…\n\n\nLiuyang\n174988\n238106\nPOLYGON ((113.9905 28.5682,…\n\n\nNingxiang\n235079\n297281\nPOLYGON ((112.7181 28.38299…\n\n\nWangcheng\n273907\n344573\nPOLYGON ((112.7914 28.52688…\n\n\nAnren\n256221\n268982\nPOLYGON ((113.1757 26.82734…\n\n\nGuidong\n98013\n106510\nPOLYGON ((114.1799 26.20117…\n\n\nJiahe\n104050\n136141\nPOLYGON ((112.4425 25.74358…\n\n\nLinwu\n102846\n126832\nPOLYGON ((112.5914 25.55143…\n\n\nRucheng\n92017\n103303\nPOLYGON ((113.6759 25.87578…\n\n\nYizhang\n133831\n151645\nPOLYGON ((113.2621 25.68394…\n\n\nYongxing\n158446\n196097\nPOLYGON ((113.3169 26.41843…\n\n\nZixing\n141883\n207589\nPOLYGON ((113.7311 26.16259…\n\n\nChangning\n119508\n143926\nPOLYGON ((112.6144 26.60198…\n\n\nHengdong\n150757\n178242\nPOLYGON ((113.1056 27.21007…\n\n\nHengnan\n153324\n175235\nPOLYGON ((112.7599 26.98149…\n\n\nHengshan\n113593\n138765\nPOLYGON ((112.607 27.4689, …\n\n\nLeiyang\n129594\n155699\nPOLYGON ((112.9996 26.69276…\n\n\nQidong\n142149\n160150\nPOLYGON ((111.7818 27.0383,…\n\n\nChenxi\n100119\n117145\nPOLYGON ((110.2624 28.21778…\n\n\nZhongfang\n82884\n113730\nPOLYGON ((109.9431 27.72858…\n\n\nHuitong\n74668\n89002\nPOLYGON ((109.9419 27.10512…\n\n\nJingzhou\n43184\n63532\nPOLYGON ((109.8186 26.75842…\n\n\nMayang\n99244\n112988\nPOLYGON ((109.795 27.98008,…\n\n\nTongdao\n46549\n59330\nPOLYGON ((109.9294 26.46561…\n\n\nXinhuang\n20518\n35930\nPOLYGON ((109.227 27.43733,…\n\n\nXupu\n140576\n154439\nPOLYGON ((110.7189 28.30485…\n\n\nYuanling\n121601\n145795\nPOLYGON ((110.9652 28.99895…\n\n\nZhijiang\n92069\n112587\nPOLYGON ((109.8818 27.60661…\n\n\nLengshuijiang\n43258\n107515\nPOLYGON ((111.5307 27.81472…\n\n\nShuangfeng\n144567\n162322\nPOLYGON ((112.263 27.70421,…\n\n\nXinhua\n132119\n145517\nPOLYGON ((111.3345 28.19642…\n\n\nChengbu\n51694\n61826\nPOLYGON ((110.4455 26.69317…\n\n\nDongan\n59024\n79925\nPOLYGON ((111.4531 26.86812…\n\n\nDongkou\n69349\n82589\nPOLYGON ((110.6622 27.37305…\n\n\nLonghui\n73780\n83352\nPOLYGON ((110.985 27.65983,…\n\n\nShaodong\n94651\n119897\nPOLYGON ((111.9054 27.40254…\n\n\nSuining\n100680\n116749\nPOLYGON ((110.389 27.10006,…\n\n\nWugang\n69398\n81510\nPOLYGON ((110.9878 27.03345…\n\n\nXinning\n52798\n63530\nPOLYGON ((111.0736 26.84627…\n\n\nXinshao\n140472\n151986\nPOLYGON ((111.6013 27.58275…\n\n\nShaoshan\n118623\n174193\nPOLYGON ((112.5391 27.97742…\n\n\nXiangxiang\n180933\n210294\nPOLYGON ((112.4549 28.05783…\n\n\nBaojing\n82798\n97361\nPOLYGON ((109.7015 28.82844…\n\n\nFenghuang\n83090\n96472\nPOLYGON ((109.5239 28.19206…\n\n\nGuzhang\n97356\n108936\nPOLYGON ((109.8968 28.74034…\n\n\nHuayuan\n59482\n79819\nPOLYGON ((109.5647 28.61712…\n\n\nJishou\n77334\n108871\nPOLYGON ((109.8375 28.4696,…\n\n\nLongshan\n38777\n48531\nPOLYGON ((109.6337 29.62521…\n\n\nLuxi\n111463\n128935\nPOLYGON ((110.1067 28.41835…\n\n\nYongshun\n74715\n84305\nPOLYGON ((110.0003 29.29499…\n\n\nAnhua\n174391\n188958\nPOLYGON ((111.6034 28.63716…\n\n\nNan\n150558\n171869\nPOLYGON ((112.3232 29.46074…\n\n\nYuanjiang\n122144\n148402\nPOLYGON ((112.4391 29.1791,…\n\n\nJianghua\n68012\n83813\nPOLYGON ((111.6461 25.29661…\n\n\nLanshan\n84575\n104663\nPOLYGON ((112.2286 25.61123…\n\n\nNingyuan\n143045\n155742\nPOLYGON ((112.0715 26.09892…\n\n\nShuangpai\n51394\n73336\nPOLYGON ((111.8864 26.11957…\n\n\nXintian\n98279\n112705\nPOLYGON ((112.2578 26.0796,…\n\n\nHuarong\n47671\n78084\nPOLYGON ((112.9242 29.69134…\n\n\nLinxiang\n26360\n58257\nPOLYGON ((113.5502 29.67418…\n\n\nMiluo\n236917\n279414\nPOLYGON ((112.9902 29.02139…\n\n\nPingjiang\n220631\n237883\nPOLYGON ((113.8436 29.06152…\n\n\nXiangyin\n185290\n219273\nPOLYGON ((112.9173 28.98264…\n\n\nCili\n64640\n83354\nPOLYGON ((110.8822 29.69017…\n\n\nChaling\n70046\n90124\nPOLYGON ((113.7666 27.10573…\n\n\nLiling\n126971\n168462\nPOLYGON ((113.5673 27.94346…\n\n\nYanling\n144693\n165714\nPOLYGON ((113.9292 26.6154,…\n\n\nYou\n129404\n165668\nPOLYGON ((113.5879 27.41324…\n\n\nZhuzhou\n284074\n311663\nPOLYGON ((113.2493 28.02411…\n\n\nSangzhi\n112268\n126892\nPOLYGON ((110.556 29.40543,…\n\n\nYueyang\n203611\n229971\nPOLYGON ((113.343 29.61064,…\n\n\nQiyang\n145238\n165876\nPOLYGON ((111.5563 26.81318…\n\n\nTaojiang\n251536\n271045\nPOLYGON ((112.0508 28.67265…\n\n\nShaoyang\n108078\n117731\nPOLYGON ((111.5013 27.30207…\n\n\nLianyuan\n238300\n256646\nPOLYGON ((111.6789 28.02946…\n\n\nHongjiang\n108870\n126603\nPOLYGON ((110.1441 27.47513…\n\n\nHengyang\n108085\n127467\nPOLYGON ((112.7144 26.98613…\n\n\nGuiyang\n262835\n295688\nPOLYGON ((113.0811 26.04963…\n\n\nChangsha\n248182\n336838\nPOLYGON ((112.9421 28.03722…\n\n\nTaoyuan\n244850\n267729\nPOLYGON ((112.0612 29.32855…\n\n\nXiangtan\n404456\n431516\nPOLYGON ((113.0426 27.8942,…\n\n\nDao\n67608\n85667\nPOLYGON ((111.498 25.81679,…\n\n\nJiangyong\n33860\n51028\nPOLYGON ((111.3659 25.39472…\n\n\n\n\n\n\nw_sum_gdppc &lt;- qtm(hunan, \"w_sum GDPPC\")\ntmap_arrange(lag_sum_gdppc, w_sum_gdppc, asp=1, ncol=2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex1b/Data/geospatial/MPSZ-2019.html",
    "href": "Hands-on_Ex/Hands-on_Ex1b/Data/geospatial/MPSZ-2019.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html",
    "href": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html",
    "title": "Hands-on_Ex1a",
    "section": "",
    "text": "options(max.print=1000000)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#getting-started",
    "title": "Hands-on_Ex1a",
    "section": "Getting Started",
    "text": "Getting Started\nThe code chunk below load the following packages:\n- tmap : for thematic mapping\n- sf : for geospatial data handling\n- tidyverse: for non-spatial data handling\n\npacman::p_load(tmap, sf, tidyverse)\n\n# note : this is the R code for quatero, usually in R, we would have use library(tamp) etc\n#pacman:: call the package. then p_load is a function within pacman"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#importing-geospatial-data",
    "href": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#importing-geospatial-data",
    "title": "Hands-on_Ex1a",
    "section": "Importing Geospatial Data",
    "text": "Importing Geospatial Data\n\nImporting the Boundaries\nThe Masterplan 2014 Subzone Boundary is a shapefile that need to be imported. It will cut singapore into different subzones\ni recall prof was saying we should project to Singapore 3414. but either code seem to work? i think it is depending on which code i put in first. if i swap these 2 code around. it doesn’t seem to work. MP2019 shapefile is still in WGS84 (degree) instead of SVY21 (meters)\n\nmpsz = st_read(dsn = \"data/geospatial\", \n                  layer = \"MPSZ-2019\")\n\nReading layer `MPSZ-2019' from data source \n  `C:\\worksheep\\ISSS624\\Hands-on_Ex\\Hands-on_Ex1a\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;% st_transform(crs = 3414)\n\n#WGS84 SVY21\n#CRS coordinate representation system for Singapore is 3414\n\n\n\nImporting the cycling path\nthis is different from the earlier where this is SVY21\n\ncyclingpath = st_read(dsn = \"data/geospatial\", \n                         layer = \"CyclingPathGazette\")\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\worksheep\\ISSS624\\Hands-on_Ex\\Hands-on_Ex1a\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2558 features and 2 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11854.32 ymin: 28347.98 xmax: 42626.09 ymax: 48948.15\nProjected CRS: SVY21\n\n\nI think i get it, the difference is base on the original file. So for WGS84 or SVY21, it is due to the shape file’s original coordinate system? I don’t recall so though.\n\n\nImporting Preschool Location\n\npreschool = st_read(\"data/geospatial/PreSchoolsLocation.kml\")\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\worksheep\\ISSS624\\Hands-on_Ex\\Hands-on_Ex1a\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nthe main diff is this is KML file instead of shapefile. but seems like i can still use st_read, just that for this i don’t need to specify dsn and layer."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#importing-aspatial-data",
    "href": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#importing-aspatial-data",
    "title": "Hands-on_Ex1a",
    "section": "Importing Aspatial Data",
    "text": "Importing Aspatial Data\n\nInitial Import\nWe are getting all the airbnb listing in\n\nlistings &lt;- read_csv(\"data/aspatial/listings.csv\")\nlist(listings) \n\n[[1]]\n# A tibble: 3,483 × 18\n       id name      host_id host_name neighbourhood_group neighbourhood latitude\n    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;               &lt;chr&gt;            &lt;dbl&gt;\n 1  71609 Villa in…  367042 Belinda   East Region         Tampines          1.35\n 2  71896 Home in …  367042 Belinda   East Region         Tampines          1.35\n 3  71903 Home in …  367042 Belinda   East Region         Tampines          1.35\n 4 275343 Rental u… 1439258 Kay       Central Region      Bukit Merah       1.29\n 5 275344 Rental u… 1439258 Kay       Central Region      Bukit Merah       1.29\n 6 289234 Home in …  367042 Belinda   East Region         Tampines          1.34\n 7 294281 Rental u… 1521514 Elizabeth Central Region      Newton            1.31\n 8 324945 Rental u… 1439258 Kay       Central Region      Bukit Merah       1.29\n 9 330095 Rental u… 1439258 Kay       Central Region      Bukit Merah       1.29\n10 369141 Place to… 1521514 Elizabeth Central Region      Newton            1.31\n# ℹ 3,473 more rows\n# ℹ 11 more variables: longitude &lt;dbl&gt;, room_type &lt;chr&gt;, price &lt;dbl&gt;,\n#   minimum_nights &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;, last_review &lt;date&gt;,\n#   reviews_per_month &lt;dbl&gt;, calculated_host_listings_count &lt;dbl&gt;,\n#   availability_365 &lt;dbl&gt;, number_of_reviews_ltm &lt;dbl&gt;, license &lt;chr&gt;\n\n\n\n\nConverting Aspatial to Spatial\nthe lat long has been converted to a geometry\n\nlistings_sf &lt;- st_as_sf(listings, \n                       coords = c(\"longitude\", \"latitude\"),\n                       crs=4326) %&gt;%\n  st_transform(crs = 3414)\n\nglimpse(listings_sf)\n\nRows: 3,483\nColumns: 17\n$ id                             &lt;dbl&gt; 71609, 71896, 71903, 275343, 275344, 28…\n$ name                           &lt;chr&gt; \"Villa in Singapore · ★4.44 · 2 bedroom…\n$ host_id                        &lt;dbl&gt; 367042, 367042, 367042, 1439258, 143925…\n$ host_name                      &lt;chr&gt; \"Belinda\", \"Belinda\", \"Belinda\", \"Kay\",…\n$ neighbourhood_group            &lt;chr&gt; \"East Region\", \"East Region\", \"East Reg…\n$ neighbourhood                  &lt;chr&gt; \"Tampines\", \"Tampines\", \"Tampines\", \"Bu…\n$ room_type                      &lt;chr&gt; \"Private room\", \"Private room\", \"Privat…\n$ price                          &lt;dbl&gt; 150, 80, 80, 55, 69, 220, 85, 75, 45, 7…\n$ minimum_nights                 &lt;dbl&gt; 92, 92, 92, 60, 60, 92, 92, 60, 60, 92,…\n$ number_of_reviews              &lt;dbl&gt; 20, 24, 47, 22, 17, 12, 133, 18, 6, 81,…\n$ last_review                    &lt;date&gt; 2020-01-17, 2019-10-13, 2020-01-09, 20…\n$ reviews_per_month              &lt;dbl&gt; 0.14, 0.16, 0.31, 0.17, 0.12, 0.09, 0.9…\n$ calculated_host_listings_count &lt;dbl&gt; 5, 5, 5, 52, 52, 5, 7, 52, 52, 7, 7, 1,…\n$ availability_365               &lt;dbl&gt; 89, 89, 89, 275, 274, 89, 365, 365, 365…\n$ number_of_reviews_ltm          &lt;dbl&gt; 0, 0, 0, 0, 3, 0, 0, 1, 3, 0, 0, 0, 0, …\n$ license                        &lt;chr&gt; NA, NA, NA, \"S0399\", \"S0399\", NA, NA, \"…\n$ geometry                       &lt;POINT [m]&gt; POINT (41972.5 36390.05), POINT (…"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#doing-some-initial-play-with-the-data",
    "href": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#doing-some-initial-play-with-the-data",
    "title": "Hands-on_Ex1a",
    "section": "Doing Some Initial Play with the Data",
    "text": "Doing Some Initial Play with the Data\n\nDataTable\n\nst_geometry(mpsz)\n\nGeometry set for 332 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n\n\n\nglimpse(mpsz)\n\nRows: 332\nColumns: 7\n$ SUBZONE_N  &lt;chr&gt; \"MARINA EAST\", \"INSTITUTION HILL\", \"ROBERTSON QUAY\", \"JURON…\n$ SUBZONE_C  &lt;chr&gt; \"MESZ01\", \"RVSZ05\", \"SRSZ01\", \"WISZ01\", \"MUSZ02\", \"MPSZ05\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA EAST\", \"RIVER VALLEY\", \"SINGAPORE RIVER\", \"WESTERN …\n$ PLN_AREA_C &lt;chr&gt; \"ME\", \"RV\", \"SR\", \"WI\", \"MU\", \"MP\", \"WI\", \"WI\", \"SI\", \"SI\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"WEST…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"WR\", \"CR\", \"CR\", \"WR\", \"WR\", \"CR\", \"CR\",…\n$ geometry   &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((103.8802 1...., MULTIPOLYGON (…\n\n\n\nhead(mpsz, n=5)\n\nSimple feature collection with 5 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6537 ymin: 1.216215 xmax: 103.8811 ymax: 1.29742\nGeodetic CRS:  WGS 84\n                SUBZONE_N SUBZONE_C      PLN_AREA_N PLN_AREA_C       REGION_N\n1             MARINA EAST    MESZ01     MARINA EAST         ME CENTRAL REGION\n2        INSTITUTION HILL    RVSZ05    RIVER VALLEY         RV CENTRAL REGION\n3          ROBERTSON QUAY    SRSZ01 SINGAPORE RIVER         SR CENTRAL REGION\n4 JURONG ISLAND AND BUKOM    WISZ01 WESTERN ISLANDS         WI    WEST REGION\n5            FORT CANNING    MUSZ02          MUSEUM         MU CENTRAL REGION\n  REGION_C                       geometry\n1       CR MULTIPOLYGON (((103.8802 1....\n2       CR MULTIPOLYGON (((103.8376 1....\n3       CR MULTIPOLYGON (((103.8341 1....\n4       WR MULTIPOLYGON (((103.7125 1....\n5       CR MULTIPOLYGON (((103.8472 1....\n\n\n\n\nPlotting a Map\n\nplot(mpsz)\n\n\n\n\n\nplot(st_geometry(mpsz))\n\n\n\n\n\nplot(mpsz[\"PLN_AREA_N\"])"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#changing-the-projection",
    "href": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#changing-the-projection",
    "title": "Hands-on_Ex1a",
    "section": "Changing the Projection",
    "text": "Changing the Projection\nFirst we need to check the data\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\n\nactually after checking i saw that prof used another command to change the projection . What is the difference between st_set_crs and st_transform. from what is googled, st_set_crs just update the metadata but doesn’t change the coordinates itself\n\nmpsz3414 &lt;- st_set_crs(mpsz, 3414)\n\n\nst_crs(mpsz3414)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\nmpsz3414 &lt;- st_transform(mpsz, 3414)\n\n\nst_crs(mpsz3414)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\npreschool3414 &lt;- st_transform(preschool, \n                              crs = 3414)\nst_crs(preschool3414)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#the-scenarios",
    "href": "Hands-on_Ex/Hands-on_Ex1a/Hands-on_Ex1a.html#the-scenarios",
    "title": "Hands-on_Ex1a",
    "section": "The Scenarios:",
    "text": "The Scenarios:\n\nScenario 1\nThe authority is planning to upgrade the exiting cycling path. To do so, they need to acquire 5 metres of reserved land on the both sides of the current cycling path. You are tasked to determine the extend of the land need to be acquired and their total area.\n\n\nScenario 1 Solution:\nQuestion: what is the difference between PLANNING_A and PLANNING_1. but given that PLANNING_A is all NA, why is showing in the plot for buffer but not for the cycling path itself?\n\nbuffer_cycling &lt;- st_buffer(cyclingpath, \n                               dist=5, nQuadSegs = 30)\nglimpse(buffer_cycling)\n\nRows: 2,558\nColumns: 3\n$ PLANNING_A &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PLANNING_1 &lt;chr&gt; \"BEDOK\", \"BEDOK\", \"BEDOK\", \"TAMPINES\", \"TAMPINES\", \"TAMPINE…\n$ geometry   &lt;POLYGON [m]&gt; POLYGON ((39803.36 34814.24..., POLYGON ((39829.27 …\n\n\n\nplot(cyclingpath)\n\n\n\n\n\nplot(buffer_cycling)\n\n\n\n\ncalculating the buffer area i.e. convert geometry into area then summing it up\n\nbuffer_cycling$AREA &lt;- st_area(buffer_cycling)\nsum(buffer_cycling$AREA)\n\n1774367 [m^2]\n\n\n\n\nScenario 2\nA pre-school service group want to find out the numbers of pre-schools in each Planning Subzone.\n\n\nScenario 2 Solution:\n\nCalculate number of Preschool in PZ\nThe code chunk below performs two operations at one go. Firstly, identify pre-schools located inside each Planning Subzone by using st_intersects(). Next, length() of Base R is used to calculate numbers of pre-schools that fall inside each planning subzone.\n\nmpsz3414$`PreSch Count`&lt;- lengths(st_intersects(mpsz3414, preschool3414))\nsummary(mpsz3414$`PreSch Count`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   4.000   6.898  10.000  72.000 \n\n\n\ntop_n(mpsz3414, 1, `PreSch Count`)\n\nSimple feature collection with 1 feature and 7 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 39655.33 ymin: 35967.33 xmax: 42940.57 ymax: 38622.37\nProjected CRS: SVY21 / Singapore TM\n      SUBZONE_N SUBZONE_C PLN_AREA_N PLN_AREA_C    REGION_N REGION_C\n1 TAMPINES EAST    TMSZ02   TAMPINES         TM EAST REGION       ER\n                        geometry PreSch Count\n1 MULTIPOLYGON (((42196.76 38...           72\n\n\n\n\nCalulating the density of pre-school by planning subzone\n\nmpsz3414$Area &lt;- mpsz3414 %&gt;%\n  st_area()\n\nmpsz3414 &lt;- mpsz3414 %&gt;%\n  mutate(`PreSch Density` = `PreSch Count`/Area * 1000000)\n\ntop_n(mpsz3414, 10, `PreSch Density`)\n\nSimple feature collection with 10 features and 9 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 17518.63 ymin: 28623.75 xmax: 36532.07 ymax: 48182.13\nProjected CRS: SVY21 / Singapore TM\n              SUBZONE_N SUBZONE_C    PLN_AREA_N PLN_AREA_C          REGION_N\n1                 CECIL    DTSZ08 DOWNTOWN CORE         DT    CENTRAL REGION\n2               PHILLIP    DTSZ04 DOWNTOWN CORE         DT    CENTRAL REGION\n3                KATONG    MPSZ02 MARINE PARADE         MP    CENTRAL REGION\n4       SERANGOON NORTH    SGSZ03     SERANGOON         SG NORTH-EAST REGION\n5         MANDAI ESTATE    MDSZ03        MANDAI         MD      NORTH REGION\n6             KEAT HONG    CKSZ02 CHOA CHU KANG         CK       WEST REGION\n7  SENGKANG TOWN CENTRE    SESZ03      SENGKANG         SE NORTH-EAST REGION\n8               MIDVIEW    WDSZ02     WOODLANDS         WD      NORTH REGION\n9        WOODLANDS EAST    WDSZ03     WOODLANDS         WD      NORTH REGION\n10    SEMBAWANG CENTRAL    SBSZ03     SEMBAWANG         SB      NORTH REGION\n   REGION_C                       geometry PreSch Count             Area\n1        CR MULTIPOLYGON (((29917.52 29...            7  196619.86 [m^2]\n2        CR MULTIPOLYGON (((29814.11 29...            1   39437.94 [m^2]\n3        CR MULTIPOLYGON (((36317.74 32...           22 1078992.03 [m^2]\n4       NER MULTIPOLYGON (((32860.5 397...           17  684704.30 [m^2]\n5        NR MULTIPOLYGON (((27119.56 45...            5  143137.94 [m^2]\n6        WR MULTIPOLYGON (((18700.53 39...           23 1143813.67 [m^2]\n7       NER MULTIPOLYGON (((35615.75 40...           33 1460534.44 [m^2]\n8        NR MULTIPOLYGON (((23820.19 46...           19  936415.53 [m^2]\n9        NR MULTIPOLYGON (((24786.75 46...           54 2553463.72 [m^2]\n10       NR MULTIPOLYGON (((26311.14 46...           27  961421.72 [m^2]\n     PreSch Density\n1  35.60169 [1/m^2]\n2  25.35630 [1/m^2]\n3  20.38940 [1/m^2]\n4  24.82824 [1/m^2]\n5  34.93134 [1/m^2]\n6  20.10817 [1/m^2]\n7  22.59447 [1/m^2]\n8  20.29014 [1/m^2]\n9  21.14775 [1/m^2]\n10 28.08341 [1/m^2]\n\n\n\n\nExploring the Data\n\nhist(mpsz3414$`PreSch Density`)\n\n\n\n\n\nggplot(data=mpsz3414, \n       aes(x= as.numeric(`PreSch Density`)))+\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  labs(title = \"Are pre-school even distributed in Singapore?\",\n       subtitle= \"There are many planning sub-zones with a single pre-school, on the other hand, \\nthere are a couple of planning sub-zones with at least 20 pre-schools\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Frequency\")\n\n\n\n\n\nggplot(data=mpsz3414, \n       aes(y = `PreSch Count`, \n           x= as.numeric(`PreSch Density`)))+\n  geom_point(color=\"black\", \n             fill=\"light blue\") +\n  xlim(0, 40) +\n  ylim(0, 40) +\n  labs(title = \"\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Pre-school count\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex1a/data/geospatial/MPSZ-2019.html",
    "href": "Hands-on_Ex/Hands-on_Ex1a/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex1b/Hands-on_Ex1b.html",
    "href": "Hands-on_Ex/Hands-on_Ex1b/Hands-on_Ex1b.html",
    "title": "Hands-on_Ex1b",
    "section": "",
    "text": "pacman::p_load(tmap, sf, tidyverse)\n\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;% st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\worksheep\\ISSS624\\Hands-on_Ex\\Hands-on_Ex1b\\Data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\nmpsz\n\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N\n1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION\n2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION\n3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION\n4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION\n5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION\n6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION\n7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION\n8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION\n9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION\n10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION\n   REGION_C                       geometry\n1        CR MULTIPOLYGON (((33222.98 29...\n2        CR MULTIPOLYGON (((28481.45 30...\n3        CR MULTIPOLYGON (((28087.34 30...\n4        WR MULTIPOLYGON (((14557.7 304...\n5        CR MULTIPOLYGON (((29542.53 31...\n6        CR MULTIPOLYGON (((35279.55 30...\n7        WR MULTIPOLYGON (((15772.59 21...\n8        WR MULTIPOLYGON (((19843.41 21...\n9        CR MULTIPOLYGON (((30870.53 22...\n10       CR MULTIPOLYGON (((26879.04 26...\n\n\n\npopdata &lt;- read_csv(\"data/aspatial/respopagesextod2011to2020.csv\")\n\n\npopdata2020 &lt;- popdata %&gt;%\n  filter(Time == 2020) %&gt;%\n  group_by(PA, SZ, AG) %&gt;%\n  summarise(`POP` = sum(`Pop`)) %&gt;%\n  ungroup()%&gt;%\n  pivot_wider(names_from=AG, \n              values_from=POP) %&gt;%\n  mutate(YOUNG = rowSums(.[3:6])\n         +rowSums(.[12])) %&gt;%\nmutate(`ECONOMY ACTIVE` = rowSums(.[7:11])+\nrowSums(.[13:15]))%&gt;%\nmutate(`AGED`=rowSums(.[16:21])) %&gt;%\nmutate(`TOTAL`=rowSums(.[3:21])) %&gt;%  \nmutate(`DEPENDENCY` = (`YOUNG` + `AGED`)\n/`ECONOMY ACTIVE`) %&gt;%\n  select(`PA`, `SZ`, `YOUNG`, \n       `ECONOMY ACTIVE`, `AGED`, \n       `TOTAL`, `DEPENDENCY`)\n\n\npopdata2020 &lt;- popdata2020 %&gt;%\n  mutate_at(.vars = vars(PA, SZ), \n          .funs = list(toupper)) %&gt;%\n  filter(`ECONOMY ACTIVE` &gt; 0)\n\n\nmpsz_pop2020 &lt;- left_join(mpsz, popdata2020,\n                          by = c(\"SUBZONE_N\" = \"SZ\"))\n\n\nwrite_rds(mpsz_pop2020, \"data/rds/mpszpop2020.rds\")\n\n\ntmap_mode(\"plot\")\nqtm(mpsz_pop2020, \n    fill = \"DEPENDENCY\")\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"Dependency ratio\") +\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar() +\n  tm_grid(alpha =0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\n\ntm_shape(mpsz_pop2020) +\n  tm_polygons()\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_polygons(\"DEPENDENCY\")\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\")\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\") +\n  tm_borders(lwd = 0.1,  alpha = 1)\n\n\n\n\n‘Natural Breaks’ (or ‘Jenks’) minimizes within-class variance and maximizes between-class variance.\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\",\n          n = 5,\n          style = \"jenks\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n‘Equal Interval’ divides the data into equal size classes.\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n‘Pretty Breaks’ creates aesthetically pleasing breaks based on the range of the data.\n\ntm_shape(mpsz_pop2020) +\n  tm_polygons(\"DEPENDENCY\", style = 'pretty', title = 'Pretty Breaks')\n\n\n\n\n‘Quantile’ ensures an equal number of observations in each class.\n\ntm_shape(mpsz_pop2020) +\n  tm_polygons(\"DEPENDENCY\", style = 'quantile', title = 'Quantile')\n\n\n\n\n‘Standard Deviation’ creates classes based on the standard deviation from the mean.\n\ntm_shape(mpsz_pop2020) +\n  tm_polygons(\"DEPENDENCY\", style = 'sd', title = 'Standard Deviation')\n\n\n\n\n\nData distribution\nHow the data values are spread across the map. More classes can capture more variability and nuances in the data, but also make the map more complex and harder to interpret. Fewer classes can simplify the map and highlight the general patterns, but also lose some details and outliers.\n\n\nClass intervals\nHow the data values are grouped into classes. Different classification methods can create different class intervals, which can affect the visual representation and interpretation of the map. For example, equal interval divides the data range into equal intervals, quantile divides the data into equal numbers of data points, and natural breaks finds natural groupings based on data distribution\n\n\nVisualization\nHow the map colors and symbols convey the data values. The choice of color scheme, symbol size, and transparency can influence the readability and aesthetics of the map. For example, sequential colors can show the gradual change of data values, while diverging colors can show the contrast between high and low values. Larger symbols and higher transparency can emphasize the data values, while smaller symbols and lower transparency can reduce the visual clutter.\n\nsummary(mpsz_pop2020$DEPENDENCY)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n 0.1111  0.7137  0.7862  0.8579  0.8767 19.0000      98 \n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\",\n          breaks = c(0, 0.60, 0.70, 0.80, 0.90, 1.00)) +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\",\n          n = 6,\n          style = \"quantile\",\n          palette = \"Blues\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\",\n          style = \"quantile\",\n          palette = \"-Greens\") +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"jenks\", \n          palette = \"Blues\", \n          legend.hist = TRUE, \n          legend.is.portrait = TRUE,\n          legend.hist.z = 0.1) +\n  tm_layout(main.title = \"Distribution of Dependency Ratio by planning subzone \\n(Jenks classification)\",\n            main.title.position = \"center\",\n            main.title.size = 1,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            legend.outside = FALSE,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"-Greens\") +\n  tm_borders(alpha = 0.5) +\n  tmap_style(\"classic\")\n\n\n\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\",\n          title = \"No. of persons\") +\n  tm_layout(main.title = \"Distribution of Dependency Ratio \\nby planning subzone\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            legend.height = 0.45, \n            legend.width = 0.35,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5) +\n  tm_compass(type=\"8star\", size = 2) +\n  tm_scale_bar(width = 0.15) +\n  tm_grid(lwd = 0.1, alpha = 0.2) +\n  tm_credits(\"Source: Planning Sub-zone boundary from Urban Redevelopment Authorithy (URA)\\n and Population data from Department of Statistics DOS\", \n             position = c(\"left\", \"bottom\"))\n\n\n\n\n\ntmap_style(\"white\")\n\n\ntm_shape(mpsz_pop2020)+\n  tm_fill(c(\"YOUNG\", \"AGED\"),\n          style = \"equal\", \n          palette = \"Blues\") +\n  tm_layout(legend.position = c(\"right\", \"bottom\")) +\n  tm_borders(alpha = 0.5) +\n  tmap_style(\"white\")\n\n\n\n\n\ntm_shape(mpsz_pop2020)+ \n  tm_polygons(c(\"DEPENDENCY\",\"AGED\"),\n          style = c(\"equal\", \"quantile\"), \n          palette = list(\"Blues\",\"Greens\")) +\n  tm_layout(legend.position = c(\"right\", \"bottom\"))\n\n\n\n\n\ntm_shape(mpsz_pop2020) +\n  tm_fill(\"DEPENDENCY\",\n          style = \"quantile\",\n          palette = \"Blues\",\n          thres.poly = 0) + \n  tm_facets(by=\"REGION_N\", \n            free.coords=TRUE, \n            drop.shapes=TRUE) +\n  tm_layout(legend.show = FALSE,\n            title.position = c(\"center\", \"center\"), \n            title.size = 20) +\n  tm_borders(alpha = 0.5)\n\n\n\n\n\nyoungmap &lt;- tm_shape(mpsz_pop2020)+ \n  tm_polygons(\"YOUNG\", \n              style = \"quantile\", \n              palette = \"Blues\")\n\nagedmap &lt;- tm_shape(mpsz_pop2020)+ \n  tm_polygons(\"AGED\", \n              style = \"quantile\", \n              palette = \"Blues\")\n\ntmap_arrange(youngmap, agedmap, asp=1, ncol=2)\n\n\n\n\n\ntm_shape(mpsz_pop2020[mpsz_pop2020$REGION_N==\"CENTRAL REGION\", ])+\n  tm_fill(\"DEPENDENCY\", \n          style = \"quantile\", \n          palette = \"Blues\", \n          legend.hist = TRUE, \n          legend.is.portrait = TRUE,\n          legend.hist.z = 0.1) +\n  tm_layout(legend.outside = TRUE,\n            legend.height = 0.45, \n            legend.width = 5.0,\n            legend.position = c(\"right\", \"bottom\"),\n            frame = FALSE) +\n  tm_borders(alpha = 0.5)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html",
    "href": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html",
    "title": "Hands-on_Ex2b",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#getting-started",
    "title": "Hands-on_Ex2b",
    "section": "",
    "text": "pacman::p_load(sf, spdep, tmap, tidyverse)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#import-data",
    "href": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#import-data",
    "title": "Hands-on_Ex2b",
    "section": "Import Data",
    "text": "Import Data\n\nImport basemap\nHunan\n\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\worksheep\\ISSS624\\Hands-on_Ex\\Hands-on_Ex2b\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\n\n\nImport metadata\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\n\n\nJoining the data together\n\nhunan &lt;- left_join(hunan,hunan2012) %&gt;%\n  select(1:4, 7, 15)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#visualising",
    "href": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#visualising",
    "title": "Hands-on_Ex2b",
    "section": "Visualising",
    "text": "Visualising\n\nequal &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"equal\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal interval classification\")\n\nquantile &lt;- tm_shape(hunan) +\n  tm_fill(\"GDPPC\",\n          n = 5,\n          style = \"quantile\") +\n  tm_borders(alpha = 0.5) +\n  tm_layout(main.title = \"Equal quantile classification\")\n\ntmap_arrange(equal, \n             quantile, \n             asp=1, \n             ncol=2)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#calculating-spatial-weight",
    "href": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#calculating-spatial-weight",
    "title": "Hands-on_Ex2b",
    "section": "Calculating Spatial Weight",
    "text": "Calculating Spatial Weight\n\nwm_q &lt;- poly2nb(hunan, \n                queen=TRUE)\nsummary(wm_q)\n\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \nLink number distribution:\n\n 1  2  3  4  5  6  7  8  9 11 \n 2  2 12 16 24 14 11  4  2  1 \n2 least connected regions:\n30 65 with 1 link\n1 most connected region:\n85 with 11 links\n\n\n\nrswm_q &lt;- nb2listw(wm_q, \n                   style=\"W\", \n                   zero.policy = TRUE)\nrswm_q\n\nCharacteristics of weights list object:\nNeighbour list object:\nNumber of regions: 88 \nNumber of nonzero links: 448 \nPercentage nonzero weights: 5.785124 \nAverage number of links: 5.090909 \n\nWeights style: W \nWeights constants summary:\n   n   nn S0       S1       S2\nW 88 7744 88 37.86334 365.9147"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#global-spatial-autocorrelation",
    "href": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#global-spatial-autocorrelation",
    "title": "Hands-on_Ex2b",
    "section": "Global Spatial Autocorrelation",
    "text": "Global Spatial Autocorrelation\n\nMaron’s I test\n\nmoran.test(hunan$GDPPC, \n           listw=rswm_q, \n           zero.policy = TRUE, \n           na.action=na.omit)\n\n\n    Moran I test under randomisation\n\ndata:  hunan$GDPPC  \nweights: rswm_q    \n\nMoran I statistic standard deviate = 4.7351, p-value = 1.095e-06\nalternative hypothesis: greater\nsample estimates:\nMoran I statistic       Expectation          Variance \n      0.300749970      -0.011494253       0.004348351 \n\n\nThe Moran’s I test is a measure of spatial autocorrelation, which is the correlation of a variable with itself through space.\nThe Moran’s I statistic is 0.300749970. This value ranges from -1 (indicating perfect dispersion) to +1 (perfect correlation). A zero value indicates a random spatial pattern. The positive Moran’s I statistic indicates a positive spatial autocorrelation, which means that similar values of hunan$GDPPC are clustered together in the Hunan region.\nThe p-value is 1.095e-06, which is less than significance level of 0.05. The observed spatial pattern is statistically significantly different from random.\nSo, based on this output, there is significant positive spatial autocorrelation in the hunan$GDPPC variable in the Hunan region.\n\nMonte Carlo Moran’s I\n\nset.seed(1234)\nbperm= moran.mc(hunan$GDPPC, \n                listw=rswm_q, \n                nsim=999, \n                zero.policy = TRUE, \n                na.action=na.omit)\nbperm\n\n\n    Monte-Carlo simulation of Moran I\n\ndata:  hunan$GDPPC \nweights: rswm_q  \nnumber of simulations + 1: 1000 \n\nstatistic = 0.30075, observed rank = 1000, p-value = 0.001\nalternative hypothesis: greater\n\n\nThere is indeed correlation and clustering of the region\n\n\nVisualising\n\nmean(bperm$res[1:999])\n\n[1] -0.01504572\n\n\n\nvar(bperm$res[1:999])\n\n[1] 0.004371574\n\n\n\nsummary(bperm$res[1:999])\n\n    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. \n-0.18339 -0.06168 -0.02125 -0.01505  0.02611  0.27593 \n\n\n\nhist(bperm$res, \n     freq=TRUE, \n     breaks=20, \n     xlab=\"Simulated Moran's I\")\nabline(v=0, \n       col=\"red\") \n\n\n\n\n\n\n\nGeary’s C test\n\ngeary.test(hunan$GDPPC, listw=rswm_q)\n\n\n    Geary C test under randomisation\n\ndata:  hunan$GDPPC \nweights: rswm_q \n\nGeary C statistic standard deviate = 3.6108, p-value = 0.0001526\nalternative hypothesis: Expectation greater than statistic\nsample estimates:\nGeary C statistic       Expectation          Variance \n        0.6907223         1.0000000         0.0073364 \n\n\n\nMonte Carlo Geary’s C\n\nset.seed(1234)\nbperm=geary.mc(hunan$GDPPC, \n               listw=rswm_q, \n               nsim=999)\nbperm\n\n\n    Monte-Carlo simulation of Geary C\n\ndata:  hunan$GDPPC \nweights: rswm_q \nnumber of simulations + 1: 1000 \n\nstatistic = 0.69072, observed rank = 1, p-value = 0.001\nalternative hypothesis: greater\n\n\n\n\nVisualising\n\nmean(bperm$res[1:999])\n\n[1] 1.004402\n\n\n\nsummary(bperm$res[1:999])\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n 0.7142  0.9502  1.0052  1.0044  1.0595  1.2722 \n\n\n\nhist(bperm$res, freq=TRUE, breaks=20, xlab=\"Simulated Geary c\")\nabline(v=1, col=\"red\")"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#spatial-correlogram",
    "href": "Hands-on_Ex/Hands-on_Ex2b/Hands-on_Ex2b.html#spatial-correlogram",
    "title": "Hands-on_Ex2b",
    "section": "Spatial Correlogram",
    "text": "Spatial Correlogram\n\nMoran’s I Correlogram\n\nMI_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"I\", \n                          style=\"W\")\nplot(MI_corr)\n\n\n\n\n\nprint(MI_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Moran's I\n         estimate expectation   variance standard deviate Pr(I) two sided    \n1 (88)  0.3007500  -0.0114943  0.0043484           4.7351       2.189e-06 ***\n2 (88)  0.2060084  -0.0114943  0.0020962           4.7505       2.029e-06 ***\n3 (88)  0.0668273  -0.0114943  0.0014602           2.0496        0.040400 *  \n4 (88)  0.0299470  -0.0114943  0.0011717           1.2107        0.226015    \n5 (88) -0.1530471  -0.0114943  0.0012440          -4.0134       5.984e-05 ***\n6 (88) -0.1187070  -0.0114943  0.0016791          -2.6164        0.008886 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n\n\n\nGeary’s C Correlogram\n\nGC_corr &lt;- sp.correlogram(wm_q, \n                          hunan$GDPPC, \n                          order=6, \n                          method=\"C\", \n                          style=\"W\")\nplot(GC_corr)\n\n\n\n\n\nprint(GC_corr)\n\nSpatial correlogram for hunan$GDPPC \nmethod: Geary's C\n        estimate expectation  variance standard deviate Pr(I) two sided    \n1 (88) 0.6907223   1.0000000 0.0073364          -3.6108       0.0003052 ***\n2 (88) 0.7630197   1.0000000 0.0049126          -3.3811       0.0007220 ***\n3 (88) 0.9397299   1.0000000 0.0049005          -0.8610       0.3892612    \n4 (88) 1.0098462   1.0000000 0.0039631           0.1564       0.8757128    \n5 (88) 1.2008204   1.0000000 0.0035568           3.3673       0.0007592 ***\n6 (88) 1.0773386   1.0000000 0.0058042           1.0151       0.3100407    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html",
    "href": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html",
    "title": "Processing and Visualising Flow Data",
    "section": "",
    "text": "Spatial interaction represent the flow of people, material, or information between locations in geographical space. It encompasses everything from freight shipments, energy flows, and the global trade in rare antiquities, to flight schedules, rush hour woes, and pedestrian foot traffic.\nEach spatial interaction, as an analogy for a set of movements, is composed of a discrete origin/destination pair. Each pair can be represented as a cell in a matrix where rows are related to the locations (centroids) of origin, while columns are related to locations (centroids) of destination. Such a matrix is commonly known as an origin/destination matrix, or a spatial interaction matrix.\nWe will build an OD matrix by using Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#overview",
    "href": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#overview",
    "title": "Processing and Visualising Flow Data",
    "section": "",
    "text": "Spatial interaction represent the flow of people, material, or information between locations in geographical space. It encompasses everything from freight shipments, energy flows, and the global trade in rare antiquities, to flight schedules, rush hour woes, and pedestrian foot traffic.\nEach spatial interaction, as an analogy for a set of movements, is composed of a discrete origin/destination pair. Each pair can be represented as a cell in a matrix where rows are related to the locations (centroids) of origin, while columns are related to locations (centroids) of destination. Such a matrix is commonly known as an origin/destination matrix, or a spatial interaction matrix.\nWe will build an OD matrix by using Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#getting-started",
    "href": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#getting-started",
    "title": "Processing and Visualising Flow Data",
    "section": "Getting Started",
    "text": "Getting Started\nFor the purpose of this exercise, four r packages will be used. They are:\n\nsf for importing, integrating, processing and transforming geospatial data.\ntidyverse for importing, integrating, wrangling and visualising data.\ntmap for creating thematic maps.\n\n\npacman::p_load(tmap, sf, DT, stplanr,\n               performance,\n               ggpubr, tidyverse)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#preparing-the-flow-data",
    "href": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#preparing-the-flow-data",
    "title": "Processing and Visualising Flow Data",
    "section": "Preparing the Flow Data",
    "text": "Preparing the Flow Data\n\nImporting the OD data\nFirstly, we will import the Passenger Volume by Origin Destination Bus Stops data set downloaded from LTA DataMall by using read_csv() of readr package.\n\nodbus202308 &lt;- read_csv(\"data/aspatial/origin_destination_bus_202308.csv\")\nodbus202308 &lt;- data.frame(lapply(odbus202308, factor))\nodbus202308$TOTAL_TRIPS &lt;- as.numeric(odbus202308$TOTAL_TRIPS)\nodbus202308$TIME_PER_HOUR &lt;- as.numeric(odbus202308$TIME_PER_HOUR)\n\nLet use display the odbus tibble data table by using the code chunk below.\n\nglimpse(odbus202308)\n\nRows: 5,709,512\nColumns: 7\n$ YEAR_MONTH          &lt;fct&gt; 2023-08, 2023-08, 2023-08, 2023-08, 2023-08, 2023-…\n$ DAY_TYPE            &lt;fct&gt; WEEKDAY, WEEKENDS/HOLIDAY, WEEKENDS/HOLIDAY, WEEKD…\n$ TIME_PER_HOUR       &lt;dbl&gt; 17, 17, 15, 15, 18, 18, 18, 18, 8, 18, 15, 11, 11,…\n$ PT_TYPE             &lt;fct&gt; BUS, BUS, BUS, BUS, BUS, BUS, BUS, BUS, BUS, BUS, …\n$ ORIGIN_PT_CODE      &lt;fct&gt; 04168, 04168, 80119, 80119, 44069, 44069, 20281, 2…\n$ DESTINATION_PT_CODE &lt;fct&gt; 10051, 10051, 90079, 90079, 17229, 17229, 20141, 2…\n$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …\n\n\n\n\nExtracting the study data\nFor the purpose of this exercise, we will extract commuting flows on weekday and between 6 and 9 o’clock.\n\nodbus6_9 &lt;- odbus202308 %&gt;%\n  filter(DAY_TYPE == \"WEEKDAY\") %&gt;%\n  filter(TIME_PER_HOUR &gt;= 6 &\n           TIME_PER_HOUR &lt;= 9) %&gt;%\n  group_by(ORIGIN_PT_CODE,\n           DESTINATION_PT_CODE) %&gt;%\n  summarise(TRIPS = sum(TOTAL_TRIPS))\n\nTable below shows the content of odbus6_9\n\ndatatable(odbus6_9)"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#working-with-geospatial-data",
    "href": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#working-with-geospatial-data",
    "title": "Processing and Visualising Flow Data",
    "section": "Working with Geospatial Data",
    "text": "Working with Geospatial Data\nFor the purpose of this exercise, two geospatial data will be used. They are:\n\nBusStop: This data provides the location of bus stop from LTA Datamall as of Jul2023.\nMPSZ-2019: This data provides the sub-zone boundary of URA Master Plan 2019.\n\nBoth data sets are in ESRI shapefile format.\n\nImporting geospatial data\nTwo geospatial data will be used in this exercise, they are:\n\nbusstop &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `BusStop' from data source \n  `C:\\worksheep\\ISSS624\\Hands-on_Ex\\Hands-on_Ex3\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 5161 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"MPSZ-2019\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\worksheep\\ISSS624\\Hands-on_Ex\\Hands-on_Ex3\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\nmpsz\n\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N\n1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION\n2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION\n3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION\n4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION\n5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION\n6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION\n7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION\n8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION\n9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION\n10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION\n   REGION_C                       geometry\n1        CR MULTIPOLYGON (((33222.98 29...\n2        CR MULTIPOLYGON (((28481.45 30...\n3        CR MULTIPOLYGON (((28087.34 30...\n4        WR MULTIPOLYGON (((14557.7 304...\n5        CR MULTIPOLYGON (((29542.53 31...\n6        CR MULTIPOLYGON (((35279.55 30...\n7        WR MULTIPOLYGON (((15772.59 21...\n8        WR MULTIPOLYGON (((19843.41 21...\n9        CR MULTIPOLYGON (((30870.53 22...\n10       CR MULTIPOLYGON (((26879.04 26...\n\n\n\n\n\n\n\n\nNote\n\n\n\n\nst_read() function of sf package is used to import the shapefile into R as sf data frame.\nst_transform() function of sf package is used to transform the projection to crs 3414."
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#geospatial-data-wrangling",
    "href": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#geospatial-data-wrangling",
    "title": "Processing and Visualising Flow Data",
    "section": "Geospatial data wrangling",
    "text": "Geospatial data wrangling\n\nCombining Busstop and mpsz\nCode chunk below populates the planning subzone code (i.e. SUBZONE_C) of mpsz sf data frame into busstop sf data frame.\n\nbusstop_mpsz &lt;- st_intersection(busstop, mpsz) %&gt;%\n  select(BUS_STOP_N, SUBZONE_C) %&gt;%\n  st_drop_geometry()\n\n\n\n\n\n\n\nNote\n\n\n\n\nst_intersection() is used to perform point and polygon overly and the output will be in point sf object.\nselect() of dplyr package is then use to retain only BUS_STOP_N and SUBZONE_C in the busstop_mpsz sf data frame.\nfive bus stops are excluded in the resultant data frame because they are outside of Singapore bpundary.\n\n\n\n\ndatatable(busstop_mpsz)\n\n\n\n\n\n\nNext, we are going to append the planning subzone code from busstop_mpsz data frame onto odbus6_9 data frame.\n\nod_data &lt;- left_join(odbus6_9 , busstop_mpsz,\n            by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\")) %&gt;%\n  rename(ORIGIN_BS = ORIGIN_PT_CODE,\n         ORIGIN_SZ = SUBZONE_C,\n         DESTIN_BS = DESTINATION_PT_CODE)\n\nBefore continue, it is a good practice for us to check for duplicating records.\n\nduplicate &lt;- od_data %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\nIf duplicated records are found, the code chunk below will be used to retain the unique records.\n\nod_data &lt;- unique(od_data)\n\nIt will be a good practice to confirm if the duplicating records issue has been addressed fully.\nNext, we will update od_data data frame cwith the planning subzone codes.\n\nod_data &lt;- left_join(od_data , busstop_mpsz,\n            by = c(\"DESTIN_BS\" = \"BUS_STOP_N\")) %&gt;%\n   rename(DESTIN_SZ = SUBZONE_C)\n\n\nduplicate &lt;- od_data %&gt;%\n  group_by_all() %&gt;%\n  filter(n()&gt;1) %&gt;%\n  ungroup()\n\n\nod_data &lt;- unique(od_data)\n\n\nod_data &lt;- od_data %&gt;%\n  drop_na() %&gt;%\n  group_by(ORIGIN_SZ, DESTIN_SZ) %&gt;%\n  summarise(MORNING_PEAK = sum(TRIPS))"
  },
  {
    "objectID": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#visualising-spatial-interaction",
    "href": "Hands-on_Ex/Hands-on_Ex3/Hands-on_Ex3.html#visualising-spatial-interaction",
    "title": "Processing and Visualising Flow Data",
    "section": "Visualising Spatial Interaction",
    "text": "Visualising Spatial Interaction\nIn this section, you will learn how to prepare a desire line by using stplanr package.\n\nRemoving intra-zonal flows\nWe will not plot the intra-zonal flows. The code chunk below will be used to remove intra-zonal flows.\n\nod_data1 &lt;- od_data[od_data$ORIGIN_SZ!=od_data$DESTIN_SZ,]\n\n\n\nCreating desire lines\nIn this code chunk below, od2line() of stplanr package is used to create the desire lines.\n\nflowLine &lt;- od2line(flow = od_data1, \n                    zones = mpsz,\n                    zone_code = \"SUBZONE_C\")\n\n\n\nVisualising the desire lines\nTo visualise the resulting desire lines, the code chunk below is used.\n\ntm_shape(mpsz) +\n  tm_polygons() +\nflowLine %&gt;%  \ntm_shape() +\n  tm_lines(lwd = \"MORNING_PEAK\",\n           style = \"quantile\",\n           scale = c(0.1, 1, 3, 5, 7, 10),\n           n = 6,\n           alpha = 0.3)\n\n\n\n\nWhen the flow data are very messy and highly skewed like the one shown above, it is wiser to focus on selected flows, for example flow greater than or equal to 5000 as shown below.\n\ntmap_mode(\"view\")\ntmap_options(check.and.fix = TRUE)\n\n\nflowLine %&gt;%  \n  filter(MORNING_PEAK &gt;= 5000) %&gt;%\ntm_shape() +\n  tm_lines(lwd = \"MORNING_PEAK\",\n           col = \"orange\",\n           style = \"quantile\",\n           scale = c(0.1, 1, 3, 5, 7, 10),\n           n = 6,\n           alpha = 0.3)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex1/In-class_Ex1.html",
    "href": "In-class_Ex/In-class_Ex1/In-class_Ex1.html",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Analytics",
    "section": "",
    "text": "options(max.print=1000000)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#getting-started",
    "href": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#getting-started",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Analytics",
    "section": "Getting Started",
    "text": "Getting Started\nThe code chunk below load the following packages:\n- tmap : for thematic mapping\n- sf : for geospatial data handling\n- tidyverse: for non-spatial data handling\n\npacman::p_load(tmap, sf, tidyverse)\n\n# note : this is the R code for quatero, usually in R, we would have use library(tamp) etc\n#pacman:: call the package. then p_load is a function within pacman"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#importing-geospatial-data",
    "href": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#importing-geospatial-data",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Analytics",
    "section": "Importing Geospatial Data",
    "text": "Importing Geospatial Data\n\nImporting the Boundaries\nThe Masterplan 2014 Subzone Boundary is a shapefile that need to be imported. It will cut singapore into different subzones\ni recall prof was saying we should project to Singapore 3414. but either code seem to work? i think it is depending on which code i put in first. if i swap these 2 code around. it doesn’t seem to work. MP2019 shapefile is still in WGS84 (degree) instead of SVY21 (meters)\n\nmpsz = st_read(dsn = \"data/geospatial\", \n                  layer = \"MPSZ-2019\")\n\nReading layer `MPSZ-2019' from data source \n  `C:\\worksheep\\ISSS624\\In-class_Ex\\In-class_Ex1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;% st_transform(crs = 3414)\n\n#WGS84 SVY21\n#CRS coordinate representation system for Singapore is 3414\n\n\n\nImporting the cycling path\nthis is different from the earlier where this is SVY21\n\ncyclingpath = st_read(dsn = \"data/geospatial\", \n                         layer = \"CyclingPathGazette\")\n\nReading layer `CyclingPathGazette' from data source \n  `C:\\worksheep\\ISSS624\\In-class_Ex\\In-class_Ex1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2558 features and 2 fields\nGeometry type: MULTILINESTRING\nDimension:     XY\nBounding box:  xmin: 11854.32 ymin: 28347.98 xmax: 42626.09 ymax: 48948.15\nProjected CRS: SVY21\n\n\nI think i get it, the difference is base on the original file. So for WGS84 or SVY21, it is due to the shape file’s original coordinate system? I don’t recall so though.\n\n\nImporting Preschool Location\n\npreschool = st_read(\"data/geospatial/PreSchoolsLocation.kml\")\n\nReading layer `PRESCHOOLS_LOCATION' from data source \n  `C:\\worksheep\\ISSS624\\In-class_Ex\\In-class_Ex1\\data\\geospatial\\PreSchoolsLocation.kml' \n  using driver `KML'\nSimple feature collection with 2290 features and 2 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nthe main diff is this is KML file instead of shapefile. but seems like i can still use st_read, just that for this i don’t need to specify dsn and layer."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#importing-aspatial-data",
    "href": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#importing-aspatial-data",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Analytics",
    "section": "Importing Aspatial Data",
    "text": "Importing Aspatial Data\n\nInitial Import\nWe are getting all the airbnb listing in\n\nlistings &lt;- read_csv(\"data/aspatial/listings.csv\")\nlist(listings) \n\n[[1]]\n# A tibble: 3,483 × 18\n       id name      host_id host_name neighbourhood_group neighbourhood latitude\n    &lt;dbl&gt; &lt;chr&gt;       &lt;dbl&gt; &lt;chr&gt;     &lt;chr&gt;               &lt;chr&gt;            &lt;dbl&gt;\n 1  71609 Villa in…  367042 Belinda   East Region         Tampines          1.35\n 2  71896 Home in …  367042 Belinda   East Region         Tampines          1.35\n 3  71903 Home in …  367042 Belinda   East Region         Tampines          1.35\n 4 275343 Rental u… 1439258 Kay       Central Region      Bukit Merah       1.29\n 5 275344 Rental u… 1439258 Kay       Central Region      Bukit Merah       1.29\n 6 289234 Home in …  367042 Belinda   East Region         Tampines          1.34\n 7 294281 Rental u… 1521514 Elizabeth Central Region      Newton            1.31\n 8 324945 Rental u… 1439258 Kay       Central Region      Bukit Merah       1.29\n 9 330095 Rental u… 1439258 Kay       Central Region      Bukit Merah       1.29\n10 369141 Place to… 1521514 Elizabeth Central Region      Newton            1.31\n# ℹ 3,473 more rows\n# ℹ 11 more variables: longitude &lt;dbl&gt;, room_type &lt;chr&gt;, price &lt;dbl&gt;,\n#   minimum_nights &lt;dbl&gt;, number_of_reviews &lt;dbl&gt;, last_review &lt;date&gt;,\n#   reviews_per_month &lt;dbl&gt;, calculated_host_listings_count &lt;dbl&gt;,\n#   availability_365 &lt;dbl&gt;, number_of_reviews_ltm &lt;dbl&gt;, license &lt;chr&gt;\n\n\n\n\nConverting Aspatial to Spatial\nthe lat long has been converted to a geometry\n\nlistings_sf &lt;- st_as_sf(listings, \n                       coords = c(\"longitude\", \"latitude\"),\n                       crs=4326) %&gt;%\n  st_transform(crs = 3414)\n\nglimpse(listings_sf)\n\nRows: 3,483\nColumns: 17\n$ id                             &lt;dbl&gt; 71609, 71896, 71903, 275343, 275344, 28…\n$ name                           &lt;chr&gt; \"Villa in Singapore · ★4.44 · 2 bedroom…\n$ host_id                        &lt;dbl&gt; 367042, 367042, 367042, 1439258, 143925…\n$ host_name                      &lt;chr&gt; \"Belinda\", \"Belinda\", \"Belinda\", \"Kay\",…\n$ neighbourhood_group            &lt;chr&gt; \"East Region\", \"East Region\", \"East Reg…\n$ neighbourhood                  &lt;chr&gt; \"Tampines\", \"Tampines\", \"Tampines\", \"Bu…\n$ room_type                      &lt;chr&gt; \"Private room\", \"Private room\", \"Privat…\n$ price                          &lt;dbl&gt; 150, 80, 80, 55, 69, 220, 85, 75, 45, 7…\n$ minimum_nights                 &lt;dbl&gt; 92, 92, 92, 60, 60, 92, 92, 60, 60, 92,…\n$ number_of_reviews              &lt;dbl&gt; 20, 24, 47, 22, 17, 12, 133, 18, 6, 81,…\n$ last_review                    &lt;date&gt; 2020-01-17, 2019-10-13, 2020-01-09, 20…\n$ reviews_per_month              &lt;dbl&gt; 0.14, 0.16, 0.31, 0.17, 0.12, 0.09, 0.9…\n$ calculated_host_listings_count &lt;dbl&gt; 5, 5, 5, 52, 52, 5, 7, 52, 52, 7, 7, 1,…\n$ availability_365               &lt;dbl&gt; 89, 89, 89, 275, 274, 89, 365, 365, 365…\n$ number_of_reviews_ltm          &lt;dbl&gt; 0, 0, 0, 0, 3, 0, 0, 1, 3, 0, 0, 0, 0, …\n$ license                        &lt;chr&gt; NA, NA, NA, \"S0399\", \"S0399\", NA, NA, \"…\n$ geometry                       &lt;POINT [m]&gt; POINT (41972.5 36390.05), POINT (…"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#doing-some-initial-play-with-the-data",
    "href": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#doing-some-initial-play-with-the-data",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Analytics",
    "section": "Doing Some Initial Play with the Data",
    "text": "Doing Some Initial Play with the Data\n\nDataTable\n\nst_geometry(mpsz)\n\nGeometry set for 332 features \nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\nFirst 5 geometries:\n\n\n\nglimpse(mpsz)\n\nRows: 332\nColumns: 7\n$ SUBZONE_N  &lt;chr&gt; \"MARINA EAST\", \"INSTITUTION HILL\", \"ROBERTSON QUAY\", \"JURON…\n$ SUBZONE_C  &lt;chr&gt; \"MESZ01\", \"RVSZ05\", \"SRSZ01\", \"WISZ01\", \"MUSZ02\", \"MPSZ05\",…\n$ PLN_AREA_N &lt;chr&gt; \"MARINA EAST\", \"RIVER VALLEY\", \"SINGAPORE RIVER\", \"WESTERN …\n$ PLN_AREA_C &lt;chr&gt; \"ME\", \"RV\", \"SR\", \"WI\", \"MU\", \"MP\", \"WI\", \"WI\", \"SI\", \"SI\",…\n$ REGION_N   &lt;chr&gt; \"CENTRAL REGION\", \"CENTRAL REGION\", \"CENTRAL REGION\", \"WEST…\n$ REGION_C   &lt;chr&gt; \"CR\", \"CR\", \"CR\", \"WR\", \"CR\", \"CR\", \"WR\", \"WR\", \"CR\", \"CR\",…\n$ geometry   &lt;MULTIPOLYGON [°]&gt; MULTIPOLYGON (((103.8802 1...., MULTIPOLYGON (…\n\n\n\nhead(mpsz, n=5)\n\nSimple feature collection with 5 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6537 ymin: 1.216215 xmax: 103.8811 ymax: 1.29742\nGeodetic CRS:  WGS 84\n                SUBZONE_N SUBZONE_C      PLN_AREA_N PLN_AREA_C       REGION_N\n1             MARINA EAST    MESZ01     MARINA EAST         ME CENTRAL REGION\n2        INSTITUTION HILL    RVSZ05    RIVER VALLEY         RV CENTRAL REGION\n3          ROBERTSON QUAY    SRSZ01 SINGAPORE RIVER         SR CENTRAL REGION\n4 JURONG ISLAND AND BUKOM    WISZ01 WESTERN ISLANDS         WI    WEST REGION\n5            FORT CANNING    MUSZ02          MUSEUM         MU CENTRAL REGION\n  REGION_C                       geometry\n1       CR MULTIPOLYGON (((103.8802 1....\n2       CR MULTIPOLYGON (((103.8376 1....\n3       CR MULTIPOLYGON (((103.8341 1....\n4       WR MULTIPOLYGON (((103.7125 1....\n5       CR MULTIPOLYGON (((103.8472 1....\n\n\n\n\nPlotting a Map\n\nplot(mpsz)\n\n\n\n\n\nplot(st_geometry(mpsz))\n\n\n\n\n\nplot(mpsz[\"PLN_AREA_N\"])"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#changing-the-projection",
    "href": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#changing-the-projection",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Analytics",
    "section": "Changing the Projection",
    "text": "Changing the Projection\nFirst we need to check the data\n\nst_crs(mpsz)\n\nCoordinate Reference System:\n  User input: WGS 84 \n  wkt:\nGEOGCRS[\"WGS 84\",\n    DATUM[\"World Geodetic System 1984\",\n        ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n            LENGTHUNIT[\"metre\",1]]],\n    PRIMEM[\"Greenwich\",0,\n        ANGLEUNIT[\"degree\",0.0174532925199433]],\n    CS[ellipsoidal,2],\n        AXIS[\"latitude\",north,\n            ORDER[1],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        AXIS[\"longitude\",east,\n            ORDER[2],\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n    ID[\"EPSG\",4326]]\n\n\nactually after checking i saw that prof used another command to change the projection . What is the difference between st_set_crs and st_transform. from what is googled, st_set_crs just update the metadata but doesn’t change the coordinates itself\n\nmpsz3414 &lt;- st_set_crs(mpsz, 3414)\n\n\nst_crs(mpsz3414)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\nmpsz3414 &lt;- st_transform(mpsz, 3414)\n\n\nst_crs(mpsz3414)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]\n\n\n\npreschool3414 &lt;- st_transform(preschool, \n                              crs = 3414)\nst_crs(preschool3414)\n\nCoordinate Reference System:\n  User input: EPSG:3414 \n  wkt:\nPROJCRS[\"SVY21 / Singapore TM\",\n    BASEGEOGCRS[\"SVY21\",\n        DATUM[\"SVY21\",\n            ELLIPSOID[\"WGS 84\",6378137,298.257223563,\n                LENGTHUNIT[\"metre\",1]]],\n        PRIMEM[\"Greenwich\",0,\n            ANGLEUNIT[\"degree\",0.0174532925199433]],\n        ID[\"EPSG\",4757]],\n    CONVERSION[\"Singapore Transverse Mercator\",\n        METHOD[\"Transverse Mercator\",\n            ID[\"EPSG\",9807]],\n        PARAMETER[\"Latitude of natural origin\",1.36666666666667,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8801]],\n        PARAMETER[\"Longitude of natural origin\",103.833333333333,\n            ANGLEUNIT[\"degree\",0.0174532925199433],\n            ID[\"EPSG\",8802]],\n        PARAMETER[\"Scale factor at natural origin\",1,\n            SCALEUNIT[\"unity\",1],\n            ID[\"EPSG\",8805]],\n        PARAMETER[\"False easting\",28001.642,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8806]],\n        PARAMETER[\"False northing\",38744.572,\n            LENGTHUNIT[\"metre\",1],\n            ID[\"EPSG\",8807]]],\n    CS[Cartesian,2],\n        AXIS[\"northing (N)\",north,\n            ORDER[1],\n            LENGTHUNIT[\"metre\",1]],\n        AXIS[\"easting (E)\",east,\n            ORDER[2],\n            LENGTHUNIT[\"metre\",1]],\n    USAGE[\n        SCOPE[\"Cadastre, engineering survey, topographic mapping.\"],\n        AREA[\"Singapore - onshore and offshore.\"],\n        BBOX[1.13,103.59,1.47,104.07]],\n    ID[\"EPSG\",3414]]"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#the-scenarios",
    "href": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#the-scenarios",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Analytics",
    "section": "The Scenarios:",
    "text": "The Scenarios:\n\nScenario 1\nThe authority is planning to upgrade the exiting cycling path. To do so, they need to acquire 5 metres of reserved land on the both sides of the current cycling path. You are tasked to determine the extend of the land need to be acquired and their total area.\n\n\nScenario 1 Solution:\nQuestion: what is the difference between PLANNING_A and PLANNING_1. but given that PLANNING_A is all NA, why is showing in the plot for buffer but not for the cycling path itself?\n\nbuffer_cycling &lt;- st_buffer(cyclingpath, \n                               dist=5, nQuadSegs = 30)\nglimpse(buffer_cycling)\n\nRows: 2,558\nColumns: 3\n$ PLANNING_A &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…\n$ PLANNING_1 &lt;chr&gt; \"BEDOK\", \"BEDOK\", \"BEDOK\", \"TAMPINES\", \"TAMPINES\", \"TAMPINE…\n$ geometry   &lt;POLYGON [m]&gt; POLYGON ((39803.36 34814.24..., POLYGON ((39829.27 …\n\n\n\nplot(cyclingpath)\n\n\n\n\n\nplot(buffer_cycling)\n\n\n\n\ncalculating the buffer area i.e. convert geometry into area then summing it up\n\nbuffer_cycling$AREA &lt;- st_area(buffer_cycling)\nsum(buffer_cycling$AREA)\n\n1774367 [m^2]\n\n\n\n\nScenario 2\nA pre-school service group want to find out the numbers of pre-schools in each Planning Subzone.\n\n\nScenario 2 Solution:\n\nCalculate number of Preschool in PZ\nThe code chunk below performs two operations at one go. Firstly, identify pre-schools located inside each Planning Subzone by using st_intersects(). Next, length() of Base R is used to calculate numbers of pre-schools that fall inside each planning subzone.\n\nmpsz3414$`PreSch Count`&lt;- lengths(st_intersects(mpsz3414, preschool3414))\nsummary(mpsz3414$`PreSch Count`)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  0.000   0.000   4.000   6.898  10.000  72.000 \n\n\n\ntop_n(mpsz3414, 1, `PreSch Count`)\n\nSimple feature collection with 1 feature and 7 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 39655.33 ymin: 35967.33 xmax: 42940.57 ymax: 38622.37\nProjected CRS: SVY21 / Singapore TM\n      SUBZONE_N SUBZONE_C PLN_AREA_N PLN_AREA_C    REGION_N REGION_C\n1 TAMPINES EAST    TMSZ02   TAMPINES         TM EAST REGION       ER\n                        geometry PreSch Count\n1 MULTIPOLYGON (((42196.76 38...           72\n\n\n\n\nCalulating the density of pre-school by planning subzone\n\nmpsz3414$Area &lt;- mpsz3414 %&gt;%\n  st_area()\n\nmpsz3414 &lt;- mpsz3414 %&gt;%\n  mutate(`PreSch Density` = `PreSch Count`/Area * 1000000)\n\ntop_n(mpsz3414, 10, `PreSch Density`)\n\nSimple feature collection with 10 features and 9 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 17518.63 ymin: 28623.75 xmax: 36532.07 ymax: 48182.13\nProjected CRS: SVY21 / Singapore TM\n              SUBZONE_N SUBZONE_C    PLN_AREA_N PLN_AREA_C          REGION_N\n1                 CECIL    DTSZ08 DOWNTOWN CORE         DT    CENTRAL REGION\n2               PHILLIP    DTSZ04 DOWNTOWN CORE         DT    CENTRAL REGION\n3                KATONG    MPSZ02 MARINE PARADE         MP    CENTRAL REGION\n4       SERANGOON NORTH    SGSZ03     SERANGOON         SG NORTH-EAST REGION\n5         MANDAI ESTATE    MDSZ03        MANDAI         MD      NORTH REGION\n6             KEAT HONG    CKSZ02 CHOA CHU KANG         CK       WEST REGION\n7  SENGKANG TOWN CENTRE    SESZ03      SENGKANG         SE NORTH-EAST REGION\n8               MIDVIEW    WDSZ02     WOODLANDS         WD      NORTH REGION\n9        WOODLANDS EAST    WDSZ03     WOODLANDS         WD      NORTH REGION\n10    SEMBAWANG CENTRAL    SBSZ03     SEMBAWANG         SB      NORTH REGION\n   REGION_C                       geometry PreSch Count             Area\n1        CR MULTIPOLYGON (((29917.52 29...            7  196619.86 [m^2]\n2        CR MULTIPOLYGON (((29814.11 29...            1   39437.94 [m^2]\n3        CR MULTIPOLYGON (((36317.74 32...           22 1078992.03 [m^2]\n4       NER MULTIPOLYGON (((32860.5 397...           17  684704.30 [m^2]\n5        NR MULTIPOLYGON (((27119.56 45...            5  143137.94 [m^2]\n6        WR MULTIPOLYGON (((18700.53 39...           23 1143813.67 [m^2]\n7       NER MULTIPOLYGON (((35615.75 40...           33 1460534.44 [m^2]\n8        NR MULTIPOLYGON (((23820.19 46...           19  936415.53 [m^2]\n9        NR MULTIPOLYGON (((24786.75 46...           54 2553463.72 [m^2]\n10       NR MULTIPOLYGON (((26311.14 46...           27  961421.72 [m^2]\n     PreSch Density\n1  35.60169 [1/m^2]\n2  25.35630 [1/m^2]\n3  20.38940 [1/m^2]\n4  24.82824 [1/m^2]\n5  34.93134 [1/m^2]\n6  20.10817 [1/m^2]\n7  22.59447 [1/m^2]\n8  20.29014 [1/m^2]\n9  21.14775 [1/m^2]\n10 28.08341 [1/m^2]\n\n\n\n\nExploring the Data\n\nhist(mpsz3414$`PreSch Density`)\n\n\n\n\n\nggplot(data=mpsz3414, \n       aes(x= as.numeric(`PreSch Density`)))+\n  geom_histogram(bins=20, \n                 color=\"black\", \n                 fill=\"light blue\") +\n  labs(title = \"Are pre-school even distributed in Singapore?\",\n       subtitle= \"There are many planning sub-zones with a single pre-school, on the other hand, \\nthere are a couple of planning sub-zones with at least 20 pre-schools\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Frequency\")\n\n\n\n\n\nggplot(data=mpsz3414, \n       aes(y = `PreSch Count`, \n           x= as.numeric(`PreSch Density`)))+\n  geom_point(color=\"black\", \n             fill=\"light blue\") +\n  xlim(0, 40) +\n  ylim(0, 40) +\n  labs(title = \"\",\n      x = \"Pre-school density (per km sq)\",\n      y = \"Pre-school count\")"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#below-are-not-for-this-ex",
    "href": "In-class_Ex/In-class_Ex1/In-class_Ex1.html#below-are-not-for-this-ex",
    "title": "In-class Exercise 1: My First Date with Geospatial Data Analytics",
    "section": "BELOW ARE NOT FOR THIS EX",
    "text": "BELOW ARE NOT FOR THIS EX\n\nPreparing the Flow Data\n\nImporting the OD data\nFirst, we will import the Passenger Volume by Origin Destination Bus Stops dataset downloaded from LTA DataMall by using read_csv() of readr package\n\nodbus &lt;- read.csv(\"data/aspatial/origin_destination_bus_202308.csv\")\n\n\nodbus$ORIGIN_PT_CODE &lt;- as.factor(odbus$ORIGIN_PT_CODE)\nodbus$DESTINATION_PT_CODE &lt;- as.factor(odbus$DESTINATION_PT_CODE)\n\n\n\n\nExtracting the study data\nFor the purpose of this exercise, we will extract commuting flows on weekday and between 7 and 9 o’clock\n\norigtrip_7_9 &lt;- odbus %&gt;%\n  filter(DAY_TYPE == \"WEEKDAY\") %&gt;%\n  filter(TIME_PER_HOUR &gt;= 7 & TIME_PER_HOUR &lt;= 9) %&gt;%\n  group_by(ORIGIN_PT_CODE) %&gt;%\n  summarise(TRIPS= sum(TOTAL_TRIPS))\n\n#for beginners, we may not want to use pipe %&gt;%, we can chop up the code into individual blocks, to understand the output step by step\n\n\nbusstop &lt;- st_read(dsn = \"data/geospatial\", layer=\"BusStop\") %&gt;% st_transform(crs = 3414)\n\n# dsn is data geospatial\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;% st_transform(crs = 3414)\n\n#WGS84 SVY21\n#CRS coordinate representation system for Singapore is 3414"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex2/In-class_Ex2.html",
    "href": "In-class_Ex/In-class_Ex2/In-class_Ex2.html",
    "title": "In-class_Ex2",
    "section": "",
    "text": "This load the R packages\nsf is a powerful package, that allow us to process a big chunk of data with a routine. it help to handle geospatial data, in a spatial tibble format\nsfdep is replacing spdef\ntmap is a mapping package, very powerful to create thematic map\ntidyverse is a family of R packages, it is a concept framework to help developer to design R packages that conform to the same design standard. It allow asynchronised update, we can update 1 module by 1 module. Tidyverse has\ntibble - the dataframe forcats - for vector stringr - for string lubridate - for date fields dplyr - tdyr purrr - organise model\npython uses panda to do data wrangle. Panda team has to upgrade everything and release it.\nknitr - will generate the HTML table for us, static HTML table, not iteractable\n\npacman::p_load(tmap, sf, tidyverse, sfdep, knitr, plotly)\n\npacman package is installed but not loaded, that’s why we use pacman::, if we don’t include pacman:: it will return a error that the function “p_load” cannot be found\nthis also allow us to have a more tidy way of loading in the required packages wihtout going into the need of typing libaray(tmap), library(sf), so & so forth\n\n\n\nFor the purpose of this in-class ex, the Hunan dataset will be used. There are 2 dataset in this use case\n\nbasemap : hunan\nmetadata : hunan2012\n\n\n\nHunan\n\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\worksheep\\ISSS624\\In-class_Ex\\In-class_Ex2\\Data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\nusing st_read allow us to read it in simple features or layer from database this is a function under the package sf\nit is in tibble format, it will not overcluster. It allow a list within the dataframe, e.g. the geometry of polygon is actually a list (also called simple feature geometry(sfg))\neach row is a “observation” in R format. The feature here is referring to the geographical type (entity), point, line or polygon.\nthe specification are written by Open Geospatial Consortium (OGC), Europe has a “law” that software must have inter-operable. Othewise, the software cannot sell in EU\n\nhead(hunan)\n\nSimple feature collection with 6 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 110.4922 ymin: 28.61762 xmax: 112.3013 ymax: 30.12812\nGeodetic CRS:  WGS 84\n   NAME_2  ID_3  NAME_3   ENGTYPE_3 Shape_Leng Shape_Area  County\n1 Changde 21098 Anxiang      County   1.869074 0.10056190 Anxiang\n2 Changde 21100 Hanshou      County   2.360691 0.19978745 Hanshou\n3 Changde 21101  Jinshi County City   1.425620 0.05302413  Jinshi\n4 Changde 21102      Li      County   3.474325 0.18908121      Li\n5 Changde 21103   Linli      County   2.289506 0.11450357   Linli\n6 Changde 21104  Shimen      County   4.171918 0.37194707  Shimen\n                        geometry\n1 POLYGON ((112.0625 29.75523...\n2 POLYGON ((112.2288 29.11684...\n3 POLYGON ((111.8927 29.6013,...\n4 POLYGON ((111.3731 29.94649...\n5 POLYGON ((111.6324 29.76288...\n6 POLYGON ((110.8825 30.11675...\n\n\n\n\n\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nthis is a typical tibble dataframe, with 88 observations (row), 29 variable (column)\n\n\n\n\nGDPPC &lt;- read_csv(\"data/aspatial/Hunan_GDPPC.csv\")\n\n\n\n\n\nhunan_allmerged &lt;- left_join(hunan,hunan2012)\n\nwe need to know which 1 we want to retain, e.g. we want to retain the spatial property, we use left_join with the dataframe with spatial attributes infront.\nleft_join is dplyr function. In R, we always use packages. This is quite smart that despite they have different column name (NAME_3 in Hunan vs County in Hunan2012), they can still do a left join w/o us specifying which column to join by specifically\nIn addition, this left_join using dplyr function automatically kept the geometry attribute. if we use the leftjoin from basic R, it doesn’t retain it\n\nhunan &lt;- hunan_allmerged %&gt;% select(1:4,7,15)\n\nthis is the previous code given by prof, but i wanted to split it up to see what the dataset is\nhunan &lt;- left_join(hunan,hunan2012)%&gt;% select(1:4, 7, 15)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex2/In-class_Ex2.html#start-of-in-class-exercise-2",
    "href": "In-class_Ex/In-class_Ex2/In-class_Ex2.html#start-of-in-class-exercise-2",
    "title": "In-class_Ex2",
    "section": "",
    "text": "This load the R packages\nsf is a powerful package, that allow us to process a big chunk of data with a routine. it help to handle geospatial data, in a spatial tibble format\nsfdep is replacing spdef\ntmap is a mapping package, very powerful to create thematic map\ntidyverse is a family of R packages, it is a concept framework to help developer to design R packages that conform to the same design standard. It allow asynchronised update, we can update 1 module by 1 module. Tidyverse has\ntibble - the dataframe forcats - for vector stringr - for string lubridate - for date fields dplyr - tdyr purrr - organise model\npython uses panda to do data wrangle. Panda team has to upgrade everything and release it.\nknitr - will generate the HTML table for us, static HTML table, not iteractable\n\npacman::p_load(tmap, sf, tidyverse, sfdep, knitr, plotly)\n\npacman package is installed but not loaded, that’s why we use pacman::, if we don’t include pacman:: it will return a error that the function “p_load” cannot be found\nthis also allow us to have a more tidy way of loading in the required packages wihtout going into the need of typing libaray(tmap), library(sf), so & so forth\n\n\n\nFor the purpose of this in-class ex, the Hunan dataset will be used. There are 2 dataset in this use case\n\nbasemap : hunan\nmetadata : hunan2012\n\n\n\nHunan\n\nhunan &lt;- st_read(dsn = \"data/geospatial\", \n                 layer = \"Hunan\")\n\nReading layer `Hunan' from data source \n  `C:\\worksheep\\ISSS624\\In-class_Ex\\In-class_Ex2\\Data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 88 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 108.7831 ymin: 24.6342 xmax: 114.2544 ymax: 30.12812\nGeodetic CRS:  WGS 84\n\n\nusing st_read allow us to read it in simple features or layer from database this is a function under the package sf\nit is in tibble format, it will not overcluster. It allow a list within the dataframe, e.g. the geometry of polygon is actually a list (also called simple feature geometry(sfg))\neach row is a “observation” in R format. The feature here is referring to the geographical type (entity), point, line or polygon.\nthe specification are written by Open Geospatial Consortium (OGC), Europe has a “law” that software must have inter-operable. Othewise, the software cannot sell in EU\n\nhead(hunan)\n\nSimple feature collection with 6 features and 7 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 110.4922 ymin: 28.61762 xmax: 112.3013 ymax: 30.12812\nGeodetic CRS:  WGS 84\n   NAME_2  ID_3  NAME_3   ENGTYPE_3 Shape_Leng Shape_Area  County\n1 Changde 21098 Anxiang      County   1.869074 0.10056190 Anxiang\n2 Changde 21100 Hanshou      County   2.360691 0.19978745 Hanshou\n3 Changde 21101  Jinshi County City   1.425620 0.05302413  Jinshi\n4 Changde 21102      Li      County   3.474325 0.18908121      Li\n5 Changde 21103   Linli      County   2.289506 0.11450357   Linli\n6 Changde 21104  Shimen      County   4.171918 0.37194707  Shimen\n                        geometry\n1 POLYGON ((112.0625 29.75523...\n2 POLYGON ((112.2288 29.11684...\n3 POLYGON ((111.8927 29.6013,...\n4 POLYGON ((111.3731 29.94649...\n5 POLYGON ((111.6324 29.76288...\n6 POLYGON ((110.8825 30.11675...\n\n\n\n\n\n\nhunan2012 &lt;- read_csv(\"data/aspatial/Hunan_2012.csv\")\n\nthis is a typical tibble dataframe, with 88 observations (row), 29 variable (column)\n\n\n\n\nGDPPC &lt;- read_csv(\"data/aspatial/Hunan_GDPPC.csv\")\n\n\n\n\n\nhunan_allmerged &lt;- left_join(hunan,hunan2012)\n\nwe need to know which 1 we want to retain, e.g. we want to retain the spatial property, we use left_join with the dataframe with spatial attributes infront.\nleft_join is dplyr function. In R, we always use packages. This is quite smart that despite they have different column name (NAME_3 in Hunan vs County in Hunan2012), they can still do a left join w/o us specifying which column to join by specifically\nIn addition, this left_join using dplyr function automatically kept the geometry attribute. if we use the leftjoin from basic R, it doesn’t retain it\n\nhunan &lt;- hunan_allmerged %&gt;% select(1:4,7,15)\n\nthis is the previous code given by prof, but i wanted to split it up to see what the dataset is\nhunan &lt;- left_join(hunan,hunan2012)%&gt;% select(1:4, 7, 15)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex2/In-class_Ex2.html#visualisation",
    "href": "In-class_Ex/In-class_Ex2/In-class_Ex2.html#visualisation",
    "title": "In-class_Ex2",
    "section": "Visualisation",
    "text": "Visualisation\n\nGDP Per Capita 2012\n\nbasemap &lt;- tm_shape(hunan) +\n  tm_polygons() +\n  tm_text(\"NAME_3\", size=0.5)\n\ngdppc &lt;- qtm(hunan, \"GDPPC\")\ntmap_arrange(basemap, gdppc, asp=1, ncol=2)\n\n\n\n\n\n\nStarting the use of sfdep\n\nwm_q &lt;- hunan %&gt;%\n  mutate(nb = st_contiguity(geometry),\n         wt = st_weights(nb, \n                         style = \"W\"),\n         .before = 1\n         )\n\nit is a tibble dataframe, so we can use mutate, which is a dpylr function that allow us to insert back into the dataframe\nst_contiguity by default use queen pattern weight style W is using row standarised weight\nso we store all the neighbour and weight into the tibble dataframe directly (as compared to spdep we need to store differently into a separate list before combining together)\nsfdep is technically a wrapper of spdep, but allow output back into tibble format, which make our live much easier\n\nComputing Local Moran I\nnsim is the number of simulation, to create different random observation local_moran() calculate multiple values, so we need to unnest local_moran variable into individual column\n\nlisa &lt;- wm_q %&gt;%\n  mutate(local_moran = local_moran(\n    GDPPC, nb, wt, nsim = 99),\n    .before = 1) %&gt;%\n  unnest(local_moran)\n\nthis follow the tibble way, is tidier than the previous method in addition, it also help to calculate all the high-high, low-low and output it as well, we no need to separately generate. no need to join table.\nsometimes when we google, the results are using older packages, yes it can solve the problem, but it may complicate your process further as it is using the older package and may not be compatible with other steps down the road.\nif the result is highly skewed (e.g. GDP), we may not want to use mean, but use median. pysal is using a python package"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex2/In-class_Ex2.html#emerging-hot-spot",
    "href": "In-class_Ex/In-class_Ex2/In-class_Ex2.html#emerging-hot-spot",
    "title": "In-class_Ex2",
    "section": "Emerging Hot Spot",
    "text": "Emerging Hot Spot\n\nCreating a Time Series Cube\n\nGDPPC_st &lt;- spacetime(GDPPC, hunan,\n                      .loc_col = \"County\",\n                      .time_col = \"Year\")\n\n\nis_spacetime_cube(GDPPC_st)\n\n[1] TRUE\n\n\n\nis_spacetime_cube(GDPPC)\n\n[1] FALSE\n\n\nAlthough the 2 dataset look similar at initially, but actually when we look into the table information, there are space time information under the meta datain GDPPC_st\n\nComputing GI* part 1\n\nGDPPC_nb &lt;- GDPPC_st %&gt;%\n  activate(\"geometry\") %&gt;%\n  mutate(nb = include_self(st_contiguity(geometry)),\n         wt = st_inverse_distance(nb, geometry,\n                                  scale = 1,\n                                  alpha = 1),\n         .before = 1 )%&gt;%\n  set_nbs(\"nb\") %&gt;%\n  set_wts(\"wt\")\n\nneed to have activate before we calculate all these. although this is not too efficient given that the neighbour don’t change across the year in this setting. However, if we don’t have this, they will have to give us a big table\n\n\nComputing Gi* part 2\n\ngi_stars &lt;- GDPPC_nb %&gt;%\n  group_by(Year) %&gt;%\n  mutate(gi_star = local_gstar_perm(\n    GDPPC, nb, wt)) %&gt;%\n  tidyr::unnest(gi_star)\n\n\n\nOutput\ncbg &lt;- gi_stars %&gt;%\np &lt;- ggplot(data = cbg,\n       aes(x = Year,\n           y = gi_star))\n\n\nggplotly(p)\nk is the time lag, 2014 compare wiht 2013, so and so forth. spatial is already taken care of by the database, space time cube GDPPC_st\n\nehsa &lt;- emerging_hotspot_analysis(\n  x = GDPPC_st,\n  .var = \"GDPPC\",\n  k = 1,\n  nsim = 99\n)\n\nthere is a difference between “no pattern” (yellow) and “missing value” (grey). all those with\nehsa_sig &lt;- hunan_ehsa %&gt;%\n  filter(p_value &lt;0.05)\ntmap_mode(\"plot\")\ntm_shape(hunan_ehsa)+\n  tm_polygons()+\n  tm_borders(alpha = 0.5) +\ntm_shape(ehsa_sig) +\n  tm_fill(\"classification\")+\n  tm_borders(alpha = 0.4)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex2/In-class_Ex2.html#notes-for-class",
    "href": "In-class_Ex/In-class_Ex2/In-class_Ex2.html#notes-for-class",
    "title": "In-class_Ex2",
    "section": "Notes for class",
    "text": "Notes for class\nIn geospatial, it is normally about space randomness than normally distributed as per statistics\nEconomically Active Group - 16-64 Economically Inactive Group - 0-15 + &gt;=65\nDependency Ratio = Economically Inactive / Economically Active\nSpatial Weights - Adjacency - Distance Based\nReal world phenomena might not have shared boundary. e.g. island has no immediate neighbour, but this island might be part of a certain region\nIn addition, we can also use inverse distance as weight\nwe can create modifying area to make it regular (e.g hexagon). The shape is not exactly fixed, but hexagon is one of the most compact geometrical shape\nOnly in more modern urban design, the layout is more grid like e.g. in punggol in Singapore, or like Seattle in US\nLag1 = immediate neighbour Lag2 = immediate + next level neighbour\nwhen we want to check when the cluster subside, we will try to see where the influence wane, so we will go lag1, lag2, lag3 so and so forth\nOn row standardisation. it is more like an average, instead of sum, if we use Binary W, those with more neighbours has more 1, leading to a higher number. Whereas if we use Row Standardised, it will be 1/x each for x neighbour. Sum = 1\n1 example given by Prof is his analysis with Pizza Hut, on time distance away from franchise store. We don’t want to be overcrowded, but also not too far. Identify each of the neighbour, and see which give them the highest market share reach.\nCounty is the smallest administrative distict, although there will still be villages within the county\nThere are 2 portion to look at - Spatial dependency (2 variable) - we use it for oil reservoir discovery, borehole sampling, interpolate to create a modelling of where is likely the oil reservoir, and avoiding bedrock. if the borehole drill hit the bedrock, it will crack and be lost underground and cannot be retrived.\n\nSpatial Autocorrelation (1 variable) : we observe the value with its neighbour. It is very similar to correlation (xi - xbar) x (yi - ybar). but it is (xi - xbar) x (xj -xbar)\n\npositive spatial autocorrelation : you see lumps, clustering negative spatial autocorrelation : you see checkedbox\nLISA high high cluster - high value surrounded by high value low low cluster - low value surrounded by low value outlier\nit might not be statistically significant because of 2 reason 1) not enough neighbour (we will want to increase the number of neighbour, to make sure we are not bias) 2) the neighbour properties (cannot solve furhter)\n\nGetis method\n\nweight matrix must be distance based, unliked Morant & Geary which can use adjacency. We want to be more precise, this is using more precise and refined data in the 1990s where there are GPS data, instead of Morant & Geary in the 1960s where it is more coarse. Getis is also looking at healthcare, which is more distance based\n\nG vs G(star) wii(d) = 0 vs wii(d) =/= 0 don’t include itself vs include itself\n\n\nTime Series\nMann-Kendall, student asked if this mean it cannot have gap. Prof replied yes, cannot have gap. need to fill in with value.\nUse G(star)i for\n\n\nSeparate notes\nquarto documents are authored using markdown, an easy to write plain tet format quarto documents are generated using pandoc, a universal document converter\nwhen we run R, it is in memory and it may not need to run in sequence, so it could be possible that the output works, because we were doing trial and error and skip different steps.\nWhereas when we render, it must go in sequence, so it may not work as per the skip step"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/in-class_Ex3.html",
    "href": "In-class_Ex/In-class_Ex3/in-class_Ex3.html",
    "title": "Calibrating Spatial Interaction Models with R",
    "section": "",
    "text": "Pull factor & push factor can be different, 1 variable or multi-variable too\nGravity Model - Potential Model - how far are people away Retail Model - people who are closer to this trade area tend to go to this location, propensity that people will shop here instead of shop here base on the distance.\n\n\n\ntypical equation, equation decomposed to formula that can be addressed by regression formula. However not a typical multiple-linear regression. Distance are usually non-linear. Distance decay depends on the goods e.g. expensive goods, long longevity we will be ok to pay more, travel more to find the it. Whereas for a normal bread, we may not travel so far to get it.\nIT people sometimes no choice, the industry is in Changi Business Park, then no choice we have to go there. Not every relationship is linear.\nThere are different type of calibration.\n\n\n\nwe need 3 set of data a) flow data (accomplished in hands-on_Ex3) b) how to calculate Sij"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#my-own-notes",
    "href": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#my-own-notes",
    "title": "Calibrating Spatial Interaction Models with R",
    "section": "",
    "text": "Pull factor & push factor can be different, 1 variable or multi-variable too\nGravity Model - Potential Model - how far are people away Retail Model - people who are closer to this trade area tend to go to this location, propensity that people will shop here instead of shop here base on the distance.\n\n\n\ntypical equation, equation decomposed to formula that can be addressed by regression formula. However not a typical multiple-linear regression. Distance are usually non-linear. Distance decay depends on the goods e.g. expensive goods, long longevity we will be ok to pay more, travel more to find the it. Whereas for a normal bread, we may not travel so far to get it.\nIT people sometimes no choice, the industry is in Changi Business Park, then no choice we have to go there. Not every relationship is linear.\nThere are different type of calibration.\n\n\n\nwe need 3 set of data a) flow data (accomplished in hands-on_Ex3) b) how to calculate Sij"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#overview",
    "href": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#overview",
    "title": "Calibrating Spatial Interaction Models with R",
    "section": "Overview",
    "text": "Overview\nSpatial Interaction Models (SIMs) are mathematical models for estimating flows between spatial entities developed by Alan Wilson in the late 1960s and early 1970, with considerable uptake and refinement for transport modelling since then Boyce and Williams (2015).\nThere are four main types of traditional SIMs (Wilson 1971):\n\nUnconstrained\nProduction-constrained\nAttraction-constrained\nDoubly-constrained\n\nOrdinary least square (OLS), log-normal, Poisson and negative binomial (NB) regression methods have been used extensively to calibrate OD flow models by processing flow data as different types of dependent variables. In this chapter, you will gain hands-on experiences on using appropriate R packages to calibrate SIM by using there four regression methods.\n\n\n\n\n\n\nNote\n\n\n\nCalibration is the process of adjusting parameters in the model to try and get the estimates to agree with the observed data as much as possible. Adjusting the parameters is the sort of iterative process that computers are particularly good at and the goodness-of-fit statistics can be used to indicate when the optimum solution is found. Historically this process required a researcher with the requisite programming skills to write a computer algorithm to iteratively adjust each parameter, check the goodness-of-fit, and then start all over again until the goodness-of-fit statistic was maximised/minimised. (Adam Dennett, 2018)"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#the-case-study-and-data",
    "href": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#the-case-study-and-data",
    "title": "Calibrating Spatial Interaction Models with R",
    "section": "The Case Study and Data",
    "text": "The Case Study and Data\nIn this exercise, we are going to calibrate SIM to determine factors affecting the public bus passenger flows during the morning peak in Singapore."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#getting-started",
    "href": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#getting-started",
    "title": "Calibrating Spatial Interaction Models with R",
    "section": "Getting Started",
    "text": "Getting Started\nFor the purpose of this exercise, four r packages will be used. They are:\n\nsf for importing, integrating, processing and transforming geospatial data.\ntidyverse for importing, integrating, wrangling and visualising data.\ntmap for creating thematic maps.\n\n\npacman::p_load(tmap, sf, sp, DT,\n               performance, reshape2,\n               ggpubr, tidyverse)\n\nsp is a older package of sf. sp allow us to handle spatial object in spatial point, line and polygon dataframe. It is more efficient in computation of large data. therefore we do continue to use it from time to time when we are dealing with large data\nperformance is designed like tibble . easystats.github.io\nreshape is the greatgrandfather of tidyr. pivot long, pivot fat. reshape has 1 interesting feature that allow handling of matrix. In tidyr, it is all in dataframe format, it doesn’t handle matrix very well. Distance is matrix form, thus it is better to use reshape, despite it being “older”. it serve very specifiy purpose, as we want to work with matrix\nggpubr create multiple plot\ntidyverse compose of basic R packages to do data science work. Packages like dyplr, gglot2, forcats, tibble, readr, stringr, tidyr, purrr."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#the-data",
    "href": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#the-data",
    "title": "Calibrating Spatial Interaction Models with R",
    "section": "The Data",
    "text": "The Data\nThis exercise is a continuation of Hands-on_Ex3 : Processing and Visualising Flow Data and the following data will be used:\n\nod_data.rds, weekday morning peak passenger flows at planning subzone level.\nmpsz.rds, URA Master Plan 2019 Planning Subzone boundary in simple feature tibble data frame format.\n\nBeside these two data sets, an additional attribute data file called pop.csv will be provided. It"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#computing-distance-matrix",
    "href": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#computing-distance-matrix",
    "title": "Calibrating Spatial Interaction Models with R",
    "section": "Computing Distance Matrix",
    "text": "Computing Distance Matrix\nIn spatial interaction, a distance matrix is a table that shows the distance between pairs of locations. For example, Euclidean distance of 3926.0025 between MESZ01 and RVSZ05, of 3939.1079 between MESZ01 and SRSZ01, and so on. By definition, an location’s distance from itself, which is shown in the main diagonal of the table, is 0.\nFirst, let us import mpsz\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"MPSZ-2019\") %&gt;%\n  st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\worksheep\\ISSS624\\In-class_Ex\\In-class_Ex3\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\nmpsz\n\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 2667.538 ymin: 15748.72 xmax: 56396.44 ymax: 50256.33\nProjected CRS: SVY21 / Singapore TM\nFirst 10 features:\n                 SUBZONE_N SUBZONE_C       PLN_AREA_N PLN_AREA_C       REGION_N\n1              MARINA EAST    MESZ01      MARINA EAST         ME CENTRAL REGION\n2         INSTITUTION HILL    RVSZ05     RIVER VALLEY         RV CENTRAL REGION\n3           ROBERTSON QUAY    SRSZ01  SINGAPORE RIVER         SR CENTRAL REGION\n4  JURONG ISLAND AND BUKOM    WISZ01  WESTERN ISLANDS         WI    WEST REGION\n5             FORT CANNING    MUSZ02           MUSEUM         MU CENTRAL REGION\n6         MARINA EAST (MP)    MPSZ05    MARINE PARADE         MP CENTRAL REGION\n7                   SUDONG    WISZ03  WESTERN ISLANDS         WI    WEST REGION\n8                  SEMAKAU    WISZ02  WESTERN ISLANDS         WI    WEST REGION\n9           SOUTHERN GROUP    SISZ02 SOUTHERN ISLANDS         SI CENTRAL REGION\n10                 SENTOSA    SISZ01 SOUTHERN ISLANDS         SI CENTRAL REGION\n   REGION_C                       geometry\n1        CR MULTIPOLYGON (((33222.98 29...\n2        CR MULTIPOLYGON (((28481.45 30...\n3        CR MULTIPOLYGON (((28087.34 30...\n4        WR MULTIPOLYGON (((14557.7 304...\n5        CR MULTIPOLYGON (((29542.53 31...\n6        CR MULTIPOLYGON (((35279.55 30...\n7        WR MULTIPOLYGON (((15772.59 21...\n8        WR MULTIPOLYGON (((19843.41 21...\n9        CR MULTIPOLYGON (((30870.53 22...\n10       CR MULTIPOLYGON (((26879.04 26...\n\n\nwhen we save into rds, it retain the r object, e.g. as simple feature (sf) tibble data.frame object class. However one downside is not all GIS software can read this.\n\nConverting from sf data.table to SpatialPolygonsDataFrame\nThere are at least two ways to compute the required distance matrix. One is based on sf and the other is based on sp. Past experience shown that computing distance matrix by using sf function took relatively longer time that sp method especially the data set is large. In view of this, sp method is used in the code chunks below.\nFirst as.Spatial() will be used to convert mpsz from sf tibble data frame to SpatialPolygonsDataFrame of sp object as shown in the code chunk below.\n\nmpsz_sp &lt;- as(mpsz, \"Spatial\")\nmpsz_sp\n\nclass       : SpatialPolygonsDataFrame \nfeatures    : 332 \nextent      : 2667.538, 56396.44, 15748.72, 50256.33  (xmin, xmax, ymin, ymax)\ncrs         : +proj=tmerc +lat_0=1.36666666666667 +lon_0=103.833333333333 +k=1 +x_0=28001.642 +y_0=38744.572 +ellps=WGS84 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs \nvariables   : 6\nnames       : SUBZONE_N, SUBZONE_C, PLN_AREA_N, PLN_AREA_C,       REGION_N, REGION_C \nmin values  : ADMIRALTY,    AMSZ01, ANG MO KIO,         AM, CENTRAL REGION,       CR \nmax values  :    YUNNAN,    YSSZ09,     YISHUN,         YS,    WEST REGION,       WR \n\n\nthis is something that prof was going through on how to extract data from sp, but i missed that and couldn’t exactly replicate the data\nmpsz_sp_selected &lt;- mpsz_sp %&gt;%\n  select(mpsz_sp@data$SUBZONE_N)\n  \n\n#this is usually how the prof write it\nmpsz_sp_variant &lt;- mpsz %&gt;%\n  as_Spatial()\n\n\n\nComputing the distance matrix\nNext, spDists() of sp package will be used to compute the Euclidean distance between the centroids of the planning subzones.\n\n\n\n\n\n\nQ&A\n\n\n\nDo you know why the distance is calculated between two centroids of a pair of spatial polygons?\n\n\nwe have 332 subzone, so 332^2 = 110224 given this is a distance matrix of each subzone to each subzone.\n\ndist &lt;- spDists(mpsz_sp, \n                longlat = FALSE)\n\n#this is just to print out a sample of 10 columns, 10 row\nhead(dist, n=c(10, 10))\n\n           [,1]       [,2]      [,3]      [,4]       [,5]      [,6]      [,7]\n [1,]     0.000  3926.0025  3939.108 20252.964  2989.9839  1431.330 19211.836\n [2,]  3926.003     0.0000   305.737 16513.865   951.8314  5254.066 16242.523\n [3,]  3939.108   305.7370     0.000 16412.062  1045.9088  5299.849 16026.146\n [4,] 20252.964 16513.8648 16412.062     0.000 17450.3044 21665.795  7229.017\n [5,]  2989.984   951.8314  1045.909 17450.304     0.0000  4303.232 17020.916\n [6,]  1431.330  5254.0664  5299.849 21665.795  4303.2323     0.000 20617.082\n [7,] 19211.836 16242.5230 16026.146  7229.017 17020.9161 20617.082     0.000\n [8,] 14960.942 12749.4101 12477.871 11284.279 13336.0421 16281.453  5606.082\n [9,]  7515.256  7934.8082  7649.776 18427.503  7801.6163  8403.896 14810.930\n[10,]  6391.342  4975.0021  4669.295 15469.566  5226.8731  7707.091 13111.391\n           [,8]      [,9]     [,10]\n [1,] 14960.942  7515.256  6391.342\n [2,] 12749.410  7934.808  4975.002\n [3,] 12477.871  7649.776  4669.295\n [4,] 11284.279 18427.503 15469.566\n [5,] 13336.042  7801.616  5226.873\n [6,] 16281.453  8403.896  7707.091\n [7,]  5606.082 14810.930 13111.391\n [8,]     0.000  9472.024  8575.490\n [9,]  9472.024     0.000  3780.800\n[10,]  8575.490  3780.800     0.000\n\n\nNotice that the output dist is a matrix object class of R. Also notice that the column heanders and row headers are not labeled with the planning subzone codes.\n\n\nLabelling column and row heanders of a distance matrix\nFirst, we will create a list sorted according to the the distance matrix by planning sub-zone code.\n\nsz_names &lt;- mpsz$SUBZONE_C\n\nNext we will attach SUBZONE_C to row and column for distance matrix matching ahead\n\ncolnames(dist) &lt;- paste0(sz_names)\nrownames(dist) &lt;- paste0(sz_names)\n\n\n\nPivoting distance value by SUBZONE_C\nNext, we will “unpivot” the distance matrix into a long table by using the row and column subzone codes as show in the code chunk below.\nmelt is a old reshape function.\n\ndistPair &lt;- melt(dist) %&gt;%\n  rename(dist = value)\nhead(distPair, 10)\n\nNotice that the within zone distance is 0.\n\n\nUpdating intra-zonal distances\nIn this section, we are going to append a constant value to replace the intra-zonal distance of 0.\nFirst, we will select and find out the minimum value of the distance by using summary().\nnote: we didn’t pass the result over a container, so it is only store in memory and does not change the existing feature\n\ndistPair %&gt;%\n  filter(dist &gt; 0) %&gt;%\n  summary()\n\nNext, a constant distance value of 50m is added into intra-zones distance. The smallest inter-zonal distance is 173.8m, so we want intra-zonal to be smaller. since cross zone from centroid to centroid is 173.8m, then the distance from intra-zonal from centroid to border will be &lt;80+m, which we simplify to 50m\nanother way is to calculate the perimeter, then find the shortest distance from centroid to the border for each subzone.\n\ndistPair$dist &lt;- ifelse(distPair$dist == 0,\n                        50, distPair$dist)\n\nThe code chunk below will be used to check the result data.frame.\n\ndistPair %&gt;%\n  summary()\n\nThe code chunk below is used to rename the origin and destination fields.\n\ndistPair &lt;- distPair %&gt;%\n  rename(orig = Var1,\n         dest = Var2)\n\nLastly, the code chunk below is used to save the dataframe for future use.\n\nwrite_rds(distPair, \"data/rds/distPair.rds\")"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#preparing-flow-data",
    "href": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#preparing-flow-data",
    "title": "Calibrating Spatial Interaction Models with R",
    "section": "Preparing flow data",
    "text": "Preparing flow data\nThe code chunk below is used import od_data save in Chapter 15 into R environment.\n\nod_data &lt;- read_rds(\"data/rds/od_data.rds\")\n\nNext, we will compute the total passenger trip between and within planning subzones by using the code chunk below. The output is all flow_data.\n\nflow_data &lt;- od_data %&gt;%\n  group_by(ORIGIN_SZ, DESTIN_SZ) %&gt;% \n  summarize(TRIPS = sum(MORNING_PEAK)) \n\nUse the code chunk below to display flow_data dataframe.\n\nhead(flow_data, 10)\n\n\nSeparating intra-flow from passenger volume df\nCode chunk below is used to add three new fields in flow_data dataframe.\n\nflow_data$FlowNoIntra &lt;- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ, \n  0, flow_data$TRIPS)\nflow_data$offset &lt;- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ, \n  0.000001, 1)\n\n\n\nCombining passenger volume data with distance value\nBefore we can join flow_data and distPair, we need to convert data value type of ORIGIN_SZ and DESTIN_SZ fields of flow_data dataframe into factor data type.\n\nflow_data$ORIGIN_SZ &lt;- as.factor(flow_data$ORIGIN_SZ)\nflow_data$DESTIN_SZ &lt;- as.factor(flow_data$DESTIN_SZ)\n\nNow, left_join() of dplyr will be used to flow_data dataframe and distPair dataframe. The output is called flow_data1.\n\nflow_data1 &lt;- flow_data %&gt;%\n  left_join (distPair,\n             by = c(\"ORIGIN_SZ\" = \"orig\",\n                    \"DESTIN_SZ\" = \"dest\"))"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#preparing-origin-and-destination-attributes",
    "href": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#preparing-origin-and-destination-attributes",
    "title": "Calibrating Spatial Interaction Models with R",
    "section": "Preparing Origin and Destination Attributes",
    "text": "Preparing Origin and Destination Attributes\n\nImporting population data\nthe data is extracted from Singstat from Department of Stats\n\npop &lt;- read_csv(\"data/aspatial/pop.csv\")\n\n\n\nGeospatial data wrangling\n\npop &lt;- pop %&gt;%\n  left_join(mpsz,\n            by = c(\"PA\" = \"PLN_AREA_N\",\n                   \"SZ\" = \"SUBZONE_N\")) %&gt;%\n  select(1:6) %&gt;%\n  rename(SZ_NAME = SZ,\n         SZ = SUBZONE_C)\n\n\n\nPreparing origin attribute\n\nflow_data1 &lt;- flow_data1 %&gt;%\n  left_join(pop,\n            by = c(ORIGIN_SZ = \"SZ\")) %&gt;%\n  rename(ORIGIN_AGE7_12 = AGE7_12,\n         ORIGIN_AGE13_24 = AGE13_24,\n         ORIGIN_AGE25_64 = AGE25_64) %&gt;%\n  select(-c(PA, SZ_NAME))\n\n\n\nPreparing destination attribute\n\nflow_data1 &lt;- flow_data1 %&gt;%\n  left_join(pop,\n            by = c(DESTIN_SZ = \"SZ\")) %&gt;%\n  rename(DESTIN_AGE7_12 = AGE7_12,\n         DESTIN_AGE13_24 = AGE13_24,\n         DESTIN_AGE25_64 = AGE25_64) %&gt;%\n  select(-c(PA, SZ_NAME))\n\nWe will called the output data file SIM_data. it is in rds data file format.\n\nwrite_rds(flow_data1, \"data/rds/SIM_data\")"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#calibrating-spatial-interaction-models",
    "href": "In-class_Ex/In-class_Ex3/in-class_Ex3.html#calibrating-spatial-interaction-models",
    "title": "Calibrating Spatial Interaction Models with R",
    "section": "Calibrating Spatial Interaction Models",
    "text": "Calibrating Spatial Interaction Models\nIn this section, you will learn how to calibrate Spatial Interaction Models by using Poisson Regression method.\n\nImporting the modelling data\nFirstly, let us import the modelling data by using the code chunk below.\n\nSIM_data &lt;- read_rds(\"data/rds/SIM_data.rds\")\n\n\n\nVisualising the dependent variable\nFirstly, let us plot the distribution of the dependent variable (i.e. TRIPS) by using histogram method by using the code chunk below.\n\nggplot(data = SIM_data,\n       aes(x = TRIPS)) +\n  geom_histogram()\n\n\n\n\nNotice that the distribution is highly skewed and not resemble bell shape or also known as normal distribution.\nNext, let us visualise the relation between the dependent variable and one of the key independent variable in Spatial Interaction Model, namely distance.\n\nggplot(data = SIM_data,\n       aes(x = dist,\n           y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n\n\n\nNotice that their relationship hardly resemble linear relationship.\nOn the other hand, if we plot the scatter plot by using the log transformed version of both variables, we can see that their relationship is more resemble linear relationship.\n\nggplot(data = SIM_data,\n       aes(x = log(dist),\n           y = log(TRIPS))) +\n  geom_point() +\n  geom_smooth(method = lm)\n\n\n\n\n\n\nChecking for variables with zero values\nSince Poisson Regression is based of log and log 0 is undefined, it is important for us to ensure that no 0 values in the explanatory variables.\nIn the code chunk below, summary() of Base R is used to compute the summary statistics of all variables in SIM_data data frame.\n\nsummary(SIM_data)\n\n  ORIGIN_SZ          DESTIN_SZ             TRIPS           FlowNoIntra      \n Length:14274       Length:14274       Min.   :     1.0   Min.   :     1.0  \n Class :character   Class :character   1st Qu.:    11.0   1st Qu.:    11.0  \n Mode  :character   Mode  :character   Median :    56.0   Median :    56.0  \n                                       Mean   :   664.3   Mean   :   664.3  \n                                       3rd Qu.:   296.0   3rd Qu.:   296.0  \n                                       Max.   :104167.0   Max.   :104167.0  \n     offset       dist         ORIGIN_AGE7_12 ORIGIN_AGE13_24 ORIGIN_AGE25_64\n Min.   :1   Min.   :  173.8   Min.   :   0   Min.   :    0   Min.   :    0  \n 1st Qu.:1   1st Qu.: 3465.4   1st Qu.: 240   1st Qu.:  460   1st Qu.: 2210  \n Median :1   Median : 6121.0   Median : 710   Median : 1400   Median : 7030  \n Mean   :1   Mean   : 6951.8   Mean   :1037   Mean   : 2278   Mean   :10536  \n 3rd Qu.:1   3rd Qu.: 9725.1   3rd Qu.:1500   3rd Qu.: 3282   3rd Qu.:15830  \n Max.   :1   Max.   :26135.8   Max.   :6340   Max.   :16380   Max.   :74610  \n DESTIN_AGE7_12 DESTIN_AGE13_24 DESTIN_AGE25_64\n Min.   :   0   Min.   :    0   Min.   :    0  \n 1st Qu.: 250   1st Qu.:  460   1st Qu.: 2210  \n Median : 720   Median : 1430   Median : 7120  \n Mean   :1040   Mean   : 2305   Mean   :10648  \n 3rd Qu.:1500   3rd Qu.: 3290   3rd Qu.:15830  \n Max.   :6340   Max.   :16380   Max.   :74610  \n\n\nThe print report above reveals that variables ORIGIN_AGE7_12, ORIGIN_AGE13_24, ORIGIN_AGE25_64,DESTIN_AGE7_12, DESTIN_AGE13_24, DESTIN_AGE25_64 consist of 0 values.\nIn view of this, code chunk below will be used to replace zero values to 0.99.\nwe don’t do this upfront because the data should be clean earlier. For this modelling, that we want to make it fit into a model that this is feature engineering.\n\nSIM_data$DESTIN_AGE7_12 &lt;- ifelse(\n  SIM_data$DESTIN_AGE7_12 == 0,\n  0.99, SIM_data$DESTIN_AGE7_12)\nSIM_data$DESTIN_AGE13_24 &lt;- ifelse(\n  SIM_data$DESTIN_AGE13_24 == 0,\n  0.99, SIM_data$DESTIN_AGE13_24)\nSIM_data$DESTIN_AGE25_64 &lt;- ifelse(\n  SIM_data$DESTIN_AGE25_64 == 0,\n  0.99, SIM_data$DESTIN_AGE25_64)\nSIM_data$ORIGIN_AGE7_12 &lt;- ifelse(\n  SIM_data$ORIGIN_AGE7_12 == 0,\n  0.99, SIM_data$ORIGIN_AGE7_12)\nSIM_data$ORIGIN_AGE13_24 &lt;- ifelse(\n  SIM_data$ORIGIN_AGE13_24 == 0,\n  0.99, SIM_data$ORIGIN_AGE13_24)\nSIM_data$ORIGIN_AGE25_64 &lt;- ifelse(\n  SIM_data$ORIGIN_AGE25_64 == 0,\n  0.99, SIM_data$ORIGIN_AGE25_64)\n\nYou can run the summary() again.\n\nsummary(SIM_data)\n\n  ORIGIN_SZ          DESTIN_SZ             TRIPS           FlowNoIntra      \n Length:14274       Length:14274       Min.   :     1.0   Min.   :     1.0  \n Class :character   Class :character   1st Qu.:    11.0   1st Qu.:    11.0  \n Mode  :character   Mode  :character   Median :    56.0   Median :    56.0  \n                                       Mean   :   664.3   Mean   :   664.3  \n                                       3rd Qu.:   296.0   3rd Qu.:   296.0  \n                                       Max.   :104167.0   Max.   :104167.0  \n     offset       dist         ORIGIN_AGE7_12    ORIGIN_AGE13_24   \n Min.   :1   Min.   :  173.8   Min.   :   0.99   Min.   :    0.99  \n 1st Qu.:1   1st Qu.: 3465.4   1st Qu.: 240.00   1st Qu.:  460.00  \n Median :1   Median : 6121.0   Median : 710.00   Median : 1400.00  \n Mean   :1   Mean   : 6951.8   Mean   :1036.73   Mean   : 2278.59  \n 3rd Qu.:1   3rd Qu.: 9725.1   3rd Qu.:1500.00   3rd Qu.: 3282.50  \n Max.   :1   Max.   :26135.8   Max.   :6340.00   Max.   :16380.00  \n ORIGIN_AGE25_64    DESTIN_AGE7_12    DESTIN_AGE13_24    DESTIN_AGE25_64   \n Min.   :    0.99   Min.   :   0.99   Min.   :    0.99   Min.   :    0.99  \n 1st Qu.: 2210.00   1st Qu.: 250.00   1st Qu.:  460.00   1st Qu.: 2210.00  \n Median : 7030.00   Median : 720.00   Median : 1430.00   Median : 7120.00  \n Mean   :10535.93   Mean   :1039.98   Mean   : 2305.33   Mean   :10647.95  \n 3rd Qu.:15830.00   3rd Qu.:1500.00   3rd Qu.: 3290.00   3rd Qu.:15830.00  \n Max.   :74610.00   Max.   :6340.00   Max.   :16380.00   Max.   :74610.00  \n\n\nNotice that all the 0 values have been replaced by 0.99.\n\n\nUnconstrained Spatial Interaction Model\nIn this section, you will learn how to calibrate an unconstrained spatial interaction model by using glm() of Base Stats. The explanatory variables are origin population by different age cohort, destination population by different age cohort (i.e. ORIGIN_AGE25_64) and distance between origin and destination in km (i.e. dist).\nThe general formula of Unconstrained Spatial Interaction Model\n\nThe code chunk used to calibrate to model is shown below:\nglm has many regression that can be used, not just least square. so we need to specify the family and link\nthe distance base on the formula is inverse. closer is what you preferred. the parameter should be negative, but the variable itself, we just add as positive.\n\nuncSIM &lt;- glm(formula = TRIPS ~ \n                log(ORIGIN_AGE25_64) + \n                log(DESTIN_AGE25_64) +\n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nuncSIM\n\n\nCall:  glm(formula = TRIPS ~ log(ORIGIN_AGE25_64) + log(DESTIN_AGE25_64) + \n    log(dist), family = poisson(link = \"log\"), data = SIM_data, \n    na.action = na.exclude)\n\nCoefficients:\n         (Intercept)  log(ORIGIN_AGE25_64)  log(DESTIN_AGE25_64)  \n            17.00287               0.21001               0.01289  \n           log(dist)  \n            -1.51785  \n\nDegrees of Freedom: 14273 Total (i.e. Null);  14270 Residual\nNull Deviance:      36120000 \nResidual Deviance: 19960000     AIC: 20040000\n\n\n\n\nR-squared function\nIn order to measure how much variation of the trips can be accounted by the model we will write a function to calculate R-Squared value as shown below.\n\nCalcRSquared &lt;- function(observed,estimated){\n  r &lt;- cor(observed,estimated)\n  R2 &lt;- r^2\n  R2\n}\n\nNext, we will compute the R-squared of the unconstrained SIM by using the code chunk below.\n\nCalcRSquared(uncSIM$data$TRIPS, uncSIM$fitted.values)\n\n[1] 0.1694734\n\n\nthe R^2 is relatively small, which show that it is not as good.\n\nr2_mcfadden(uncSIM)\n\n# R2 for Generalized Linear Regression\n       R2: 0.446\n  adj. R2: 0.446\n\n\n\n\nOrigin (Production) constrained SIM\nIn this section, we will fit an origin constrained SIM by using the code3 chunk below.\nThe general formula of Origin Constrained Spatial Interaction Model\n\n\norcSIM &lt;- glm(formula = TRIPS ~ \n                 ORIGIN_SZ +\n                 log(DESTIN_AGE25_64) +\n                 log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(orcSIM)\n\n\nCall:\nglm(formula = TRIPS ~ ORIGIN_SZ + log(DESTIN_AGE25_64) + log(dist), \n    family = poisson(link = \"log\"), data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                       Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)          19.9309957  0.0054015  3689.887  &lt; 2e-16 ***\nORIGIN_SZAMSZ02       0.6805710  0.0052686   129.175  &lt; 2e-16 ***\nORIGIN_SZAMSZ03       0.3597850  0.0054884    65.554  &lt; 2e-16 ***\nORIGIN_SZAMSZ04      -0.1106566  0.0060027   -18.434  &lt; 2e-16 ***\nORIGIN_SZAMSZ05      -0.3140561  0.0067998   -46.186  &lt; 2e-16 ***\nORIGIN_SZAMSZ06       0.0634425  0.0060258    10.528  &lt; 2e-16 ***\nORIGIN_SZAMSZ07      -1.1301580  0.0110298  -102.464  &lt; 2e-16 ***\nORIGIN_SZAMSZ08      -0.6330394  0.0102949   -61.491  &lt; 2e-16 ***\nORIGIN_SZAMSZ09       0.1064915  0.0063450    16.784  &lt; 2e-16 ***\nORIGIN_SZAMSZ10       0.5061899  0.0053889    93.931  &lt; 2e-16 ***\nORIGIN_SZAMSZ11      -1.3167911  0.0144870   -90.895  &lt; 2e-16 ***\nORIGIN_SZAMSZ12      -1.5103004  0.0127453  -118.499  &lt; 2e-16 ***\nORIGIN_SZBDSZ01       1.3626004  0.0051433   264.929  &lt; 2e-16 ***\nORIGIN_SZBDSZ02       0.9554084  0.0059655   160.156  &lt; 2e-16 ***\nORIGIN_SZBDSZ03       1.1476190  0.0054278   211.433  &lt; 2e-16 ***\nORIGIN_SZBDSZ04       2.0110410  0.0046344   433.940  &lt; 2e-16 ***\nORIGIN_SZBDSZ05       1.0658940  0.0053976   197.477  &lt; 2e-16 ***\nORIGIN_SZBDSZ06       1.2719222  0.0054774   232.213  &lt; 2e-16 ***\nORIGIN_SZBDSZ07      -0.5053039  0.0111553   -45.297  &lt; 2e-16 ***\nORIGIN_SZBDSZ08      -0.3556193  0.0102947   -34.544  &lt; 2e-16 ***\nORIGIN_SZBKSZ01      -0.3606399  0.0075473   -47.784  &lt; 2e-16 ***\nORIGIN_SZBKSZ02       0.1357265  0.0061394    22.107  &lt; 2e-16 ***\nORIGIN_SZBKSZ03       0.4101999  0.0058983    69.545  &lt; 2e-16 ***\nORIGIN_SZBKSZ04      -0.3418645  0.0070764   -48.310  &lt; 2e-16 ***\nORIGIN_SZBKSZ05      -0.2986750  0.0074073   -40.322  &lt; 2e-16 ***\nORIGIN_SZBKSZ06      -0.2637855  0.0068739   -38.375  &lt; 2e-16 ***\nORIGIN_SZBKSZ07       0.5498323  0.0051476   106.813  &lt; 2e-16 ***\nORIGIN_SZBKSZ08      -0.0527393  0.0061457    -8.582  &lt; 2e-16 ***\nORIGIN_SZBKSZ09      -0.1564691  0.0067300   -23.249  &lt; 2e-16 ***\nORIGIN_SZBLSZ01      -1.7551329  0.0176599   -99.385  &lt; 2e-16 ***\nORIGIN_SZBLSZ02      -1.9493637  0.0213859   -91.152  &lt; 2e-16 ***\nORIGIN_SZBLSZ03      -2.9057732  0.0535995   -54.213  &lt; 2e-16 ***\nORIGIN_SZBLSZ04      -1.4672066  0.0254726   -57.599  &lt; 2e-16 ***\nORIGIN_SZBMSZ01       0.1806064  0.0060563    29.821  &lt; 2e-16 ***\nORIGIN_SZBMSZ02      -1.4026549  0.0078244  -179.267  &lt; 2e-16 ***\nORIGIN_SZBMSZ03      -0.5976236  0.0063808   -93.660  &lt; 2e-16 ***\nORIGIN_SZBMSZ04      -0.5456513  0.0059061   -92.388  &lt; 2e-16 ***\nORIGIN_SZBMSZ05      -3.1095195  0.0188118  -165.297  &lt; 2e-16 ***\nORIGIN_SZBMSZ06      -3.0273827  0.0194319  -155.794  &lt; 2e-16 ***\nORIGIN_SZBMSZ07      -0.7378197  0.0066865  -110.345  &lt; 2e-16 ***\nORIGIN_SZBMSZ08      -0.9306150  0.0067188  -138.510  &lt; 2e-16 ***\nORIGIN_SZBMSZ09      -1.4137345  0.0101071  -139.876  &lt; 2e-16 ***\nORIGIN_SZBMSZ10      -1.7054195  0.0101582  -167.886  &lt; 2e-16 ***\nORIGIN_SZBMSZ11      -1.2418380  0.0076792  -161.714  &lt; 2e-16 ***\nORIGIN_SZBMSZ12      -1.3746537  0.0109769  -125.231  &lt; 2e-16 ***\nORIGIN_SZBMSZ13      -0.4339494  0.0069335   -62.587  &lt; 2e-16 ***\nORIGIN_SZBMSZ14      -0.9950458  0.0076302  -130.410  &lt; 2e-16 ***\nORIGIN_SZBMSZ15      -0.6544196  0.0068964   -94.892  &lt; 2e-16 ***\nORIGIN_SZBMSZ16      -1.5193747  0.0105329  -144.250  &lt; 2e-16 ***\nORIGIN_SZBMSZ17      -1.6536771  0.0180672   -91.529  &lt; 2e-16 ***\nORIGIN_SZBPSZ01       0.1484355  0.0064734    22.930  &lt; 2e-16 ***\nORIGIN_SZBPSZ02      -0.3602094  0.0073902   -48.741  &lt; 2e-16 ***\nORIGIN_SZBPSZ03      -0.1567975  0.0072226   -21.709  &lt; 2e-16 ***\nORIGIN_SZBPSZ04       0.4504873  0.0058418    77.115  &lt; 2e-16 ***\nORIGIN_SZBPSZ05       0.5028646  0.0053682    93.675  &lt; 2e-16 ***\nORIGIN_SZBPSZ06      -1.0125668  0.0105638   -95.853  &lt; 2e-16 ***\nORIGIN_SZBPSZ07      -0.3859065  0.0098561   -39.154  &lt; 2e-16 ***\nORIGIN_SZBSSZ01       0.1488497  0.0065504    22.724  &lt; 2e-16 ***\nORIGIN_SZBSSZ02       0.4269498  0.0055893    76.387  &lt; 2e-16 ***\nORIGIN_SZBSSZ03      -0.2437385  0.0062020   -39.300  &lt; 2e-16 ***\nORIGIN_SZBTSZ01       0.1987940  0.0066672    29.817  &lt; 2e-16 ***\nORIGIN_SZBTSZ02      -0.4571546  0.0090784   -50.356  &lt; 2e-16 ***\nORIGIN_SZBTSZ03      -0.2697243  0.0077941   -34.606  &lt; 2e-16 ***\nORIGIN_SZBTSZ04      -1.0997236  0.0115225   -95.441  &lt; 2e-16 ***\nORIGIN_SZBTSZ05      -1.0053122  0.0132594   -75.819  &lt; 2e-16 ***\nORIGIN_SZBTSZ06      -1.0841201  0.0102242  -106.035  &lt; 2e-16 ***\nORIGIN_SZBTSZ07      -2.3134497  0.0158499  -145.960  &lt; 2e-16 ***\nORIGIN_SZBTSZ08      -1.1581618  0.0121161   -95.589  &lt; 2e-16 ***\nORIGIN_SZCBSZ01      -1.0805930  0.0577831   -18.701  &lt; 2e-16 ***\nORIGIN_SZCCSZ01      -0.8145372  0.0152638   -53.364  &lt; 2e-16 ***\nORIGIN_SZCHSZ01       0.0377079  0.0133240     2.830 0.004654 ** \nORIGIN_SZCHSZ02      -0.6209553  0.0096388   -64.422  &lt; 2e-16 ***\nORIGIN_SZCHSZ03       1.6790244  0.0069559   241.381  &lt; 2e-16 ***\nORIGIN_SZCKSZ01       0.0839586  0.0059934    14.008  &lt; 2e-16 ***\nORIGIN_SZCKSZ02       0.4379511  0.0062289    70.309  &lt; 2e-16 ***\nORIGIN_SZCKSZ03       0.7956950  0.0051892   153.335  &lt; 2e-16 ***\nORIGIN_SZCKSZ04       1.2740323  0.0053165   239.637  &lt; 2e-16 ***\nORIGIN_SZCKSZ05       0.9326213  0.0061807   150.893  &lt; 2e-16 ***\nORIGIN_SZCKSZ06       0.3976273  0.0085639    46.431  &lt; 2e-16 ***\nORIGIN_SZCLSZ01      -0.7522917  0.0094655   -79.477  &lt; 2e-16 ***\nORIGIN_SZCLSZ02      -1.3937450  0.0153260   -90.940  &lt; 2e-16 ***\nORIGIN_SZCLSZ03      -0.7898683  0.0091016   -86.784  &lt; 2e-16 ***\nORIGIN_SZCLSZ04       0.8451512  0.0051258   164.882  &lt; 2e-16 ***\nORIGIN_SZCLSZ05      -1.6573818  0.0166091   -99.788  &lt; 2e-16 ***\nORIGIN_SZCLSZ06       0.9478181  0.0048182   196.716  &lt; 2e-16 ***\nORIGIN_SZCLSZ07      -0.2499753  0.0064632   -38.677  &lt; 2e-16 ***\nORIGIN_SZCLSZ08       0.1350119  0.0069296    19.483  &lt; 2e-16 ***\nORIGIN_SZCLSZ09      -1.3868782  0.0192743   -71.955  &lt; 2e-16 ***\nORIGIN_SZDTSZ02      -3.7535792  0.0871325   -43.079  &lt; 2e-16 ***\nORIGIN_SZDTSZ03      -3.8462041  0.0840156   -45.780  &lt; 2e-16 ***\nORIGIN_SZDTSZ13      -2.9738127  0.0349241   -85.151  &lt; 2e-16 ***\nORIGIN_SZGLSZ01      -1.5175198  0.0110135  -137.787  &lt; 2e-16 ***\nORIGIN_SZGLSZ02       0.2405712  0.0058742    40.954  &lt; 2e-16 ***\nORIGIN_SZGLSZ03       0.1940241  0.0061989    31.300  &lt; 2e-16 ***\nORIGIN_SZGLSZ04       1.0292572  0.0049028   209.931  &lt; 2e-16 ***\nORIGIN_SZGLSZ05       0.9864552  0.0050898   193.811  &lt; 2e-16 ***\nORIGIN_SZHGSZ01       0.3073609  0.0054307    56.597  &lt; 2e-16 ***\nORIGIN_SZHGSZ02       0.3827293  0.0054555    70.154  &lt; 2e-16 ***\nORIGIN_SZHGSZ03       0.2342580  0.0059240    39.544  &lt; 2e-16 ***\nORIGIN_SZHGSZ04       0.8750090  0.0049639   176.275  &lt; 2e-16 ***\nORIGIN_SZHGSZ05       1.1695280  0.0049468   236.420  &lt; 2e-16 ***\nORIGIN_SZHGSZ06      -0.0462411  0.0063805    -7.247 4.25e-13 ***\nORIGIN_SZHGSZ07       0.4488583  0.0055139    81.404  &lt; 2e-16 ***\nORIGIN_SZHGSZ08       0.2236095  0.0061279    36.490  &lt; 2e-16 ***\nORIGIN_SZHGSZ09      -1.6376674  0.0084442  -193.941  &lt; 2e-16 ***\nORIGIN_SZHGSZ10      -2.9849025  0.0501042   -59.574  &lt; 2e-16 ***\nORIGIN_SZJESZ01       0.3926525  0.0056268    69.783  &lt; 2e-16 ***\nORIGIN_SZJESZ02       0.1230160  0.0056864    21.633  &lt; 2e-16 ***\nORIGIN_SZJESZ03       0.0188276  0.0061020     3.085 0.002032 ** \nORIGIN_SZJESZ04      -1.3611618  0.0117184  -116.156  &lt; 2e-16 ***\nORIGIN_SZJESZ05      -2.0643662  0.0157083  -131.419  &lt; 2e-16 ***\nORIGIN_SZJESZ06       0.1556368  0.0055245    28.172  &lt; 2e-16 ***\nORIGIN_SZJESZ07      -1.7664532  0.0133171  -132.646  &lt; 2e-16 ***\nORIGIN_SZJESZ08      -0.9115981  0.0138203   -65.961  &lt; 2e-16 ***\nORIGIN_SZJESZ09       0.6121916  0.0060381   101.388  &lt; 2e-16 ***\nORIGIN_SZJESZ10      -1.1953045  0.0233216   -51.253  &lt; 2e-16 ***\nORIGIN_SZJESZ11      -1.4088748  0.0220921   -63.773  &lt; 2e-16 ***\nORIGIN_SZJWSZ01       0.5759093  0.0077741    74.081  &lt; 2e-16 ***\nORIGIN_SZJWSZ02       0.9769314  0.0053029   184.227  &lt; 2e-16 ***\nORIGIN_SZJWSZ03       1.3242695  0.0049068   269.882  &lt; 2e-16 ***\nORIGIN_SZJWSZ04       0.5621088  0.0057831    97.199  &lt; 2e-16 ***\nORIGIN_SZJWSZ05      -1.5744341  0.0146904  -107.174  &lt; 2e-16 ***\nORIGIN_SZJWSZ06      -0.9113320  0.0126913   -71.807  &lt; 2e-16 ***\nORIGIN_SZJWSZ07      -2.3083419  0.0357843   -64.507  &lt; 2e-16 ***\nORIGIN_SZJWSZ08       2.0114225  0.0047956   419.429  &lt; 2e-16 ***\nORIGIN_SZJWSZ09       1.9086705  0.0045255   421.759  &lt; 2e-16 ***\nORIGIN_SZKLSZ01       0.2743166  0.0056908    48.204  &lt; 2e-16 ***\nORIGIN_SZKLSZ02      -0.6443386  0.0074521   -86.463  &lt; 2e-16 ***\nORIGIN_SZKLSZ03      -0.3990113  0.0067213   -59.366  &lt; 2e-16 ***\nORIGIN_SZKLSZ04      -2.1413876  0.0138405  -154.719  &lt; 2e-16 ***\nORIGIN_SZKLSZ05      -1.0913697  0.0121512   -89.816  &lt; 2e-16 ***\nORIGIN_SZKLSZ06      -5.6240764  0.1857405   -30.279  &lt; 2e-16 ***\nORIGIN_SZKLSZ07      -1.1885897  0.0096830  -122.750  &lt; 2e-16 ***\nORIGIN_SZKLSZ08      -1.7018593  0.0114317  -148.872  &lt; 2e-16 ***\nORIGIN_SZLKSZ01      -1.6659670  0.0446420   -37.318  &lt; 2e-16 ***\nORIGIN_SZMDSZ01      -1.1210505  0.0318834   -35.161  &lt; 2e-16 ***\nORIGIN_SZMDSZ02      -0.5096299  0.0116645   -43.691  &lt; 2e-16 ***\nORIGIN_SZMDSZ03      -1.9187039  0.0198291   -96.762  &lt; 2e-16 ***\nORIGIN_SZMPSZ01      -0.5260512  0.0094201   -55.844  &lt; 2e-16 ***\nORIGIN_SZMPSZ02      -0.2905084  0.0077974   -37.257  &lt; 2e-16 ***\nORIGIN_SZMPSZ03       0.3342293  0.0063715    52.457  &lt; 2e-16 ***\nORIGIN_SZMUSZ02      -3.8337096  0.1105053   -34.693  &lt; 2e-16 ***\nORIGIN_SZNTSZ01      -2.9845040  0.0397028   -75.171  &lt; 2e-16 ***\nORIGIN_SZNTSZ02      -3.1812985  0.0249470  -127.522  &lt; 2e-16 ***\nORIGIN_SZNTSZ03      -0.9742991  0.0085424  -114.054  &lt; 2e-16 ***\nORIGIN_SZNTSZ05      -4.2086932  0.0579737   -72.597  &lt; 2e-16 ***\nORIGIN_SZNTSZ06      -4.5831822  0.0583494   -78.547  &lt; 2e-16 ***\nORIGIN_SZNVSZ01       0.3186962  0.0052944    60.195  &lt; 2e-16 ***\nORIGIN_SZNVSZ02      -0.5321136  0.0073747   -72.154  &lt; 2e-16 ***\nORIGIN_SZNVSZ03      -0.9911852  0.0090560  -109.451  &lt; 2e-16 ***\nORIGIN_SZNVSZ04      -0.8329721  0.0099590   -83.640  &lt; 2e-16 ***\nORIGIN_SZNVSZ05      -2.1460777  0.0182401  -117.657  &lt; 2e-16 ***\nORIGIN_SZPGSZ01      -0.5604078  0.0151515   -36.987  &lt; 2e-16 ***\nORIGIN_SZPGSZ02      -0.4025139  0.0085135   -47.279  &lt; 2e-16 ***\nORIGIN_SZPGSZ03       0.6975483  0.0055534   125.608  &lt; 2e-16 ***\nORIGIN_SZPGSZ04       1.2175486  0.0051080   238.363  &lt; 2e-16 ***\nORIGIN_SZPGSZ05       0.3895354  0.0069851    55.767  &lt; 2e-16 ***\nORIGIN_SZPLSZ01      -0.5572701  0.0134473   -41.441  &lt; 2e-16 ***\nORIGIN_SZPLSZ02      -0.9854214  0.0172337   -57.180  &lt; 2e-16 ***\nORIGIN_SZPLSZ03      -1.6991954  0.0472629   -35.952  &lt; 2e-16 ***\nORIGIN_SZPLSZ04      -2.2000217  0.0373580   -58.890  &lt; 2e-16 ***\nORIGIN_SZPLSZ05      -1.7086663  0.0260920   -65.486  &lt; 2e-16 ***\nORIGIN_SZPNSZ01       1.5292867  0.0055102   277.535  &lt; 2e-16 ***\nORIGIN_SZPNSZ02       0.7457519  0.0127815    58.346  &lt; 2e-16 ***\nORIGIN_SZPNSZ03      -1.3659046  0.0216180   -63.184  &lt; 2e-16 ***\nORIGIN_SZPNSZ04      -2.0025379  0.0360655   -55.525  &lt; 2e-16 ***\nORIGIN_SZPNSZ05      -0.9157959  0.0320955   -28.533  &lt; 2e-16 ***\nORIGIN_SZPRSZ01       0.0522611  0.0139142     3.756 0.000173 ***\nORIGIN_SZPRSZ02       1.3063371  0.0053809   242.774  &lt; 2e-16 ***\nORIGIN_SZPRSZ03       0.9963670  0.0054293   183.516  &lt; 2e-16 ***\nORIGIN_SZPRSZ04      -0.0300950  0.0088010    -3.419 0.000627 ***\nORIGIN_SZPRSZ05       1.6840313  0.0050839   331.245  &lt; 2e-16 ***\nORIGIN_SZPRSZ06      -0.8277202  0.0131296   -63.042  &lt; 2e-16 ***\nORIGIN_SZPRSZ07      -2.1698449  0.0177362  -122.340  &lt; 2e-16 ***\nORIGIN_SZPRSZ08       0.4559353  0.0072609    62.793  &lt; 2e-16 ***\nORIGIN_SZQTSZ01      -0.3517047  0.0078770   -44.650  &lt; 2e-16 ***\nORIGIN_SZQTSZ02      -0.8199353  0.0071544  -114.605  &lt; 2e-16 ***\nORIGIN_SZQTSZ03      -0.2457614  0.0065555   -37.490  &lt; 2e-16 ***\nORIGIN_SZQTSZ04      -1.2216614  0.0084050  -145.349  &lt; 2e-16 ***\nORIGIN_SZQTSZ05      -0.7219952  0.0072360   -99.778  &lt; 2e-16 ***\nORIGIN_SZQTSZ06      -0.6729363  0.0076658   -87.784  &lt; 2e-16 ***\nORIGIN_SZQTSZ07      -1.4497690  0.0109365  -132.563  &lt; 2e-16 ***\nORIGIN_SZQTSZ08      -0.2770151  0.0070193   -39.465  &lt; 2e-16 ***\nORIGIN_SZQTSZ09      -0.6157554  0.0078739   -78.202  &lt; 2e-16 ***\nORIGIN_SZQTSZ10      -0.3091547  0.0075471   -40.963  &lt; 2e-16 ***\nORIGIN_SZQTSZ11      -1.9698881  0.0151247  -130.243  &lt; 2e-16 ***\nORIGIN_SZQTSZ12      -2.6449643  0.0205857  -128.485  &lt; 2e-16 ***\nORIGIN_SZQTSZ13      -0.3754107  0.0088433   -42.452  &lt; 2e-16 ***\nORIGIN_SZQTSZ14      -1.6537473  0.0134378  -123.067  &lt; 2e-16 ***\nORIGIN_SZQTSZ15      -0.3435351  0.0131956   -26.034  &lt; 2e-16 ***\nORIGIN_SZRCSZ01      -1.7104390  0.0141179  -121.154  &lt; 2e-16 ***\nORIGIN_SZRCSZ06      -1.1250727  0.0094909  -118.542  &lt; 2e-16 ***\nORIGIN_SZRVSZ01      -3.0220116  0.0339694   -88.963  &lt; 2e-16 ***\nORIGIN_SZRVSZ02      -3.6040075  0.0297641  -121.086  &lt; 2e-16 ***\nORIGIN_SZRVSZ03      -3.2345594  0.0259149  -124.814  &lt; 2e-16 ***\nORIGIN_SZRVSZ04      -3.6900313  0.0575908   -64.073  &lt; 2e-16 ***\nORIGIN_SZRVSZ05      -2.9527570  0.0178582  -165.344  &lt; 2e-16 ***\nORIGIN_SZSBSZ01       0.0238445  0.0078563     3.035 0.002405 ** \nORIGIN_SZSBSZ02      -0.5780602  0.0093054   -62.121  &lt; 2e-16 ***\nORIGIN_SZSBSZ03       0.8961719  0.0054586   164.175  &lt; 2e-16 ***\nORIGIN_SZSBSZ04       0.8421798  0.0061888   136.080  &lt; 2e-16 ***\nORIGIN_SZSBSZ05      -0.1682984  0.0078342   -21.482  &lt; 2e-16 ***\nORIGIN_SZSBSZ06      -1.1482701  0.0196421   -58.460  &lt; 2e-16 ***\nORIGIN_SZSBSZ07      -0.8830317  0.0160709   -54.946  &lt; 2e-16 ***\nORIGIN_SZSBSZ08      -1.1039492  0.0174602   -63.226  &lt; 2e-16 ***\nORIGIN_SZSBSZ09      -0.5946691  0.0101961   -58.323  &lt; 2e-16 ***\nORIGIN_SZSESZ02       1.1144933  0.0050948   218.749  &lt; 2e-16 ***\nORIGIN_SZSESZ03       1.1058963  0.0049026   225.574  &lt; 2e-16 ***\nORIGIN_SZSESZ04       0.7427975  0.0056948   130.433  &lt; 2e-16 ***\nORIGIN_SZSESZ05      -0.2812684  0.0069596   -40.414  &lt; 2e-16 ***\nORIGIN_SZSESZ06       0.8168315  0.0055800   146.387  &lt; 2e-16 ***\nORIGIN_SZSESZ07      -2.2842043  0.0231232   -98.784  &lt; 2e-16 ***\nORIGIN_SZSGSZ01      -0.7313790  0.0098957   -73.909  &lt; 2e-16 ***\nORIGIN_SZSGSZ02      -1.1185406  0.0110919  -100.843  &lt; 2e-16 ***\nORIGIN_SZSGSZ03       0.1752618  0.0060508    28.965  &lt; 2e-16 ***\nORIGIN_SZSGSZ04       0.3764395  0.0056165    67.023  &lt; 2e-16 ***\nORIGIN_SZSGSZ05      -1.7203916  0.0118945  -144.637  &lt; 2e-16 ***\nORIGIN_SZSGSZ06       0.4630857  0.0052886    87.563  &lt; 2e-16 ***\nORIGIN_SZSGSZ07      -0.7051233  0.0073133   -96.417  &lt; 2e-16 ***\nORIGIN_SZSKSZ01       0.2053928  0.0100710    20.395  &lt; 2e-16 ***\nORIGIN_SZSKSZ02       1.2630428  0.0063490   198.935  &lt; 2e-16 ***\nORIGIN_SZSKSZ03      -0.3035297  0.0096788   -31.360  &lt; 2e-16 ***\nORIGIN_SZSKSZ04      -1.7952886  0.0359225   -49.977  &lt; 2e-16 ***\nORIGIN_SZSKSZ05      -0.3836861  0.0176686   -21.716  &lt; 2e-16 ***\nORIGIN_SZSLSZ01      -2.5916326  0.0348001   -74.472  &lt; 2e-16 ***\nORIGIN_SZSLSZ04      -0.2251549  0.0088517   -25.436  &lt; 2e-16 ***\nORIGIN_SZSRSZ01      -2.9590365  0.0173638  -170.414  &lt; 2e-16 ***\nORIGIN_SZTHSZ01      -1.9639893  0.0570321   -34.437  &lt; 2e-16 ***\nORIGIN_SZTHSZ03      -1.7281304  0.0272797   -63.349  &lt; 2e-16 ***\nORIGIN_SZTHSZ04      -2.7837906  0.0343179   -81.118  &lt; 2e-16 ***\nORIGIN_SZTHSZ06      -2.1800693  0.0205491  -106.091  &lt; 2e-16 ***\nORIGIN_SZTMSZ01       0.8228136  0.0066824   123.131  &lt; 2e-16 ***\nORIGIN_SZTMSZ02       2.3174781  0.0044978   515.243  &lt; 2e-16 ***\nORIGIN_SZTMSZ03       1.7061757  0.0048615   350.957  &lt; 2e-16 ***\nORIGIN_SZTMSZ04       1.2407899  0.0058389   212.504  &lt; 2e-16 ***\nORIGIN_SZTMSZ05      -0.1000526  0.0124079    -8.064 7.41e-16 ***\nORIGIN_SZTNSZ01      -2.0347519  0.0139596  -145.760  &lt; 2e-16 ***\nORIGIN_SZTNSZ02      -1.8682671  0.0107901  -173.146  &lt; 2e-16 ***\nORIGIN_SZTNSZ03      -2.1737183  0.0146759  -148.115  &lt; 2e-16 ***\nORIGIN_SZTNSZ04      -0.5006452  0.0081501   -61.428  &lt; 2e-16 ***\nORIGIN_SZTPSZ01      -0.6722487  0.0075606   -88.914  &lt; 2e-16 ***\nORIGIN_SZTPSZ02       0.4552916  0.0050191    90.711  &lt; 2e-16 ***\nORIGIN_SZTPSZ03      -0.7865781  0.0072250  -108.869  &lt; 2e-16 ***\nORIGIN_SZTPSZ04      -0.7049044  0.0066456  -106.071  &lt; 2e-16 ***\nORIGIN_SZTPSZ05      -0.5574925  0.0070366   -79.227  &lt; 2e-16 ***\nORIGIN_SZTPSZ06      -0.4247282  0.0068709   -61.815  &lt; 2e-16 ***\nORIGIN_SZTPSZ07      -0.2846984  0.0071030   -40.081  &lt; 2e-16 ***\nORIGIN_SZTPSZ08      -1.0898051  0.0110046   -99.031  &lt; 2e-16 ***\nORIGIN_SZTPSZ09      -0.8092746  0.0079160  -102.232  &lt; 2e-16 ***\nORIGIN_SZTPSZ10      -0.9332072  0.0086809  -107.502  &lt; 2e-16 ***\nORIGIN_SZTPSZ11      -0.0421981  0.0064343    -6.558 5.44e-11 ***\nORIGIN_SZTPSZ12      -0.6330081  0.0078324   -80.819  &lt; 2e-16 ***\nORIGIN_SZTSSZ01      -1.7650409  0.0517357   -34.116  &lt; 2e-16 ***\nORIGIN_SZTSSZ02       1.1707267  0.0094178   124.310  &lt; 2e-16 ***\nORIGIN_SZTSSZ03       0.6581679  0.0095894    68.635  &lt; 2e-16 ***\nORIGIN_SZTSSZ04       0.8736493  0.0104965    83.233  &lt; 2e-16 ***\nORIGIN_SZTSSZ05       0.0957248  0.0178709     5.356 8.49e-08 ***\nORIGIN_SZTSSZ06       1.7581609  0.0206810    85.013  &lt; 2e-16 ***\nORIGIN_SZWCSZ01       0.8097950  0.0105622    76.669  &lt; 2e-16 ***\nORIGIN_SZWCSZ02      -1.9966163  0.0345747   -57.748  &lt; 2e-16 ***\nORIGIN_SZWCSZ03      -5.0687420  0.1474971   -34.365  &lt; 2e-16 ***\nORIGIN_SZWDSZ01       1.4926003  0.0047216   316.124  &lt; 2e-16 ***\nORIGIN_SZWDSZ02       0.9916597  0.0055755   177.859  &lt; 2e-16 ***\nORIGIN_SZWDSZ03       1.5918065  0.0052180   305.062  &lt; 2e-16 ***\nORIGIN_SZWDSZ04       1.3717152  0.0060516   226.669  &lt; 2e-16 ***\nORIGIN_SZWDSZ05       0.6700111  0.0062287   107.569  &lt; 2e-16 ***\nORIGIN_SZWDSZ06       0.8115996  0.0060947   133.165  &lt; 2e-16 ***\nORIGIN_SZWDSZ07      -0.6488914  0.0093567   -69.351  &lt; 2e-16 ***\nORIGIN_SZWDSZ08      -0.3610234  0.0096440   -37.435  &lt; 2e-16 ***\nORIGIN_SZWDSZ09       1.4445461  0.0052279   276.317  &lt; 2e-16 ***\nORIGIN_SZYSSZ01      -0.2039272  0.0069548   -29.322  &lt; 2e-16 ***\nORIGIN_SZYSSZ02       0.8707707  0.0058957   147.697  &lt; 2e-16 ***\nORIGIN_SZYSSZ03       1.8348842  0.0050377   364.231  &lt; 2e-16 ***\nORIGIN_SZYSSZ04       1.0780641  0.0052960   203.564  &lt; 2e-16 ***\nORIGIN_SZYSSZ05       0.3222765  0.0069700    46.237  &lt; 2e-16 ***\nORIGIN_SZYSSZ06      -0.4424689  0.0124866   -35.435  &lt; 2e-16 ***\nORIGIN_SZYSSZ07      -1.0267883  0.0155821   -65.895  &lt; 2e-16 ***\nORIGIN_SZYSSZ08       0.1833117  0.0070935    25.842  &lt; 2e-16 ***\nORIGIN_SZYSSZ09       1.0766070  0.0050451   213.396  &lt; 2e-16 ***\nlog(DESTIN_AGE25_64)  0.0295428  0.0001051   280.998  &lt; 2e-16 ***\nlog(dist)            -1.7024691  0.0004625 -3681.042  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 36117615  on 14273  degrees of freedom\nResidual deviance: 12983718  on 13993  degrees of freedom\nAIC: 13068835\n\nNumber of Fisher Scoring iterations: 6\n\n\nWe can examine how the constraints hold for destinations this time.\n\nCalcRSquared(orcSIM$data$TRIPS, orcSIM$fitted.values)\n\n[1] 0.4029115\n\n\n\n\nDestination constrained\nIn this section, we will fit a destination constrained SIM by using the code chunk below.\nThe general formula of Destination Constrained Spatial Interaction Model\n\n\ndecSIM &lt;- glm(formula = TRIPS ~ \n                DESTIN_SZ + \n                log(ORIGIN_AGE25_64) + \n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(decSIM)\n\n\nCall:\nglm(formula = TRIPS ~ DESTIN_SZ + log(ORIGIN_AGE25_64) + log(dist), \n    family = poisson(link = \"log\"), data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                       Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)          19.4822997  0.0050784  3836.298  &lt; 2e-16 ***\nDESTIN_SZAMSZ02       0.1263056  0.0049743    25.392  &lt; 2e-16 ***\nDESTIN_SZAMSZ03       0.0421788  0.0049859     8.460  &lt; 2e-16 ***\nDESTIN_SZAMSZ04      -1.1668479  0.0074254  -157.143  &lt; 2e-16 ***\nDESTIN_SZAMSZ05      -1.2586639  0.0075854  -165.931  &lt; 2e-16 ***\nDESTIN_SZAMSZ06      -1.1414791  0.0073474  -155.359  &lt; 2e-16 ***\nDESTIN_SZAMSZ07      -1.5565804  0.0109476  -142.185  &lt; 2e-16 ***\nDESTIN_SZAMSZ08      -0.3990754  0.0074159   -53.813  &lt; 2e-16 ***\nDESTIN_SZAMSZ09      -1.0109118  0.0076802  -131.626  &lt; 2e-16 ***\nDESTIN_SZAMSZ10       0.0159285  0.0051765     3.077  0.00209 ** \nDESTIN_SZAMSZ11      -0.3653273  0.0094866   -38.510  &lt; 2e-16 ***\nDESTIN_SZAMSZ12       0.5297606  0.0053243    99.500  &lt; 2e-16 ***\nDESTIN_SZBDSZ01       1.0394822  0.0044226   235.037  &lt; 2e-16 ***\nDESTIN_SZBDSZ02       0.1956964  0.0059564    32.855  &lt; 2e-16 ***\nDESTIN_SZBDSZ03       0.3209267  0.0053718    59.742  &lt; 2e-16 ***\nDESTIN_SZBDSZ04       1.2429874  0.0043104   288.370  &lt; 2e-16 ***\nDESTIN_SZBDSZ05       0.8535842  0.0046360   184.122  &lt; 2e-16 ***\nDESTIN_SZBDSZ06       0.5181443  0.0053736    96.423  &lt; 2e-16 ***\nDESTIN_SZBDSZ07      -0.5849371  0.0110468   -52.951  &lt; 2e-16 ***\nDESTIN_SZBDSZ08      -1.2871050  0.0128623  -100.068  &lt; 2e-16 ***\nDESTIN_SZBKSZ01      -1.0633560  0.0077771  -136.730  &lt; 2e-16 ***\nDESTIN_SZBKSZ02      -0.4065316  0.0066712   -60.938  &lt; 2e-16 ***\nDESTIN_SZBKSZ03      -0.6815674  0.0066509  -102.477  &lt; 2e-16 ***\nDESTIN_SZBKSZ04      -0.4185485  0.0058306   -71.785  &lt; 2e-16 ***\nDESTIN_SZBKSZ05      -0.8887654  0.0073867  -120.319  &lt; 2e-16 ***\nDESTIN_SZBKSZ06      -0.9436078  0.0068625  -137.501  &lt; 2e-16 ***\nDESTIN_SZBKSZ07      -0.0067325  0.0048408    -1.391  0.16430    \nDESTIN_SZBKSZ08      -1.2680903  0.0079177  -160.160  &lt; 2e-16 ***\nDESTIN_SZBKSZ09      -0.0350151  0.0054287    -6.450 1.12e-10 ***\nDESTIN_SZBLSZ01      -0.3045203  0.0081978   -37.146  &lt; 2e-16 ***\nDESTIN_SZBLSZ02       0.6432424  0.0074449    86.400  &lt; 2e-16 ***\nDESTIN_SZBLSZ03       1.9595113  0.0084705   231.333  &lt; 2e-16 ***\nDESTIN_SZBLSZ04       0.0149756  0.0172081     0.870  0.38415    \nDESTIN_SZBMSZ01      -0.0378127  0.0055294    -6.838 8.00e-12 ***\nDESTIN_SZBMSZ02      -0.8458055  0.0054043  -156.505  &lt; 2e-16 ***\nDESTIN_SZBMSZ03      -1.1334399  0.0063720  -177.878  &lt; 2e-16 ***\nDESTIN_SZBMSZ04      -1.1164759  0.0057743  -193.353  &lt; 2e-16 ***\nDESTIN_SZBMSZ05      -1.1078742  0.0078703  -140.766  &lt; 2e-16 ***\nDESTIN_SZBMSZ06      -2.2787234  0.0155126  -146.895  &lt; 2e-16 ***\nDESTIN_SZBMSZ07      -0.2739089  0.0051924   -52.752  &lt; 2e-16 ***\nDESTIN_SZBMSZ08      -1.6825978  0.0071842  -234.209  &lt; 2e-16 ***\nDESTIN_SZBMSZ09      -3.0047801  0.0159980  -187.823  &lt; 2e-16 ***\nDESTIN_SZBMSZ10      -2.2232689  0.0096907  -229.423  &lt; 2e-16 ***\nDESTIN_SZBMSZ11      -1.9657136  0.0086445  -227.394  &lt; 2e-16 ***\nDESTIN_SZBMSZ12      -1.5359286  0.0089658  -171.310  &lt; 2e-16 ***\nDESTIN_SZBMSZ13      -0.5657561  0.0059960   -94.355  &lt; 2e-16 ***\nDESTIN_SZBMSZ14      -1.6904858  0.0084858  -199.214  &lt; 2e-16 ***\nDESTIN_SZBMSZ15      -1.5268383  0.0079959  -190.953  &lt; 2e-16 ***\nDESTIN_SZBMSZ16      -2.2045600  0.0130872  -168.452  &lt; 2e-16 ***\nDESTIN_SZBMSZ17      -2.2992381  0.0184895  -124.353  &lt; 2e-16 ***\nDESTIN_SZBPSZ01      -0.8549497  0.0065168  -131.191  &lt; 2e-16 ***\nDESTIN_SZBPSZ02      -1.7470549  0.0095751  -182.457  &lt; 2e-16 ***\nDESTIN_SZBPSZ03      -1.4015145  0.0090888  -154.203  &lt; 2e-16 ***\nDESTIN_SZBPSZ04      -0.5250632  0.0066496   -78.962  &lt; 2e-16 ***\nDESTIN_SZBPSZ05       0.3413171  0.0046404    73.553  &lt; 2e-16 ***\nDESTIN_SZBPSZ06      -0.8569188  0.0090795   -94.380  &lt; 2e-16 ***\nDESTIN_SZBPSZ07      -0.0751284  0.0089704    -8.375  &lt; 2e-16 ***\nDESTIN_SZBSSZ01       0.1015228  0.0055735    18.215  &lt; 2e-16 ***\nDESTIN_SZBSSZ02      -0.7066412  0.0063845  -110.682  &lt; 2e-16 ***\nDESTIN_SZBSSZ03       0.1622730  0.0046689    34.756  &lt; 2e-16 ***\nDESTIN_SZBTSZ01       0.5470615  0.0047984   114.009  &lt; 2e-16 ***\nDESTIN_SZBTSZ02      -0.1393371  0.0078266   -17.803  &lt; 2e-16 ***\nDESTIN_SZBTSZ03       0.1474771  0.0059428    24.816  &lt; 2e-16 ***\nDESTIN_SZBTSZ04      -1.2857827  0.0122000  -105.392  &lt; 2e-16 ***\nDESTIN_SZBTSZ05      -0.2629188  0.0081769   -32.154  &lt; 2e-16 ***\nDESTIN_SZBTSZ06      -0.8319920  0.0081401  -102.209  &lt; 2e-16 ***\nDESTIN_SZBTSZ07      -1.8829448  0.0121227  -155.324  &lt; 2e-16 ***\nDESTIN_SZBTSZ08      -1.5732123  0.0116752  -134.748  &lt; 2e-16 ***\nDESTIN_SZCBSZ01      -3.5334327  0.3333510   -10.600  &lt; 2e-16 ***\nDESTIN_SZCCSZ01      -0.2129306  0.0093782   -22.705  &lt; 2e-16 ***\nDESTIN_SZCHSZ01      -0.1494972  0.0113078   -13.221  &lt; 2e-16 ***\nDESTIN_SZCHSZ02       0.0041774  0.0063195     0.661  0.50860    \nDESTIN_SZCHSZ03       2.5565450  0.0046495   549.857  &lt; 2e-16 ***\nDESTIN_SZCKSZ01       0.0489719  0.0053801     9.102  &lt; 2e-16 ***\nDESTIN_SZCKSZ02      -0.3548993  0.0060671   -58.496  &lt; 2e-16 ***\nDESTIN_SZCKSZ03       0.5386351  0.0044913   119.928  &lt; 2e-16 ***\nDESTIN_SZCKSZ04      -0.4425512  0.0073837   -59.936  &lt; 2e-16 ***\nDESTIN_SZCKSZ05      -0.4092591  0.0077267   -52.967  &lt; 2e-16 ***\nDESTIN_SZCKSZ06       0.2207041  0.0074252    29.724  &lt; 2e-16 ***\nDESTIN_SZCLSZ01       0.2851460  0.0052362    54.457  &lt; 2e-16 ***\nDESTIN_SZCLSZ02      -1.9270528  0.0147688  -130.482  &lt; 2e-16 ***\nDESTIN_SZCLSZ03      -0.6266521  0.0086780   -72.212  &lt; 2e-16 ***\nDESTIN_SZCLSZ04      -0.1335581  0.0054216   -24.634  &lt; 2e-16 ***\nDESTIN_SZCLSZ05      -0.8912963  0.0096015   -92.829  &lt; 2e-16 ***\nDESTIN_SZCLSZ06       0.1781234  0.0048150    36.993  &lt; 2e-16 ***\nDESTIN_SZCLSZ07      -0.5609619  0.0062277   -90.075  &lt; 2e-16 ***\nDESTIN_SZCLSZ08      -0.3875308  0.0068390   -56.665  &lt; 2e-16 ***\nDESTIN_SZCLSZ09       0.2539453  0.0072623    34.968  &lt; 2e-16 ***\nDESTIN_SZDTSZ02      -2.5036295  0.0373421   -67.046  &lt; 2e-16 ***\nDESTIN_SZDTSZ03      -0.8956407  0.0149971   -59.721  &lt; 2e-16 ***\nDESTIN_SZDTSZ13      -1.6562176  0.0175441   -94.403  &lt; 2e-16 ***\nDESTIN_SZGLSZ01      -0.2716152  0.0056553   -48.029  &lt; 2e-16 ***\nDESTIN_SZGLSZ02      -0.1735665  0.0055548   -31.246  &lt; 2e-16 ***\nDESTIN_SZGLSZ03       0.7029507  0.0044934   156.441  &lt; 2e-16 ***\nDESTIN_SZGLSZ04       0.5788027  0.0045449   127.351  &lt; 2e-16 ***\nDESTIN_SZGLSZ05       0.6865291  0.0045131   152.118  &lt; 2e-16 ***\nDESTIN_SZHGSZ01       0.3275950  0.0043866    74.681  &lt; 2e-16 ***\nDESTIN_SZHGSZ02      -0.6326974  0.0063517   -99.610  &lt; 2e-16 ***\nDESTIN_SZHGSZ03      -1.0597982  0.0073914  -143.382  &lt; 2e-16 ***\nDESTIN_SZHGSZ04      -0.2267013  0.0052178   -43.448  &lt; 2e-16 ***\nDESTIN_SZHGSZ05      -0.3063050  0.0055452   -55.238  &lt; 2e-16 ***\nDESTIN_SZHGSZ06      -0.7483961  0.0065544  -114.182  &lt; 2e-16 ***\nDESTIN_SZHGSZ07       0.1096958  0.0051309    21.379  &lt; 2e-16 ***\nDESTIN_SZHGSZ08      -0.1374201  0.0056692   -24.240  &lt; 2e-16 ***\nDESTIN_SZHGSZ09       0.0775400  0.0060230    12.874  &lt; 2e-16 ***\nDESTIN_SZHGSZ10      -3.3017475  0.0289292  -114.132  &lt; 2e-16 ***\nDESTIN_SZJESZ01      -0.0489065  0.0057246    -8.543  &lt; 2e-16 ***\nDESTIN_SZJESZ02      -0.5101614  0.0060074   -84.921  &lt; 2e-16 ***\nDESTIN_SZJESZ03      -0.5328921  0.0064129   -83.097  &lt; 2e-16 ***\nDESTIN_SZJESZ04      -0.7348953  0.0082249   -89.351  &lt; 2e-16 ***\nDESTIN_SZJESZ05      -1.0864570  0.0111740   -97.231  &lt; 2e-16 ***\nDESTIN_SZJESZ06       0.2407920  0.0046801    51.451  &lt; 2e-16 ***\nDESTIN_SZJESZ07      -1.1523093  0.0090103  -127.888  &lt; 2e-16 ***\nDESTIN_SZJESZ08      -0.4627356  0.0094529   -48.952  &lt; 2e-16 ***\nDESTIN_SZJESZ09       0.0528616  0.0068126     7.759 8.53e-15 ***\nDESTIN_SZJESZ10       1.0240660  0.0084045   121.848  &lt; 2e-16 ***\nDESTIN_SZJESZ11       0.7875517  0.0076251   103.284  &lt; 2e-16 ***\nDESTIN_SZJWSZ01      -0.1533418  0.0076198   -20.124  &lt; 2e-16 ***\nDESTIN_SZJWSZ02      -0.0011019  0.0059389    -0.186  0.85280    \nDESTIN_SZJWSZ03       0.9063789  0.0046747   193.892  &lt; 2e-16 ***\nDESTIN_SZJWSZ04       0.7019286  0.0049743   141.112  &lt; 2e-16 ***\nDESTIN_SZJWSZ05      -0.5197057  0.0072971   -71.220  &lt; 2e-16 ***\nDESTIN_SZJWSZ06       0.3350986  0.0061171    54.780  &lt; 2e-16 ***\nDESTIN_SZJWSZ07      -0.5961960  0.0328336   -18.158  &lt; 2e-16 ***\nDESTIN_SZJWSZ08       0.8054662  0.0056006   143.819  &lt; 2e-16 ***\nDESTIN_SZJWSZ09       1.5860146  0.0040282   393.723  &lt; 2e-16 ***\nDESTIN_SZKLSZ01      -0.6500838  0.0063560  -102.279  &lt; 2e-16 ***\nDESTIN_SZKLSZ02      -0.7039434  0.0064465  -109.197  &lt; 2e-16 ***\nDESTIN_SZKLSZ03      -1.1972384  0.0075577  -158.413  &lt; 2e-16 ***\nDESTIN_SZKLSZ04      -1.7172228  0.0097573  -175.993  &lt; 2e-16 ***\nDESTIN_SZKLSZ05      -0.6042386  0.0093730   -64.466  &lt; 2e-16 ***\nDESTIN_SZKLSZ06      -3.0201496  0.0389503   -77.539  &lt; 2e-16 ***\nDESTIN_SZKLSZ07      -1.1522413  0.0076607  -150.409  &lt; 2e-16 ***\nDESTIN_SZKLSZ08      -0.6977825  0.0057610  -121.122  &lt; 2e-16 ***\nDESTIN_SZLKSZ01      -0.6895952  0.0268661   -25.668  &lt; 2e-16 ***\nDESTIN_SZMDSZ01      -0.7155951  0.0228203   -31.358  &lt; 2e-16 ***\nDESTIN_SZMDSZ02      -0.8153643  0.0123003   -66.288  &lt; 2e-16 ***\nDESTIN_SZMDSZ03      -2.7745226  0.0301326   -92.077  &lt; 2e-16 ***\nDESTIN_SZMPSZ01      -0.5492095  0.0087198   -62.984  &lt; 2e-16 ***\nDESTIN_SZMPSZ02      -0.6104744  0.0069346   -88.033  &lt; 2e-16 ***\nDESTIN_SZMPSZ03       0.2775047  0.0054964    50.489  &lt; 2e-16 ***\nDESTIN_SZMUSZ02      -2.6322870  0.0214943  -122.464  &lt; 2e-16 ***\nDESTIN_SZNTSZ01      -4.0762008  0.0531046   -76.758  &lt; 2e-16 ***\nDESTIN_SZNTSZ02      -1.9765545  0.0125659  -157.296  &lt; 2e-16 ***\nDESTIN_SZNTSZ03      -1.4563069  0.0085433  -170.462  &lt; 2e-16 ***\nDESTIN_SZNTSZ05      -2.0125598  0.0270737   -74.336  &lt; 2e-16 ***\nDESTIN_SZNTSZ06      -3.0145357  0.0504986   -59.695  &lt; 2e-16 ***\nDESTIN_SZNVSZ01      -0.4693625  0.0053866   -87.135  &lt; 2e-16 ***\nDESTIN_SZNVSZ02      -0.4525631  0.0060428   -74.894  &lt; 2e-16 ***\nDESTIN_SZNVSZ03      -0.4821492  0.0064725   -74.492  &lt; 2e-16 ***\nDESTIN_SZNVSZ04      -1.8929756  0.0128397  -147.432  &lt; 2e-16 ***\nDESTIN_SZNVSZ05      -1.4501752  0.0099737  -145.400  &lt; 2e-16 ***\nDESTIN_SZPGSZ01      -1.2305867  0.0174321   -70.593  &lt; 2e-16 ***\nDESTIN_SZPGSZ02      -0.8232919  0.0080153  -102.715  &lt; 2e-16 ***\nDESTIN_SZPGSZ03       0.2138480  0.0050850    42.054  &lt; 2e-16 ***\nDESTIN_SZPGSZ04       0.1045757  0.0053579    19.518  &lt; 2e-16 ***\nDESTIN_SZPGSZ05      -0.7542450  0.0088883   -84.858  &lt; 2e-16 ***\nDESTIN_SZPLSZ01      -0.0098642  0.0080428    -1.226  0.22003    \nDESTIN_SZPLSZ02      -1.2630412  0.0152594   -82.771  &lt; 2e-16 ***\nDESTIN_SZPLSZ03      -0.1554479  0.0108611   -14.312  &lt; 2e-16 ***\nDESTIN_SZPLSZ04      -1.5505819  0.0114768  -135.105  &lt; 2e-16 ***\nDESTIN_SZPLSZ05      -0.2417805  0.0130391   -18.543  &lt; 2e-16 ***\nDESTIN_SZPNSZ01       0.7926715  0.0073628   107.659  &lt; 2e-16 ***\nDESTIN_SZPNSZ02       2.1914920  0.0073537   298.013  &lt; 2e-16 ***\nDESTIN_SZPNSZ03       1.0246845  0.0086874   117.951  &lt; 2e-16 ***\nDESTIN_SZPNSZ04       2.5522612  0.0091789   278.057  &lt; 2e-16 ***\nDESTIN_SZPNSZ05       1.7995301  0.0138562   129.872  &lt; 2e-16 ***\nDESTIN_SZPRSZ01      -0.6576686  0.0096037   -68.481  &lt; 2e-16 ***\nDESTIN_SZPRSZ02       0.3113532  0.0059851    52.021  &lt; 2e-16 ***\nDESTIN_SZPRSZ03       0.9255296  0.0044779   206.687  &lt; 2e-16 ***\nDESTIN_SZPRSZ04      -0.0028578  0.0093218    -0.307  0.75917    \nDESTIN_SZPRSZ05       0.2457863  0.0058261    42.187  &lt; 2e-16 ***\nDESTIN_SZPRSZ06       0.3692137  0.0064542    57.205  &lt; 2e-16 ***\nDESTIN_SZPRSZ07      -1.6733306  0.0138440  -120.871  &lt; 2e-16 ***\nDESTIN_SZPRSZ08      -0.2221048  0.0074846   -29.675  &lt; 2e-16 ***\nDESTIN_SZQTSZ01      -1.0185488  0.0093179  -109.311  &lt; 2e-16 ***\nDESTIN_SZQTSZ02      -1.2802688  0.0081670  -156.761  &lt; 2e-16 ***\nDESTIN_SZQTSZ03      -1.3322708  0.0079106  -168.415  &lt; 2e-16 ***\nDESTIN_SZQTSZ04      -1.1803631  0.0077366  -152.568  &lt; 2e-16 ***\nDESTIN_SZQTSZ05      -1.2215818  0.0072829  -167.734  &lt; 2e-16 ***\nDESTIN_SZQTSZ06      -1.3213145  0.0074858  -176.509  &lt; 2e-16 ***\nDESTIN_SZQTSZ07      -1.6426306  0.0123347  -133.171  &lt; 2e-16 ***\nDESTIN_SZQTSZ08      -0.2224169  0.0058405   -38.082  &lt; 2e-16 ***\nDESTIN_SZQTSZ09      -0.8142678  0.0069796  -116.665  &lt; 2e-16 ***\nDESTIN_SZQTSZ10      -0.1090496  0.0062573   -17.428  &lt; 2e-16 ***\nDESTIN_SZQTSZ11      -0.0108951  0.0061145    -1.782  0.07477 .  \nDESTIN_SZQTSZ12      -0.8582515  0.0090243   -95.105  &lt; 2e-16 ***\nDESTIN_SZQTSZ13       0.1834409  0.0065231    28.122  &lt; 2e-16 ***\nDESTIN_SZQTSZ14       0.1994454  0.0073615    27.093  &lt; 2e-16 ***\nDESTIN_SZQTSZ15       0.6740197  0.0088699    75.990  &lt; 2e-16 ***\nDESTIN_SZRCSZ01      -0.7746427  0.0079375   -97.593  &lt; 2e-16 ***\nDESTIN_SZRCSZ06      -1.4394098  0.0209931   -68.566  &lt; 2e-16 ***\nDESTIN_SZRVSZ01      -2.6060495  0.0175759  -148.274  &lt; 2e-16 ***\nDESTIN_SZRVSZ02      -2.5823769  0.0354706   -72.803  &lt; 2e-16 ***\nDESTIN_SZRVSZ03      -2.5890601  0.0152644  -169.614  &lt; 2e-16 ***\nDESTIN_SZRVSZ04      -2.2277482  0.0165661  -134.477  &lt; 2e-16 ***\nDESTIN_SZRVSZ05      -3.8610445  0.0298251  -129.456  &lt; 2e-16 ***\nDESTIN_SZSBSZ01      -1.2035529  0.0103954  -115.777  &lt; 2e-16 ***\nDESTIN_SZSBSZ02      -1.0267199  0.0085239  -120.452  &lt; 2e-16 ***\nDESTIN_SZSBSZ03       0.5977382  0.0050336   118.750  &lt; 2e-16 ***\nDESTIN_SZSBSZ04       0.5362769  0.0060573    88.534  &lt; 2e-16 ***\nDESTIN_SZSBSZ05      -1.0440525  0.0089622  -116.495  &lt; 2e-16 ***\nDESTIN_SZSBSZ06      -1.3939595  0.0246679   -56.509  &lt; 2e-16 ***\nDESTIN_SZSBSZ07       0.1029116  0.0235414     4.372 1.23e-05 ***\nDESTIN_SZSBSZ08       1.3564902  0.0060529   224.105  &lt; 2e-16 ***\nDESTIN_SZSBSZ09       0.4573712  0.0056585    80.829  &lt; 2e-16 ***\nDESTIN_SZSESZ02      -0.1553609  0.0056716   -27.393  &lt; 2e-16 ***\nDESTIN_SZSESZ03       0.5412776  0.0043801   123.576  &lt; 2e-16 ***\nDESTIN_SZSESZ04      -0.6382091  0.0065411   -97.568  &lt; 2e-16 ***\nDESTIN_SZSESZ05      -0.3332093  0.0055002   -60.581  &lt; 2e-16 ***\nDESTIN_SZSESZ06      -0.3085951  0.0072340   -42.659  &lt; 2e-16 ***\nDESTIN_SZSESZ07      -2.6237684  0.0245753  -106.764  &lt; 2e-16 ***\nDESTIN_SZSGSZ01      -0.1062372  0.0066634   -15.943  &lt; 2e-16 ***\nDESTIN_SZSGSZ02      -0.0475568  0.0058908    -8.073 6.85e-16 ***\nDESTIN_SZSGSZ03      -0.2118402  0.0055056   -38.477  &lt; 2e-16 ***\nDESTIN_SZSGSZ04      -0.1099618  0.0054841   -20.051  &lt; 2e-16 ***\nDESTIN_SZSGSZ05      -2.1556963  0.0113821  -189.394  &lt; 2e-16 ***\nDESTIN_SZSGSZ06       0.4416352  0.0043842   100.734  &lt; 2e-16 ***\nDESTIN_SZSGSZ07      -0.3949335  0.0059250   -66.655  &lt; 2e-16 ***\nDESTIN_SZSISZ01      -1.2847094  0.0288610   -44.514  &lt; 2e-16 ***\nDESTIN_SZSKSZ01       0.3089834  0.0082924    37.261  &lt; 2e-16 ***\nDESTIN_SZSKSZ02       1.4139309  0.0059981   235.729  &lt; 2e-16 ***\nDESTIN_SZSKSZ03       0.2427688  0.0067373    36.034  &lt; 2e-16 ***\nDESTIN_SZSKSZ04      -0.2527488  0.0161286   -15.671  &lt; 2e-16 ***\nDESTIN_SZSKSZ05       0.6046051  0.0122766    49.249  &lt; 2e-16 ***\nDESTIN_SZSLSZ01      -0.3927387  0.0099790   -39.356  &lt; 2e-16 ***\nDESTIN_SZSLSZ04      -0.5942110  0.0086225   -68.914  &lt; 2e-16 ***\nDESTIN_SZSRSZ01      -2.6855766  0.0138707  -193.615  &lt; 2e-16 ***\nDESTIN_SZTHSZ01      -3.2750084  0.0402668   -81.333  &lt; 2e-16 ***\nDESTIN_SZTHSZ03      -1.7964408  0.0261810   -68.616  &lt; 2e-16 ***\nDESTIN_SZTHSZ04      -2.6323994  0.0241831  -108.853  &lt; 2e-16 ***\nDESTIN_SZTHSZ06      -1.9444390  0.0166052  -117.098  &lt; 2e-16 ***\nDESTIN_SZTMSZ01       0.3856054  0.0063086    61.123  &lt; 2e-16 ***\nDESTIN_SZTMSZ02       1.8586526  0.0039229   473.790  &lt; 2e-16 ***\nDESTIN_SZTMSZ03       1.2601385  0.0044018   286.278  &lt; 2e-16 ***\nDESTIN_SZTMSZ04       1.5884327  0.0043362   366.316  &lt; 2e-16 ***\nDESTIN_SZTMSZ05       1.0377553  0.0063271   164.018  &lt; 2e-16 ***\nDESTIN_SZTNSZ01      -0.9954275  0.0080345  -123.895  &lt; 2e-16 ***\nDESTIN_SZTNSZ02      -2.1032696  0.0109228  -192.557  &lt; 2e-16 ***\nDESTIN_SZTNSZ03      -2.0044892  0.0129215  -155.128  &lt; 2e-16 ***\nDESTIN_SZTNSZ04      -0.9750326  0.0081677  -119.377  &lt; 2e-16 ***\nDESTIN_SZTPSZ01      -0.7788383  0.0068769  -113.254  &lt; 2e-16 ***\nDESTIN_SZTPSZ02       0.2866080  0.0042843    66.898  &lt; 2e-16 ***\nDESTIN_SZTPSZ03      -0.8749841  0.0065470  -133.646  &lt; 2e-16 ***\nDESTIN_SZTPSZ04      -1.6852792  0.0081488  -206.812  &lt; 2e-16 ***\nDESTIN_SZTPSZ05      -1.3721346  0.0068230  -201.104  &lt; 2e-16 ***\nDESTIN_SZTPSZ06      -0.7832133  0.0069164  -113.239  &lt; 2e-16 ***\nDESTIN_SZTPSZ07      -2.3109126  0.0130830  -176.635  &lt; 2e-16 ***\nDESTIN_SZTPSZ08      -1.6406531  0.0104897  -156.406  &lt; 2e-16 ***\nDESTIN_SZTPSZ09      -0.5636273  0.0076848   -73.343  &lt; 2e-16 ***\nDESTIN_SZTPSZ10      -1.5640843  0.0099984  -156.433  &lt; 2e-16 ***\nDESTIN_SZTPSZ11      -0.3700482  0.0059834   -61.846  &lt; 2e-16 ***\nDESTIN_SZTPSZ12      -0.8828228  0.0072302  -122.102  &lt; 2e-16 ***\nDESTIN_SZTSSZ01       0.3529526  0.0221887    15.907  &lt; 2e-16 ***\nDESTIN_SZTSSZ02       1.0265792  0.0153515    66.871  &lt; 2e-16 ***\nDESTIN_SZTSSZ03       1.9647347  0.0092388   212.662  &lt; 2e-16 ***\nDESTIN_SZTSSZ04       1.8649836  0.0089976   207.275  &lt; 2e-16 ***\nDESTIN_SZTSSZ05       2.8437058  0.0085738   331.673  &lt; 2e-16 ***\nDESTIN_SZTSSZ06       3.4238870  0.0161304   212.263  &lt; 2e-16 ***\nDESTIN_SZWCSZ01       2.9550693  0.0051690   571.689  &lt; 2e-16 ***\nDESTIN_SZWCSZ02      -0.8214103  0.0129213   -63.570  &lt; 2e-16 ***\nDESTIN_SZWCSZ03      -1.7393427  0.0347472   -50.057  &lt; 2e-16 ***\nDESTIN_SZWDSZ01       1.3424417  0.0039957   335.972  &lt; 2e-16 ***\nDESTIN_SZWDSZ02      -0.2103694  0.0068601   -30.666  &lt; 2e-16 ***\nDESTIN_SZWDSZ03       0.8268551  0.0051363   160.983  &lt; 2e-16 ***\nDESTIN_SZWDSZ04      -0.0643997  0.0079076    -8.144 3.82e-16 ***\nDESTIN_SZWDSZ05       0.0451985  0.0075732     5.968 2.40e-09 ***\nDESTIN_SZWDSZ06       0.6981330  0.0051936   134.423  &lt; 2e-16 ***\nDESTIN_SZWDSZ07      -0.0403233  0.0067749    -5.952 2.65e-09 ***\nDESTIN_SZWDSZ08       0.2850631  0.0069225    41.179  &lt; 2e-16 ***\nDESTIN_SZWDSZ09       1.3016106  0.0050365   258.433  &lt; 2e-16 ***\nDESTIN_SZYSSZ01       0.7598564  0.0044144   172.133  &lt; 2e-16 ***\nDESTIN_SZYSSZ02       0.2648061  0.0058239    45.469  &lt; 2e-16 ***\nDESTIN_SZYSSZ03      -0.0412163  0.0068337    -6.031 1.63e-09 ***\nDESTIN_SZYSSZ04      -0.0561054  0.0060829    -9.223  &lt; 2e-16 ***\nDESTIN_SZYSSZ05      -0.9970159  0.0121827   -81.839  &lt; 2e-16 ***\nDESTIN_SZYSSZ06      -1.3808376  0.0125738  -109.819  &lt; 2e-16 ***\nDESTIN_SZYSSZ07      -0.7128364  0.0165296   -43.125  &lt; 2e-16 ***\nDESTIN_SZYSSZ08       0.9409510  0.0045886   205.064  &lt; 2e-16 ***\nDESTIN_SZYSSZ09       0.3738436  0.0047971    77.930  &lt; 2e-16 ***\nlog(ORIGIN_AGE25_64)  0.1928847  0.0001667  1157.214  &lt; 2e-16 ***\nlog(dist)            -1.7828141  0.0004794 -3718.501  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 36117615  on 14273  degrees of freedom\nResidual deviance: 12319763  on 13992  degrees of freedom\nAIC: 12404881\n\nNumber of Fisher Scoring iterations: 7\n\n\nWe can examine how the constraints hold for destinations this time.\n\nCalcRSquared(decSIM$data$TRIPS, decSIM$fitted.values)\n\n[1] 0.496166\n\n\n\n\nDoubly constrained\nIn this section, we will fit a doubly constrained SIM by using the code chunk below.\nThe general formula of Doubly Constrained Spatial Interaction Model\n\n\ndbcSIM &lt;- glm(formula = TRIPS ~ \n                ORIGIN_SZ + \n                DESTIN_SZ + \n                log(dist),\n              family = poisson(link = \"log\"),\n              data = SIM_data,\n              na.action = na.exclude)\nsummary(dbcSIM)\n\n\nCall:\nglm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(dist), family = poisson(link = \"log\"), \n    data = SIM_data, na.action = na.exclude)\n\nCoefficients:\n                  Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)     21.9587595  0.0066831  3285.715  &lt; 2e-16 ***\nORIGIN_SZAMSZ02  0.4778050  0.0054127    88.275  &lt; 2e-16 ***\nORIGIN_SZAMSZ03  0.2895973  0.0055517    52.163  &lt; 2e-16 ***\nORIGIN_SZAMSZ04 -0.2628080  0.0060720   -43.282  &lt; 2e-16 ***\nORIGIN_SZAMSZ05 -0.2631404  0.0069008   -38.132  &lt; 2e-16 ***\nORIGIN_SZAMSZ06  0.1722337  0.0062028    27.767  &lt; 2e-16 ***\nORIGIN_SZAMSZ07 -0.9883200  0.0111224   -88.859  &lt; 2e-16 ***\nORIGIN_SZAMSZ08 -0.4052821  0.0104095   -38.934  &lt; 2e-16 ***\nORIGIN_SZAMSZ09  0.0356290  0.0064816     5.497 3.86e-08 ***\nORIGIN_SZAMSZ10  0.4815569  0.0055521    86.735  &lt; 2e-16 ***\nORIGIN_SZAMSZ11 -1.4440079  0.0146079   -98.851  &lt; 2e-16 ***\nORIGIN_SZAMSZ12 -1.7862677  0.0128071  -139.475  &lt; 2e-16 ***\nORIGIN_SZBDSZ01  0.8653749  0.0054381   159.132  &lt; 2e-16 ***\nORIGIN_SZBDSZ02  0.0841000  0.0062834    13.385  &lt; 2e-16 ***\nORIGIN_SZBDSZ03  0.3158343  0.0057510    54.918  &lt; 2e-16 ***\nORIGIN_SZBDSZ04  1.4556701  0.0049986   291.215  &lt; 2e-16 ***\nORIGIN_SZBDSZ05  0.6363125  0.0057193   111.257  &lt; 2e-16 ***\nORIGIN_SZBDSZ06  0.6749341  0.0058650   115.078  &lt; 2e-16 ***\nORIGIN_SZBDSZ07 -1.2176407  0.0113698  -107.095  &lt; 2e-16 ***\nORIGIN_SZBDSZ08 -0.9803580  0.0105604   -92.833  &lt; 2e-16 ***\nORIGIN_SZBKSZ01 -0.2919642  0.0080763   -36.151  &lt; 2e-16 ***\nORIGIN_SZBKSZ02  0.4609570  0.0067997    67.791  &lt; 2e-16 ***\nORIGIN_SZBKSZ03  0.6273448  0.0065989    95.068  &lt; 2e-16 ***\nORIGIN_SZBKSZ04 -0.2499063  0.0076555   -32.644  &lt; 2e-16 ***\nORIGIN_SZBKSZ05 -0.2628428  0.0078905   -33.311  &lt; 2e-16 ***\nORIGIN_SZBKSZ06 -0.2174034  0.0075134   -28.936  &lt; 2e-16 ***\nORIGIN_SZBKSZ07  0.7094093  0.0058574   121.114  &lt; 2e-16 ***\nORIGIN_SZBKSZ08 -0.1614362  0.0067626   -23.872  &lt; 2e-16 ***\nORIGIN_SZBKSZ09 -0.2739085  0.0072969   -37.537  &lt; 2e-16 ***\nORIGIN_SZBLSZ01 -2.4281074  0.0181172  -134.022  &lt; 2e-16 ***\nORIGIN_SZBLSZ02 -2.7305447  0.0219341  -124.489  &lt; 2e-16 ***\nORIGIN_SZBLSZ03 -3.3071431  0.0540398   -61.198  &lt; 2e-16 ***\nORIGIN_SZBLSZ04 -2.4550671  0.0263946   -93.014  &lt; 2e-16 ***\nORIGIN_SZBMSZ01  0.1198976  0.0065964    18.176  &lt; 2e-16 ***\nORIGIN_SZBMSZ02 -1.3908667  0.0083230  -167.112  &lt; 2e-16 ***\nORIGIN_SZBMSZ03 -0.6999122  0.0069754  -100.339  &lt; 2e-16 ***\nORIGIN_SZBMSZ04 -0.2691159  0.0066184   -40.662  &lt; 2e-16 ***\nORIGIN_SZBMSZ05 -2.6163780  0.0190989  -136.991  &lt; 2e-16 ***\nORIGIN_SZBMSZ06 -2.9729956  0.0197182  -150.774  &lt; 2e-16 ***\nORIGIN_SZBMSZ07 -0.7309916  0.0072407  -100.956  &lt; 2e-16 ***\nORIGIN_SZBMSZ08 -1.0019514  0.0073169  -136.936  &lt; 2e-16 ***\nORIGIN_SZBMSZ09 -1.3667460  0.0105325  -129.764  &lt; 2e-16 ***\nORIGIN_SZBMSZ10 -1.6907268  0.0106687  -158.476  &lt; 2e-16 ***\nORIGIN_SZBMSZ11 -1.2288802  0.0082919  -148.202  &lt; 2e-16 ***\nORIGIN_SZBMSZ12 -1.6517767  0.0115101  -143.507  &lt; 2e-16 ***\nORIGIN_SZBMSZ13 -0.7251351  0.0075289   -96.314  &lt; 2e-16 ***\nORIGIN_SZBMSZ14 -1.1534912  0.0082629  -139.599  &lt; 2e-16 ***\nORIGIN_SZBMSZ15 -0.5476774  0.0075710   -72.339  &lt; 2e-16 ***\nORIGIN_SZBMSZ16 -1.5195034  0.0111459  -136.329  &lt; 2e-16 ***\nORIGIN_SZBMSZ17 -1.6026767  0.0184419   -86.904  &lt; 2e-16 ***\nORIGIN_SZBPSZ01  0.5571291  0.0071866    77.523  &lt; 2e-16 ***\nORIGIN_SZBPSZ02  0.0523197  0.0082259     6.360 2.01e-10 ***\nORIGIN_SZBPSZ03  0.2942047  0.0080482    36.555  &lt; 2e-16 ***\nORIGIN_SZBPSZ04  0.6246296  0.0065878    94.816  &lt; 2e-16 ***\nORIGIN_SZBPSZ05  0.8663708  0.0060852   142.372  &lt; 2e-16 ***\nORIGIN_SZBPSZ06 -0.9896182  0.0109551   -90.334  &lt; 2e-16 ***\nORIGIN_SZBPSZ07 -0.5219250  0.0101830   -51.255  &lt; 2e-16 ***\nORIGIN_SZBSSZ01  0.3299588  0.0066440    49.663  &lt; 2e-16 ***\nORIGIN_SZBSSZ02  0.2851357  0.0057077    49.956  &lt; 2e-16 ***\nORIGIN_SZBSSZ03 -0.2084740  0.0063364   -32.901  &lt; 2e-16 ***\nORIGIN_SZBTSZ01  0.1425664  0.0071103    20.051  &lt; 2e-16 ***\nORIGIN_SZBTSZ02 -0.5591999  0.0093616   -59.733  &lt; 2e-16 ***\nORIGIN_SZBTSZ03 -0.3648190  0.0081677   -44.666  &lt; 2e-16 ***\nORIGIN_SZBTSZ04 -1.4555078  0.0120138  -121.152  &lt; 2e-16 ***\nORIGIN_SZBTSZ05 -0.8635510  0.0133848   -64.517  &lt; 2e-16 ***\nORIGIN_SZBTSZ06 -1.1383111  0.0106421  -106.963  &lt; 2e-16 ***\nORIGIN_SZBTSZ07 -2.3477669  0.0160858  -145.953  &lt; 2e-16 ***\nORIGIN_SZBTSZ08 -1.2918779  0.0124862  -103.464  &lt; 2e-16 ***\nORIGIN_SZCBSZ01 -3.3713588  0.0578683   -58.259  &lt; 2e-16 ***\nORIGIN_SZCCSZ01 -0.6029242  0.0153385   -39.308  &lt; 2e-16 ***\nORIGIN_SZCHSZ01 -0.7641380  0.0135100   -56.561  &lt; 2e-16 ***\nORIGIN_SZCHSZ02 -0.8400736  0.0101951   -82.400  &lt; 2e-16 ***\nORIGIN_SZCHSZ03  1.2753127  0.0072576   175.720  &lt; 2e-16 ***\nORIGIN_SZCKSZ01  0.2470943  0.0067135    36.806  &lt; 2e-16 ***\nORIGIN_SZCKSZ02  0.5793581  0.0070498    82.181  &lt; 2e-16 ***\nORIGIN_SZCKSZ03  1.0795767  0.0060642   178.025  &lt; 2e-16 ***\nORIGIN_SZCKSZ04  1.4947920  0.0063122   236.808  &lt; 2e-16 ***\nORIGIN_SZCKSZ05  0.7457580  0.0074071   100.681  &lt; 2e-16 ***\nORIGIN_SZCKSZ06  0.5760952  0.0094861    60.730  &lt; 2e-16 ***\nORIGIN_SZCLSZ01 -0.9061335  0.0098617   -91.884  &lt; 2e-16 ***\nORIGIN_SZCLSZ02 -1.7609479  0.0156124  -112.791  &lt; 2e-16 ***\nORIGIN_SZCLSZ03 -1.0081325  0.0095171  -105.929  &lt; 2e-16 ***\nORIGIN_SZCLSZ04  0.6181200  0.0057953   106.659  &lt; 2e-16 ***\nORIGIN_SZCLSZ05 -2.0462335  0.0168934  -121.127  &lt; 2e-16 ***\nORIGIN_SZCLSZ06  0.7902389  0.0055680   141.924  &lt; 2e-16 ***\nORIGIN_SZCLSZ07 -0.5472929  0.0071001   -77.082  &lt; 2e-16 ***\nORIGIN_SZCLSZ08 -0.2197650  0.0077460   -28.372  &lt; 2e-16 ***\nORIGIN_SZCLSZ09 -1.8175782  0.0195989   -92.739  &lt; 2e-16 ***\nORIGIN_SZDTSZ02 -3.7618796  0.0872098   -43.136  &lt; 2e-16 ***\nORIGIN_SZDTSZ03 -3.4514766  0.0840812   -41.049  &lt; 2e-16 ***\nORIGIN_SZDTSZ13 -3.0627578  0.0352485   -86.891  &lt; 2e-16 ***\nORIGIN_SZGLSZ01 -1.8055929  0.0111938  -161.303  &lt; 2e-16 ***\nORIGIN_SZGLSZ02 -0.1588829  0.0061413   -25.871  &lt; 2e-16 ***\nORIGIN_SZGLSZ03 -0.2508524  0.0064276   -39.027  &lt; 2e-16 ***\nORIGIN_SZGLSZ04  0.8819358  0.0051993   169.627  &lt; 2e-16 ***\nORIGIN_SZGLSZ05  0.6062778  0.0053735   112.828  &lt; 2e-16 ***\nORIGIN_SZHGSZ01  0.3841503  0.0056776    67.660  &lt; 2e-16 ***\nORIGIN_SZHGSZ02  0.3962330  0.0057579    68.815  &lt; 2e-16 ***\nORIGIN_SZHGSZ03  0.2159531  0.0061671    35.017  &lt; 2e-16 ***\nORIGIN_SZHGSZ04  0.7831941  0.0052216   149.992  &lt; 2e-16 ***\nORIGIN_SZHGSZ05  1.1741558  0.0051799   226.677  &lt; 2e-16 ***\nORIGIN_SZHGSZ06 -0.1891403  0.0065556   -28.852  &lt; 2e-16 ***\nORIGIN_SZHGSZ07  0.3105421  0.0057186    54.304  &lt; 2e-16 ***\nORIGIN_SZHGSZ08 -0.0766364  0.0063474   -12.074  &lt; 2e-16 ***\nORIGIN_SZHGSZ09 -1.2211107  0.0101434  -120.384  &lt; 2e-16 ***\nORIGIN_SZHGSZ10 -3.4844709  0.0504793   -69.028  &lt; 2e-16 ***\nORIGIN_SZJESZ01  0.4916496  0.0063444    77.493  &lt; 2e-16 ***\nORIGIN_SZJESZ02  0.1343893  0.0063762    21.077  &lt; 2e-16 ***\nORIGIN_SZJESZ03 -0.2761723  0.0068085   -40.563  &lt; 2e-16 ***\nORIGIN_SZJESZ04 -1.5932744  0.0121402  -131.240  &lt; 2e-16 ***\nORIGIN_SZJESZ05 -2.3041311  0.0160245  -143.788  &lt; 2e-16 ***\nORIGIN_SZJESZ06  0.2811076  0.0062495    44.981  &lt; 2e-16 ***\nORIGIN_SZJESZ07 -1.9413956  0.0136276  -142.461  &lt; 2e-16 ***\nORIGIN_SZJESZ08 -1.3315645  0.0143168   -93.007  &lt; 2e-16 ***\nORIGIN_SZJESZ09  0.4418314  0.0069208    63.841  &lt; 2e-16 ***\nORIGIN_SZJESZ10 -1.5551555  0.0236523   -65.751  &lt; 2e-16 ***\nORIGIN_SZJESZ11 -1.8888230  0.0224630   -84.086  &lt; 2e-16 ***\nORIGIN_SZJWSZ01  0.2564586  0.0084699    30.279  &lt; 2e-16 ***\nORIGIN_SZJWSZ02  0.6899398  0.0061751   111.729  &lt; 2e-16 ***\nORIGIN_SZJWSZ03  1.4761229  0.0057392   257.198  &lt; 2e-16 ***\nORIGIN_SZJWSZ04  0.5701272  0.0065749    86.713  &lt; 2e-16 ***\nORIGIN_SZJWSZ05 -2.1253657  0.0150769  -140.968  &lt; 2e-16 ***\nORIGIN_SZJWSZ06 -1.5307265  0.0131906  -116.047  &lt; 2e-16 ***\nORIGIN_SZJWSZ07 -2.8801618  0.0360772   -79.833  &lt; 2e-16 ***\nORIGIN_SZJWSZ08  1.4428820  0.0059638   241.938  &lt; 2e-16 ***\nORIGIN_SZJWSZ09  1.8968475  0.0055649   340.860  &lt; 2e-16 ***\nORIGIN_SZKLSZ01  0.1116580  0.0059844    18.658  &lt; 2e-16 ***\nORIGIN_SZKLSZ02 -0.9618787  0.0077344  -124.364  &lt; 2e-16 ***\nORIGIN_SZKLSZ03 -0.7070626  0.0070275  -100.613  &lt; 2e-16 ***\nORIGIN_SZKLSZ04 -2.2742765  0.0139991  -162.459  &lt; 2e-16 ***\nORIGIN_SZKLSZ05 -1.1907262  0.0123719   -96.244  &lt; 2e-16 ***\nORIGIN_SZKLSZ06 -5.9774897  0.1857994   -32.172  &lt; 2e-16 ***\nORIGIN_SZKLSZ07 -1.4258369  0.0103083  -138.320  &lt; 2e-16 ***\nORIGIN_SZKLSZ08 -1.7625888  0.0116107  -151.808  &lt; 2e-16 ***\nORIGIN_SZLKSZ01 -2.0541388  0.0448216   -45.829  &lt; 2e-16 ***\nORIGIN_SZMDSZ01 -0.8571117  0.0321054   -26.697  &lt; 2e-16 ***\nORIGIN_SZMDSZ02 -0.6034597  0.0120724   -49.987  &lt; 2e-16 ***\nORIGIN_SZMDSZ03 -2.1681163  0.0201078  -107.825  &lt; 2e-16 ***\nORIGIN_SZMPSZ01 -0.9331562  0.0096218   -96.984  &lt; 2e-16 ***\nORIGIN_SZMPSZ02 -1.0268229  0.0081379  -126.178  &lt; 2e-16 ***\nORIGIN_SZMPSZ03  0.0054001  0.0066875     0.807 0.419385    \nORIGIN_SZMUSZ02 -3.6269863  0.1105492   -32.809  &lt; 2e-16 ***\nORIGIN_SZNTSZ01 -3.0593717  0.0399843   -76.514  &lt; 2e-16 ***\nORIGIN_SZNTSZ02 -3.3331415  0.0251754  -132.397  &lt; 2e-16 ***\nORIGIN_SZNTSZ03 -0.8351522  0.0090372   -92.413  &lt; 2e-16 ***\nORIGIN_SZNTSZ05 -4.2082472  0.0583343   -72.140  &lt; 2e-16 ***\nORIGIN_SZNTSZ06 -3.8549296  0.0593793   -64.920  &lt; 2e-16 ***\nORIGIN_SZNVSZ01  0.2789069  0.0056024    49.784  &lt; 2e-16 ***\nORIGIN_SZNVSZ02 -0.6036857  0.0077126   -78.273  &lt; 2e-16 ***\nORIGIN_SZNVSZ03 -1.0072683  0.0092678  -108.685  &lt; 2e-16 ***\nORIGIN_SZNVSZ04 -0.8723996  0.0101399   -86.037  &lt; 2e-16 ***\nORIGIN_SZNVSZ05 -2.1552928  0.0183064  -117.734  &lt; 2e-16 ***\nORIGIN_SZPGSZ01  0.0520607  0.0157846     3.298 0.000973 ***\nORIGIN_SZPGSZ02 -0.3481687  0.0089328   -38.976  &lt; 2e-16 ***\nORIGIN_SZPGSZ03  0.9095292  0.0058835   154.590  &lt; 2e-16 ***\nORIGIN_SZPGSZ04  1.3653717  0.0054727   249.489  &lt; 2e-16 ***\nORIGIN_SZPGSZ05  0.3762720  0.0073841    50.957  &lt; 2e-16 ***\nORIGIN_SZPLSZ01 -0.9142754  0.0136552   -66.954  &lt; 2e-16 ***\nORIGIN_SZPLSZ02 -1.0987582  0.0175891   -62.468  &lt; 2e-16 ***\nORIGIN_SZPLSZ03 -2.3427113  0.0474176   -49.406  &lt; 2e-16 ***\nORIGIN_SZPLSZ04 -2.9140779  0.0374458   -77.821  &lt; 2e-16 ***\nORIGIN_SZPLSZ05 -2.2381965  0.0261572   -85.567  &lt; 2e-16 ***\nORIGIN_SZPNSZ01  0.9659006  0.0075177   128.484  &lt; 2e-16 ***\nORIGIN_SZPNSZ02 -0.0158348  0.0143869    -1.101 0.271053    \nORIGIN_SZPNSZ03 -2.1837321  0.0224396   -97.316  &lt; 2e-16 ***\nORIGIN_SZPNSZ04 -3.2481509  0.0370762   -87.608  &lt; 2e-16 ***\nORIGIN_SZPNSZ05 -2.0450679  0.0328165   -62.318  &lt; 2e-16 ***\nORIGIN_SZPRSZ01 -0.6701245  0.0141567   -47.336  &lt; 2e-16 ***\nORIGIN_SZPRSZ02  0.7931907  0.0058079   136.570  &lt; 2e-16 ***\nORIGIN_SZPRSZ03  0.4249094  0.0058610    72.498  &lt; 2e-16 ***\nORIGIN_SZPRSZ04 -0.8529967  0.0090997   -93.739  &lt; 2e-16 ***\nORIGIN_SZPRSZ05  0.7865479  0.0055282   142.278  &lt; 2e-16 ***\nORIGIN_SZPRSZ06 -1.3303664  0.0134512   -98.903  &lt; 2e-16 ***\nORIGIN_SZPRSZ07 -3.0458370  0.0181514  -167.802  &lt; 2e-16 ***\nORIGIN_SZPRSZ08 -0.5342399  0.0075966   -70.327  &lt; 2e-16 ***\nORIGIN_SZQTSZ01 -0.2548930  0.0086485   -29.473  &lt; 2e-16 ***\nORIGIN_SZQTSZ02 -0.8662439  0.0076549  -113.162  &lt; 2e-16 ***\nORIGIN_SZQTSZ03 -0.0890168  0.0072455   -12.286  &lt; 2e-16 ***\nORIGIN_SZQTSZ04 -1.4634370  0.0089384  -163.724  &lt; 2e-16 ***\nORIGIN_SZQTSZ05 -0.6535669  0.0077612   -84.210  &lt; 2e-16 ***\nORIGIN_SZQTSZ06 -0.8275765  0.0081835  -101.128  &lt; 2e-16 ***\nORIGIN_SZQTSZ07 -1.5369800  0.0112808  -136.248  &lt; 2e-16 ***\nORIGIN_SZQTSZ08 -0.4437979  0.0075302   -58.936  &lt; 2e-16 ***\nORIGIN_SZQTSZ09 -0.8184934  0.0083589   -97.918  &lt; 2e-16 ***\nORIGIN_SZQTSZ10 -0.6906597  0.0080980   -85.288  &lt; 2e-16 ***\nORIGIN_SZQTSZ11 -2.3251162  0.0154191  -150.795  &lt; 2e-16 ***\nORIGIN_SZQTSZ12 -3.0442790  0.0208985  -145.670  &lt; 2e-16 ***\nORIGIN_SZQTSZ13 -0.7241013  0.0093441   -77.493  &lt; 2e-16 ***\nORIGIN_SZQTSZ14 -1.8225351  0.0138207  -131.870  &lt; 2e-16 ***\nORIGIN_SZQTSZ15 -0.8720806  0.0138589   -62.926  &lt; 2e-16 ***\nORIGIN_SZRCSZ01 -1.8063415  0.0144295  -125.184  &lt; 2e-16 ***\nORIGIN_SZRCSZ06 -0.5370905  0.0101573   -52.877  &lt; 2e-16 ***\nORIGIN_SZRVSZ01 -2.7426167  0.0341386   -80.338  &lt; 2e-16 ***\nORIGIN_SZRVSZ02 -3.0827269  0.0302299  -101.976  &lt; 2e-16 ***\nORIGIN_SZRVSZ03 -2.9133853  0.0262543  -110.968  &lt; 2e-16 ***\nORIGIN_SZRVSZ04 -3.4220022  0.0582209   -58.776  &lt; 2e-16 ***\nORIGIN_SZRVSZ05 -2.6206257  0.0197470  -132.710  &lt; 2e-16 ***\nORIGIN_SZSBSZ01  0.1010337  0.0085117    11.870  &lt; 2e-16 ***\nORIGIN_SZSBSZ02 -0.8810456  0.0098244   -89.680  &lt; 2e-16 ***\nORIGIN_SZSBSZ03  0.8303668  0.0063009   131.785  &lt; 2e-16 ***\nORIGIN_SZSBSZ04  0.3489128  0.0071456    48.829  &lt; 2e-16 ***\nORIGIN_SZSBSZ05 -0.3182914  0.0085560   -37.201  &lt; 2e-16 ***\nORIGIN_SZSBSZ06 -0.9074308  0.0200035   -45.364  &lt; 2e-16 ***\nORIGIN_SZSBSZ07 -0.2217124  0.0167188   -13.261  &lt; 2e-16 ***\nORIGIN_SZSBSZ08 -1.3007367  0.0178771   -72.760  &lt; 2e-16 ***\nORIGIN_SZSBSZ09 -0.9813703  0.0107885   -90.965  &lt; 2e-16 ***\nORIGIN_SZSESZ02  1.1283424  0.0054209   208.146  &lt; 2e-16 ***\nORIGIN_SZSESZ03  1.2389996  0.0051926   238.610  &lt; 2e-16 ***\nORIGIN_SZSESZ04  0.7535119  0.0060371   124.814  &lt; 2e-16 ***\nORIGIN_SZSESZ05 -0.2347978  0.0071482   -32.847  &lt; 2e-16 ***\nORIGIN_SZSESZ06  0.9520620  0.0057572   165.368  &lt; 2e-16 ***\nORIGIN_SZSESZ07 -2.4296685  0.0231677  -104.873  &lt; 2e-16 ***\nORIGIN_SZSGSZ01 -0.6995899  0.0099969   -69.980  &lt; 2e-16 ***\nORIGIN_SZSGSZ02 -1.2602157  0.0111471  -113.053  &lt; 2e-16 ***\nORIGIN_SZSGSZ03  0.0725860  0.0061970    11.713  &lt; 2e-16 ***\nORIGIN_SZSGSZ04  0.2738315  0.0057524    47.603  &lt; 2e-16 ***\nORIGIN_SZSGSZ05 -2.0207710  0.0119838  -168.625  &lt; 2e-16 ***\nORIGIN_SZSGSZ06  0.4885608  0.0054646    89.404  &lt; 2e-16 ***\nORIGIN_SZSGSZ07 -0.8892155  0.0075074  -118.445  &lt; 2e-16 ***\nORIGIN_SZSKSZ01 -0.3682754  0.0108025   -34.092  &lt; 2e-16 ***\nORIGIN_SZSKSZ02  1.1826086  0.0071388   165.659  &lt; 2e-16 ***\nORIGIN_SZSKSZ03 -0.3230177  0.0101683   -31.767  &lt; 2e-16 ***\nORIGIN_SZSKSZ04 -1.8504236  0.0362400   -51.060  &lt; 2e-16 ***\nORIGIN_SZSKSZ05 -0.2759035  0.0185157   -14.901  &lt; 2e-16 ***\nORIGIN_SZSLSZ01 -2.2757902  0.0348766   -65.253  &lt; 2e-16 ***\nORIGIN_SZSLSZ04 -0.0899820  0.0090356    -9.959  &lt; 2e-16 ***\nORIGIN_SZSRSZ01 -2.1460151  0.0187871  -114.228  &lt; 2e-16 ***\nORIGIN_SZTHSZ01 -2.6851549  0.0571841   -46.956  &lt; 2e-16 ***\nORIGIN_SZTHSZ03 -1.0121495  0.0275551   -36.732  &lt; 2e-16 ***\nORIGIN_SZTHSZ04 -2.6129645  0.0345167   -75.701  &lt; 2e-16 ***\nORIGIN_SZTHSZ06 -1.7229100  0.0208134   -82.779  &lt; 2e-16 ***\nORIGIN_SZTMSZ01 -0.2254986  0.0070312   -32.071  &lt; 2e-16 ***\nORIGIN_SZTMSZ02  1.7271575  0.0049219   350.914  &lt; 2e-16 ***\nORIGIN_SZTMSZ03  0.9891319  0.0052266   189.250  &lt; 2e-16 ***\nORIGIN_SZTMSZ04  0.2018090  0.0062114    32.490  &lt; 2e-16 ***\nORIGIN_SZTMSZ05 -1.1882870  0.0125842   -94.427  &lt; 2e-16 ***\nORIGIN_SZTNSZ01 -1.6122620  0.0141911  -113.611  &lt; 2e-16 ***\nORIGIN_SZTNSZ02 -1.5630967  0.0112227  -139.280  &lt; 2e-16 ***\nORIGIN_SZTNSZ03 -2.0739538  0.0149298  -138.914  &lt; 2e-16 ***\nORIGIN_SZTNSZ04 -0.2816960  0.0085295   -33.026  &lt; 2e-16 ***\nORIGIN_SZTPSZ01 -0.7822239  0.0077901  -100.412  &lt; 2e-16 ***\nORIGIN_SZTPSZ02  0.5735478  0.0053042   108.131  &lt; 2e-16 ***\nORIGIN_SZTPSZ03 -0.8748650  0.0074202  -117.903  &lt; 2e-16 ***\nORIGIN_SZTPSZ04 -0.8537831  0.0069792  -122.332  &lt; 2e-16 ***\nORIGIN_SZTPSZ05 -0.5581114  0.0077012   -72.471  &lt; 2e-16 ***\nORIGIN_SZTPSZ06  0.0262001  0.0075241     3.482 0.000497 ***\nORIGIN_SZTPSZ07 -0.5969952  0.0074272   -80.380  &lt; 2e-16 ***\nORIGIN_SZTPSZ08 -1.0537959  0.0111297   -94.683  &lt; 2e-16 ***\nORIGIN_SZTPSZ09 -0.9588508  0.0081314  -117.920  &lt; 2e-16 ***\nORIGIN_SZTPSZ10 -1.1177249  0.0089403  -125.021  &lt; 2e-16 ***\nORIGIN_SZTPSZ11 -0.2799677  0.0067135   -41.702  &lt; 2e-16 ***\nORIGIN_SZTPSZ12 -0.8898871  0.0080215  -110.938  &lt; 2e-16 ***\nORIGIN_SZTSSZ01 -2.6146463  0.0521606   -50.127  &lt; 2e-16 ***\nORIGIN_SZTSSZ02  0.1682588  0.0119965    14.026  &lt; 2e-16 ***\nORIGIN_SZTSSZ03  0.2587653  0.0123809    20.900  &lt; 2e-16 ***\nORIGIN_SZTSSZ04 -0.5473825  0.0135215   -40.482  &lt; 2e-16 ***\nORIGIN_SZTSSZ05 -0.9967379  0.0206068   -48.369  &lt; 2e-16 ***\nORIGIN_SZTSSZ06  0.4933147  0.0229597    21.486  &lt; 2e-16 ***\nORIGIN_SZWCSZ01  1.2524706  0.0111133   112.700  &lt; 2e-16 ***\nORIGIN_SZWCSZ02 -2.8544820  0.0347805   -82.071  &lt; 2e-16 ***\nORIGIN_SZWCSZ03 -5.1277334  0.1475585   -34.751  &lt; 2e-16 ***\nORIGIN_SZWDSZ01  1.4725308  0.0056496   260.645  &lt; 2e-16 ***\nORIGIN_SZWDSZ02  0.1571680  0.0064909    24.214  &lt; 2e-16 ***\nORIGIN_SZWDSZ03  1.2584097  0.0061471   204.717  &lt; 2e-16 ***\nORIGIN_SZWDSZ04  0.8578765  0.0069277   123.833  &lt; 2e-16 ***\nORIGIN_SZWDSZ05  0.1702728  0.0069687    24.434  &lt; 2e-16 ***\nORIGIN_SZWDSZ06  0.1736910  0.0069507    24.989  &lt; 2e-16 ***\nORIGIN_SZWDSZ07 -1.5610176  0.0100803  -154.859  &lt; 2e-16 ***\nORIGIN_SZWDSZ08 -0.9490906  0.0102047   -93.005  &lt; 2e-16 ***\nORIGIN_SZWDSZ09  1.2107011  0.0062294   194.354  &lt; 2e-16 ***\nORIGIN_SZYSSZ01 -0.3324158  0.0074537   -44.598  &lt; 2e-16 ***\nORIGIN_SZYSSZ02  0.8177113  0.0066108   123.693  &lt; 2e-16 ***\nORIGIN_SZYSSZ03  1.6751777  0.0058470   286.503  &lt; 2e-16 ***\nORIGIN_SZYSSZ04  0.8130044  0.0059025   137.738  &lt; 2e-16 ***\nORIGIN_SZYSSZ05  0.3678420  0.0072431    50.785  &lt; 2e-16 ***\nORIGIN_SZYSSZ06 -0.6024384  0.0126722   -47.540  &lt; 2e-16 ***\nORIGIN_SZYSSZ07 -0.7631918  0.0158478   -48.157  &lt; 2e-16 ***\nORIGIN_SZYSSZ08  0.2141930  0.0076154    28.126  &lt; 2e-16 ***\nORIGIN_SZYSSZ09  1.0809368  0.0057973   186.457  &lt; 2e-16 ***\nDESTIN_SZAMSZ02  0.0761304  0.0051207    14.867  &lt; 2e-16 ***\nDESTIN_SZAMSZ03  0.0143394  0.0050755     2.825 0.004724 ** \nDESTIN_SZAMSZ04 -1.2516780  0.0074947  -167.008  &lt; 2e-16 ***\nDESTIN_SZAMSZ05 -1.2312375  0.0076598  -160.741  &lt; 2e-16 ***\nDESTIN_SZAMSZ06 -1.0333412  0.0075283  -137.261  &lt; 2e-16 ***\nDESTIN_SZAMSZ07 -1.5338249  0.0110036  -139.392  &lt; 2e-16 ***\nDESTIN_SZAMSZ08 -0.3751665  0.0075358   -49.784  &lt; 2e-16 ***\nDESTIN_SZAMSZ09 -1.1633493  0.0077556  -150.001  &lt; 2e-16 ***\nDESTIN_SZAMSZ10  0.1017717  0.0053151    19.148  &lt; 2e-16 ***\nDESTIN_SZAMSZ11 -0.8840362  0.0097007   -91.131  &lt; 2e-16 ***\nDESTIN_SZAMSZ12  0.1628123  0.0055220    29.484  &lt; 2e-16 ***\nDESTIN_SZBDSZ01  1.0040794  0.0047922   209.523  &lt; 2e-16 ***\nDESTIN_SZBDSZ02 -0.2478149  0.0063085   -39.283  &lt; 2e-16 ***\nDESTIN_SZBDSZ03  0.1016088  0.0057420    17.696  &lt; 2e-16 ***\nDESTIN_SZBDSZ04  1.1082928  0.0047747   232.116  &lt; 2e-16 ***\nDESTIN_SZBDSZ05  0.8737933  0.0050593   172.712  &lt; 2e-16 ***\nDESTIN_SZBDSZ06  0.2897032  0.0058244    49.740  &lt; 2e-16 ***\nDESTIN_SZBDSZ07 -0.9026193  0.0113656   -79.416  &lt; 2e-16 ***\nDESTIN_SZBDSZ08 -1.7063577  0.0131234  -130.024  &lt; 2e-16 ***\nDESTIN_SZBKSZ01 -1.3892839  0.0083307  -166.767  &lt; 2e-16 ***\nDESTIN_SZBKSZ02 -0.6661120  0.0073464   -90.672  &lt; 2e-16 ***\nDESTIN_SZBKSZ03 -0.9536826  0.0073196  -130.292  &lt; 2e-16 ***\nDESTIN_SZBKSZ04 -0.6655610  0.0065868  -101.044  &lt; 2e-16 ***\nDESTIN_SZBKSZ05 -0.9053119  0.0079264  -114.215  &lt; 2e-16 ***\nDESTIN_SZBKSZ06 -1.2622159  0.0075079  -168.119  &lt; 2e-16 ***\nDESTIN_SZBKSZ07 -0.0423370  0.0056686    -7.469 8.10e-14 ***\nDESTIN_SZBKSZ08 -1.3811240  0.0084985  -162.515  &lt; 2e-16 ***\nDESTIN_SZBKSZ09 -0.0797012  0.0061428   -12.975  &lt; 2e-16 ***\nDESTIN_SZBLSZ01 -0.8859670  0.0088108  -100.555  &lt; 2e-16 ***\nDESTIN_SZBLSZ02  0.1362723  0.0082167    16.585  &lt; 2e-16 ***\nDESTIN_SZBLSZ03  1.2037396  0.0093508   128.732  &lt; 2e-16 ***\nDESTIN_SZBLSZ04 -0.9316219  0.0178080   -52.315  &lt; 2e-16 ***\nDESTIN_SZBMSZ01  0.7188470  0.0061160   117.536  &lt; 2e-16 ***\nDESTIN_SZBMSZ02 -0.0597895  0.0061206    -9.769  &lt; 2e-16 ***\nDESTIN_SZBMSZ03 -0.2427075  0.0069937   -34.704  &lt; 2e-16 ***\nDESTIN_SZBMSZ04 -0.0622494  0.0065569    -9.494  &lt; 2e-16 ***\nDESTIN_SZBMSZ05 -0.2857019  0.0086450   -33.048  &lt; 2e-16 ***\nDESTIN_SZBMSZ06 -1.3486558  0.0158904   -84.872  &lt; 2e-16 ***\nDESTIN_SZBMSZ07  0.4549687  0.0058315    78.020  &lt; 2e-16 ***\nDESTIN_SZBMSZ08 -0.8730268  0.0077814  -112.195  &lt; 2e-16 ***\nDESTIN_SZBMSZ09 -2.0319890  0.0163038  -124.633  &lt; 2e-16 ***\nDESTIN_SZBMSZ10 -1.4319101  0.0102616  -139.541  &lt; 2e-16 ***\nDESTIN_SZBMSZ11 -1.2429176  0.0092250  -134.733  &lt; 2e-16 ***\nDESTIN_SZBMSZ12 -0.8526549  0.0096009   -88.810  &lt; 2e-16 ***\nDESTIN_SZBMSZ13  0.1399907  0.0066885    20.930  &lt; 2e-16 ***\nDESTIN_SZBMSZ14 -1.0103155  0.0091377  -110.566  &lt; 2e-16 ***\nDESTIN_SZBMSZ15 -0.6819769  0.0086179   -79.135  &lt; 2e-16 ***\nDESTIN_SZBMSZ16 -1.4468308  0.0134051  -107.931  &lt; 2e-16 ***\nDESTIN_SZBMSZ17 -1.5312175  0.0186843   -81.952  &lt; 2e-16 ***\nDESTIN_SZBPSZ01 -1.1726725  0.0073257  -160.077  &lt; 2e-16 ***\nDESTIN_SZBPSZ02 -2.1072012  0.0103320  -203.949  &lt; 2e-16 ***\nDESTIN_SZBPSZ03 -1.6944911  0.0098520  -171.995  &lt; 2e-16 ***\nDESTIN_SZBPSZ04 -0.7664610  0.0074458  -102.939  &lt; 2e-16 ***\nDESTIN_SZBPSZ05  0.1358370  0.0056258    24.145  &lt; 2e-16 ***\nDESTIN_SZBPSZ06 -1.2425471  0.0096942  -128.175  &lt; 2e-16 ***\nDESTIN_SZBPSZ07 -0.1666192  0.0094969   -17.545  &lt; 2e-16 ***\nDESTIN_SZBSSZ01  0.3857894  0.0057261    67.374  &lt; 2e-16 ***\nDESTIN_SZBSSZ02 -0.5293265  0.0064886   -81.578  &lt; 2e-16 ***\nDESTIN_SZBSSZ03  0.3909966  0.0048540    80.551  &lt; 2e-16 ***\nDESTIN_SZBTSZ01  0.7114965  0.0054528   130.482  &lt; 2e-16 ***\nDESTIN_SZBTSZ02 -0.0487084  0.0082474    -5.906 3.51e-09 ***\nDESTIN_SZBTSZ03  0.5539032  0.0064423    85.979  &lt; 2e-16 ***\nDESTIN_SZBTSZ04 -0.7120734  0.0128676   -55.339  &lt; 2e-16 ***\nDESTIN_SZBTSZ05  0.2176097  0.0086791    25.073  &lt; 2e-16 ***\nDESTIN_SZBTSZ06 -0.2167084  0.0084925   -25.518  &lt; 2e-16 ***\nDESTIN_SZBTSZ07 -1.4045618  0.0124363  -112.940  &lt; 2e-16 ***\nDESTIN_SZBTSZ08 -0.8213918  0.0120793   -68.000  &lt; 2e-16 ***\nDESTIN_SZCBSZ01 -5.7340877  0.3333916   -17.199  &lt; 2e-16 ***\nDESTIN_SZCCSZ01 -0.0304192  0.0095920    -3.171 0.001518 ** \nDESTIN_SZCHSZ01 -0.2598507  0.0115311   -22.535  &lt; 2e-16 ***\nDESTIN_SZCHSZ02  0.3497750  0.0068334    51.186  &lt; 2e-16 ***\nDESTIN_SZCHSZ03  2.4550172  0.0050883   482.481  &lt; 2e-16 ***\nDESTIN_SZCKSZ01 -0.4691744  0.0063130   -74.319  &lt; 2e-16 ***\nDESTIN_SZCKSZ02 -0.9557084  0.0069331  -137.847  &lt; 2e-16 ***\nDESTIN_SZCKSZ03  0.0442112  0.0057117     7.740 9.91e-15 ***\nDESTIN_SZCKSZ04 -0.8592063  0.0081238  -105.764  &lt; 2e-16 ***\nDESTIN_SZCKSZ05 -1.1745333  0.0087305  -134.532  &lt; 2e-16 ***\nDESTIN_SZCKSZ06 -0.4982877  0.0085514   -58.269  &lt; 2e-16 ***\nDESTIN_SZCLSZ01  0.2665065  0.0059712    44.632  &lt; 2e-16 ***\nDESTIN_SZCLSZ02 -1.9758876  0.0150823  -131.007  &lt; 2e-16 ***\nDESTIN_SZCLSZ03 -0.9051310  0.0091479   -98.944  &lt; 2e-16 ***\nDESTIN_SZCLSZ04 -0.0828732  0.0061559   -13.462  &lt; 2e-16 ***\nDESTIN_SZCLSZ05 -1.1414780  0.0100760  -113.287  &lt; 2e-16 ***\nDESTIN_SZCLSZ06  0.3229402  0.0056269    57.392  &lt; 2e-16 ***\nDESTIN_SZCLSZ07 -0.4833612  0.0069777   -69.272  &lt; 2e-16 ***\nDESTIN_SZCLSZ08 -0.3219670  0.0075615   -42.580  &lt; 2e-16 ***\nDESTIN_SZCLSZ09  0.0564166  0.0080703     6.991 2.74e-12 ***\nDESTIN_SZDTSZ02 -1.6384236  0.0374725   -43.723  &lt; 2e-16 ***\nDESTIN_SZDTSZ03 -0.4021571  0.0152716   -26.334  &lt; 2e-16 ***\nDESTIN_SZDTSZ13 -1.2799441  0.0177095   -72.274  &lt; 2e-16 ***\nDESTIN_SZGLSZ01 -0.0190303  0.0060665    -3.137 0.001707 ** \nDESTIN_SZGLSZ02 -0.0308469  0.0058724    -5.253 1.50e-07 ***\nDESTIN_SZGLSZ03  0.6927638  0.0048456   142.969  &lt; 2e-16 ***\nDESTIN_SZGLSZ04  0.9325848  0.0049183   189.616  &lt; 2e-16 ***\nDESTIN_SZGLSZ05  0.8480056  0.0048801   173.768  &lt; 2e-16 ***\nDESTIN_SZHGSZ01  0.0652969  0.0047795    13.662  &lt; 2e-16 ***\nDESTIN_SZHGSZ02 -0.9498251  0.0066577  -142.667  &lt; 2e-16 ***\nDESTIN_SZHGSZ03 -1.4372499  0.0076387  -188.154  &lt; 2e-16 ***\nDESTIN_SZHGSZ04 -0.5236292  0.0055353   -94.599  &lt; 2e-16 ***\nDESTIN_SZHGSZ05 -0.5420295  0.0058099   -93.295  &lt; 2e-16 ***\nDESTIN_SZHGSZ06 -0.9054730  0.0067581  -133.983  &lt; 2e-16 ***\nDESTIN_SZHGSZ07  0.0215109  0.0054019     3.982 6.83e-05 ***\nDESTIN_SZHGSZ08 -0.0490979  0.0059206    -8.293  &lt; 2e-16 ***\nDESTIN_SZHGSZ09 -0.0711560  0.0062875   -11.317  &lt; 2e-16 ***\nDESTIN_SZHGSZ10 -3.5807154  0.0290642  -123.200  &lt; 2e-16 ***\nDESTIN_SZJESZ01 -0.4023638  0.0065057   -61.848  &lt; 2e-16 ***\nDESTIN_SZJESZ02 -0.7654353  0.0067096  -114.081  &lt; 2e-16 ***\nDESTIN_SZJESZ03 -0.8778812  0.0071238  -123.232  &lt; 2e-16 ***\nDESTIN_SZJESZ04 -1.1998075  0.0088733  -135.215  &lt; 2e-16 ***\nDESTIN_SZJESZ05 -1.5623652  0.0116898  -133.652  &lt; 2e-16 ***\nDESTIN_SZJESZ06  0.2311474  0.0055595    41.577  &lt; 2e-16 ***\nDESTIN_SZJESZ07 -1.2753348  0.0094838  -134.475  &lt; 2e-16 ***\nDESTIN_SZJESZ08 -0.7654533  0.0099306   -77.081  &lt; 2e-16 ***\nDESTIN_SZJESZ09  0.1637628  0.0074164    22.081  &lt; 2e-16 ***\nDESTIN_SZJESZ10  0.7394958  0.0091249    81.041  &lt; 2e-16 ***\nDESTIN_SZJESZ11  0.5157364  0.0086546    59.591  &lt; 2e-16 ***\nDESTIN_SZJWSZ01 -1.0165204  0.0083025  -122.435  &lt; 2e-16 ***\nDESTIN_SZJWSZ02 -0.8530646  0.0067851  -125.727  &lt; 2e-16 ***\nDESTIN_SZJWSZ03  0.5176135  0.0056449    91.695  &lt; 2e-16 ***\nDESTIN_SZJWSZ04  0.3427105  0.0058499    58.584  &lt; 2e-16 ***\nDESTIN_SZJWSZ05 -1.1695940  0.0080069  -146.073  &lt; 2e-16 ***\nDESTIN_SZJWSZ06 -0.7466462  0.0070240  -106.299  &lt; 2e-16 ***\nDESTIN_SZJWSZ07 -3.0124535  0.0333481   -90.334  &lt; 2e-16 ***\nDESTIN_SZJWSZ08 -0.4253502  0.0066584   -63.881  &lt; 2e-16 ***\nDESTIN_SZJWSZ09  0.9428005  0.0053190   177.251  &lt; 2e-16 ***\nDESTIN_SZKLSZ01 -0.2965013  0.0066422   -44.639  &lt; 2e-16 ***\nDESTIN_SZKLSZ02 -0.4921137  0.0067689   -72.702  &lt; 2e-16 ***\nDESTIN_SZKLSZ03 -0.8489213  0.0078294  -108.427  &lt; 2e-16 ***\nDESTIN_SZKLSZ04 -1.2656342  0.0099918  -126.667  &lt; 2e-16 ***\nDESTIN_SZKLSZ05 -0.3570126  0.0096300   -37.073  &lt; 2e-16 ***\nDESTIN_SZKLSZ06 -2.4764906  0.0390868   -63.359  &lt; 2e-16 ***\nDESTIN_SZKLSZ07 -0.7316189  0.0080994   -90.330  &lt; 2e-16 ***\nDESTIN_SZKLSZ08 -0.1115398  0.0061168   -18.235  &lt; 2e-16 ***\nDESTIN_SZLKSZ01 -1.4940710  0.0271518   -55.027  &lt; 2e-16 ***\nDESTIN_SZMDSZ01 -1.6101440  0.0231238   -69.631  &lt; 2e-16 ***\nDESTIN_SZMDSZ02 -0.9339318  0.0126277   -73.959  &lt; 2e-16 ***\nDESTIN_SZMDSZ03 -3.4868547  0.0303657  -114.829  &lt; 2e-16 ***\nDESTIN_SZMPSZ01 -0.4518483  0.0089869   -50.279  &lt; 2e-16 ***\nDESTIN_SZMPSZ02 -0.5868264  0.0073193   -80.176  &lt; 2e-16 ***\nDESTIN_SZMPSZ03  0.4805365  0.0059041    81.391  &lt; 2e-16 ***\nDESTIN_SZMUSZ02 -1.3837581  0.0218713   -63.268  &lt; 2e-16 ***\nDESTIN_SZNTSZ01 -3.0694691  0.0533346   -57.551  &lt; 2e-16 ***\nDESTIN_SZNTSZ02 -1.4992973  0.0130358  -115.014  &lt; 2e-16 ***\nDESTIN_SZNTSZ03 -0.5221236  0.0089923   -58.064  &lt; 2e-16 ***\nDESTIN_SZNTSZ05 -1.9751162  0.0282369   -69.948  &lt; 2e-16 ***\nDESTIN_SZNTSZ06 -3.9959411  0.0511214   -78.166  &lt; 2e-16 ***\nDESTIN_SZNVSZ01 -0.1126966  0.0057077   -19.745  &lt; 2e-16 ***\nDESTIN_SZNVSZ02 -0.0259250  0.0064427    -4.024 5.72e-05 ***\nDESTIN_SZNVSZ03 -0.0123214  0.0067692    -1.820 0.068725 .  \nDESTIN_SZNVSZ04 -1.3371298  0.0130261  -102.650  &lt; 2e-16 ***\nDESTIN_SZNVSZ05 -0.9686333  0.0101539   -95.395  &lt; 2e-16 ***\nDESTIN_SZPGSZ01 -1.1798309  0.0180543   -65.349  &lt; 2e-16 ***\nDESTIN_SZPGSZ02 -1.3289737  0.0085335  -155.736  &lt; 2e-16 ***\nDESTIN_SZPGSZ03 -0.1661373  0.0055166   -30.116  &lt; 2e-16 ***\nDESTIN_SZPGSZ04 -0.3046408  0.0058469   -52.103  &lt; 2e-16 ***\nDESTIN_SZPGSZ05 -1.5412612  0.0093261  -165.264  &lt; 2e-16 ***\nDESTIN_SZPLSZ01 -0.3439667  0.0083504   -41.192  &lt; 2e-16 ***\nDESTIN_SZPLSZ02 -1.7574919  0.0154244  -113.942  &lt; 2e-16 ***\nDESTIN_SZPLSZ03 -0.3455776  0.0112089   -30.831  &lt; 2e-16 ***\nDESTIN_SZPLSZ04 -2.0749385  0.0141153  -146.999  &lt; 2e-16 ***\nDESTIN_SZPLSZ05 -0.4855216  0.0134069   -36.214  &lt; 2e-16 ***\nDESTIN_SZPNSZ01  0.0117816  0.0083558     1.410 0.158543    \nDESTIN_SZPNSZ02  0.7389858  0.0089823    82.272  &lt; 2e-16 ***\nDESTIN_SZPNSZ03 -0.4708719  0.0098588   -47.761  &lt; 2e-16 ***\nDESTIN_SZPNSZ04  1.3156771  0.0111200   118.316  &lt; 2e-16 ***\nDESTIN_SZPNSZ05  0.9881886  0.0153169    64.516  &lt; 2e-16 ***\nDESTIN_SZPRSZ01 -1.0678999  0.0098295  -108.642  &lt; 2e-16 ***\nDESTIN_SZPRSZ02  0.0650279  0.0063927    10.172  &lt; 2e-16 ***\nDESTIN_SZPRSZ03  0.6348138  0.0050147   126.592  &lt; 2e-16 ***\nDESTIN_SZPRSZ04 -0.3640286  0.0097572   -37.309  &lt; 2e-16 ***\nDESTIN_SZPRSZ05  0.0380410  0.0062577     6.079 1.21e-09 ***\nDESTIN_SZPRSZ06  0.3153712  0.0068742    45.877  &lt; 2e-16 ***\nDESTIN_SZPRSZ07 -1.6669973  0.0145573  -114.513  &lt; 2e-16 ***\nDESTIN_SZPRSZ08 -0.6170648  0.0078424   -78.683  &lt; 2e-16 ***\nDESTIN_SZQTSZ01 -0.5496582  0.0098285   -55.925  &lt; 2e-16 ***\nDESTIN_SZQTSZ02 -0.7318114  0.0086807   -84.303  &lt; 2e-16 ***\nDESTIN_SZQTSZ03 -0.5893064  0.0084789   -69.503  &lt; 2e-16 ***\nDESTIN_SZQTSZ04 -0.7103906  0.0085341   -83.242  &lt; 2e-16 ***\nDESTIN_SZQTSZ05 -0.4721472  0.0078164   -60.405  &lt; 2e-16 ***\nDESTIN_SZQTSZ06 -0.6591466  0.0080069   -82.322  &lt; 2e-16 ***\nDESTIN_SZQTSZ07 -0.9540454  0.0126807   -75.236  &lt; 2e-16 ***\nDESTIN_SZQTSZ08  0.4508867  0.0064870    69.507  &lt; 2e-16 ***\nDESTIN_SZQTSZ09 -0.4061810  0.0075485   -53.810  &lt; 2e-16 ***\nDESTIN_SZQTSZ10  0.1351889  0.0068202    19.822  &lt; 2e-16 ***\nDESTIN_SZQTSZ11  0.3181553  0.0067958    46.816  &lt; 2e-16 ***\nDESTIN_SZQTSZ12 -0.1055766  0.0095576   -11.046  &lt; 2e-16 ***\nDESTIN_SZQTSZ13  0.5199663  0.0071928    72.290  &lt; 2e-16 ***\nDESTIN_SZQTSZ14  0.6086332  0.0078537    77.496  &lt; 2e-16 ***\nDESTIN_SZQTSZ15  1.3906866  0.0092250   150.753  &lt; 2e-16 ***\nDESTIN_SZRCSZ01 -0.0862091  0.0085363   -10.099  &lt; 2e-16 ***\nDESTIN_SZRCSZ06 -1.0186282  0.0211113   -48.250  &lt; 2e-16 ***\nDESTIN_SZRVSZ01 -1.5294454  0.0179337   -85.283  &lt; 2e-16 ***\nDESTIN_SZRVSZ02 -2.3607754  0.0355628   -66.383  &lt; 2e-16 ***\nDESTIN_SZRVSZ03 -1.5266254  0.0156276   -97.688  &lt; 2e-16 ***\nDESTIN_SZRVSZ04 -1.0986565  0.0168695   -65.127  &lt; 2e-16 ***\nDESTIN_SZRVSZ05 -2.4004418  0.0320917   -74.799  &lt; 2e-16 ***\nDESTIN_SZSBSZ01 -1.4023966  0.0109496  -128.078  &lt; 2e-16 ***\nDESTIN_SZSBSZ02 -1.3899893  0.0090891  -152.929  &lt; 2e-16 ***\nDESTIN_SZSBSZ03  0.4509008  0.0059864    75.321  &lt; 2e-16 ***\nDESTIN_SZSBSZ04  0.1796309  0.0070142    25.610  &lt; 2e-16 ***\nDESTIN_SZSBSZ05 -1.3159699  0.0096485  -136.391  &lt; 2e-16 ***\nDESTIN_SZSBSZ06 -1.7705263  0.0253064   -69.964  &lt; 2e-16 ***\nDESTIN_SZSBSZ07 -0.7471529  0.0238628   -31.310  &lt; 2e-16 ***\nDESTIN_SZSBSZ08  0.7884520  0.0069638   113.221  &lt; 2e-16 ***\nDESTIN_SZSBSZ09  0.0131702  0.0066350     1.985 0.047150 *  \nDESTIN_SZSESZ02 -0.7247347  0.0060626  -119.541  &lt; 2e-16 ***\nDESTIN_SZSESZ03  0.1032728  0.0048330    21.368  &lt; 2e-16 ***\nDESTIN_SZSESZ04 -1.0992420  0.0068328  -160.878  &lt; 2e-16 ***\nDESTIN_SZSESZ05 -0.8374712  0.0058155  -144.006  &lt; 2e-16 ***\nDESTIN_SZSESZ06 -0.5531619  0.0074766   -73.985  &lt; 2e-16 ***\nDESTIN_SZSESZ07 -3.0328672  0.0246371  -123.101  &lt; 2e-16 ***\nDESTIN_SZSGSZ01 -0.1933777  0.0068235   -28.340  &lt; 2e-16 ***\nDESTIN_SZSGSZ02 -0.3000845  0.0060284   -49.779  &lt; 2e-16 ***\nDESTIN_SZSGSZ03 -0.4322879  0.0057308   -75.433  &lt; 2e-16 ***\nDESTIN_SZSGSZ04 -0.1214792  0.0056548   -21.482  &lt; 2e-16 ***\nDESTIN_SZSGSZ05 -2.0309074  0.0114993  -176.611  &lt; 2e-16 ***\nDESTIN_SZSGSZ06  0.6592095  0.0046364   142.182  &lt; 2e-16 ***\nDESTIN_SZSGSZ07 -0.4618538  0.0062027   -74.460  &lt; 2e-16 ***\nDESTIN_SZSISZ01 -0.5227257  0.0293399   -17.816  &lt; 2e-16 ***\nDESTIN_SZSKSZ01 -0.4797341  0.0091087   -52.668  &lt; 2e-16 ***\nDESTIN_SZSKSZ02  0.8477357  0.0067821   124.996  &lt; 2e-16 ***\nDESTIN_SZSKSZ03 -0.2477566  0.0074817   -33.115  &lt; 2e-16 ***\nDESTIN_SZSKSZ04 -1.3315992  0.0167055   -79.710  &lt; 2e-16 ***\nDESTIN_SZSKSZ05 -0.3519096  0.0131326   -26.797  &lt; 2e-16 ***\nDESTIN_SZSLSZ01 -0.8570431  0.0102100   -83.941  &lt; 2e-16 ***\nDESTIN_SZSLSZ04 -0.9949105  0.0088280  -112.699  &lt; 2e-16 ***\nDESTIN_SZSRSZ01 -1.0260696  0.0154393   -66.458  &lt; 2e-16 ***\nDESTIN_SZTHSZ01 -4.2040410  0.0404795  -103.856  &lt; 2e-16 ***\nDESTIN_SZTHSZ03 -2.4907000  0.0264056   -94.325  &lt; 2e-16 ***\nDESTIN_SZTHSZ04 -3.0701470  0.0244975  -125.325  &lt; 2e-16 ***\nDESTIN_SZTHSZ06 -2.5308161  0.0169699  -149.135  &lt; 2e-16 ***\nDESTIN_SZTMSZ01 -0.2354889  0.0067201   -35.042  &lt; 2e-16 ***\nDESTIN_SZTMSZ02  1.7379292  0.0044573   389.906  &lt; 2e-16 ***\nDESTIN_SZTMSZ03  0.9112458  0.0048718   187.043  &lt; 2e-16 ***\nDESTIN_SZTMSZ04  1.0731075  0.0048626   220.685  &lt; 2e-16 ***\nDESTIN_SZTMSZ05  0.6398583  0.0067321    95.046  &lt; 2e-16 ***\nDESTIN_SZTNSZ01 -0.3500456  0.0083835   -41.754  &lt; 2e-16 ***\nDESTIN_SZTNSZ02 -1.0573515  0.0112412   -94.060  &lt; 2e-16 ***\nDESTIN_SZTNSZ03 -1.4069979  0.0132733  -106.002  &lt; 2e-16 ***\nDESTIN_SZTNSZ04 -0.3616604  0.0085207   -42.445  &lt; 2e-16 ***\nDESTIN_SZTPSZ01 -0.5919243  0.0071153   -83.190  &lt; 2e-16 ***\nDESTIN_SZTPSZ02  0.7083350  0.0046540   152.198  &lt; 2e-16 ***\nDESTIN_SZTPSZ03 -0.5746433  0.0069625   -82.534  &lt; 2e-16 ***\nDESTIN_SZTPSZ04 -1.5821259  0.0084517  -187.196  &lt; 2e-16 ***\nDESTIN_SZTPSZ05 -1.1796256  0.0073039  -161.505  &lt; 2e-16 ***\nDESTIN_SZTPSZ06 -0.3968272  0.0077295   -51.339  &lt; 2e-16 ***\nDESTIN_SZTPSZ07 -2.1796617  0.0135199  -161.219  &lt; 2e-16 ***\nDESTIN_SZTPSZ08 -1.2568483  0.0107267  -117.170  &lt; 2e-16 ***\nDESTIN_SZTPSZ09 -0.2446623  0.0080840   -30.265  &lt; 2e-16 ***\nDESTIN_SZTPSZ10 -1.2542191  0.0102049  -122.904  &lt; 2e-16 ***\nDESTIN_SZTPSZ11 -0.0886883  0.0062888   -14.102  &lt; 2e-16 ***\nDESTIN_SZTPSZ12 -0.7211823  0.0075086   -96.048  &lt; 2e-16 ***\nDESTIN_SZTSSZ01 -1.6271921  0.0238498   -68.227  &lt; 2e-16 ***\nDESTIN_SZTSSZ02 -0.3340439  0.0169137   -19.750  &lt; 2e-16 ***\nDESTIN_SZTSSZ03  0.3924580  0.0111060    35.338  &lt; 2e-16 ***\nDESTIN_SZTSSZ04  0.4169932  0.0114926    36.283  &lt; 2e-16 ***\nDESTIN_SZTSSZ05  1.3206287  0.0120381   109.704  &lt; 2e-16 ***\nDESTIN_SZTSSZ06  2.4023725  0.0192840   124.579  &lt; 2e-16 ***\nDESTIN_SZWCSZ01  2.0697378  0.0061379   337.206  &lt; 2e-16 ***\nDESTIN_SZWCSZ02 -2.0934025  0.0134782  -155.318  &lt; 2e-16 ***\nDESTIN_SZWCSZ03 -3.0670149  0.0349748   -87.692  &lt; 2e-16 ***\nDESTIN_SZWDSZ01  1.0113215  0.0051461   196.522  &lt; 2e-16 ***\nDESTIN_SZWDSZ02 -1.3383793  0.0076482  -174.993  &lt; 2e-16 ***\nDESTIN_SZWDSZ03  0.3394361  0.0060396    56.202  &lt; 2e-16 ***\nDESTIN_SZWDSZ04 -0.8324928  0.0086019   -96.780  &lt; 2e-16 ***\nDESTIN_SZWDSZ05 -0.8279090  0.0083251   -99.447  &lt; 2e-16 ***\nDESTIN_SZWDSZ06 -0.2252899  0.0061074   -36.888  &lt; 2e-16 ***\nDESTIN_SZWDSZ07 -1.3638599  0.0077990  -174.877  &lt; 2e-16 ***\nDESTIN_SZWDSZ08 -0.4350176  0.0077566   -56.083  &lt; 2e-16 ***\nDESTIN_SZWDSZ09  0.5461048  0.0060745    89.901  &lt; 2e-16 ***\nDESTIN_SZYSSZ01  0.0243093  0.0053476     4.546 5.47e-06 ***\nDESTIN_SZYSSZ02 -0.3398962  0.0065947   -51.540  &lt; 2e-16 ***\nDESTIN_SZYSSZ03 -0.3694187  0.0074032   -49.900  &lt; 2e-16 ***\nDESTIN_SZYSSZ04 -0.5222848  0.0067396   -77.495  &lt; 2e-16 ***\nDESTIN_SZYSSZ05 -1.5460539  0.0124899  -123.784  &lt; 2e-16 ***\nDESTIN_SZYSSZ06 -1.5556892  0.0127640  -121.881  &lt; 2e-16 ***\nDESTIN_SZYSSZ07 -0.8673403  0.0167723   -51.713  &lt; 2e-16 ***\nDESTIN_SZYSSZ08  0.5389364  0.0052540   102.577  &lt; 2e-16 ***\nDESTIN_SZYSSZ09  0.1199483  0.0055235    21.716  &lt; 2e-16 ***\nlog(dist)       -1.8906989  0.0005319 -3554.786  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 36117615  on 14273  degrees of freedom\nResidual deviance:  8091747  on 13715  degrees of freedom\nAIC: 8177420\n\nNumber of Fisher Scoring iterations: 7\n\n\nWe can examine how the constraints hold for destinations this time.\n\nCalcRSquared(dbcSIM$data$TRIPS, dbcSIM$fitted.values)\n\n[1] 0.6883675\n\n\nNotice that there is a relatively greater improvement in the R^2 value.\n\n\nModel comparison\nAnother useful model performance measure for continuous dependent variable is Root Mean Squared Error. In this sub-section, you will learn how to use compare_performance() of performance package\nFirst of all, let us create a list called model_list by using the code chun below.\n\nmodel_list &lt;- list(unconstrained=uncSIM,\n                   originConstrained=orcSIM,\n                   destinationConstrained=decSIM,\n                   doublyConstrained=dbcSIM)\n\nNext, we will compute the RMSE of all the models in model_list file by using the code chunk below.\n\ncompare_performance(model_list,\n                    metrics = \"RMSE\")\n\n# Comparison of Model Performance Indices\n\nName                   | Model |     RMSE\n-----------------------------------------\nunconstrained          |   glm | 2429.978\noriginConstrained      |   glm | 2057.579\ndestinationConstrained |   glm | 1891.724\ndoublyConstrained      |   glm | 1487.111\n\n\nThe print above reveals that doubly constrained SIM is the best model among all the four SIMs because it has the smallest RMSE value of 1487.111.\n\n\nVisualising fitted\nIn this section, you will learn how to visualise the observed values and the fitted values.\nFirstly we will extract the fitted values from each model by using the code chunk below.\n\ndf &lt;- as.data.frame(uncSIM$fitted.values) %&gt;%\n  round(digits = 0)\n\nNext, we will join the values to SIM_data data frame.\n\nSIM_data &lt;- SIM_data %&gt;%\n  cbind(df) %&gt;%\n  rename(uncTRIPS = \"uncSIM$fitted.values\")\n\nRepeat the same step by for Origin Constrained SIM (i.e. orcSIM)\n\ndf &lt;- as.data.frame(orcSIM$fitted.values) %&gt;%\n  round(digits = 0)\n\n\nSIM_data &lt;- SIM_data %&gt;%\n  cbind(df) %&gt;%\n  rename(orcTRIPS = \"orcSIM$fitted.values\")\n\nRepeat the same step by for Destination Constrained SIM (i.e. decSIM)\n\ndf &lt;- as.data.frame(decSIM$fitted.values) %&gt;%\n  round(digits = 0)\n\n\nSIM_data &lt;- SIM_data %&gt;%\n  cbind(df) %&gt;%\n  rename(decTRIPS = \"decSIM$fitted.values\")\n\nRepeat the same step by for Doubly Constrained SIM (i.e. dbcSIM)\n\ndf &lt;- as.data.frame(dbcSIM$fitted.values) %&gt;%\n  round(digits = 0)\n\n\nSIM_data &lt;- SIM_data %&gt;%\n  cbind(df) %&gt;%\n  rename(dbcTRIPS = \"dbcSIM$fitted.values\")\n\n\nunc_p &lt;- ggplot(data = SIM_data,\n                aes(x = uncTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\norc_p &lt;- ggplot(data = SIM_data,\n                aes(x = orcTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\ndec_p &lt;- ggplot(data = SIM_data,\n                aes(x = decTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\ndbc_p &lt;- ggplot(data = SIM_data,\n                aes(x = dbcTRIPS,\n                    y = TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm)\n\nggarrange(unc_p, orc_p, dec_p, dbc_p,\n          ncol = 2,\n          nrow = 2)"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1/data/geospatial/MPSZ-2019.html",
    "href": "Take-home_Ex/Take-home_Ex1/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "Find out more about geospatial analytics from TSKAM!"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#objective",
    "href": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#objective",
    "title": "Take-home_Ex1",
    "section": "",
    "text": "Everyday, many of us take buses to various destination. Some of us take a shuttle bus to MRT station to transit, some change bus reach their destination, and some have direct bus to their destination.\nLet us analyse how Singaporeans tend to transit using bus using LTA data “Passenger Volume by Origin Destination Bus Stops” downloaded from LTA DataMall"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#setting-up-the-environment",
    "href": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#setting-up-the-environment",
    "title": "Take-home_Ex1",
    "section": "Setting Up the Environment",
    "text": "Setting Up the Environment\nTo aid us in the analysis, we are using R and the associated packages. We set the stage by loading them into the environment as below\n\n\nCode\npacman::p_load(tmap, sf, tidyverse, sfdep, knitr, plotly, DT, lubridate, magick)\n\n\n\n\nCode\n#these procedures will be reused, so easier to keep them as a function\n\n#check if all unique\nisUnique &lt;- function(v){\n  return(!any(duplicated(v)))\n}\n\n\n#extract the number of rows that are not unique\nextractduplicatecount &lt;- function(v){\n  return(v %&gt;%\n    group_by_all() %&gt;%\n    filter(n()&gt;1) %&gt;%\n    ungroup() %&gt;%\n    nrow())\n}\n\n\n\nSetting the Static Basemap\nThis is the basemap of Singapore gotten from OneMap\n\n\nCode\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;% st_transform(crs = 3414)\n\n\nReading layer `MPSZ-2019' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\nThis basemap comprise of small subzones. However, we wil want to merge all into 1 singapore map. Upon the first merger the subzones seem to have some small overlap. Given our usecase, actually we don’t need it to be so precise, so we can do a further simplication via st_simplify (note: this come at a cost of precision)\n\n\nCode\n#Merge\nsgp &lt;- st_union(mpsz$geometry)\n\n# Simplify the geometry\nsgp_simple &lt;- st_simplify(sgp, dTolerance = 100) %&gt;% \n  st_as_sf() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n  \ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#first-look-at-our-bus-data",
    "href": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#first-look-at-our-bus-data",
    "title": "Take-home_Ex1",
    "section": "First Look at our BUS Data",
    "text": "First Look at our BUS Data\nWe need to load in the dataset downloaded.\n\n\nCode\nodbus202308 &lt;- read_csv(\"data/aspatial/origin_destination_bus_202308.csv\")\nglimpse(odbus202308)\n\n\nRows: 5,709,512\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2023-08\", \"2023-08\", \"2023-08\", \"2023-08\", \"2023-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKDAY\", \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 17, 7, 17, 14, 10, 10,…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;chr&gt; \"04168\", \"04168\", \"80119\", \"80119\", \"44069\", \"4406…\n$ DESTINATION_PT_CODE &lt;chr&gt; \"10051\", \"10051\", \"90079\", \"90079\", \"17229\", \"1722…\n$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …\n\n\nWe see that apart from the total trips & time, the rest of the variables are as character field.\n\n\nCode\n#datatable(sample_n(odbus202308,25), filter = 'top', options = list(paging = FALSE))\ndatatable(sample_n(odbus202308,25))\n\n\n\n\n\n\n\nHowever, we expect that month of travel, day_type, public transport type, origin & destination code are supposed to be standardised. Lets catergorising these variables to check the unique combinations.\n\n\nCode\n# Change all columns to factors\nodbus202308 &lt;- data.frame(lapply(odbus202308, factor))\nodbus202308$TOTAL_TRIPS &lt;- as.numeric(odbus202308$TOTAL_TRIPS)\nodbus202308$TIME_PER_HOUR &lt;- as.numeric(odbus202308$TIME_PER_HOUR)\n\n\nAfter catergorising the variables, we see that as per dataset naming, there was only bus transport data in 2023 Aug. The days are grouped together into 2 category of WEEKDAY or WEEKENDS/HOLIDAY.\nThe timing is consolidated into 0-24, though interestingly Weekday 3am is not present, probably because there were no bus services operating on weekday at 3am.\n\n\nCode\n# Find the distinct values in each column\ndistinct_values &lt;- odbus202308 %&gt;%\n  select(-TOTAL_TRIPS, -ORIGIN_PT_CODE, -DESTINATION_PT_CODE) %&gt;%\n  distinct() %&gt;%\n  arrange(PT_TYPE, YEAR_MONTH, DAY_TYPE, TIME_PER_HOUR)\n\n#datatable(distinct_values, filter = 'top', options = list(paging = FALSE))\ndatatable(distinct_values)\n\n\n\n\n\n\n\nLets also check if the trips data is unique.\n\n\nCode\nodbus202308_isunique &lt;- isUnique(odbus202308)\nodbus202308_extractduplicatecount &lt;- extractduplicatecount(odbus202308)\n\n\nCheck if trips data is unique returned TRUE. There are 0 lines that are duplicated\n\nWhen do we take BUS?\nFirst we want to summarise the data to group by WEEKDAY or WEEKENDS/HOLIDAY and sum up all the trips made at each TIME_PER_HOUR\n\n\nCode\n#summarising the data\nalltriptime &lt;- odbus202308 %&gt;%\n  group_by(DAY_TYPE, TIME_PER_HOUR) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS))\n\ndaytype_trip &lt;- alltriptime %&gt;%\n  group_by(DAY_TYPE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS))\n\n\n\n\nCode\nweekd_ratio &lt;- sprintf(\"%.f%%\", daytype_trip %&gt;% filter(DAY_TYPE==\"WEEKENDS/HOLIDAY\") %&gt;% pull(TOTAL_TRIPS) / daytype_trip %&gt;% filter(DAY_TYPE==\"WEEKDAY\") %&gt;% pull(TOTAL_TRIPS)*100)\n\n\nThe temporal distribution of the trips is not surprising as we tend to have morning and evening peaks during WEEKDAY where people go to and back from work/school.\nWhereas on WEEKENDS/HOLIDAY, timing is more flexible and more spread out. The total quantum of bus trips made on WEEKENDS/HOLIDAY is only 33%% of that in WEEKDAY. As a result, the bus operators probably cater lesser buses too (as we would have experienced the lower frequency).\n\n\nCode\n# Create the plot\nplot_ly(alltriptime, x = ~TIME_PER_HOUR, y = ~TOTAL_TRIPS, color = ~DAY_TYPE, type = 'scatter', mode = 'lines') %&gt;%\n  layout(title = \"Distribution of Trips Across Time\", xaxis = list(title = \"Time\"), yaxis = list(title = \"Number of Trips\"))\n\n\n\n\n\n\nThus we will want to pay more focus on the following time period for further analysis. Although it can be argued that the WEEKDAY afternoon peak is from 4pm to 8pm instead of 5pm to 8pm, but we will like to standardise the analysis period to a 3 hour window for each peak hour first\n\n\n\nPeak Hour Period\nBus Tap on Time\n\n\n\n\nWeekday morning peak\n6am to 9pm\n\n\nWeekday afternoon peak\n5pm to 8pm\n\n\nWeekends/Holiday morning peak\n11am to 2pm\n\n\nWeekends/Holiday evening peak\n4pm to 7pm"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#where-do-we-take-the-bus",
    "href": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#where-do-we-take-the-bus",
    "title": "Take-home_Ex1",
    "section": "Where do we take the Bus?",
    "text": "Where do we take the Bus?\n\nLoading in Busstop Data\nFrom the bus trip data, we have trips from ORIGIN_PT_CODE to DESTINATION_PT_CODE. however, that is a unique ID tagged to each busstop, but without the busstop metadata, we don’t know where are these busstops. So we need to add in an additional data to plot the geographical location of each busstop.\n\n\nCode\nbusstop &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\n\nReading layer `BusStop' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 5161 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\nWe see that busstop data is a point data with only 1 pair of XY coordinate per feature. BUS_STOP_N in the busstop data is a unique ID matching to that of ORIGIN_PT_CODE & DESTINATION_PT_CODE. Thus lets apply the same transformation to make it into a category to allow matching of the trip data to the busstop location.\n\n\nCode\n#datatable(sample_n(busstop,25), filter = 'top', options = list(paging = FALSE))\ndatatable(sample_n(busstop,25))\n\n\n\n\n\n\n\n\n\nCode\nbusstop$BUS_STOP_N &lt;- as.factor(busstop$BUS_STOP_N)\nbusstop$BUS_ROOF_N &lt;- as.factor(busstop$BUS_ROOF_N)\n\n\nLets check if the busstops are unique.\n\n\nCode\nbusstop_isunique &lt;- isUnique(busstop)\nbusstop_extractduplicatecount &lt;- extractduplicatecount(busstop)\n\n\nCheck if busstop data is unique returned TRUE. There are 0 lines that are duplicated. So lets plot the the busstop onto a map to show the busstops. There are 2 interesting observations\n1) There are 5 busstop ploted in Johor\n2) Landed Estates despite it being populated is not well served by bus stop, perhaps because we assume they have other means of transport?\n\n\nCode\n# Read the landed area shapefile downloadeded from data.gov.sg then converted to shapefile\nlanded &lt;- st_read(dsn = \"data/geospatial\", layer = \"LandedHousingAreaLayer-polygon\")%&gt;%\n  st_transform(crs = 3414) %&gt;% st_make_valid()\n\n\nReading layer `LandedHousingAreaLayer-polygon' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 254 features and 7 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6892 ymin: 1.270595 xmax: 103.9755 ymax: 1.462248\nGeodetic CRS:  WGS 84\n\n\n\n\nCode\n# Find points that are in Singapore\nsgbusstop &lt;- st_intersection(busstop, sgp_simple)\n\n# Find points that are not within Singapore\njohorbusstop &lt;- busstop[!busstop$BUS_STOP_N %in%\n                          sgbusstop$BUS_STOP_N,]\n\n\n\n\nCode\ntmap_mode(\"view\")\ntmap_options(check.and.fix = TRUE)\n\n\n\n\nCode\ntmap_mode(\"plot\")\ntmap_options(check.and.fix = TRUE)\n\n\n\n\nCode\ntmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(landed)+\n  tm_polygons(col=\"green\", \n              alpha = 0.6,\n              border.alpha = 0.1)+\n  tm_shape(sgbusstop)+\n  tm_dots(size = 0.005,\n          alpha = 0.5,\n          border.alpha = 0.1,\n          clustering = FALSE)+\n  tm_shape(johorbusstop)+\n  tm_dots(col=\"orange\",\n          size = 0.01,\n          alpha = 0.5,\n          border.alpha = 0.1,\n          clustering = FALSE)\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\nOther than above, the area not dotted with bus stops in Singapore Main Island, are broadly speaking more “ulu” e.g.\na) Central Reserve / Nature Reserve\nb) SAF Training Facilities\nc) Lim Chu Kang Area\n\n\nLayering Busstop with No. Trips\nWe should then first check there are busstops that are found in trips but don’t have a busstop point mapped. This is more important because, it is possible for an existing busstop to have no demand, but not possible to have trips from a missing busstop. a) BUS_STOP_N from geometry data b) ORIGIN_PT_CODE from trips data\n\n\nCode\n# Assuming 'db1' and 'db2' are your data frames, and 'bus_stop' is the bus stop identifier\nmissing_in_busstop_ORIGIN &lt;- data.frame(setdiff(odbus202308$ORIGIN_PT_CODE,busstop$BUS_STOP_N)) %&gt;% rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_DESTINATION &lt;- data.frame(setdiff(odbus202308$DESTINATION_PT_CODE,busstop$BUS_STOP_N)) %&gt;% \n  rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_combined &lt;- rbind(missing_in_busstop_ORIGIN,missing_in_busstop_DESTINATION) %&gt;% unique() %&gt;% \n  arrange(BUS_STOP_N)\n\n\n\n\nCode\norigin_daytime &lt;- odbus202308 %&gt;%\n  group_by(DAY_TYPE,TIME_PER_HOUR,ORIGIN_PT_CODE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS))\n\norigin_only &lt;- origin_daytime %&gt;%\n  group_by(ORIGIN_PT_CODE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS))\n\norigin_total &lt;- origin_only %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(ORIGIN_PT_CODE))\n\nmissing_in_busstop_trips &lt;- left_join(missing_in_busstop_combined, origin_only\n                                      , by=c(\"BUS_STOP_N\" = \"ORIGIN_PT_CODE\")) %&gt;%\n  arrange(desc(TOTAL_TRIPS))\n\nmissing_in_busstop_total &lt;- missing_in_busstop_trips %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(BUS_STOP_N))\n\nmissing_stop1 &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_STOPS)\n\nmissing_stop_ratio1 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total %&gt;% pull(TOTAL_STOPS) / origin_total %&gt;% pull(TOTAL_STOPS)*100)\n\nmissing_trip_ratio1 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total %&gt;% pull(TOTAL_TRIPS) / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\n\nUpon inspection, there are 54 busstops that are not found with a geometry data point. They made up of 1.6% of trips and 1.1% of bus stops. In particular, the top 2 observations 59009 and 47009 are Yishun & Woodlands Interchange respectively and should be included. Thus i have made some manual input to find the location of yishun bus interchange & woodlands temp bus interchange.\nNote: although woodlands regional bus interchange has started operation, there are a few bus services that continue to run from the temp bus interchange [LINK].\n\n\nCode\nmanualbusstop &lt;- tibble(BUS_STOP_N = c('59009','47009'), lat = c(1.4278664,1.4375880), lon = c(103.8361437,103.7865749), LOC_DESC = c('YISHUN BUS INT','WOODLANDS TEMP BUS INT'), BUS_ROOF_N=c('','')) \n\nmanualbusstop_geo2 &lt;- st_as_sf(manualbusstop, coords = c(\"lon\",\"lat\"), crs = 4326) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(manualbusstop_geo2)+\n  tm_dots(col=\"red\",\n          size = 0.2)+  \n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\nThereafter, lets concentrate on the busstop in Singapore, and concatenate the geometry data from LTA and the manual input, and check the difference in the trips missing\n\n\nCode\nbusstop2 &lt;- rbind(sgbusstop,manualbusstop_geo2) \n\nmissing_in_busstop_ORIGIN2 &lt;- data.frame(setdiff(odbus202308$ORIGIN_PT_CODE,busstop2$BUS_STOP_N)) %&gt;% rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_DESTINATION2 &lt;- data.frame(setdiff(odbus202308$DESTINATION_PT_CODE,busstop2$BUS_STOP_N)) %&gt;% \n  rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_combined2 &lt;- rbind(missing_in_busstop_ORIGIN2,missing_in_busstop_DESTINATION2) %&gt;% unique() %&gt;% \n  arrange(BUS_STOP_N)\n\nmissing_in_busstop_trips2 &lt;- left_join(missing_in_busstop_combined2, origin_only\n                                      , by=c(\"BUS_STOP_N\" = \"ORIGIN_PT_CODE\")) %&gt;%\n  arrange(desc(TOTAL_TRIPS))\n\nmissing_in_busstop_total2 &lt;- missing_in_busstop_trips2 %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(BUS_STOP_N))\n\nmissing_stop2 &lt;- missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS)\n\nmissing_stop_diff &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_STOPS) - missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS)\n\nmissing_trip_diff &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_TRIPS) - missing_in_busstop_total2 %&gt;% pull(TOTAL_TRIPS)\n\n\nmissing_stop_ratio2 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS) / origin_total %&gt;% pull(TOTAL_STOPS)*100)\n\nmissing_trip_ratio2 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total2 %&gt;% pull(TOTAL_TRIPS) / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\nmissing_trip_ratio_diff &lt;- sprintf(\"%.1f%%\", missing_trip_diff / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\n\n\n\nCode\nrm(sgp,busstop,odbus202308,mpsz,manualbusstop,manualbusstop_geo2,sgbusstop,johorbusstop,daytype_trip,distinct_values)\ngc()\n\n\n          used  (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells 3672475 196.2   50372823 2690.2  78707534 4203.5\nVcells 6923667  52.9  169162831 1290.7 211453536 1613.3\n\n\nAfter the update, there are 55 busstops that are not found with a geometry data point. They made up of 0.8% of trips and 1.1% of bus stops. By just adding -1 stops, we are now accounting for 0.9% more trips.\nNow lets plot where are the busstops with the highest origin\n\n\nCode\nbusstoptime &lt;- left_join(busstop2 , origin_only,\n            by = c(\"BUS_STOP_N\" = \"ORIGIN_PT_CODE\")) %&gt;%\n  arrange(desc(TOTAL_TRIPS))\n\nhigh_busstoptime &lt;- busstoptime %&gt;% \n  head(100) %&gt;%\n  select(LOC_DESC,everything())\n\n\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(busstoptime)+\n  tm_dots(col = \"TOTAL_TRIPS\",\n          alpha = 1,\n          border.alpha =0.01,\n          style = \"log10_pretty\",\n          title = \"Number of Trips\")+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\nWe can see that it is very difficult to visualise this given the numerous busstops. The high usage busstops are hidden among the numerous lower usage busstops, so lets do another plot to show only the top 100 busstops\nOnce we look at it, actually it kind of coincide very closely to the MRT stations, which is not surprising because MRT are important transport node that people transit. One interesting observation, is the top 100 busstop tend to coincide more with the “older” MRT lines like NS line, EW line & NE line. This is especially pronounced in the eastern side of Singapore.\n\n\nCode\n# Read the landed area shapefile downloadeded from data.gov.sg then converted to shapefile\nMRT &lt;- st_read(dsn = \"data/geospatial\", layer = \"Train_Station_Exit_Layer\") %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\n\nReading layer `Train_Station_Exit_Layer' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex1\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 565 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6134.086 ymin: 27499.7 xmax: 45356.36 ymax: 47865.92\nProjected CRS: SVY21\n\n\nCode\ntmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(high_busstoptime)+\n  tm_dots(col = \"TOTAL_TRIPS\",\n          alpha = 1,\n          size = 0.1,\n          style = \"pretty\",\n          popup.vars=c(\"Number of Trips: \"= \"TOTAL_TRIPS\",\n                       \"DESC: \"=\"LOC_DESC\")\n          )+\n  tm_shape(MRT)+\n  tm_dots(col=\"purple\", \n          alpha = 0.05,\n          border.alpha = 0.4)\n\n\n\n\n\n\n\nCode\n#tmap_mode(\"plot\")\n\n\n\n\nCode\nrm(busstoptime,high_busstoptime,origin_only,origin_total)\ngc()\n\n\n          used  (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells 3693795 197.3   40298259 2152.2  78707534 4203.5\nVcells 7021550  53.6  135330265 1032.5 211453536 1613.3\n\n\n\n\nSummarising the trips into hexagon\nIn addition, we know that people could walk from 1 busstop to a nearby busstop. So lets summarise this result geographically. We want to group busstops that are nearby together, say by 500m.\n\n\nCode\nsgp_hex &lt;- st_make_grid(sgp_simple,\n                       cellsize= 500,\n                       crs= 3414,\n                       what = \"polygons\", \n                       square = FALSE)\n\nsgp_hexid &lt;- sgp_hex %&gt;%\n  st_as_sf() %&gt;%\n  mutate(hex_id = paste0(\"HEX_\",row_number()))\n\nsgp_hexid$hex_id &lt;- as.factor(sgp_hexid$hex_id)\n  \nst_geometry(sgp_hexid) &lt;- \"geometry\"\n\nbusstop_withhex &lt;- st_intersection(busstop2,sgp_hexid)\n\nsgp_hexid_bs_df &lt;- st_intersection(sgp_hexid,busstop2) %&gt;%\n  data.frame() %&gt;%\n  select(hex_id,BUS_STOP_N, LOC_DESC)\n\nsgp_hexid_wbs_df &lt;- sgp_hexid_bs_df %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(TOTAL_STOPS = n_distinct(BUS_STOP_N),\n            ALL_STOPS_ID = list(as.factor(BUS_STOP_N)),\n            ALL_STOPS_DESC = list(LOC_DESC))\n\nhex_bs_spread_df &lt;- sgp_hexid_wbs_df %&gt;%\n  group_by(TOTAL_STOPS) %&gt;%\n  summarise(TOTAL_HEX = n_distinct(hex_id)) %&gt;%\n  arrange(desc(TOTAL_HEX))\n\nsgp_hexid_wbs_geo &lt;- left_join(sgp_hexid,sgp_hexid_wbs_df) %&gt;%\n  filter(TOTAL_STOPS &gt; 0)\n\nhex_wbs_number &lt;- nrow(sgp_hexid_wbs_df)\nhex_wbs_mostfrequent &lt;- hex_bs_spread_df$TOTAL_STOPS[1]\nhex_wbs_mostfrequent_count &lt;- hex_bs_spread_df$TOTAL_HEX[1]\n\nrm(sgp_hex)\ngc()\n\n\n          used  (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells 3805679 203.3   32238608 1721.8  78707534 4203.5\nVcells 7382893  56.4  108264212  826.0 211453536 1613.3\n\n\n\nBusstops Distribution in Hexagon\nThere are 1519 hexagons with busstops, of which there are 420 hexagon with 2 busstops within the same hexagon. A distribution of the number of busstops within the 1519 hexagons as below.\n\n\nCode\n# Create the plot\nplot_ly(hex_bs_spread_df %&gt;% arrange(TOTAL_STOPS), x = ~TOTAL_STOPS, y = ~TOTAL_HEX, type = 'scatter', mode = 'lines') %&gt;%\n  layout(title = \"Distribution of Bus Stops across Hexagons\", xaxis = list(title = \"# Bus Stops\"), yaxis = list(title = \"# Hexagons\"))\n\n\n\n\n\n\nCode\nrm(hex_bs_spread_df)\ngc()\n\n\n          used  (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells 3805455 203.3   25790887 1377.4  78707534 4203.5\nVcells 7392224  56.4   86611370  660.8 211453536 1613.3\n\n\n\n\nCode\ntmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(col=\"TOTAL_STOPS\", \n              alpha = 1,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")) +\n  tm_layout(main.title = \"Busstops Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\n\n\nTrips distribution by Hexagon\nAfter we gotten the base hexagon matched with the number of bus stops. that forms part of the basemap, next lets find out the number of trips in each hexagon. We will also compare average with sum.\n\nSum of all trips will give a better sensing on how crowded it is.\nWhile average will allow us to be a bit “fairer” because more busstops in 1 hexagon will usually result in more trips. However, while we don’t want to attribute the trips due to how we cut the hexagon, we should also note that sometimes there are more busstops in the vicinity because there is a high demand there, e.g. interchange or transfer to MRT. Averaging in this case does not paint the correct picture\n\n\n\nCode\n# Assuming df is your dataframe\norigin_daytime2 &lt;- origin_daytime\norigin_daytime2$TIME_PER_HOUR &lt;- paste0(\"T\",origin_daytime2$TIME_PER_HOUR)\n\norigin_daytime_wide &lt;- origin_daytime2 %&gt;%\n  pivot_wider(names_from = TIME_PER_HOUR, values_from = TOTAL_TRIPS) %&gt;%\n  mutate_all(replace_na,0) %&gt;%\n  mutate(T0609 = T6 + T7 + T8 + T9,\n         T1720 = T17 + T18 + T19 + T20,\n         T1114 = T11 + T12 + T13 + T14,\n         T1619 = T16 + T17 + T18 + T19)\n\nsgp_hexid_bs_weekday_data &lt;- left_join(sgp_hexid_bs_df, \n                               origin_daytime_wide %&gt;% \n                                 filter(DAY_TYPE == \"WEEKDAY\"),\n                               by = c(\"BUS_STOP_N\" =  \"ORIGIN_PT_CODE\")) %&gt;%\n  select(-c(DAY_TYPE,BUS_STOP_N,LOC_DESC)) %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise_all(sum, na.rm=TRUE) %&gt;%\n  mutate(diff_WD = (T0609/T1720))\n\nsgp_hexid_bs_weekday_data[sgp_hexid_bs_weekday_data == Inf] &lt;- NaN\n\nsgp_hexid_bs_weekday_geo &lt;- left_join(sgp_hexid_bs_weekday_data,sgp_hexid_wbs_geo) %&gt;%\n  mutate(avT0609 = T0609 / TOTAL_STOPS,\n         avT1720 = T1720 / TOTAL_STOPS) %&gt;%\n  st_as_sf()\n\nsgp_hexid_bs_weekend_data &lt;- left_join(sgp_hexid_bs_df, \n                               origin_daytime_wide %&gt;% \n                                 filter(DAY_TYPE == \"WEEKENDS/HOLIDAY\"),\n                               by = c(\"BUS_STOP_N\" =  \"ORIGIN_PT_CODE\")) %&gt;%\n  select(-c(DAY_TYPE,BUS_STOP_N,LOC_DESC)) %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise_all(sum, na.rm=TRUE) %&gt;%\n  mutate(diff_WE = (T1114/T1619))\n\nsgp_hexid_bs_weekend_data[sgp_hexid_bs_weekend_data == Inf] &lt;- NaN\n\nsgp_hexid_bs_weekend_geo &lt;- left_join(sgp_hexid_bs_weekend_data,sgp_hexid_wbs_geo) %&gt;%\n  mutate(avT1114 = T1114 / TOTAL_STOPS,\n         avT1619 = T1619 / TOTAL_STOPS) %&gt;%\n  st_as_sf()\n\n\nrm(origin_daytime2)\ngc()\n\n\n          used  (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells 3838520 205.0   20632710 1102.0  78707534 4203.5\nVcells 8107239  61.9   69289096  528.7 211453536 1613.3\n\n\n\n\nWeekday\nWe can see that the most congested area tend to be further away from central e.g. punngol, hougang, tampines, woodlands, yishun, jurong, boon lay in the morning. Whereas in the evening, the most congested area are more spread out, but with a concentration in the around the central / CBD region like in raffles place, cityhall, bugis.\nThis is align with the general “routine” as people go from where they live to where they work / school in the morning. Whereas in the evening, it is in the opposite direction.\nHowever, what it generally show is the workplace / school are probably more distributed than the living location.\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_bs_weekday_geo %&gt;%\n             filter(T0609 &gt; 0))+\n  tm_polygons(col=\"T0609\",\n              alpha = 1,\n              border.alpha = 0.1,\n              style = \"quantile\",\n              palette = \"Blues\",\n              title = \"All Passenger Trips\") +\n  tm_layout(main.title = \"Weekday Morning Peak 0600 - 0900 (Sum)\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\nCode\n#tmap_mode(\"plot\")\n\n\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_bs_weekday_geo %&gt;%\n             filter(T0609 &gt; 0))+\n  tm_polygons(col=\"avT0609\",\n              alpha = 1,\n              border.alpha = 0.1,\n              style = \"quantile\",\n              palette = \"Blues\",\n              title = \"Average Passenger Trips\") +\n  tm_layout(main.title = \"Weekday Morning Peak 0600 - 0900 (Average)\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\nCode\n#tmap_mode(\"plot\")\n\n\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_bs_weekday_geo %&gt;%\n             filter(T1720 &gt; 0))+\n  tm_polygons(col=\"T1720\",\n              alpha = 1,\n              border.alpha = 0.1,\n              style = \"quantile\",\n              palette = \"Blues\",\n              title = \"All Passenger Trips\") +\n  tm_layout(main.title = \"Weekday Evening Peak 1700 - 2000 (Sum)\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\nCode\n#tmap_mode(\"plot\")\n\n\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_bs_weekday_geo %&gt;%\n             filter(T1720 &gt; 0))+\n  tm_polygons(col=\"avT1720\",\n              alpha = 1,\n              border.alpha = 0.1,\n              style = \"quantile\",\n              palette = \"Blues\",\n              title = \"Average Passenger Trips\") +\n  tm_layout(main.title = \"Weekday Evening Peak 1700 - 2000 (Average)\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\nCode\n#tmap_mode(\"plot\")\n\n\nOverall, there isn’t a strong difference between sum and average. Thus will prefer the use of Sum as there are indeed transport nodes that have multiple busstops serving strong demand. Thus for subsequent analysis on weekend, will only be showing sum for simplicity\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_bs_weekday_geo %&gt;%\n             na.omit(diff_WD))+\n  tm_polygons(col=\"diff_WD\",\n              alpha = 1,\n              border.alpha = 0.1,\n              #style = \"quantile\",\n              breaks = c(-Inf,0.5,2,Inf),\n              labels = c(\"Evening Congested &lt;50%\", \"Similar 50%-200%\", \"Morning Congested &gt;200%\"),\n              palette = \"Reds\",\n              title = \"Morning / Evening Trips\") +\n  tm_layout(main.title = \"Diff between Weekday Morning & Evening Peak\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\nCode\n#tmap_mode(\"plot\")\n\n\n\n\nWeekend/Holiday\nWhereas on Weekend, the spatial distribution is quite similar between morning and evening peaks. This could be due to different people having different schedule, e.g. some prefer to sleep in, some prefer to start early. There is no “fixed” timing that everyone must obey as per work / school.\nIn addition, the most congested area on weekend is generally less congested than the weekdays (although as someone walking around, i certainly don’t feel so, but data vs feeling, i rather trust data looking at Singapore on average). Comparing ~300,000 to 500,000 Passenger Trips on the most congested hexagonal area on Weekday Peaks, ~100,000 to 150,000 Passenger Trips on the most congested hexagonal area on Weekend Peaks.\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_bs_weekend_geo %&gt;%\n             filter(T1114 &gt; 0))+\n  tm_polygons(col=\"T1114\",\n              alpha = 1,\n              border.alpha = 0.1,\n              style = \"quantile\",\n              palette = \"Blues\",\n              title = \"Passenger Trips\") +\n  tm_layout(main.title = \"Weekend/Holiday Morning Peak 1100-1400\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\nCode\n#tmap_mode(\"plot\")\n\n\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_bs_weekend_geo %&gt;%\n             filter(T1619 &gt; 0))+\n  tm_polygons(col=\"T1619\",\n              alpha = 1,\n              border.alpha = 0.1,\n              style = \"quantile\",\n              palette = \"Blues\",\n              title = \"Passenger Trips\") +\n  tm_layout(main.title = \"Weekend/Holiday Evening Peak 1600-1900\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\nCode\n#tmap_mode(\"plot\")\n\n\nOne interesting feature is a cluster of morning being more congested than evening in the Eastern Area in Loyang Way & Changi Ferry Terminal. a) For Loyang Way, it is an industrial area, perhaps there’s some factory converted dormitories on loyang way where the workers are going out in the weekend. b) For Changi Ferry Terminal, it serve a line between Singapore and Johor [LINK] perhaps tourist from Malaysia are coming over in the Weekend/Holiday morning\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_bs_weekend_geo %&gt;%\n             na.omit(diff_WE))+\n  tm_polygons(col=\"diff_WE\",\n              alpha = 0.7,\n              border.alpha = 0.1,\n              #style = \"quantile\",\n              breaks = c(-Inf,0.5,2,Inf),\n              labels = c(\"Evening Congested &lt;50%\", \"Similar 50%-200%\", \"Morning Congested &gt;200%\"),\n              palette = \"Reds\",\n              title = \"Morning/ Evening Trips\") +\n  tm_layout(main.title = \"Diff between Weekend/Holiday Morning & Evening Peak\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\nCode\ntmap_mode(\"plot\")"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#how-are-the-congested-area-spill-over",
    "href": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#how-are-the-congested-area-spill-over",
    "title": "Take-home_Ex1",
    "section": "How are the congested area spill over?",
    "text": "How are the congested area spill over?\nWe know there are congregation effect, e.g. where there are housing estate e.g. HDB, Condos, Purpose Built Dormitories that house the majority of the Singapore population, be it Singaporean or Pass Holders. In addition, there are concentration of people in areas for different purposes, e.g. Working at CBD, shopping at Orchard, going to School, jogging at East Coast Park etc. We have seen that earlier, but we will be interested to know how are these effect spilled over to the neighbourhood in terms of transport and where does this effect fade off.\nHowever, we know that some areas are more “ulu” / at the fringe of the Singapore e.g. Tuas, Mandai to name a few. In these places, we don’t want to assume no relationship base on there are no “immediate neighbour”, therefore we will want to weigh by how far is this hexagon away from X other hexagon with busstops. One way to think of this is maybe different people could be dropped off at either side of these “ulu” places, but they are still related.\nWe will use X = 18 because typically in a hexagon, we have 6 immediate neighbours and 12 neighbour or neighbour, thus we will use 18 to get possibly the 2nd order neighbour.\n\n\nCode\n#geo &lt;- st_geometry(sgp_hexid_wbs_geo)\n#nb &lt;- st_knn(geo)\n#dists &lt;- unlist(st_nb_dists(geo,nb))\n#summary(dists)\n\nsgp_hexid_bs_weekday0609_geo_nb &lt;- sgp_hexid_bs_weekday_geo %&gt;%\n  select(T0609, hex_id, ALL_STOPS_ID, ALL_STOPS_DESC)%&gt;%\n  mutate(nb = st_knn(geometry,\n                     k=18),\n         wts = st_inverse_distance(nb,geometry),\n         .before = 1) %&gt;%\n  mutate(lmT0609 = local_moran(T0609,nb,wts,nsim = 99),\n         .before = 1) %&gt;%\n  unnest(lmT0609)\n\n\nsgp_hexid_bs_weekday1720_geo_nb &lt;- sgp_hexid_bs_weekday_geo %&gt;%\n  select(T1720, hex_id, ALL_STOPS_ID, ALL_STOPS_DESC)%&gt;%\n  mutate(nb = st_knn(geometry,\n                     k=18),\n         wts = st_inverse_distance(nb,geometry),\n         .before = 1) %&gt;%\n  mutate(lmT1720 = local_moran(T1720,nb,wts,nsim = 99),\n         .before = 1) %&gt;%\n  unnest(lmT1720)\n\nsgp_hexid_bs_weekend1114_geo_nb &lt;- sgp_hexid_bs_weekend_geo %&gt;%\n  select(T1114, hex_id, ALL_STOPS_ID, ALL_STOPS_DESC)%&gt;%\n  mutate(nb = st_knn(geometry,\n                     k=18),\n         wts = st_inverse_distance(nb,geometry),\n         .before = 1) %&gt;%\n  mutate(lmT1114 = local_moran(T1114,nb,wts,nsim = 99),\n         .before = 1) %&gt;%\n  unnest(lmT1114)\n\nsgp_hexid_bs_weekend1619_geo_nb &lt;- sgp_hexid_bs_weekend_geo %&gt;%\n  select(T1619, hex_id, ALL_STOPS_ID, ALL_STOPS_DESC)%&gt;%\n  mutate(nb = st_knn(geometry,\n                     k=18),\n         wts = st_inverse_distance(nb,geometry),\n         .before = 1) %&gt;%\n  mutate(lmT1619 = local_moran(T1619,nb,wts,nsim = 99),\n         .before = 1) %&gt;%\n  unnest(lmT1619)\n\n\n\nWeekday Morning Peak\nThe weekday morning peak, we see congregation of high-high cluster in major transport nodes like MRT / Bus Interchange nearer to the residential area like Yishun, Woodlands, Punggol, Hougang, Tampines, Jurong\nWhereas the low-low clusters are in the fringe area especially in the Tuas, Lim Chu Kang, Mandai region, where there are little residential area. The CBD area is also a low-low cluster in the morning, probably due to the low residential population there. This could change in the future where government is intending to allow mix land use in CBD with more residential.\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(alpha=0.05,\n              border.alpha = 0.1)+\n  tm_shape(sgp_hexid_bs_weekday0609_geo_nb %&gt;%\n            filter(p_ii_sim &lt; 0.05)) +\n  tm_polygons(col=\"median\",\n              alpha = 0.7,\n              border.alpha = 0.1,\n              #style = \"quantile\",\n              #title = \"\"\n              ) +\n  tm_layout(main.title = \"Weekday Morning Peak\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\n\n\nWeekday Evening Peak\nThe weekday evening peak is somewhat surprising, as i would have expected some high-high cluster in the CBD / core central region. While the earlier graph showed there is indeed congestion at selected hexagon, it is not significant to constitute a high-high cluster, except for a small single segment in the CBD\nThe fringe area remain as low-low cluster.\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(alpha=0.05,\n              border.alpha = 0.1)+\n  tm_shape(sgp_hexid_bs_weekday1720_geo_nb %&gt;%\n            filter(p_ii_sim &lt; 0.05)) +\n  tm_polygons(col=\"median\",\n              alpha = 0.7,\n              border.alpha = 0.1,\n              #style = \"quantile\",\n              #title = \"\"\n              ) +\n  tm_layout(main.title = \"Weekday Evening Peak\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\n\n\nWeekend Morning Peak\nIn line with earlier observation, the weekend schedule are more spread out. Thus the high high clusters are more spread out with people being able to choose where to go instead of a routine work / school location. The residential clusters remain high-high as people travel from their home (being the constant) to their destination. But the cluster are less congregated as compared to weekday morning peak\nThe fringe areas remain the consistent low-low areas\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(alpha=0.05,\n              border.alpha = 0.1)+\n  tm_shape(sgp_hexid_bs_weekend1114_geo_nb %&gt;%\n            filter(p_ii_sim &lt; 0.05)) +\n  tm_polygons(col=\"median\",\n              alpha = 0.7,\n              border.alpha = 0.1,\n              #style = \"quantile\",\n              #title = \"\"\n              ) +\n  tm_layout(main.title = \"Weekend Morning Peak\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\n\n\nWeekend Evening Peak\nThis is the period that pressumably people go home from their destination. There is a distinct new high-high cluster nearer to Dhoby Ghuat / Bugis area\nThe low-low cluster has not much changes, and remain largely with the fringe areas.\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(alpha=0.05,\n              border.alpha = 0.1)+\n  tm_shape(sgp_hexid_bs_weekend1619_geo_nb %&gt;%\n            filter(p_ii_sim &lt; 0.05)) +\n  tm_polygons(col=\"median\",\n              alpha = 0.7,\n              border.alpha = 0.1,\n              #style = \"quantile\",\n              #title = \"\"\n              ) +\n  tm_layout(main.title = \"Weekend Evening Peak\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.5)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#references",
    "href": "Take-home_Ex/Take-home_Ex1/Take-home_Ex1.html#references",
    "title": "Take-home_Ex1",
    "section": "References",
    "text": "References\nSpecial thanks to Prof Kam & his numerous sharings\n[1] https://isss624.netlify.app/\n[2] https://isss624-ay2023-24nov.netlify.app/\n[3] https://r4gdsa.netlify.app/\n[4] https://urbandatapalette.com/post/2021-08-tessellation-sf/\n[5] https://www.easybook.com/en-sg/ferry/terminal/changi\n[6] https://landtransportguru.net/woodlands-temporary-bus-interchange/"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex4/In-class_Ex4.html",
    "href": "In-class_Ex/In-class_Ex4/In-class_Ex4.html",
    "title": "In Class Ex4",
    "section": "",
    "text": "after looking at the Hand-on Ex3, the pattern is displayed, but what are the factors contributing to this differences. Can we build the model. Spatial Interaction Model. Professional Geographer, built model to explain this phenomenon.\nIf you move the pivot to the lighter side in a see-saw, it will help to balance. Similarly, in a trip flow, between pushing & pulling, the gravitational model make use of similar idea. Calibrating the model in statistics, is usually multiple linear regression. In this topic, we are specifically using possion regression. We don’t have negative trip, in terms of trips who should be in whole number, instead of decimal and this is not in line with the linear regression, thus we use possion regression.\nGLM instead of LM, generalised linear regression model, that is usually used during machine learning.\nSchool Directory and Information, in the morning especially secondary school & JC student. Poly, Uni student have varying time schedule\n80% of the population stay in HDB, so we can use HDB property information from data.gov.sg to plot it into the hexagons to proxy for the population. # of dwelling unit is a better option than # blocks, because block can have different # units, In addition, we can use the distribution of 1room, 2room etc to 5room and national average to can a “sumproduct” to proxy for population by block\nBusiness - small scale, large scale, alot of them at the industrial park. Prof has a way to do this every quarter.\nFin Services - in Singapore, we have quite a lot of regional headquarter, and they are concentrated. The money changer, are not a store but a building.\nThis is to be used as factor, journey to work, weekend journey. No need to use all, shop usually open at 10am, except F&B for breakfast.\nFor lesisure, re-creational for example we can look at theatre only if we want to focus\n12 years ago, Prof prepared a dataset for crime that is extrapolated from other places but proxy to Singapore, the students went to use it for other classes thinking it is the truth* and the other prof shared with MHA that led to MHA calling up Prof."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex4/In-class_Ex4.html#my-own-notes",
    "href": "In-class_Ex/In-class_Ex4/In-class_Ex4.html#my-own-notes",
    "title": "In Class Ex4",
    "section": "",
    "text": "after looking at the Hand-on Ex3, the pattern is displayed, but what are the factors contributing to this differences. Can we build the model. Spatial Interaction Model. Professional Geographer, built model to explain this phenomenon.\nIf you move the pivot to the lighter side in a see-saw, it will help to balance. Similarly, in a trip flow, between pushing & pulling, the gravitational model make use of similar idea. Calibrating the model in statistics, is usually multiple linear regression. In this topic, we are specifically using possion regression. We don’t have negative trip, in terms of trips who should be in whole number, instead of decimal and this is not in line with the linear regression, thus we use possion regression.\nGLM instead of LM, generalised linear regression model, that is usually used during machine learning.\nSchool Directory and Information, in the morning especially secondary school & JC student. Poly, Uni student have varying time schedule\n80% of the population stay in HDB, so we can use HDB property information from data.gov.sg to plot it into the hexagons to proxy for the population. # of dwelling unit is a better option than # blocks, because block can have different # units, In addition, we can use the distribution of 1room, 2room etc to 5room and national average to can a “sumproduct” to proxy for population by block\nBusiness - small scale, large scale, alot of them at the industrial park. Prof has a way to do this every quarter.\nFin Services - in Singapore, we have quite a lot of regional headquarter, and they are concentrated. The money changer, are not a store but a building.\nThis is to be used as factor, journey to work, weekend journey. No need to use all, shop usually open at 10am, except F&B for breakfast.\nFor lesisure, re-creational for example we can look at theatre only if we want to focus\n12 years ago, Prof prepared a dataset for crime that is extrapolated from other places but proxy to Singapore, the students went to use it for other classes thinking it is the truth* and the other prof shared with MHA that led to MHA calling up Prof."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex4/In-class_Ex4.html#getting-started",
    "href": "In-class_Ex/In-class_Ex4/In-class_Ex4.html#getting-started",
    "title": "In Class Ex4",
    "section": "Getting Started",
    "text": "Getting Started\n\npacman:: p_load(tidyverse, sf, httr, tmap)\n\nHTTR is a r package similarly like python, that allow us to work with html pages\nif we only want a specific location, LATLONG is the most convinient, it is align with Satellite. Total 24 of them, tri-angulated by 3 satellite.\n1 degree distance at the equator is not the same as 1 degree distance at the north pole. So if we want to measure distance or area, we should go for projected coordinate system. We use the great circle method.\nFor onemap if we"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex4/In-class_Ex4.html#geocoding-using-sla-onemap-api",
    "href": "In-class_Ex/In-class_Ex4/In-class_Ex4.html#geocoding-using-sla-onemap-api",
    "title": "In Class Ex4",
    "section": "Geocoding using SLA OneMap API",
    "text": "Geocoding using SLA OneMap API\nAddress geocoding, or simply geocoding, is the process of taking\n\nurl &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n\ncsv &lt;- read_csv(\"data/aspatial/Generalinformationofschools.csv\")\n\n#this is saving the postal_code separately as a list\npostcodes &lt;- csv$`postal_code`\n\n\n#initialisation, empty dataframe\nfound &lt;- data.frame()\nnot_found &lt;- data.frame()\n\n\nfor (postcode in postcodes){\n  query &lt;- list('searchVal'=postcode, 'returnGeom' = 'Y', 'getAddrDetails' = 'Y', 'pageNum' = '1')\n  res &lt;- GET(url, query=query)\n  \n  if((content(res)$found) != 0){\n    found &lt;- rbind(found,data.frame(content(res))[4:13])\n  } else {\n    not_found = data.frame(postcode)\n  }\n}\n\nnote : 1) #| eval:false is for 2) message false 3) echo the code chunk will not show\nthe API call is new. so the old search is not the same\n{content(res)}\nmerged = merge(csv, found, by.x = 'postal_code', by.y = 'results.POSTAL', all = TRUE)\nwrite.csv(merged, file = 'data/aspatial/schools.csv')\nwrite.csv(not_found, file = \"data/aspatial/not_found.csv\")\nThere’s decimal degree and there’s also minute second degree.\n\nnewschoolread &lt;- read_csv(\"data/aspatial/schools_updated.csv\") %&gt;%\n  rename(longtitude = results.LONGITUDE,\n         latitude = results.LATITUDE) %&gt;%\n  select(postal_code, school_name, longtitude, latitude)\n\n\nschools_sf &lt;- st_as_sf(newschoolread,\n                       coords = c(\"longtitude\",\"latitude\"),\n                       crs = 4326\n                       ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\nwe put as crs = 4326 first because it was in WGS84 as longtitude latitude (degree). Thereafter, then we convert it to SVY21 under crs = 3414\n\ntmap_mode(\"view\")\ntm_shape(schools_sf %&gt;%\n           select(school_name,everything()))+\n  tm_dots(col=\"black\", \n              alpha = 0.6,\n              border.alpha = 0.4) + \n  tm_view(set.zoom.limits = c(11,14))\n\n\n\n\n\ntmap_mode(\"plot\")\n\n\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;% st_transform(crs = 3414)\n\nReading layer `MPSZ-2019' from data source \n  `C:\\worksheep\\ISSS624\\In-class_Ex\\In-class_Ex4\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n#Merge\nsgp &lt;- st_union(mpsz$geometry)\n\n# Simplify the geometry\nsgp_simple &lt;- st_simplify(sgp, dTolerance = 100) %&gt;% \n  st_as_sf() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n  \ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)\n\n\n\n\nFor coding, we need to make sure the coordinate system is the same, for ArcGIS / QGIS we have projection on the fly, so it can work\n\nmpsz$`SCHOOL_COUNT` &lt;- lengths(st_intersects(mpsz, schools_sf))\ntm_shape(mpsz)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(schools_sf)+\n  tm_dots()\n\n\n\n\nit is a generic application of length to get the “count”\n\nbusiness &lt;- st_read(dsn = \"data/geospatial\", layer = \"Business\") %&gt;% st_transform(crs = 3414)\n\nReading layer `Business' from data source \n  `C:\\worksheep\\ISSS624\\In-class_Ex\\In-class_Ex4\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 6550 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3669.148 ymin: 25408.41 xmax: 47034.83 ymax: 50148.54\nProjected CRS: SVY21 / Singapore TM\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(business)+\n  tm_dots()\n\n\n\n\nthis is the business SME (small medium enterprises)\n\nmpsz$`BUSINESS_COUNT` &lt;- lengths(st_intersects(mpsz, business))\ntm_shape(mpsz)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(business)+\n  tm_dots()\n\n\n\n\n\ntmap_options(check.and.fix = TRUE)\ntm_shape(mpsz)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(business)+\n  tm_dots()\n\n\n\n\nthe trick is to always plot the polygon first then the dots. tmap_options(check.and.fix) is to allow ploting of not-closed polygons\nflow_data &lt;- flow_data %&gt;%\n  left_join(mpsz_tidy,\n            by = c(\"DESTIN_SZ\" = \"SUBZONE_C\"))\nthe attractiveness is referring to the destination. take note of that because all these variables are representing the attractiveness at the destination. If we are looking at attractiveness of the origin, we need to switch it. Calibrating journey to home, it becomes origin. Where are we modelling. Journey to home after work, the business are the “pushing” factor from the origin instead of the “pulling” factor of the destination.\nsummary(flow_data)\nbefore we do the log function, we need to check the data, make sure there is no 0, log 0 is error. So we assign a small value to make sure it is not 0, as long as not 1, because there could be count with 1\nflow_data$SCHOOL_COUNT &lt;- ifelse(flow_data$SCHOOL_COUNT == 0, 0.99, flow_data$SCHOOL_COUNT)\n\nGoing through the Take-Home 2\nthere was a study by a NTU group that through the survey that the maximum willingness to walk is about 750m. Therefore we use 325m\nChoose only 1 time period. Each of them have meaning.\nThose are limitation, by right we want to know the day. Friday, Sat, we might chill out, but Sunday we getting ready for monday blue, so we might not go out.\nThe attractiveness is different."
  },
  {
    "objectID": "In-class_Ex/In-class_Ex4/In-class_Ex4.html#part-b",
    "href": "In-class_Ex/In-class_Ex4/In-class_Ex4.html#part-b",
    "title": "In Class Ex4",
    "section": "PART B",
    "text": "PART B\n\npacman::p_load(tmap, sf, performance, ggpubr, tidyverse)\n\nperformance is to compuete the performance matrix, to compute MSE (Mean Square Error) ggpubr is to gel several plot into 1\n\nflow_data &lt;- read_rds(\"data/rds/flow_data_tidy.rds\")\nglimpse(flow_data)\n\nRows: 14,734\nColumns: 13\n$ ORIGIN_SZ       &lt;chr&gt; \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMSZ01\", \"AMS…\n$ DESTIN_SZ       &lt;chr&gt; \"AMSZ01\", \"AMSZ02\", \"AMSZ03\", \"AMSZ04\", \"AMSZ05\", \"AMS…\n$ MORNING_PEAK    &lt;dbl&gt; 1998, 8289, 8971, 2252, 6136, 2148, 1620, 1925, 1773, …\n$ dist            &lt;dbl&gt; 50.0000, 810.4491, 1360.9294, 840.4432, 1076.7916, 805…\n$ ORIGIN_AGE7_12  &lt;dbl&gt; 310, 310, 310, 310, 310, 310, 310, 310, 310, 310, 310,…\n$ ORIGIN_AGE13_24 &lt;dbl&gt; 710, 710, 710, 710, 710, 710, 710, 710, 710, 710, 710,…\n$ ORIGIN_AGE25_64 &lt;dbl&gt; 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, 2780, …\n$ DESTIN_AGE7_12  &lt;dbl&gt; 310.00, 1140.00, 1010.00, 980.00, 810.00, 1050.00, 420…\n$ DESTIN_AGE13_24 &lt;dbl&gt; 710.00, 2770.00, 2650.00, 2000.00, 1920.00, 2390.00, 1…\n$ DESTIN_AGE25_64 &lt;dbl&gt; 2780.00, 15700.00, 14240.00, 11320.00, 9650.00, 12460.…\n$ SCHOOL_COUNT    &lt;dbl&gt; 0.99, 2.00, 2.00, 1.00, 3.00, 2.00, 0.99, 0.99, 3.00, …\n$ RETAIL_COUNT    &lt;dbl&gt; 1.00, 0.99, 6.00, 0.99, 0.99, 0.99, 1.00, 117.00, 0.99…\n$ geometry        &lt;LINESTRING [m]&gt; LINESTRING (29501.77 39419...., LINESTRING …\n\n\nR is case senstitive, MORNING_PEAK will be renamed back to TRIPS, then dist to DIST to prevent confusion with R’s function dist\n\nflow_data$FlowNoIntra &lt;- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ,\n  0, flow_data$MORNING_PEAK)\n\nflow_data$offset &lt;- ifelse(\n  flow_data$ORIGIN_SZ == flow_data$DESTIN_SZ,\n  0.000001,1\n)\n\ninter_zonal_flow &lt;- flow_data %&gt;%\n  filter(FlowNoIntra &gt; 0)\n\ninter_zonal_flow &lt;- inter_zonal_flow %&gt;%\n  rename(TRIPS = MORNING_PEAK,\n         DIST = dist)\n\ntry to save the data, then we can add the line eval = false, to straight read the data. Then when we move from data cleaning to data modelling, it is good to clear the whole environment.\n\noptions(max.print = 99999)\n\n\norcSIM_Poisson &lt;- glm(formula = TRIPS ~\n                     ORIGIN_SZ +\n                     log(SCHOOL_COUNT) +\n                     log(RETAIL_COUNT) +\n                     log(DIST) -1,\n                     family = poisson(link = \"log\"),\n                     data = inter_zonal_flow,\n                     na.action = na.exclude\n                     )\nsummary(orcSIM_Poisson, maxsum=nlevels(orcSIM_Poisson))\n\n\nCall:\nglm(formula = TRIPS ~ ORIGIN_SZ + log(SCHOOL_COUNT) + log(RETAIL_COUNT) + \n    log(DIST) - 1, family = poisson(link = \"log\"), data = inter_zonal_flow, \n    na.action = na.exclude)\n\nCoefficients:\n                    Estimate Std. Error  z value Pr(&gt;|z|)    \nORIGIN_SZAMSZ01   19.8739840  0.0047627  4172.84   &lt;2e-16 ***\nORIGIN_SZAMSZ02   20.5902203  0.0042786  4812.33   &lt;2e-16 ***\nORIGIN_SZAMSZ03   20.2327026  0.0045531  4443.70   &lt;2e-16 ***\nORIGIN_SZAMSZ04   19.7744438  0.0049837  3967.79   &lt;2e-16 ***\nORIGIN_SZAMSZ05   19.6574529  0.0056396  3485.61   &lt;2e-16 ***\nORIGIN_SZAMSZ06   19.9659115  0.0048946  4079.16   &lt;2e-16 ***\nORIGIN_SZAMSZ07   18.6746164  0.0096316  1938.90   &lt;2e-16 ***\nORIGIN_SZAMSZ08   19.2701601  0.0090776  2122.82   &lt;2e-16 ***\nORIGIN_SZAMSZ09   19.9889467  0.0052858  3781.64   &lt;2e-16 ***\nORIGIN_SZAMSZ10   20.3422035  0.0045778  4443.62   &lt;2e-16 ***\nORIGIN_SZAMSZ11   18.3944113  0.0129212  1423.58   &lt;2e-16 ***\nORIGIN_SZAMSZ12   18.3484209  0.0109652  1673.33   &lt;2e-16 ***\nORIGIN_SZBDSZ01   20.9668587  0.0043388  4832.36   &lt;2e-16 ***\nORIGIN_SZBDSZ02   20.4059518  0.0050601  4032.75   &lt;2e-16 ***\nORIGIN_SZBDSZ03   20.6725514  0.0045276  4565.93   &lt;2e-16 ***\nORIGIN_SZBDSZ04   21.6703853  0.0038930  5566.44   &lt;2e-16 ***\nORIGIN_SZBDSZ05   20.7497445  0.0046085  4502.46   &lt;2e-16 ***\nORIGIN_SZBDSZ06   20.9119361  0.0046432  4503.77   &lt;2e-16 ***\nORIGIN_SZBDSZ07   18.9749815  0.0097896  1938.28   &lt;2e-16 ***\nORIGIN_SZBDSZ08   19.1933901  0.0091312  2101.95   &lt;2e-16 ***\nORIGIN_SZBKSZ01   19.5422606  0.0064732  3018.96   &lt;2e-16 ***\nORIGIN_SZBKSZ02   20.1748913  0.0050076  4028.89   &lt;2e-16 ***\nORIGIN_SZBKSZ03   20.3984624  0.0047226  4319.35   &lt;2e-16 ***\nORIGIN_SZBKSZ04   19.6182212  0.0059652  3288.76   &lt;2e-16 ***\nORIGIN_SZBKSZ05   19.6033818  0.0063181  3102.74   &lt;2e-16 ***\nORIGIN_SZBKSZ06   19.7145224  0.0056372  3497.20   &lt;2e-16 ***\nORIGIN_SZBKSZ07   20.4237448  0.0041912  4873.03   &lt;2e-16 ***\nORIGIN_SZBKSZ08   19.7992538  0.0050405  3928.02   &lt;2e-16 ***\nORIGIN_SZBKSZ09   19.7821586  0.0055558  3560.66   &lt;2e-16 ***\nORIGIN_SZBLSZ01   17.7977276  0.0149058  1194.01   &lt;2e-16 ***\nORIGIN_SZBLSZ02   17.4287491  0.0192364   906.03   &lt;2e-16 ***\nORIGIN_SZBLSZ03   16.5884288  0.0459848   360.74   &lt;2e-16 ***\nORIGIN_SZBLSZ04   17.7851626  0.0232823   763.89   &lt;2e-16 ***\nORIGIN_SZBMSZ01   20.0751840  0.0052887  3795.89   &lt;2e-16 ***\nORIGIN_SZBMSZ02   18.6956140  0.0066656  2804.80   &lt;2e-16 ***\nORIGIN_SZBMSZ03   19.3204425  0.0054755  3528.56   &lt;2e-16 ***\nORIGIN_SZBMSZ04   19.4724220  0.0049390  3942.59   &lt;2e-16 ***\nORIGIN_SZBMSZ05   16.9581801  0.0168804  1004.61   &lt;2e-16 ***\nORIGIN_SZBMSZ06   16.9898638  0.0181852   934.27   &lt;2e-16 ***\nORIGIN_SZBMSZ07   19.2868403  0.0056231  3429.91   &lt;2e-16 ***\nORIGIN_SZBMSZ08   19.1477543  0.0055918  3424.28   &lt;2e-16 ***\nORIGIN_SZBMSZ09   18.7564539  0.0086298  2173.46   &lt;2e-16 ***\nORIGIN_SZBMSZ10   18.3617854  0.0089250  2057.35   &lt;2e-16 ***\nORIGIN_SZBMSZ11   18.9167941  0.0063340  2986.54   &lt;2e-16 ***\nORIGIN_SZBMSZ12   18.7874661  0.0093024  2019.63   &lt;2e-16 ***\nORIGIN_SZBMSZ13   19.5654046  0.0057517  3401.70   &lt;2e-16 ***\nORIGIN_SZBMSZ14   19.0685619  0.0063346  3010.24   &lt;2e-16 ***\nORIGIN_SZBMSZ15   19.4403124  0.0058147  3343.30   &lt;2e-16 ***\nORIGIN_SZBMSZ16   18.4469203  0.0092638  1991.28   &lt;2e-16 ***\nORIGIN_SZBMSZ17   18.3430175  0.0157692  1163.22   &lt;2e-16 ***\nORIGIN_SZBPSZ01   20.1806714  0.0053660  3760.81   &lt;2e-16 ***\nORIGIN_SZBPSZ02   19.8116707  0.0061485  3222.19   &lt;2e-16 ***\nORIGIN_SZBPSZ03   19.8467602  0.0059769  3320.57   &lt;2e-16 ***\nORIGIN_SZBPSZ04   20.4613200  0.0048398  4227.72   &lt;2e-16 ***\nORIGIN_SZBPSZ05   20.5379711  0.0043769  4692.39   &lt;2e-16 ***\nORIGIN_SZBPSZ06   18.8948034  0.0093668  2017.21   &lt;2e-16 ***\nORIGIN_SZBPSZ07   19.4104568  0.0087961  2206.70   &lt;2e-16 ***\nORIGIN_SZBSSZ01   20.0139503  0.0056561  3538.45   &lt;2e-16 ***\nORIGIN_SZBSSZ02   20.2543885  0.0047198  4291.38   &lt;2e-16 ***\nORIGIN_SZBSSZ03   19.5428803  0.0052713  3707.41   &lt;2e-16 ***\nORIGIN_SZBTSZ01   20.0198045  0.0058541  3419.77   &lt;2e-16 ***\nORIGIN_SZBTSZ02   19.3618525  0.0081472  2376.51   &lt;2e-16 ***\nORIGIN_SZBTSZ03   19.5883853  0.0068935  2841.59   &lt;2e-16 ***\nORIGIN_SZBTSZ04   18.7720238  0.0103909  1806.58   &lt;2e-16 ***\nORIGIN_SZBTSZ05   18.8069026  0.0120628  1559.08   &lt;2e-16 ***\nORIGIN_SZBTSZ06   18.7068633  0.0094575  1978.00   &lt;2e-16 ***\nORIGIN_SZBTSZ07   17.6292257  0.0141551  1245.43   &lt;2e-16 ***\nORIGIN_SZBTSZ08   18.6989374  0.0109610  1705.94   &lt;2e-16 ***\nORIGIN_SZCBSZ01   18.2189868  0.0548317   332.27   &lt;2e-16 ***\nORIGIN_SZCCSZ01   18.9734563  0.0139450  1360.59   &lt;2e-16 ***\nORIGIN_SZCHSZ01   19.5955119  0.0121035  1619.00   &lt;2e-16 ***\nORIGIN_SZCHSZ02   19.3320960  0.0081620  2368.55   &lt;2e-16 ***\nORIGIN_SZCHSZ03   21.2164518  0.0063552  3338.43   &lt;2e-16 ***\nORIGIN_SZCKSZ01   20.1046845  0.0049333  4075.29   &lt;2e-16 ***\nORIGIN_SZCKSZ02   20.5371946  0.0050256  4086.53   &lt;2e-16 ***\nORIGIN_SZCKSZ03   20.7210560  0.0042184  4912.07   &lt;2e-16 ***\nORIGIN_SZCKSZ04   21.4013886  0.0042524  5032.80   &lt;2e-16 ***\nORIGIN_SZCKSZ05   20.9413146  0.0049434  4236.18   &lt;2e-16 ***\nORIGIN_SZCKSZ06   20.2557727  0.0071832  2819.88   &lt;2e-16 ***\nORIGIN_SZCLSZ01   19.3383703  0.0076634  2523.46   &lt;2e-16 ***\nORIGIN_SZCLSZ02   18.5226956  0.0135522  1366.77   &lt;2e-16 ***\nORIGIN_SZCLSZ03   19.0225512  0.0080145  2373.51   &lt;2e-16 ***\nORIGIN_SZCLSZ04   20.7981505  0.0042400  4905.22   &lt;2e-16 ***\nORIGIN_SZCLSZ05   18.3015625  0.0146815  1246.58   &lt;2e-16 ***\nORIGIN_SZCLSZ06   20.8207386  0.0039567  5262.09   &lt;2e-16 ***\nORIGIN_SZCLSZ07   19.6728958  0.0054199  3629.76   &lt;2e-16 ***\nORIGIN_SZCLSZ08   20.0851929  0.0056956  3526.43   &lt;2e-16 ***\nORIGIN_SZCLSZ09   18.5749589  0.0165415  1122.93   &lt;2e-16 ***\nORIGIN_SZDTSZ02   15.8276209  0.0833992   189.78   &lt;2e-16 ***\nORIGIN_SZDTSZ03   16.2512838  0.0737972   220.22   &lt;2e-16 ***\nORIGIN_SZDTSZ13   16.7744385  0.0312450   536.87   &lt;2e-16 ***\nORIGIN_SZGLSZ01   18.2368248  0.0096104  1897.62   &lt;2e-16 ***\nORIGIN_SZGLSZ02   19.8705255  0.0049014  4054.06   &lt;2e-16 ***\nORIGIN_SZGLSZ03   19.8249435  0.0053109  3732.85   &lt;2e-16 ***\nORIGIN_SZGLSZ04   20.7800335  0.0041261  5036.20   &lt;2e-16 ***\nORIGIN_SZGLSZ05   20.6040494  0.0043049  4786.23   &lt;2e-16 ***\nORIGIN_SZHGSZ01   20.0273475  0.0044824  4468.04   &lt;2e-16 ***\nORIGIN_SZHGSZ02   20.2480656  0.0044575  4542.47   &lt;2e-16 ***\nORIGIN_SZHGSZ03   20.0756442  0.0049003  4096.81   &lt;2e-16 ***\nORIGIN_SZHGSZ04   20.7577748  0.0040465  5129.84   &lt;2e-16 ***\nORIGIN_SZHGSZ05   20.9779992  0.0040123  5228.42   &lt;2e-16 ***\nORIGIN_SZHGSZ06   19.7403058  0.0054229  3640.20   &lt;2e-16 ***\nORIGIN_SZHGSZ07   20.1896268  0.0046051  4384.22   &lt;2e-16 ***\nORIGIN_SZHGSZ08   19.8646492  0.0052403  3790.72   &lt;2e-16 ***\nORIGIN_SZHGSZ09   18.3647736  0.0069196  2654.04   &lt;2e-16 ***\nORIGIN_SZHGSZ10   16.8720475  0.0421046   400.72   &lt;2e-16 ***\nORIGIN_SZJESZ01   20.2673794  0.0046723  4337.79   &lt;2e-16 ***\nORIGIN_SZJESZ02   20.0595982  0.0046503  4313.61   &lt;2e-16 ***\nORIGIN_SZJESZ03   19.9128778  0.0049848  3994.75   &lt;2e-16 ***\nORIGIN_SZJESZ04   18.5053667  0.0099227  1864.94   &lt;2e-16 ***\nORIGIN_SZJESZ05   17.8172930  0.0138840  1283.29   &lt;2e-16 ***\nORIGIN_SZJESZ06   20.0124157  0.0045009  4446.36   &lt;2e-16 ***\nORIGIN_SZJESZ07   18.1821423  0.0117267  1550.49   &lt;2e-16 ***\nORIGIN_SZJESZ08   18.8713046  0.0116456  1620.46   &lt;2e-16 ***\nORIGIN_SZJESZ09   20.5535527  0.0048456  4241.72   &lt;2e-16 ***\nORIGIN_SZJESZ10   18.4922322  0.0191243   966.95   &lt;2e-16 ***\nORIGIN_SZJESZ11   18.2891211  0.0197114   927.85   &lt;2e-16 ***\nORIGIN_SZJWSZ01   20.4912737  0.0063102  3247.35   &lt;2e-16 ***\nORIGIN_SZJWSZ02   20.8236694  0.0042249  4928.82   &lt;2e-16 ***\nORIGIN_SZJWSZ03   21.2587613  0.0039733  5350.40   &lt;2e-16 ***\nORIGIN_SZJWSZ04   20.3816464  0.0046199  4411.67   &lt;2e-16 ***\nORIGIN_SZJWSZ05   18.0607448  0.0128857  1401.61   &lt;2e-16 ***\nORIGIN_SZJWSZ06   18.7015202  0.0107614  1737.83   &lt;2e-16 ***\nORIGIN_SZJWSZ07   17.3991822  0.0277096   627.91   &lt;2e-16 ***\nORIGIN_SZJWSZ08   21.8044465  0.0037356  5836.95   &lt;2e-16 ***\nORIGIN_SZJWSZ09   21.5414930  0.0036033  5978.19   &lt;2e-16 ***\nORIGIN_SZKLSZ01   20.0307712  0.0047868  4184.59   &lt;2e-16 ***\nORIGIN_SZKLSZ02   19.0634769  0.0062318  3059.05   &lt;2e-16 ***\nORIGIN_SZKLSZ03   19.2685700  0.0057172  3370.25   &lt;2e-16 ***\nORIGIN_SZKLSZ04   17.7085067  0.0119809  1478.06   &lt;2e-16 ***\nORIGIN_SZKLSZ05   18.6384471  0.0107596  1732.26   &lt;2e-16 ***\nORIGIN_SZKLSZ06   13.7280296  0.1857160    73.92   &lt;2e-16 ***\nORIGIN_SZKLSZ07   18.6425146  0.0084952  2194.47   &lt;2e-16 ***\nORIGIN_SZKLSZ08   18.0928506  0.0101567  1781.37   &lt;2e-16 ***\nORIGIN_SZLKSZ01   17.8907138  0.0397083   450.55   &lt;2e-16 ***\nORIGIN_SZMDSZ01   18.7605188  0.0285455   657.22   &lt;2e-16 ***\nORIGIN_SZMDSZ02   19.1533927  0.0102815  1862.90   &lt;2e-16 ***\nORIGIN_SZMDSZ03   17.8404982  0.0169690  1051.36   &lt;2e-16 ***\nORIGIN_SZMPSZ01   19.0765941  0.0083937  2272.74   &lt;2e-16 ***\nORIGIN_SZMPSZ02   19.2162527  0.0068331  2812.24   &lt;2e-16 ***\nORIGIN_SZMPSZ03   19.9965344  0.0054569  3664.44   &lt;2e-16 ***\nORIGIN_SZMUSZ02   15.9130765  0.1037472   153.38   &lt;2e-16 ***\nORIGIN_SZNTSZ01   17.0840999  0.0352513   484.64   &lt;2e-16 ***\nORIGIN_SZNTSZ02   16.5792122  0.0233186   710.99   &lt;2e-16 ***\nORIGIN_SZNTSZ03   18.9506415  0.0075957  2494.93   &lt;2e-16 ***\nORIGIN_SZNTSZ05   15.8770261  0.0495825   320.21   &lt;2e-16 ***\nORIGIN_SZNTSZ06   15.3997415  0.0557029   276.46   &lt;2e-16 ***\nORIGIN_SZNVSZ01   20.2241694  0.0043487  4650.65   &lt;2e-16 ***\nORIGIN_SZNVSZ02   19.1897826  0.0065383  2934.97   &lt;2e-16 ***\nORIGIN_SZNVSZ03   18.8854268  0.0080459  2347.22   &lt;2e-16 ***\nORIGIN_SZNVSZ04   18.8940191  0.0090985  2076.61   &lt;2e-16 ***\nORIGIN_SZNVSZ05   17.6278585  0.0168107  1048.61   &lt;2e-16 ***\nORIGIN_SZPGSZ01   19.4825220  0.0122960  1584.46   &lt;2e-16 ***\nORIGIN_SZPGSZ02   19.4726761  0.0073116  2663.25   &lt;2e-16 ***\nORIGIN_SZPGSZ03   20.5515713  0.0045631  4503.86   &lt;2e-16 ***\nORIGIN_SZPGSZ04   21.0527131  0.0041500  5072.89   &lt;2e-16 ***\nORIGIN_SZPGSZ05   20.1436604  0.0057267  3517.48   &lt;2e-16 ***\nORIGIN_SZPLSZ01   19.1832002  0.0120006  1598.53   &lt;2e-16 ***\nORIGIN_SZPLSZ02   18.8752206  0.0149740  1260.53   &lt;2e-16 ***\nORIGIN_SZPLSZ03   18.1000818  0.0371769   486.86   &lt;2e-16 ***\nORIGIN_SZPLSZ04   17.1730559  0.0370280   463.79   &lt;2e-16 ***\nORIGIN_SZPLSZ05   17.9084439  0.0225031   795.82   &lt;2e-16 ***\nORIGIN_SZPNSZ01   21.0804425  0.0044829  4702.41   &lt;2e-16 ***\nORIGIN_SZPNSZ02   19.8822123  0.0111507  1783.05   &lt;2e-16 ***\nORIGIN_SZPNSZ03   17.9293289  0.0193571   926.24   &lt;2e-16 ***\nORIGIN_SZPNSZ04   17.1039594  0.0334954   510.64   &lt;2e-16 ***\nORIGIN_SZPNSZ05   18.2543864  0.0275554   662.46   &lt;2e-16 ***\nORIGIN_SZPRSZ01   19.8777935  0.0117586  1690.49   &lt;2e-16 ***\nORIGIN_SZPRSZ02   21.0751780  0.0044832  4700.88   &lt;2e-16 ***\nORIGIN_SZPRSZ03   20.6717019  0.0045577  4535.55   &lt;2e-16 ***\nORIGIN_SZPRSZ04   19.6365125  0.0074923  2620.90   &lt;2e-16 ***\nORIGIN_SZPRSZ05   21.3132151  0.0042119  5060.24   &lt;2e-16 ***\nORIGIN_SZPRSZ06   18.9314574  0.0117278  1614.24   &lt;2e-16 ***\nORIGIN_SZPRSZ07   17.2822918  0.0162430  1063.98   &lt;2e-16 ***\nORIGIN_SZPRSZ08   19.9267642  0.0062298  3198.62   &lt;2e-16 ***\nORIGIN_SZQTSZ01   19.7357175  0.0066359  2974.08   &lt;2e-16 ***\nORIGIN_SZQTSZ02   19.2082141  0.0061402  3128.26   &lt;2e-16 ***\nORIGIN_SZQTSZ03   19.7771883  0.0056220  3517.83   &lt;2e-16 ***\nORIGIN_SZQTSZ04   18.7114421  0.0072842  2568.76   &lt;2e-16 ***\nORIGIN_SZQTSZ05   19.3049324  0.0062401  3093.69   &lt;2e-16 ***\nORIGIN_SZQTSZ06   19.2643228  0.0065590  2937.09   &lt;2e-16 ***\nORIGIN_SZQTSZ07   18.5697347  0.0095373  1947.06   &lt;2e-16 ***\nORIGIN_SZQTSZ08   19.6147001  0.0061330  3198.21   &lt;2e-16 ***\nORIGIN_SZQTSZ09   19.2550793  0.0069947  2752.82   &lt;2e-16 ***\nORIGIN_SZQTSZ10   19.5801866  0.0064513  3035.07   &lt;2e-16 ***\nORIGIN_SZQTSZ11   17.7398366  0.0143648  1234.95   &lt;2e-16 ***\nORIGIN_SZQTSZ12   17.2420354  0.0186736   923.34   &lt;2e-16 ***\nORIGIN_SZQTSZ13   19.3857418  0.0078878  2457.69   &lt;2e-16 ***\nORIGIN_SZQTSZ14   18.1300753  0.0122096  1484.90   &lt;2e-16 ***\nORIGIN_SZQTSZ15   19.4222283  0.0120871  1606.86   &lt;2e-16 ***\nORIGIN_SZRCSZ01   18.1549045  0.0125108  1451.13   &lt;2e-16 ***\nORIGIN_SZRCSZ06   18.8836400  0.0082161  2298.38   &lt;2e-16 ***\nORIGIN_SZRVSZ01   16.7864438  0.0323796   518.43   &lt;2e-16 ***\nORIGIN_SZRVSZ02   16.4203244  0.0276836   593.14   &lt;2e-16 ***\nORIGIN_SZRVSZ03   16.6453738  0.0244992   679.42   &lt;2e-16 ***\nORIGIN_SZRVSZ04   15.9559213  0.0556344   286.80   &lt;2e-16 ***\nORIGIN_SZRVSZ05   17.0476331  0.0164122  1038.71   &lt;2e-16 ***\nORIGIN_SZSBSZ01   20.0417968  0.0062488  3207.29   &lt;2e-16 ***\nORIGIN_SZSBSZ02   19.1869565  0.0081051  2367.26   &lt;2e-16 ***\nORIGIN_SZSBSZ03   20.5769861  0.0045108  4561.70   &lt;2e-16 ***\nORIGIN_SZSBSZ04   20.5154199  0.0050548  4058.57   &lt;2e-16 ***\nORIGIN_SZSBSZ05   19.6250669  0.0065562  2993.35   &lt;2e-16 ***\nORIGIN_SZSBSZ06   18.8419757  0.0171135  1101.00   &lt;2e-16 ***\nORIGIN_SZSBSZ07   19.4897259  0.0124528  1565.09   &lt;2e-16 ***\nORIGIN_SZSBSZ08   18.7027917  0.0140545  1330.73   &lt;2e-16 ***\nORIGIN_SZSBSZ09   18.8893480  0.0088571  2132.67   &lt;2e-16 ***\nORIGIN_SZSESZ02   20.8962192  0.0041665  5015.34   &lt;2e-16 ***\nORIGIN_SZSESZ03   20.9452771  0.0039737  5270.94   &lt;2e-16 ***\nORIGIN_SZSESZ04   20.6576142  0.0046364  4455.55   &lt;2e-16 ***\nORIGIN_SZSESZ05   19.5170732  0.0058912  3312.92   &lt;2e-16 ***\nORIGIN_SZSESZ06   20.7595824  0.0045747  4537.89   &lt;2e-16 ***\nORIGIN_SZSESZ07   17.6888256  0.0195787   903.47   &lt;2e-16 ***\nORIGIN_SZSGSZ01   19.1359250  0.0085781  2230.79   &lt;2e-16 ***\nORIGIN_SZSGSZ02   18.5614369  0.0102037  1819.10   &lt;2e-16 ***\nORIGIN_SZSGSZ03   19.9933176  0.0050434  3964.23   &lt;2e-16 ***\nORIGIN_SZSGSZ04   20.2426871  0.0047211  4287.71   &lt;2e-16 ***\nORIGIN_SZSGSZ05   18.0114965  0.0107743  1671.70   &lt;2e-16 ***\nORIGIN_SZSGSZ06   20.2593194  0.0044538  4548.76   &lt;2e-16 ***\nORIGIN_SZSGSZ07   19.0763664  0.0062968  3029.54   &lt;2e-16 ***\nORIGIN_SZSKSZ01   19.9222451  0.0085136  2340.04   &lt;2e-16 ***\nORIGIN_SZSKSZ02   20.8633383  0.0055248  3776.33   &lt;2e-16 ***\nORIGIN_SZSKSZ03   19.6528148  0.0080534  2440.33   &lt;2e-16 ***\nORIGIN_SZSKSZ04   18.0754470  0.0275771   655.45   &lt;2e-16 ***\nORIGIN_SZSKSZ05   19.1192521  0.0155579  1228.91   &lt;2e-16 ***\nORIGIN_SZSLSZ01   17.1501034  0.0329384   520.67   &lt;2e-16 ***\nORIGIN_SZSLSZ04   19.5949774  0.0076753  2552.98   &lt;2e-16 ***\nORIGIN_SZSRSZ01   16.9761403  0.0162020  1047.78   &lt;2e-16 ***\nORIGIN_SZTHSZ01   17.9695687  0.0488559   367.81   &lt;2e-16 ***\nORIGIN_SZTHSZ03   18.5427522  0.0223617   829.22   &lt;2e-16 ***\nORIGIN_SZTHSZ04   17.4760374  0.0286247   610.52   &lt;2e-16 ***\nORIGIN_SZTHSZ06   17.8401186  0.0183322   973.16   &lt;2e-16 ***\nORIGIN_SZTMSZ01   20.3406361  0.0056607  3593.33   &lt;2e-16 ***\nORIGIN_SZTMSZ02   22.0307026  0.0037386  5892.85   &lt;2e-16 ***\nORIGIN_SZTMSZ03   21.3451920  0.0040606  5256.65   &lt;2e-16 ***\nORIGIN_SZTMSZ04   20.6611593  0.0049896  4140.87   &lt;2e-16 ***\nORIGIN_SZTMSZ05   19.3323133  0.0112868  1712.82   &lt;2e-16 ***\nORIGIN_SZTNSZ01   17.9513571  0.0128266  1399.54   &lt;2e-16 ***\nORIGIN_SZTNSZ02   18.0267387  0.0098372  1832.51   &lt;2e-16 ***\nORIGIN_SZTNSZ03   17.7253700  0.0134668  1316.23   &lt;2e-16 ***\nORIGIN_SZTNSZ04   19.4474075  0.0073760  2636.59   &lt;2e-16 ***\nORIGIN_SZTPSZ01   19.1078631  0.0065635  2911.25   &lt;2e-16 ***\nORIGIN_SZTPSZ02   20.2837634  0.0041411  4898.18   &lt;2e-16 ***\nORIGIN_SZTPSZ03   19.1838238  0.0059552  3221.37   &lt;2e-16 ***\nORIGIN_SZTPSZ04   19.1805388  0.0054778  3501.53   &lt;2e-16 ***\nORIGIN_SZTPSZ05   19.3718076  0.0058610  3305.18   &lt;2e-16 ***\nORIGIN_SZTPSZ06   19.6605723  0.0054968  3576.70   &lt;2e-16 ***\nORIGIN_SZTPSZ07   19.4499807  0.0060491  3215.36   &lt;2e-16 ***\nORIGIN_SZTPSZ08   18.7996538  0.0095757  1963.28   &lt;2e-16 ***\nORIGIN_SZTPSZ09   19.0025110  0.0067068  2833.31   &lt;2e-16 ***\nORIGIN_SZTPSZ10   18.8899657  0.0076094  2482.46   &lt;2e-16 ***\nORIGIN_SZTPSZ11   19.6277780  0.0053983  3635.93   &lt;2e-16 ***\nORIGIN_SZTPSZ12   19.1471104  0.0065742  2912.45   &lt;2e-16 ***\nORIGIN_SZTSSZ01   17.4901113  0.0478954   365.17   &lt;2e-16 ***\nORIGIN_SZTSSZ02   20.4997466  0.0081850  2504.55   &lt;2e-16 ***\nORIGIN_SZTSSZ03   20.1076553  0.0084728  2373.19   &lt;2e-16 ***\nORIGIN_SZTSSZ04   20.0646610  0.0089008  2254.26   &lt;2e-16 ***\nORIGIN_SZTSSZ05   19.3962067  0.0151392  1281.19   &lt;2e-16 ***\nORIGIN_SZTSSZ06   20.9235857  0.0178278  1173.65   &lt;2e-16 ***\nORIGIN_SZWCSZ01   20.8411600  0.0086519  2408.86   &lt;2e-16 ***\nORIGIN_SZWCSZ02   17.7355404  0.0328889   539.26   &lt;2e-16 ***\nORIGIN_SZWCSZ03   14.9380886  0.1240699   120.40   &lt;2e-16 ***\nORIGIN_SZWDSZ01   21.1969012  0.0037830  5603.23   &lt;2e-16 ***\nORIGIN_SZWDSZ02   20.5930001  0.0044572  4620.13   &lt;2e-16 ***\nORIGIN_SZWDSZ03   21.2521867  0.0041672  5099.85   &lt;2e-16 ***\nORIGIN_SZWDSZ04   21.0702687  0.0048648  4331.13   &lt;2e-16 ***\nORIGIN_SZWDSZ05   20.4008998  0.0051801  3938.35   &lt;2e-16 ***\nORIGIN_SZWDSZ06   20.6669176  0.0049280  4193.78   &lt;2e-16 ***\nORIGIN_SZWDSZ07   19.0500370  0.0082729  2302.71   &lt;2e-16 ***\nORIGIN_SZWDSZ08   19.0816252  0.0080667  2365.49   &lt;2e-16 ***\nORIGIN_SZWDSZ09   21.4182096  0.0040391  5302.73   &lt;2e-16 ***\nORIGIN_SZYSSZ01   19.5355157  0.0057540  3395.14   &lt;2e-16 ***\nORIGIN_SZYSSZ02   20.8737972  0.0048278  4323.64   &lt;2e-16 ***\nORIGIN_SZYSSZ03   21.6614437  0.0040011  5413.81   &lt;2e-16 ***\nORIGIN_SZYSSZ04   20.9305289  0.0043595  4801.10   &lt;2e-16 ***\nORIGIN_SZYSSZ05   20.1727678  0.0058466  3450.34   &lt;2e-16 ***\nORIGIN_SZYSSZ06   19.1481507  0.0116724  1640.47   &lt;2e-16 ***\nORIGIN_SZYSSZ07   18.7919074  0.0141636  1326.78   &lt;2e-16 ***\nORIGIN_SZYSSZ08   19.9733515  0.0061229  3262.07   &lt;2e-16 ***\nORIGIN_SZYSSZ09   20.9366181  0.0040347  5189.15   &lt;2e-16 ***\nlog(SCHOOL_COUNT)  0.4755516  0.0004701  1011.55   &lt;2e-16 ***\nlog(RETAIL_COUNT)  0.1796905  0.0001856   968.12   &lt;2e-16 ***\nlog(DIST)         -1.6929522  0.0004093 -4136.01   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 189463537  on 14471  degrees of freedom\nResidual deviance:  15526121  on 14189  degrees of freedom\nAIC: 15615824\n\nNumber of Fisher Scoring iterations: 6\n\n\nthe purpose of the -1 is to remove the intercept. For the origin, destination constraint, it is already constrained, so there is no such thing as intercept. This is different from the in-class Ex3, while\nwe already control the origin / destination, there is no such thing as intercept. The idea of intercept is to control the overflow.\nwe need to look at the parameter, alpha, gamma, beta\nfor distance, we should look at inverse relationship. log(DIST) should be -ve. T\nattractiveness should always be +ve. In Singapore, it is unusual, but in other places, it could be e.g. crime rate, you don’t want to go shopping / reside in a place with high crime rate\n\nCalcRSquared &lt;- function(observed,estimated){\n  r &lt;- cor(observed,estimated)\n  R2 &lt;- r^2\n  R2\n}\n\n\nCalcRSquared(orcSIM_Poisson$data$TRIPS, orcSIM_Poisson$fitted.values)\n\n[1] 0.4362208\n\n\nnotice that we use data from specific field, in R datamodel, we have the trips in a list. This is a list of 30 objects. The list contain multiple information.\nif we want to convert to dataframe, we just to extract, for example\n\nsomeerrorextract &lt;- orcSIM_Poisson$residuals %&gt;%\n  as.data.frame()\n\nbut when we extract, we don’t know which it correlates to becuase it don’t have the name, so we need to extract the name, and join it back as per in-class_Ex3\nthe fitted value is the estimated value.\n\nperformance_rmse(orcSIM_Poisson,\n                 normalized = FALSE)\n\n[1] 2613.236\n\n\nnormalised = TRUE, it will standardise the value. mean = 0, std = 1, if we set it as false then it is a raw value\nDoubly constrainted\n\ndbcSIM_Poisson &lt;- glm(formula = TRIPS ~\n                        ORIGIN_SZ + \n                        DESTIN_SZ +\n                        log(DIST),\n                      family = poisson(link = \"log\"),\n                      data = inter_zonal_flow,\n                      na.action = na.exclude)\n\nsummary(dbcSIM_Poisson)\n\n\nCall:\nglm(formula = TRIPS ~ ORIGIN_SZ + DESTIN_SZ + log(DIST), family = poisson(link = \"log\"), \n    data = inter_zonal_flow, na.action = na.exclude)\n\nCoefficients:\n                  Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)     21.8312374  0.0059160  3690.190  &lt; 2e-16 ***\nORIGIN_SZAMSZ02  0.5263502  0.0048031   109.585  &lt; 2e-16 ***\nORIGIN_SZAMSZ03  0.3139982  0.0049254    63.751  &lt; 2e-16 ***\nORIGIN_SZAMSZ04 -0.2146257  0.0053639   -40.013  &lt; 2e-16 ***\nORIGIN_SZAMSZ05 -0.1890446  0.0060386   -31.306  &lt; 2e-16 ***\nORIGIN_SZAMSZ06  0.1539201  0.0054401    28.294  &lt; 2e-16 ***\nORIGIN_SZAMSZ07 -0.9826565  0.0098676   -99.584  &lt; 2e-16 ***\nORIGIN_SZAMSZ08 -0.4488417  0.0093070   -48.226  &lt; 2e-16 ***\nORIGIN_SZAMSZ09  0.0713474  0.0057402    12.429  &lt; 2e-16 ***\nORIGIN_SZAMSZ10  0.4313742  0.0050370    85.641  &lt; 2e-16 ***\nORIGIN_SZAMSZ11 -1.4712226  0.0131178  -112.154  &lt; 2e-16 ***\nORIGIN_SZAMSZ12 -1.7250733  0.0111603  -154.573  &lt; 2e-16 ***\nORIGIN_SZBDSZ01  0.8810576  0.0048168   182.914  &lt; 2e-16 ***\nORIGIN_SZBDSZ02  0.1100240  0.0055529    19.814  &lt; 2e-16 ***\nORIGIN_SZBDSZ03  0.3606166  0.0050672    71.167  &lt; 2e-16 ***\nORIGIN_SZBDSZ04  1.4624347  0.0044212   330.781  &lt; 2e-16 ***\nORIGIN_SZBDSZ05  0.6207557  0.0050843   122.092  &lt; 2e-16 ***\nORIGIN_SZBDSZ06  0.6712973  0.0051953   129.214  &lt; 2e-16 ***\nORIGIN_SZBDSZ07 -1.2338669  0.0100775  -122.437  &lt; 2e-16 ***\nORIGIN_SZBDSZ08 -1.0444562  0.0094555  -110.460  &lt; 2e-16 ***\nORIGIN_SZBKSZ01 -0.2838426  0.0071354   -39.780  &lt; 2e-16 ***\nORIGIN_SZBKSZ02  0.5550522  0.0059014    94.054  &lt; 2e-16 ***\nORIGIN_SZBKSZ03  0.7396640  0.0056796   130.231  &lt; 2e-16 ***\nORIGIN_SZBKSZ04 -0.2242451  0.0067482   -33.230  &lt; 2e-16 ***\nORIGIN_SZBKSZ05 -0.2371614  0.0069386   -34.180  &lt; 2e-16 ***\nORIGIN_SZBKSZ06 -0.1413812  0.0065035   -21.739  &lt; 2e-16 ***\nORIGIN_SZBKSZ07  0.7089989  0.0051843   136.758  &lt; 2e-16 ***\nORIGIN_SZBKSZ08 -0.0907065  0.0059157   -15.333  &lt; 2e-16 ***\nORIGIN_SZBKSZ09 -0.1775146  0.0063302   -28.042  &lt; 2e-16 ***\nORIGIN_SZBLSZ01 -2.3684539  0.0154280  -153.516  &lt; 2e-16 ***\nORIGIN_SZBLSZ02 -2.8078475  0.0197839  -141.926  &lt; 2e-16 ***\nORIGIN_SZBLSZ03 -3.3122763  0.0466091   -71.065  &lt; 2e-16 ***\nORIGIN_SZBLSZ04 -2.6770542  0.0241793  -110.717  &lt; 2e-16 ***\nORIGIN_SZBMSZ01  0.0618035  0.0059400    10.405  &lt; 2e-16 ***\nORIGIN_SZBMSZ02 -1.3535767  0.0073741  -183.557  &lt; 2e-16 ***\nORIGIN_SZBMSZ03 -0.7569095  0.0063187  -119.790  &lt; 2e-16 ***\nORIGIN_SZBMSZ04 -0.2949304  0.0059603   -49.483  &lt; 2e-16 ***\nORIGIN_SZBMSZ05 -2.6131992  0.0172376  -151.599  &lt; 2e-16 ***\nORIGIN_SZBMSZ06 -3.0315024  0.0185502  -163.422  &lt; 2e-16 ***\nORIGIN_SZBMSZ07 -0.6962524  0.0064068  -108.674  &lt; 2e-16 ***\nORIGIN_SZBMSZ08 -0.9310730  0.0064541  -144.261  &lt; 2e-16 ***\nORIGIN_SZBMSZ09 -1.2911253  0.0092047  -140.268  &lt; 2e-16 ***\nORIGIN_SZBMSZ10 -1.6687004  0.0095708  -174.353  &lt; 2e-16 ***\nORIGIN_SZBMSZ11 -1.1152794  0.0072027  -154.841  &lt; 2e-16 ***\nORIGIN_SZBMSZ12 -1.5323954  0.0099932  -153.344  &lt; 2e-16 ***\nORIGIN_SZBMSZ13 -0.6267376  0.0065863   -95.158  &lt; 2e-16 ***\nORIGIN_SZBMSZ14 -1.0475467  0.0072472  -144.544  &lt; 2e-16 ***\nORIGIN_SZBMSZ15 -0.5049444  0.0067390   -74.929  &lt; 2e-16 ***\nORIGIN_SZBMSZ16 -1.5282897  0.0099545  -153.527  &lt; 2e-16 ***\nORIGIN_SZBMSZ17 -1.5722349  0.0161533   -97.332  &lt; 2e-16 ***\nORIGIN_SZBPSZ01  0.5814175  0.0062904    92.429  &lt; 2e-16 ***\nORIGIN_SZBPSZ02  0.0875442  0.0072190    12.127  &lt; 2e-16 ***\nORIGIN_SZBPSZ03  0.3358227  0.0070460    47.662  &lt; 2e-16 ***\nORIGIN_SZBPSZ04  0.6507586  0.0057726   112.733  &lt; 2e-16 ***\nORIGIN_SZBPSZ05  0.9502124  0.0052971   179.384  &lt; 2e-16 ***\nORIGIN_SZBPSZ06 -1.0480314  0.0098191  -106.734  &lt; 2e-16 ***\nORIGIN_SZBPSZ07 -0.5467931  0.0091676   -59.644  &lt; 2e-16 ***\nORIGIN_SZBSSZ01  0.2998334  0.0059193    50.654  &lt; 2e-16 ***\nORIGIN_SZBSSZ02  0.2841036  0.0050863    55.856  &lt; 2e-16 ***\nORIGIN_SZBSSZ03 -0.2331505  0.0056565   -41.218  &lt; 2e-16 ***\nORIGIN_SZBTSZ01  0.0987284  0.0063715    15.495  &lt; 2e-16 ***\nORIGIN_SZBTSZ02 -0.6261229  0.0084604   -74.006  &lt; 2e-16 ***\nORIGIN_SZBTSZ03 -0.4326963  0.0073452   -58.909  &lt; 2e-16 ***\nORIGIN_SZBTSZ04 -1.4998668  0.0110013  -136.336  &lt; 2e-16 ***\nORIGIN_SZBTSZ05 -0.9564768  0.0122202   -78.270  &lt; 2e-16 ***\nORIGIN_SZBTSZ06 -1.2853131  0.0099328  -129.401  &lt; 2e-16 ***\nORIGIN_SZBTSZ07 -2.3870991  0.0144589  -165.096  &lt; 2e-16 ***\nORIGIN_SZBTSZ08 -1.3715855  0.0113825  -120.499  &lt; 2e-16 ***\nORIGIN_SZCBSZ01 -3.5940232  0.0548979   -65.467  &lt; 2e-16 ***\nORIGIN_SZCCSZ01 -0.7008220  0.0140373   -49.926  &lt; 2e-16 ***\nORIGIN_SZCHSZ01 -0.9109524  0.0122869   -74.140  &lt; 2e-16 ***\nORIGIN_SZCHSZ02 -0.8566547  0.0088749   -96.526  &lt; 2e-16 ***\nORIGIN_SZCHSZ03  1.1153731  0.0066136   168.650  &lt; 2e-16 ***\nORIGIN_SZCKSZ01  0.3001815  0.0058548    51.271  &lt; 2e-16 ***\nORIGIN_SZCKSZ02  0.7185711  0.0060595   118.585  &lt; 2e-16 ***\nORIGIN_SZCKSZ03  1.1389824  0.0053179   214.178  &lt; 2e-16 ***\nORIGIN_SZCKSZ04  1.6281772  0.0054761   297.324  &lt; 2e-16 ***\nORIGIN_SZCKSZ05  0.8338470  0.0064178   129.927  &lt; 2e-16 ***\nORIGIN_SZCKSZ06  0.6528993  0.0082375    79.259  &lt; 2e-16 ***\nORIGIN_SZCLSZ01 -0.7174758  0.0082123   -87.366  &lt; 2e-16 ***\nORIGIN_SZCLSZ02 -1.7513100  0.0139062  -125.938  &lt; 2e-16 ***\nORIGIN_SZCLSZ03 -1.0362873  0.0085485  -121.224  &lt; 2e-16 ***\nORIGIN_SZCLSZ04  0.6160017  0.0051276   120.136  &lt; 2e-16 ***\nORIGIN_SZCLSZ05 -2.1005122  0.0150228  -139.821  &lt; 2e-16 ***\nORIGIN_SZCLSZ06  0.7252108  0.0049447   146.665  &lt; 2e-16 ***\nORIGIN_SZCLSZ07 -0.5343482  0.0062500   -85.496  &lt; 2e-16 ***\nORIGIN_SZCLSZ08 -0.2153408  0.0067571   -31.869  &lt; 2e-16 ***\nORIGIN_SZCLSZ09 -1.8019961  0.0169078  -106.578  &lt; 2e-16 ***\nORIGIN_SZDTSZ02 -3.9057711  0.0834668   -46.794  &lt; 2e-16 ***\nORIGIN_SZDTSZ03 -3.4152419  0.0738650   -46.236  &lt; 2e-16 ***\nORIGIN_SZDTSZ13 -3.0183438  0.0315257   -95.742  &lt; 2e-16 ***\nORIGIN_SZGLSZ01 -1.7812384  0.0099367  -179.258  &lt; 2e-16 ***\nORIGIN_SZGLSZ02 -0.1074991  0.0054325   -19.788  &lt; 2e-16 ***\nORIGIN_SZGLSZ03 -0.2461106  0.0057176   -43.045  &lt; 2e-16 ***\nORIGIN_SZGLSZ04  0.8657186  0.0046413   186.524  &lt; 2e-16 ***\nORIGIN_SZGLSZ05  0.5871393  0.0047939   122.477  &lt; 2e-16 ***\nORIGIN_SZHGSZ01  0.3543819  0.0050461    70.229  &lt; 2e-16 ***\nORIGIN_SZHGSZ02  0.4218178  0.0050820    83.003  &lt; 2e-16 ***\nORIGIN_SZHGSZ03  0.2411309  0.0054241    44.456  &lt; 2e-16 ***\nORIGIN_SZHGSZ04  0.8180622  0.0046153   177.252  &lt; 2e-16 ***\nORIGIN_SZHGSZ05  1.2173687  0.0045655   266.647  &lt; 2e-16 ***\nORIGIN_SZHGSZ06 -0.1826300  0.0058214   -31.372  &lt; 2e-16 ***\nORIGIN_SZHGSZ07  0.3172839  0.0050733    62.540  &lt; 2e-16 ***\nORIGIN_SZHGSZ08 -0.1151369  0.0057067   -20.176  &lt; 2e-16 ***\nORIGIN_SZHGSZ09 -1.2873441  0.0091690  -140.401  &lt; 2e-16 ***\nORIGIN_SZHGSZ10 -3.3783178  0.0424682   -79.549  &lt; 2e-16 ***\nORIGIN_SZJESZ01  0.4859234  0.0055927    86.885  &lt; 2e-16 ***\nORIGIN_SZJESZ02  0.1766088  0.0055800    31.650  &lt; 2e-16 ***\nORIGIN_SZJESZ03 -0.2177441  0.0059535   -36.574  &lt; 2e-16 ***\nORIGIN_SZJESZ04 -1.5532182  0.0104526  -148.597  &lt; 2e-16 ***\nORIGIN_SZJESZ05 -2.3332926  0.0142701  -163.509  &lt; 2e-16 ***\nORIGIN_SZJESZ06  0.3007382  0.0055019    54.661  &lt; 2e-16 ***\nORIGIN_SZJESZ07 -1.9687994  0.0121092  -162.587  &lt; 2e-16 ***\nORIGIN_SZJESZ08 -1.3032070  0.0122024  -106.800  &lt; 2e-16 ***\nORIGIN_SZJESZ09  0.5762635  0.0058766    98.061  &lt; 2e-16 ***\nORIGIN_SZJESZ10 -1.4423113  0.0194773   -74.051  &lt; 2e-16 ***\nORIGIN_SZJESZ11 -1.9720897  0.0200811   -98.206  &lt; 2e-16 ***\nORIGIN_SZJWSZ01  0.3808627  0.0071357    53.374  &lt; 2e-16 ***\nORIGIN_SZJWSZ02  0.7963999  0.0053150   149.840  &lt; 2e-16 ***\nORIGIN_SZJWSZ03  1.5429636  0.0049961   308.834  &lt; 2e-16 ***\nORIGIN_SZJWSZ04  0.6410760  0.0056711   113.042  &lt; 2e-16 ***\nORIGIN_SZJWSZ05 -2.1571049  0.0133584  -161.479  &lt; 2e-16 ***\nORIGIN_SZJWSZ06 -1.5174532  0.0113384  -133.833  &lt; 2e-16 ***\nORIGIN_SZJWSZ07 -2.7089963  0.0280439   -96.598  &lt; 2e-16 ***\nORIGIN_SZJWSZ08  1.5343415  0.0051711   296.713  &lt; 2e-16 ***\nORIGIN_SZJWSZ09  1.8837410  0.0048845   385.656  &lt; 2e-16 ***\nORIGIN_SZKLSZ01  0.1081286  0.0053307    20.284  &lt; 2e-16 ***\nORIGIN_SZKLSZ02 -0.8844695  0.0067728  -130.591  &lt; 2e-16 ***\nORIGIN_SZKLSZ03 -0.6872640  0.0062857  -109.337  &lt; 2e-16 ***\nORIGIN_SZKLSZ04 -2.2090319  0.0122440  -180.418  &lt; 2e-16 ***\nORIGIN_SZKLSZ05 -1.1728726  0.0110765  -105.888  &lt; 2e-16 ***\nORIGIN_SZKLSZ06 -6.1162315  0.1857789   -32.922  &lt; 2e-16 ***\nORIGIN_SZKLSZ07 -1.4082749  0.0092299  -152.578  &lt; 2e-16 ***\nORIGIN_SZKLSZ08 -1.7781551  0.0104682  -169.862  &lt; 2e-16 ***\nORIGIN_SZLKSZ01 -2.0531568  0.0398803   -51.483  &lt; 2e-16 ***\nORIGIN_SZMDSZ01 -0.8825639  0.0287621   -30.685  &lt; 2e-16 ***\nORIGIN_SZMDSZ02 -0.6219993  0.0107388   -57.921  &lt; 2e-16 ***\nORIGIN_SZMDSZ03 -2.0840156  0.0173117  -120.382  &lt; 2e-16 ***\nORIGIN_SZMPSZ01 -0.9659093  0.0086972  -111.060  &lt; 2e-16 ***\nORIGIN_SZMPSZ02 -1.0411153  0.0073403  -141.836  &lt; 2e-16 ***\nORIGIN_SZMPSZ03  0.0001659  0.0059401     0.028 0.977719    \nORIGIN_SZMUSZ02 -3.7599031  0.1037937   -36.225  &lt; 2e-16 ***\nORIGIN_SZNTSZ01 -3.0388366  0.0355325   -85.523  &lt; 2e-16 ***\nORIGIN_SZNTSZ02 -3.4230640  0.0235902  -145.106  &lt; 2e-16 ***\nORIGIN_SZNTSZ03 -0.9094796  0.0082551  -110.172  &lt; 2e-16 ***\nORIGIN_SZNTSZ05 -4.0861681  0.0499630   -81.784  &lt; 2e-16 ***\nORIGIN_SZNTSZ06 -3.9497128  0.0565388   -69.858  &lt; 2e-16 ***\nORIGIN_SZNVSZ01  0.3235636  0.0049439    65.447  &lt; 2e-16 ***\nORIGIN_SZNVSZ02 -0.6946748  0.0070536   -98.485  &lt; 2e-16 ***\nORIGIN_SZNVSZ03 -1.0540196  0.0083781  -125.806  &lt; 2e-16 ***\nORIGIN_SZNVSZ04 -0.9897977  0.0093463  -105.903  &lt; 2e-16 ***\nORIGIN_SZNVSZ05 -2.2578432  0.0169180  -133.458  &lt; 2e-16 ***\nORIGIN_SZPGSZ01  0.2399827  0.0130436    18.398  &lt; 2e-16 ***\nORIGIN_SZPGSZ02 -0.3352342  0.0078451   -42.732  &lt; 2e-16 ***\nORIGIN_SZPGSZ03  0.9515148  0.0051376   185.207  &lt; 2e-16 ***\nORIGIN_SZPGSZ04  1.3998952  0.0047991   291.697  &lt; 2e-16 ***\nORIGIN_SZPGSZ05  0.4451629  0.0063423    70.189  &lt; 2e-16 ***\nORIGIN_SZPLSZ01 -0.9705918  0.0122781   -79.050  &lt; 2e-16 ***\nORIGIN_SZPLSZ02 -1.0670151  0.0153358   -69.577  &lt; 2e-16 ***\nORIGIN_SZPLSZ03 -2.1229124  0.0373527   -56.834  &lt; 2e-16 ***\nORIGIN_SZPLSZ04 -3.0911932  0.0371296   -83.254  &lt; 2e-16 ***\nORIGIN_SZPLSZ05 -2.1705708  0.0226085   -96.007  &lt; 2e-16 ***\nORIGIN_SZPNSZ01  0.9052637  0.0065952   137.262  &lt; 2e-16 ***\nORIGIN_SZPNSZ02 -0.1720425  0.0125658   -13.691  &lt; 2e-16 ***\nORIGIN_SZPNSZ03 -2.3973459  0.0201408  -119.029  &lt; 2e-16 ***\nORIGIN_SZPNSZ04 -3.4483689  0.0343741  -100.319  &lt; 2e-16 ***\nORIGIN_SZPNSZ05 -2.0588530  0.0282328   -72.924  &lt; 2e-16 ***\nORIGIN_SZPRSZ01 -0.6399015  0.0120470   -53.117  &lt; 2e-16 ***\nORIGIN_SZPRSZ02  0.8122270  0.0050886   159.617  &lt; 2e-16 ***\nORIGIN_SZPRSZ03  0.3990960  0.0051810    77.031  &lt; 2e-16 ***\nORIGIN_SZPRSZ04 -0.8485348  0.0079236  -107.089  &lt; 2e-16 ***\nORIGIN_SZPRSZ05  0.8008791  0.0048532   165.021  &lt; 2e-16 ***\nORIGIN_SZPRSZ06 -1.4498806  0.0121422  -119.408  &lt; 2e-16 ***\nORIGIN_SZPRSZ07 -3.2025045  0.0167118  -191.631  &lt; 2e-16 ***\nORIGIN_SZPRSZ08 -0.5862269  0.0067255   -87.165  &lt; 2e-16 ***\nORIGIN_SZQTSZ01 -0.1859270  0.0075531   -24.616  &lt; 2e-16 ***\nORIGIN_SZQTSZ02 -0.8715122  0.0068124  -127.929  &lt; 2e-16 ***\nORIGIN_SZQTSZ03 -0.1259816  0.0064796   -19.443  &lt; 2e-16 ***\nORIGIN_SZQTSZ04 -1.4620032  0.0079848  -183.098  &lt; 2e-16 ***\nORIGIN_SZQTSZ05 -0.6675643  0.0069616   -95.892  &lt; 2e-16 ***\nORIGIN_SZQTSZ06 -0.8190026  0.0072713  -112.634  &lt; 2e-16 ***\nORIGIN_SZQTSZ07 -1.5189403  0.0099864  -152.101  &lt; 2e-16 ***\nORIGIN_SZQTSZ08 -0.4976238  0.0067874   -73.316  &lt; 2e-16 ***\nORIGIN_SZQTSZ09 -0.9006162  0.0075978  -118.536  &lt; 2e-16 ***\nORIGIN_SZQTSZ10 -0.6690184  0.0071574   -93.473  &lt; 2e-16 ***\nORIGIN_SZQTSZ11 -2.5203437  0.0147000  -171.452  &lt; 2e-16 ***\nORIGIN_SZQTSZ12 -3.0461675  0.0190193  -160.162  &lt; 2e-16 ***\nORIGIN_SZQTSZ13 -0.7501068  0.0084481   -88.791  &lt; 2e-16 ***\nORIGIN_SZQTSZ14 -1.9321849  0.0126114  -153.209  &lt; 2e-16 ***\nORIGIN_SZQTSZ15 -0.9576828  0.0127157   -75.315  &lt; 2e-16 ***\nORIGIN_SZRCSZ01 -1.8167951  0.0129234  -140.582  &lt; 2e-16 ***\nORIGIN_SZRCSZ06 -0.5560563  0.0090507   -61.438  &lt; 2e-16 ***\nORIGIN_SZRVSZ01 -2.8862570  0.0325532   -88.663  &lt; 2e-16 ***\nORIGIN_SZRVSZ02 -3.1555662  0.0281279  -112.186  &lt; 2e-16 ***\nORIGIN_SZRVSZ03 -2.9836089  0.0248449  -120.089  &lt; 2e-16 ***\nORIGIN_SZRVSZ04 -3.5520422  0.0561371   -63.274  &lt; 2e-16 ***\nORIGIN_SZRVSZ05 -2.5866584  0.0180382  -143.399  &lt; 2e-16 ***\nORIGIN_SZSBSZ01  0.2867444  0.0071098    40.331  &lt; 2e-16 ***\nORIGIN_SZSBSZ02 -0.9012334  0.0087262  -103.278  &lt; 2e-16 ***\nORIGIN_SZSBSZ03  0.8311038  0.0055422   149.958  &lt; 2e-16 ***\nORIGIN_SZSBSZ04  0.4044170  0.0062047    65.179  &lt; 2e-16 ***\nORIGIN_SZSBSZ05 -0.2661845  0.0074162   -35.892  &lt; 2e-16 ***\nORIGIN_SZSBSZ06 -0.9023075  0.0175046   -51.547  &lt; 2e-16 ***\nORIGIN_SZSBSZ07  0.0505870  0.0131317     3.852 0.000117 ***\nORIGIN_SZSBSZ08 -1.1158011  0.0145416   -76.732  &lt; 2e-16 ***\nORIGIN_SZSBSZ09 -0.9682835  0.0095396  -101.501  &lt; 2e-16 ***\nORIGIN_SZSESZ02  1.1452735  0.0047810   239.548  &lt; 2e-16 ***\nORIGIN_SZSESZ03  1.2815277  0.0045677   280.564  &lt; 2e-16 ***\nORIGIN_SZSESZ04  0.8085857  0.0052756   153.269  &lt; 2e-16 ***\nORIGIN_SZSESZ05 -0.2329413  0.0063113   -36.909  &lt; 2e-16 ***\nORIGIN_SZSESZ06  1.0576879  0.0049909   211.925  &lt; 2e-16 ***\nORIGIN_SZSESZ07 -2.3165908  0.0196831  -117.695  &lt; 2e-16 ***\nORIGIN_SZSGSZ01 -0.6606350  0.0088079   -75.005  &lt; 2e-16 ***\nORIGIN_SZSGSZ02 -1.3638984  0.0104040  -131.094  &lt; 2e-16 ***\nORIGIN_SZSGSZ03  0.1152591  0.0054649    21.091  &lt; 2e-16 ***\nORIGIN_SZSGSZ04  0.2954067  0.0050865    58.077  &lt; 2e-16 ***\nORIGIN_SZSGSZ05 -2.0792678  0.0109882  -189.227  &lt; 2e-16 ***\nORIGIN_SZSGSZ06  0.4563227  0.0048880    93.356  &lt; 2e-16 ***\nORIGIN_SZSGSZ07 -0.8955254  0.0067100  -133.461  &lt; 2e-16 ***\nORIGIN_SZSKSZ01 -0.3184402  0.0093032   -34.229  &lt; 2e-16 ***\nORIGIN_SZSKSZ02  1.1160484  0.0063851   174.790  &lt; 2e-16 ***\nORIGIN_SZSKSZ03 -0.2566692  0.0086021   -29.838  &lt; 2e-16 ***\nORIGIN_SZSKSZ04 -1.5781827  0.0279394   -56.486  &lt; 2e-16 ***\nORIGIN_SZSKSZ05 -0.2724361  0.0163597   -16.653  &lt; 2e-16 ***\nORIGIN_SZSLSZ01 -2.4458625  0.0330301   -74.050  &lt; 2e-16 ***\nORIGIN_SZSLSZ04 -0.0987076  0.0079626   -12.396  &lt; 2e-16 ***\nORIGIN_SZSRSZ01 -2.2584977  0.0176647  -127.854  &lt; 2e-16 ***\nORIGIN_SZTHSZ01 -2.5878524  0.0489998   -52.814  &lt; 2e-16 ***\nORIGIN_SZTHSZ03 -0.8101746  0.0226814   -35.720  &lt; 2e-16 ***\nORIGIN_SZTHSZ04 -2.4186655  0.0288663   -83.789  &lt; 2e-16 ***\nORIGIN_SZTHSZ06 -1.7080541  0.0186353   -91.657  &lt; 2e-16 ***\nORIGIN_SZTMSZ01 -0.2193476  0.0061823   -35.480  &lt; 2e-16 ***\nORIGIN_SZTMSZ02  1.7772464  0.0043394   409.558  &lt; 2e-16 ***\nORIGIN_SZTMSZ03  1.0051343  0.0046055   218.249  &lt; 2e-16 ***\nORIGIN_SZTMSZ04  0.1642370  0.0055078    29.819  &lt; 2e-16 ***\nORIGIN_SZTMSZ05 -1.2878706  0.0114828  -112.157  &lt; 2e-16 ***\nORIGIN_SZTNSZ01 -1.7163504  0.0131268  -130.751  &lt; 2e-16 ***\nORIGIN_SZTNSZ02 -1.6508988  0.0103851  -158.968  &lt; 2e-16 ***\nORIGIN_SZTNSZ03 -2.1545577  0.0137947  -156.187  &lt; 2e-16 ***\nORIGIN_SZTNSZ04 -0.3949120  0.0078496   -50.310  &lt; 2e-16 ***\nORIGIN_SZTPSZ01 -0.8058100  0.0069916  -115.253  &lt; 2e-16 ***\nORIGIN_SZTPSZ02  0.5369060  0.0047272   113.577  &lt; 2e-16 ***\nORIGIN_SZTPSZ03 -0.7779333  0.0064278  -121.027  &lt; 2e-16 ***\nORIGIN_SZTPSZ04 -0.8153581  0.0061387  -132.823  &lt; 2e-16 ***\nORIGIN_SZTPSZ05 -0.5073676  0.0067771   -74.865  &lt; 2e-16 ***\nORIGIN_SZTPSZ06  0.0847301  0.0065717    12.893  &lt; 2e-16 ***\nORIGIN_SZTPSZ07 -0.5839519  0.0066148   -88.280  &lt; 2e-16 ***\nORIGIN_SZTPSZ08 -1.0577941  0.0098480  -107.412  &lt; 2e-16 ***\nORIGIN_SZTPSZ09 -0.9067707  0.0071367  -127.057  &lt; 2e-16 ***\nORIGIN_SZTPSZ10 -1.1362091  0.0080905  -140.438  &lt; 2e-16 ***\nORIGIN_SZTPSZ11 -0.2374621  0.0059472   -39.928  &lt; 2e-16 ***\nORIGIN_SZTPSZ12 -0.8028874  0.0069663  -115.253  &lt; 2e-16 ***\nORIGIN_SZTSSZ01 -2.7809271  0.0482843   -57.595  &lt; 2e-16 ***\nORIGIN_SZTSSZ02  0.0425804  0.0105088     4.052 5.08e-05 ***\nORIGIN_SZTSSZ03  0.1142369  0.0109412    10.441  &lt; 2e-16 ***\nORIGIN_SZTSSZ04 -0.6186261  0.0116324   -53.181  &lt; 2e-16 ***\nORIGIN_SZTSSZ05 -1.0846732  0.0173555   -62.497  &lt; 2e-16 ***\nORIGIN_SZTSSZ06  0.3980173  0.0198100    20.092  &lt; 2e-16 ***\nORIGIN_SZWCSZ01  1.3545143  0.0092002   147.227  &lt; 2e-16 ***\nORIGIN_SZWCSZ02 -2.9863278  0.0330906   -90.247  &lt; 2e-16 ***\nORIGIN_SZWCSZ03 -5.0504916  0.1241385   -40.684  &lt; 2e-16 ***\nORIGIN_SZWDSZ01  1.5238429  0.0049404   308.448  &lt; 2e-16 ***\nORIGIN_SZWDSZ02  0.2832576  0.0056218    50.386  &lt; 2e-16 ***\nORIGIN_SZWDSZ03  1.3702524  0.0053266   257.245  &lt; 2e-16 ***\nORIGIN_SZWDSZ04  1.0248225  0.0059272   172.903  &lt; 2e-16 ***\nORIGIN_SZWDSZ05  0.2356778  0.0060587    38.899  &lt; 2e-16 ***\nORIGIN_SZWDSZ06  0.3146925  0.0059919    52.520  &lt; 2e-16 ***\nORIGIN_SZWDSZ07 -1.4971897  0.0091243  -164.088  &lt; 2e-16 ***\nORIGIN_SZWDSZ08 -0.8894079  0.0087414  -101.747  &lt; 2e-16 ***\nORIGIN_SZWDSZ09  1.4437633  0.0053160   271.590  &lt; 2e-16 ***\nORIGIN_SZYSSZ01 -0.2519398  0.0064443   -39.095  &lt; 2e-16 ***\nORIGIN_SZYSSZ02  0.8726785  0.0057658   151.354  &lt; 2e-16 ***\nORIGIN_SZYSSZ03  1.7868139  0.0050674   352.611  &lt; 2e-16 ***\nORIGIN_SZYSSZ04  0.8418040  0.0051738   162.704  &lt; 2e-16 ***\nORIGIN_SZYSSZ05  0.4292096  0.0062520    68.652  &lt; 2e-16 ***\nORIGIN_SZYSSZ06 -0.7459961  0.0119123   -62.624  &lt; 2e-16 ***\nORIGIN_SZYSSZ07 -0.8422281  0.0144559   -58.262  &lt; 2e-16 ***\nORIGIN_SZYSSZ08  0.1829428  0.0067885    26.949  &lt; 2e-16 ***\nORIGIN_SZYSSZ09  1.1159712  0.0050760   219.853  &lt; 2e-16 ***\nDESTIN_SZAMSZ02  0.0694567  0.0045966    15.111  &lt; 2e-16 ***\nDESTIN_SZAMSZ03  0.0760100  0.0044639    17.028  &lt; 2e-16 ***\nDESTIN_SZAMSZ04 -1.1306391  0.0064373  -175.639  &lt; 2e-16 ***\nDESTIN_SZAMSZ05 -1.0751133  0.0065164  -164.985  &lt; 2e-16 ***\nDESTIN_SZAMSZ06 -0.9624298  0.0065937  -145.962  &lt; 2e-16 ***\nDESTIN_SZAMSZ07 -1.5060319  0.0097616  -154.281  &lt; 2e-16 ***\nDESTIN_SZAMSZ08 -0.4813202  0.0069794   -68.963  &lt; 2e-16 ***\nDESTIN_SZAMSZ09 -1.0220675  0.0066313  -154.129  &lt; 2e-16 ***\nDESTIN_SZAMSZ10  0.1235142  0.0047044    26.255  &lt; 2e-16 ***\nDESTIN_SZAMSZ11 -0.8917993  0.0088519  -100.746  &lt; 2e-16 ***\nDESTIN_SZAMSZ12  0.0195208  0.0051704     3.775 0.000160 ***\nDESTIN_SZBDSZ01  0.9736349  0.0042757   227.713  &lt; 2e-16 ***\nDESTIN_SZBDSZ02 -0.1969470  0.0055284   -35.625  &lt; 2e-16 ***\nDESTIN_SZBDSZ03  0.1266471  0.0050786    24.938  &lt; 2e-16 ***\nDESTIN_SZBDSZ04  1.1608485  0.0041956   276.684  &lt; 2e-16 ***\nDESTIN_SZBDSZ05  0.9293840  0.0044412   209.265  &lt; 2e-16 ***\nDESTIN_SZBDSZ06  0.4090567  0.0050300    81.323  &lt; 2e-16 ***\nDESTIN_SZBDSZ07 -0.8171478  0.0098945   -82.586  &lt; 2e-16 ***\nDESTIN_SZBDSZ08 -1.5895287  0.0111632  -142.391  &lt; 2e-16 ***\nDESTIN_SZBKSZ01 -1.3793311  0.0072145  -191.189  &lt; 2e-16 ***\nDESTIN_SZBKSZ02 -0.5253670  0.0061879   -84.903  &lt; 2e-16 ***\nDESTIN_SZBKSZ03 -1.0095362  0.0065426  -154.301  &lt; 2e-16 ***\nDESTIN_SZBKSZ04 -0.5662858  0.0056453  -100.311  &lt; 2e-16 ***\nDESTIN_SZBKSZ05 -0.9406607  0.0070597  -133.244  &lt; 2e-16 ***\nDESTIN_SZBKSZ06 -1.3129276  0.0067414  -194.755  &lt; 2e-16 ***\nDESTIN_SZBKSZ07  0.0120605  0.0049284     2.447 0.014400 *  \nDESTIN_SZBKSZ08 -1.3658471  0.0075109  -181.849  &lt; 2e-16 ***\nDESTIN_SZBKSZ09 -0.1771310  0.0055645   -31.832  &lt; 2e-16 ***\nDESTIN_SZBLSZ01 -0.8175223  0.0075645  -108.074  &lt; 2e-16 ***\nDESTIN_SZBLSZ02  0.1631280  0.0071753    22.735  &lt; 2e-16 ***\nDESTIN_SZBLSZ03  1.2598494  0.0081706   154.194  &lt; 2e-16 ***\nDESTIN_SZBLSZ04 -0.5642975  0.0137827   -40.943  &lt; 2e-16 ***\nDESTIN_SZBMSZ01  0.6921844  0.0054211   127.684  &lt; 2e-16 ***\nDESTIN_SZBMSZ02 -0.1209392  0.0055362   -21.845  &lt; 2e-16 ***\nDESTIN_SZBMSZ03 -0.2373881  0.0062427   -38.027  &lt; 2e-16 ***\nDESTIN_SZBMSZ04 -0.0407117  0.0058001    -7.019 2.23e-12 ***\nDESTIN_SZBMSZ05 -0.2363309  0.0075967   -31.110  &lt; 2e-16 ***\nDESTIN_SZBMSZ06 -1.1930710  0.0134761   -88.532  &lt; 2e-16 ***\nDESTIN_SZBMSZ07  0.4625103  0.0051864    89.178  &lt; 2e-16 ***\nDESTIN_SZBMSZ08 -0.8604731  0.0069899  -123.102  &lt; 2e-16 ***\nDESTIN_SZBMSZ09 -2.1290239  0.0154841  -137.498  &lt; 2e-16 ***\nDESTIN_SZBMSZ10 -1.4617153  0.0094014  -155.478  &lt; 2e-16 ***\nDESTIN_SZBMSZ11 -1.3234050  0.0085506  -154.773  &lt; 2e-16 ***\nDESTIN_SZBMSZ12 -0.8399230  0.0085361   -98.397  &lt; 2e-16 ***\nDESTIN_SZBMSZ13  0.1366529  0.0059697    22.891  &lt; 2e-16 ***\nDESTIN_SZBMSZ14 -1.0491968  0.0083021  -126.378  &lt; 2e-16 ***\nDESTIN_SZBMSZ15 -0.6726684  0.0076276   -88.189  &lt; 2e-16 ***\nDESTIN_SZBMSZ16 -1.4011734  0.0116569  -120.201  &lt; 2e-16 ***\nDESTIN_SZBMSZ17 -1.5682752  0.0167333   -93.722  &lt; 2e-16 ***\nDESTIN_SZBPSZ01 -1.1120017  0.0063197  -175.959  &lt; 2e-16 ***\nDESTIN_SZBPSZ02 -2.0833466  0.0091139  -228.590  &lt; 2e-16 ***\nDESTIN_SZBPSZ03 -1.6937265  0.0087437  -193.709  &lt; 2e-16 ***\nDESTIN_SZBPSZ04 -0.7964999  0.0066129  -120.447  &lt; 2e-16 ***\nDESTIN_SZBPSZ05  0.2109118  0.0048815    43.206  &lt; 2e-16 ***\nDESTIN_SZBPSZ06 -1.1808365  0.0083657  -141.152  &lt; 2e-16 ***\nDESTIN_SZBPSZ07 -0.2077428  0.0084543   -24.572  &lt; 2e-16 ***\nDESTIN_SZBSSZ01  0.3164175  0.0050682    62.431  &lt; 2e-16 ***\nDESTIN_SZBSSZ02 -0.4852688  0.0057001   -85.134  &lt; 2e-16 ***\nDESTIN_SZBSSZ03  0.4130432  0.0043061    95.921  &lt; 2e-16 ***\nDESTIN_SZBTSZ01  0.6215095  0.0048914   127.061  &lt; 2e-16 ***\nDESTIN_SZBTSZ02 -0.0145076  0.0071799    -2.021 0.043324 *  \nDESTIN_SZBTSZ03  0.4919981  0.0058498    84.105  &lt; 2e-16 ***\nDESTIN_SZBTSZ04 -0.6957555  0.0114078   -60.989  &lt; 2e-16 ***\nDESTIN_SZBTSZ05  0.3329814  0.0073568    45.262  &lt; 2e-16 ***\nDESTIN_SZBTSZ06 -0.1333295  0.0073965   -18.026  &lt; 2e-16 ***\nDESTIN_SZBTSZ07 -1.4449581  0.0113186  -127.663  &lt; 2e-16 ***\nDESTIN_SZBTSZ08 -0.7079056  0.0103797   -68.201  &lt; 2e-16 ***\nDESTIN_SZCBSZ01 -5.7344725  0.3162767   -18.131  &lt; 2e-16 ***\nDESTIN_SZCCSZ01 -0.0009541  0.0083381    -0.114 0.908900    \nDESTIN_SZCHSZ01 -0.2083016  0.0099054   -21.029  &lt; 2e-16 ***\nDESTIN_SZCHSZ02  0.5369606  0.0057531    93.334  &lt; 2e-16 ***\nDESTIN_SZCHSZ03  2.5530638  0.0043945   580.971  &lt; 2e-16 ***\nDESTIN_SZCKSZ01 -0.5725975  0.0056507  -101.333  &lt; 2e-16 ***\nDESTIN_SZCKSZ02 -1.1181852  0.0063287  -176.685  &lt; 2e-16 ***\nDESTIN_SZCKSZ03  0.1156680  0.0049440    23.396  &lt; 2e-16 ***\nDESTIN_SZCKSZ04 -0.8647725  0.0071003  -121.794  &lt; 2e-16 ***\nDESTIN_SZCKSZ05 -1.1641791  0.0076248  -152.684  &lt; 2e-16 ***\nDESTIN_SZCKSZ06 -0.4397612  0.0073040   -60.208  &lt; 2e-16 ***\nDESTIN_SZCLSZ01  0.1930552  0.0053752    35.916  &lt; 2e-16 ***\nDESTIN_SZCLSZ02 -2.0436501  0.0136039  -150.225  &lt; 2e-16 ***\nDESTIN_SZCLSZ03 -0.9338571  0.0082908  -112.638  &lt; 2e-16 ***\nDESTIN_SZCLSZ04  0.0532041  0.0053276     9.987  &lt; 2e-16 ***\nDESTIN_SZCLSZ05 -1.0782781  0.0088184  -122.276  &lt; 2e-16 ***\nDESTIN_SZCLSZ06  0.4068171  0.0049068    82.910  &lt; 2e-16 ***\nDESTIN_SZCLSZ07 -0.3579507  0.0060289   -59.373  &lt; 2e-16 ***\nDESTIN_SZCLSZ08 -0.2487993  0.0066588   -37.364  &lt; 2e-16 ***\nDESTIN_SZCLSZ09  0.1611080  0.0071178    22.635  &lt; 2e-16 ***\nDESTIN_SZDTSZ02 -1.7308348  0.0349466   -49.528  &lt; 2e-16 ***\nDESTIN_SZDTSZ03 -0.5994253  0.0146230   -40.992  &lt; 2e-16 ***\nDESTIN_SZDTSZ13 -1.3685031  0.0162803   -84.059  &lt; 2e-16 ***\nDESTIN_SZGLSZ01 -0.0910001  0.0055275   -16.463  &lt; 2e-16 ***\nDESTIN_SZGLSZ02 -0.0692224  0.0052840   -13.100  &lt; 2e-16 ***\nDESTIN_SZGLSZ03  0.6493421  0.0043446   149.459  &lt; 2e-16 ***\nDESTIN_SZGLSZ04  0.9327947  0.0043674   213.583  &lt; 2e-16 ***\nDESTIN_SZGLSZ05  0.8161728  0.0043625   187.087  &lt; 2e-16 ***\nDESTIN_SZHGSZ01  0.0658625  0.0042516    15.491  &lt; 2e-16 ***\nDESTIN_SZHGSZ02 -0.8134329  0.0056721  -143.409  &lt; 2e-16 ***\nDESTIN_SZHGSZ03 -1.3546132  0.0066257  -204.448  &lt; 2e-16 ***\nDESTIN_SZHGSZ04 -0.4500588  0.0048448   -92.895  &lt; 2e-16 ***\nDESTIN_SZHGSZ05 -0.5026431  0.0050996   -98.566  &lt; 2e-16 ***\nDESTIN_SZHGSZ06 -0.8673686  0.0059530  -145.704  &lt; 2e-16 ***\nDESTIN_SZHGSZ07  0.0560490  0.0047702    11.750  &lt; 2e-16 ***\nDESTIN_SZHGSZ08 -0.0443189  0.0052599    -8.426  &lt; 2e-16 ***\nDESTIN_SZHGSZ09 -0.0126355  0.0054966    -2.299 0.021518 *  \nDESTIN_SZHGSZ10 -3.5821793  0.0263281  -136.059  &lt; 2e-16 ***\nDESTIN_SZJESZ01 -0.3704281  0.0056684   -65.350  &lt; 2e-16 ***\nDESTIN_SZJESZ02 -0.7369159  0.0058686  -125.570  &lt; 2e-16 ***\nDESTIN_SZJESZ03 -0.8985484  0.0063627  -141.222  &lt; 2e-16 ***\nDESTIN_SZJESZ04 -1.0511995  0.0073996  -142.061  &lt; 2e-16 ***\nDESTIN_SZJESZ05 -1.5324974  0.0102612  -149.349  &lt; 2e-16 ***\nDESTIN_SZJESZ06  0.3105267  0.0048241    64.370  &lt; 2e-16 ***\nDESTIN_SZJESZ07 -1.3234483  0.0085497  -154.795  &lt; 2e-16 ***\nDESTIN_SZJESZ08 -0.6559742  0.0083174   -78.867  &lt; 2e-16 ***\nDESTIN_SZJESZ09  0.2663752  0.0063370    42.035  &lt; 2e-16 ***\nDESTIN_SZJESZ10  0.8529026  0.0076067   112.126  &lt; 2e-16 ***\nDESTIN_SZJESZ11  0.5559641  0.0074629    74.497  &lt; 2e-16 ***\nDESTIN_SZJWSZ01 -0.9790971  0.0071830  -136.308  &lt; 2e-16 ***\nDESTIN_SZJWSZ02 -0.8746590  0.0060179  -145.342  &lt; 2e-16 ***\nDESTIN_SZJWSZ03  0.5689062  0.0049105   115.855  &lt; 2e-16 ***\nDESTIN_SZJWSZ04  0.4520963  0.0050302    89.876  &lt; 2e-16 ***\nDESTIN_SZJWSZ05 -1.0249671  0.0067371  -152.137  &lt; 2e-16 ***\nDESTIN_SZJWSZ06 -0.7451483  0.0062189  -119.819  &lt; 2e-16 ***\nDESTIN_SZJWSZ07 -2.8453099  0.0287335   -99.024  &lt; 2e-16 ***\nDESTIN_SZJWSZ08 -0.3372309  0.0058003   -58.141  &lt; 2e-16 ***\nDESTIN_SZJWSZ09  1.0505330  0.0045908   228.832  &lt; 2e-16 ***\nDESTIN_SZKLSZ01 -0.2334836  0.0057970   -40.277  &lt; 2e-16 ***\nDESTIN_SZKLSZ02 -0.5416148  0.0061432   -88.164  &lt; 2e-16 ***\nDESTIN_SZKLSZ03 -0.8026495  0.0068745  -116.757  &lt; 2e-16 ***\nDESTIN_SZKLSZ04 -1.2918594  0.0090197  -143.227  &lt; 2e-16 ***\nDESTIN_SZKLSZ05 -0.4069101  0.0087812   -46.339  &lt; 2e-16 ***\nDESTIN_SZKLSZ06 -2.5333101  0.0363215   -69.747  &lt; 2e-16 ***\nDESTIN_SZKLSZ07 -0.6623343  0.0070761   -93.601  &lt; 2e-16 ***\nDESTIN_SZKLSZ08 -0.1408205  0.0054965   -25.620  &lt; 2e-16 ***\nDESTIN_SZLKSZ01 -1.2639235  0.0208254   -60.691  &lt; 2e-16 ***\nDESTIN_SZMDSZ01 -1.5655800  0.0202787   -77.203  &lt; 2e-16 ***\nDESTIN_SZMDSZ02 -0.9767682  0.0114687   -85.168  &lt; 2e-16 ***\nDESTIN_SZMDSZ03 -3.3328109  0.0254294  -131.061  &lt; 2e-16 ***\nDESTIN_SZMPSZ01 -0.4552859  0.0080666   -56.441  &lt; 2e-16 ***\nDESTIN_SZMPSZ02 -0.5386560  0.0064620   -83.358  &lt; 2e-16 ***\nDESTIN_SZMPSZ03  0.4952000  0.0052295    94.694  &lt; 2e-16 ***\nDESTIN_SZMUSZ02 -1.4434175  0.0202509   -71.277  &lt; 2e-16 ***\nDESTIN_SZNTSZ01 -2.9194067  0.0449654   -64.926  &lt; 2e-16 ***\nDESTIN_SZNTSZ02 -1.3780179  0.0112867  -122.092  &lt; 2e-16 ***\nDESTIN_SZNTSZ03 -0.5044699  0.0080449   -62.707  &lt; 2e-16 ***\nDESTIN_SZNTSZ05 -2.0017134  0.0258750   -77.361  &lt; 2e-16 ***\nDESTIN_SZNTSZ06 -3.8120537  0.0434271   -87.781  &lt; 2e-16 ***\nDESTIN_SZNVSZ01 -0.1071506  0.0051026   -20.999  &lt; 2e-16 ***\nDESTIN_SZNVSZ02 -0.0274710  0.0057611    -4.768 1.86e-06 ***\nDESTIN_SZNVSZ03  0.1076352  0.0057909    18.587  &lt; 2e-16 ***\nDESTIN_SZNVSZ04 -1.2087250  0.0110438  -109.448  &lt; 2e-16 ***\nDESTIN_SZNVSZ05 -1.0058290  0.0092167  -109.131  &lt; 2e-16 ***\nDESTIN_SZPGSZ01 -1.2029931  0.0163170   -73.726  &lt; 2e-16 ***\nDESTIN_SZPGSZ02 -1.2878671  0.0074139  -173.709  &lt; 2e-16 ***\nDESTIN_SZPGSZ03 -0.1520894  0.0048629   -31.275  &lt; 2e-16 ***\nDESTIN_SZPGSZ04 -0.1985959  0.0050374   -39.424  &lt; 2e-16 ***\nDESTIN_SZPGSZ05 -1.5290983  0.0082617  -185.083  &lt; 2e-16 ***\nDESTIN_SZPLSZ01 -0.3567934  0.0074298   -48.022  &lt; 2e-16 ***\nDESTIN_SZPLSZ02 -1.7114351  0.0134462  -127.280  &lt; 2e-16 ***\nDESTIN_SZPLSZ03 -0.3241427  0.0098895   -32.776  &lt; 2e-16 ***\nDESTIN_SZPLSZ04 -1.7117196  0.0119003  -143.838  &lt; 2e-16 ***\nDESTIN_SZPLSZ05 -0.5086379  0.0120051   -42.368  &lt; 2e-16 ***\nDESTIN_SZPNSZ01  0.2026781  0.0068977    29.383  &lt; 2e-16 ***\nDESTIN_SZPNSZ02  0.8313754  0.0078544   105.848  &lt; 2e-16 ***\nDESTIN_SZPNSZ03 -0.4041254  0.0086586   -46.673  &lt; 2e-16 ***\nDESTIN_SZPNSZ04  1.5814539  0.0093641   168.885  &lt; 2e-16 ***\nDESTIN_SZPNSZ05  1.1823430  0.0129843    91.059  &lt; 2e-16 ***\nDESTIN_SZPRSZ01 -1.1057553  0.0088197  -125.374  &lt; 2e-16 ***\nDESTIN_SZPRSZ02  0.0895099  0.0056308    15.897  &lt; 2e-16 ***\nDESTIN_SZPRSZ03  0.6921925  0.0043977   157.397  &lt; 2e-16 ***\nDESTIN_SZPRSZ04 -0.2848336  0.0084725   -33.619  &lt; 2e-16 ***\nDESTIN_SZPRSZ05  0.1744480  0.0053553    32.575  &lt; 2e-16 ***\nDESTIN_SZPRSZ06  0.4279206  0.0058735    72.856  &lt; 2e-16 ***\nDESTIN_SZPRSZ07 -1.5123108  0.0124303  -121.664  &lt; 2e-16 ***\nDESTIN_SZPRSZ08 -0.5650226  0.0068530   -82.449  &lt; 2e-16 ***\nDESTIN_SZQTSZ01 -0.5952360  0.0090505   -65.769  &lt; 2e-16 ***\nDESTIN_SZQTSZ02 -0.7728170  0.0078910   -97.937  &lt; 2e-16 ***\nDESTIN_SZQTSZ03 -0.5066812  0.0073996   -68.474  &lt; 2e-16 ***\nDESTIN_SZQTSZ04 -0.6398414  0.0075411   -84.847  &lt; 2e-16 ***\nDESTIN_SZQTSZ05 -0.4354527  0.0069345   -62.795  &lt; 2e-16 ***\nDESTIN_SZQTSZ06 -0.6597391  0.0071919   -91.733  &lt; 2e-16 ***\nDESTIN_SZQTSZ07 -0.9392696  0.0112518   -83.477  &lt; 2e-16 ***\nDESTIN_SZQTSZ08  0.4617774  0.0057011    80.998  &lt; 2e-16 ***\nDESTIN_SZQTSZ09 -0.3174497  0.0065890   -48.178  &lt; 2e-16 ***\nDESTIN_SZQTSZ10  0.1993449  0.0059923    33.267  &lt; 2e-16 ***\nDESTIN_SZQTSZ11  0.2551535  0.0061885    41.230  &lt; 2e-16 ***\nDESTIN_SZQTSZ12 -0.1662603  0.0086701   -19.176  &lt; 2e-16 ***\nDESTIN_SZQTSZ13  0.5500978  0.0063091    87.192  &lt; 2e-16 ***\nDESTIN_SZQTSZ14  0.5364435  0.0070157    76.463  &lt; 2e-16 ***\nDESTIN_SZQTSZ15  1.3611043  0.0081643   166.715  &lt; 2e-16 ***\nDESTIN_SZRCSZ01 -0.1034049  0.0076769   -13.470  &lt; 2e-16 ***\nDESTIN_SZRCSZ06 -1.0633902  0.0189846   -56.013  &lt; 2e-16 ***\nDESTIN_SZRVSZ01 -1.5486221  0.0165272   -93.701  &lt; 2e-16 ***\nDESTIN_SZRVSZ02 -2.4092611  0.0326906   -73.699  &lt; 2e-16 ***\nDESTIN_SZRVSZ03 -1.5172079  0.0139258  -108.950  &lt; 2e-16 ***\nDESTIN_SZRVSZ04 -1.1663615  0.0157430   -74.088  &lt; 2e-16 ***\nDESTIN_SZRVSZ05 -2.2404292  0.0281339   -79.634  &lt; 2e-16 ***\nDESTIN_SZSBSZ01 -1.3783780  0.0096022  -143.549  &lt; 2e-16 ***\nDESTIN_SZSBSZ02 -1.4445213  0.0081630  -176.959  &lt; 2e-16 ***\nDESTIN_SZSBSZ03  0.5149906  0.0051663    99.683  &lt; 2e-16 ***\nDESTIN_SZSBSZ04  0.2389086  0.0060765    39.317  &lt; 2e-16 ***\nDESTIN_SZSBSZ05 -1.2737442  0.0082818  -153.801  &lt; 2e-16 ***\nDESTIN_SZSBSZ06 -1.8683520  0.0227277   -82.206  &lt; 2e-16 ***\nDESTIN_SZSBSZ07 -0.5993154  0.0184895   -32.414  &lt; 2e-16 ***\nDESTIN_SZSBSZ08  0.8156302  0.0059840   136.302  &lt; 2e-16 ***\nDESTIN_SZSBSZ09  0.0900611  0.0057054    15.785  &lt; 2e-16 ***\nDESTIN_SZSESZ02 -0.6397704  0.0052491  -121.882  &lt; 2e-16 ***\nDESTIN_SZSESZ03  0.1714103  0.0042357    40.468  &lt; 2e-16 ***\nDESTIN_SZSESZ04 -1.0596175  0.0059865  -177.002  &lt; 2e-16 ***\nDESTIN_SZSESZ05 -0.8071891  0.0051229  -157.566  &lt; 2e-16 ***\nDESTIN_SZSESZ06 -0.5580934  0.0066216   -84.284  &lt; 2e-16 ***\nDESTIN_SZSESZ07 -3.1448863  0.0227788  -138.062  &lt; 2e-16 ***\nDESTIN_SZSGSZ01 -0.1795225  0.0060127   -29.857  &lt; 2e-16 ***\nDESTIN_SZSGSZ02 -0.2986570  0.0053561   -55.760  &lt; 2e-16 ***\nDESTIN_SZSGSZ03 -0.4074671  0.0050609   -80.513  &lt; 2e-16 ***\nDESTIN_SZSGSZ04 -0.1505164  0.0050931   -29.553  &lt; 2e-16 ***\nDESTIN_SZSGSZ05 -1.9908372  0.0101448  -196.242  &lt; 2e-16 ***\nDESTIN_SZSGSZ06  0.6715268  0.0041161   163.148  &lt; 2e-16 ***\nDESTIN_SZSGSZ07 -0.4494757  0.0055319   -81.252  &lt; 2e-16 ***\nDESTIN_SZSISZ01 -0.5517983  0.0261860   -21.072  &lt; 2e-16 ***\nDESTIN_SZSKSZ01 -0.4749154  0.0079257   -59.921  &lt; 2e-16 ***\nDESTIN_SZSKSZ02  0.9400302  0.0057218   164.290  &lt; 2e-16 ***\nDESTIN_SZSKSZ03 -0.2800377  0.0066081   -42.378  &lt; 2e-16 ***\nDESTIN_SZSKSZ04 -1.2570212  0.0145351   -86.482  &lt; 2e-16 ***\nDESTIN_SZSKSZ05 -0.2600474  0.0112800   -23.054  &lt; 2e-16 ***\nDESTIN_SZSLSZ01 -0.7775604  0.0085818   -90.606  &lt; 2e-16 ***\nDESTIN_SZSLSZ04 -0.8586515  0.0073142  -117.396  &lt; 2e-16 ***\nDESTIN_SZSRSZ01 -1.1370887  0.0142148   -79.993  &lt; 2e-16 ***\nDESTIN_SZTHSZ01 -4.3259988  0.0368554  -117.378  &lt; 2e-16 ***\nDESTIN_SZTHSZ03 -2.6632914  0.0252720  -105.385  &lt; 2e-16 ***\nDESTIN_SZTHSZ04 -3.1000906  0.0216372  -143.276  &lt; 2e-16 ***\nDESTIN_SZTHSZ06 -2.5952642  0.0156340  -166.001  &lt; 2e-16 ***\nDESTIN_SZTMSZ01 -0.2092828  0.0059257   -35.318  &lt; 2e-16 ***\nDESTIN_SZTMSZ02  1.8238139  0.0039155   465.798  &lt; 2e-16 ***\nDESTIN_SZTMSZ03  0.8518259  0.0043636   195.210  &lt; 2e-16 ***\nDESTIN_SZTMSZ04  1.0222812  0.0043466   235.191  &lt; 2e-16 ***\nDESTIN_SZTMSZ05  0.6323777  0.0060058   105.294  &lt; 2e-16 ***\nDESTIN_SZTNSZ01 -0.3336078  0.0074388   -44.847  &lt; 2e-16 ***\nDESTIN_SZTNSZ02 -1.0820469  0.0101689  -106.408  &lt; 2e-16 ***\nDESTIN_SZTNSZ03 -1.4186505  0.0119906  -118.313  &lt; 2e-16 ***\nDESTIN_SZTNSZ04 -0.3058199  0.0074743   -40.916  &lt; 2e-16 ***\nDESTIN_SZTPSZ01 -0.4872299  0.0061571   -79.133  &lt; 2e-16 ***\nDESTIN_SZTPSZ02  0.7158441  0.0041312   173.278  &lt; 2e-16 ***\nDESTIN_SZTPSZ03 -0.4314229  0.0059917   -72.004  &lt; 2e-16 ***\nDESTIN_SZTPSZ04 -1.5898245  0.0076083  -208.959  &lt; 2e-16 ***\nDESTIN_SZTPSZ05 -1.0445550  0.0062363  -167.497  &lt; 2e-16 ***\nDESTIN_SZTPSZ06 -0.4319582  0.0070100   -61.621  &lt; 2e-16 ***\nDESTIN_SZTPSZ07 -2.1602303  0.0120352  -179.493  &lt; 2e-16 ***\nDESTIN_SZTPSZ08 -1.1920493  0.0093083  -128.063  &lt; 2e-16 ***\nDESTIN_SZTPSZ09 -0.2022481  0.0071137   -28.431  &lt; 2e-16 ***\nDESTIN_SZTPSZ10 -1.2464793  0.0090124  -138.308  &lt; 2e-16 ***\nDESTIN_SZTPSZ11 -0.0808445  0.0056019   -14.432  &lt; 2e-16 ***\nDESTIN_SZTPSZ12 -0.6784376  0.0066340  -102.267  &lt; 2e-16 ***\nDESTIN_SZTSSZ01 -1.5845062  0.0222086   -71.346  &lt; 2e-16 ***\nDESTIN_SZTSSZ02 -0.1886010  0.0146338   -12.888  &lt; 2e-16 ***\nDESTIN_SZTSSZ03  0.6525526  0.0092450    70.585  &lt; 2e-16 ***\nDESTIN_SZTSSZ04  0.5285464  0.0100182    52.759  &lt; 2e-16 ***\nDESTIN_SZTSSZ05  1.4670106  0.0104357   140.577  &lt; 2e-16 ***\nDESTIN_SZTSSZ06  2.5043588  0.0167444   149.564  &lt; 2e-16 ***\nDESTIN_SZWCSZ01  1.9787931  0.0054306   364.375  &lt; 2e-16 ***\nDESTIN_SZWCSZ02 -2.2593108  0.0127916  -176.624  &lt; 2e-16 ***\nDESTIN_SZWCSZ03 -3.1897655  0.0326927   -97.568  &lt; 2e-16 ***\nDESTIN_SZWDSZ01  1.0476108  0.0044629   234.738  &lt; 2e-16 ***\nDESTIN_SZWDSZ02 -1.3176990  0.0065894  -199.973  &lt; 2e-16 ***\nDESTIN_SZWDSZ03  0.3432057  0.0052496    65.377  &lt; 2e-16 ***\nDESTIN_SZWDSZ04 -0.7895927  0.0073392  -107.586  &lt; 2e-16 ***\nDESTIN_SZWDSZ05 -0.8751665  0.0072946  -119.975  &lt; 2e-16 ***\nDESTIN_SZWDSZ06 -0.2106221  0.0053027   -39.720  &lt; 2e-16 ***\nDESTIN_SZWDSZ07 -1.6050834  0.0071754  -223.692  &lt; 2e-16 ***\nDESTIN_SZWDSZ08 -0.5124717  0.0069223   -74.032  &lt; 2e-16 ***\nDESTIN_SZWDSZ09  0.3813542  0.0054697    69.721  &lt; 2e-16 ***\nDESTIN_SZYSSZ01  0.0853753  0.0046572    18.332  &lt; 2e-16 ***\nDESTIN_SZYSSZ02 -0.3227172  0.0057351   -56.271  &lt; 2e-16 ***\nDESTIN_SZYSSZ03 -0.4151283  0.0066299   -62.615  &lt; 2e-16 ***\nDESTIN_SZYSSZ04 -0.4637327  0.0058206   -79.671  &lt; 2e-16 ***\nDESTIN_SZYSSZ05 -1.5888242  0.0111001  -143.136  &lt; 2e-16 ***\nDESTIN_SZYSSZ06 -1.4606209  0.0107759  -135.545  &lt; 2e-16 ***\nDESTIN_SZYSSZ07 -0.7839065  0.0144357   -54.304  &lt; 2e-16 ***\nDESTIN_SZYSSZ08  0.6265412  0.0045504   137.691  &lt; 2e-16 ***\nDESTIN_SZYSSZ09  0.1520067  0.0048092    31.607  &lt; 2e-16 ***\nlog(DIST)       -1.8468315  0.0004608 -4008.033  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 47094011  on 14470  degrees of freedom\nResidual deviance: 10420261  on 13912  degrees of freedom\nAIC: 10510518\n\nNumber of Fisher Scoring iterations: 7\n\n\ndoubly constraint no attractive variable.\nmodel_list &lt;- list(unconstrained = uncSIM,\n                   originConstrained = orcSIM,\n                   desintationConstrained = decSIM,\n                   doublyConstrained = dbcSIM)\ncompare_performance(model_list,\n                    metrics = \"RMSE\")\nthe smallest RMSE is the best.\nin the in-class exercise 3, we can also visually see the RMSE, the bigger the RMSE, the data point are not as a close fit\nthen there’s a big outlier, we might want to find out the big outlier. the model skew it? if we remove the outlier, how does that affect the model.\nthe outlier shift the line? will the model perform better"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html",
    "title": "Take-home_Ex2",
    "section": "",
    "text": "To visualise and try to understand the flow of commuters in the Weekday Morning Peak"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#objective",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#objective",
    "title": "Take-home_Ex2",
    "section": "",
    "text": "To visualise and try to understand the flow of commuters in the Weekday Morning Peak"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#setting-up-the-environment",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#setting-up-the-environment",
    "title": "Take-home_Ex2",
    "section": "Setting Up the Environment",
    "text": "Setting Up the Environment\n\nPackages\nTo aid us in the analysis, we are using R and the associated packages. We set the stage by loading them into the environment as below\n\ntmap: used for creating thematic maps, such as choropleth and bubble maps\nsf: used for importing, managing, and processing geospatial data\ntidyverse: a collection of packages for data science tasks\nsfdep: used to create spatial weights matrix objects\nhttr : used to make API calls, especially to OneMap API to geocode the address\n\n\n\nCode\npacman::p_load(tmap, sf, tidyverse, sfdep, knitr, plotly, DT, lubridate, magick, httr, stplanr)\n\n\n\n\nReusable Functions\nIn addition, we check for duplicates fairly often, thus we can make it into a function for reuseability\n\n\nCode\n#these procedures will be reused, so easier to keep them as a function\n\n#check if all unique\nisUnique &lt;- function(v){\n  return(!any(duplicated(v)))\n}\n\n\n#extract the number of rows that are not unique\nextractduplicatecount &lt;- function(v){\n  return(v %&gt;%\n    group_by_all() %&gt;%\n    filter(n()&gt;1) %&gt;%\n    ungroup() %&gt;%\n    nrow())\n}"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#first-look-at-our-bus-data",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#first-look-at-our-bus-data",
    "title": "Take-home_Ex2",
    "section": "First Look at our BUS Data",
    "text": "First Look at our BUS Data\nWe need to load in the dataset downloaded.\n\n\nCode\nodbus202308 &lt;- read_csv(\"data/aspatial/origin_destination_bus_202308.csv\")\nglimpse(odbus202308)\n\n\nRows: 5,709,512\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2023-08\", \"2023-08\", \"2023-08\", \"2023-08\", \"2023-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKDAY\", \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 17, 7, 17, 14, 10, 10,…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;chr&gt; \"04168\", \"04168\", \"80119\", \"80119\", \"44069\", \"4406…\n$ DESTINATION_PT_CODE &lt;chr&gt; \"10051\", \"10051\", \"90079\", \"90079\", \"17229\", \"1722…\n$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …\n\n\nWe see that apart from the total trips & time, the rest of the variables are as character field. However, we expect that month of travel, day_type, public transport type, origin & destination code are supposed to be standardised. Lets catergorising these variables to check the unique combinations.\n\n\nCode\n# Change all columns to factors\nodbus202308 &lt;- data.frame(lapply(odbus202308, factor))\nodbus202308$TOTAL_TRIPS &lt;- as.numeric(odbus202308$TOTAL_TRIPS)\nodbus202308$TIME_PER_HOUR &lt;- as.numeric(odbus202308$TIME_PER_HOUR)\n\n\nAfter catergorising the variables, we see that as per dataset naming, there was only bus transport data in 2023 Aug. The days are grouped together into 2 category of WEEKDAY or WEEKENDS/HOLIDAY.\nThe timing is consolidated into 0-24, though interestingly Weekday 3am is not present, probably because there were no bus services operating on weekday at 4am.\n\n\nCode\nodbus202308_isunique &lt;- isUnique(odbus202308)\nodbus202308_extractduplicatecount &lt;- extractduplicatecount(odbus202308)\n\n\n\n\nCode\n#Lets also check if the trips data is unique. Check if trips data is unique returned `r #odbus202308_isunique`. There are `r odbus202308_extractduplicatecount` lines that are duplicated\n\n\nLets also check if the trips data is unique. Check if trips data is unique returned TRUE. There are 0 lines that are duplicated"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#where-do-we-take-the-bus",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#where-do-we-take-the-bus",
    "title": "Take-home_Ex2",
    "section": "Where do we take the Bus?",
    "text": "Where do we take the Bus?\n\nLoading in Busstop Data\nFrom the bus trip data, we have trips from ORIGIN_PT_CODE to DESTINATION_PT_CODE. however, that is a unique ID tagged to each busstop, but without the busstop metadata, we don’t know where are these busstops. So we need to add in an additional data to plot the geographical location of each busstop.\n\n\nCode\nbusstop &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\n\nReading layer `BusStop' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 5161 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\nWe see that busstop data is a point data with only 1 pair of XY coordinate per feature. BUS_STOP_N in the busstop data is a unique ID matching to that of ORIGIN_PT_CODE & DESTINATION_PT_CODE. Thus lets apply the same transformation to make it into a category to allow matching of the trip data to the busstop location.\n\n\nCode\n#datatable(sample_n(busstop,25), filter = 'top', options = list(paging = FALSE))\ndatatable(sample_n(busstop,25))\n\n\n\n\n\n\n\n\n\nCode\nbusstop$BUS_STOP_N &lt;- as.factor(busstop$BUS_STOP_N)\nbusstop$BUS_ROOF_N &lt;- as.factor(busstop$BUS_ROOF_N)\n\n\nLets check if the busstops are unique.\n\n\nCode\nbusstop_isunique &lt;- isUnique(busstop)\nbusstop_extractduplicatecount &lt;- extractduplicatecount(busstop)\n\n\nCheck if busstop data is unique returned TRUE. There are 0 lines that are duplicated.\n\n\nLayering Busstop with No. Trips\nWe should then first check there are busstops that are found in trips but don’t have a busstop point mapped. This is more important because, it is possible for an existing busstop to have no demand, but not possible to have trips from a missing busstop. a) BUS_STOP_N from geometry data b) ORIGIN_PT_CODE from trips data\n\n\nCode\n# Assuming 'db1' and 'db2' are your data frames, and 'bus_stop' is the bus stop identifier\nmissing_in_busstop_ORIGIN &lt;- data.frame(setdiff(odbus202308$ORIGIN_PT_CODE,busstop$BUS_STOP_N)) %&gt;% rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_DESTINATION &lt;- data.frame(setdiff(odbus202308$DESTINATION_PT_CODE,busstop$BUS_STOP_N)) %&gt;% \n  rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_combined &lt;- rbind(missing_in_busstop_ORIGIN,missing_in_busstop_DESTINATION) %&gt;% unique() %&gt;% \n  arrange(BUS_STOP_N)\n\n\n\n\nCode\norigin_daytime &lt;- odbus202308 %&gt;%\n  group_by(DAY_TYPE,TIME_PER_HOUR,ORIGIN_PT_CODE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS))\n\norigin_only &lt;- origin_daytime %&gt;%\n  group_by(ORIGIN_PT_CODE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS))\n\norigin_total &lt;- origin_only %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(ORIGIN_PT_CODE))\n\nmissing_in_busstop_trips &lt;- left_join(missing_in_busstop_combined, origin_only\n                                      , by=c(\"BUS_STOP_N\" = \"ORIGIN_PT_CODE\")) %&gt;%\n  arrange(desc(TOTAL_TRIPS))\n\nmissing_in_busstop_total &lt;- missing_in_busstop_trips %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(BUS_STOP_N))\n\nmissing_stop1 &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_STOPS)\n\nmissing_stop_ratio1 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total %&gt;% pull(TOTAL_STOPS) / origin_total %&gt;% pull(TOTAL_STOPS)*100)\n\nmissing_trip_ratio1 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total %&gt;% pull(TOTAL_TRIPS) / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\n\nUpon inspection, there are 54 busstops that are not found with a geometry data point. They made up of 1.6% of trips and 1.1% of bus stops. In particular, the top 2 observations 59009 and 47009 are Yishun & Woodlands Interchange respectively and should be included. Thus i have made some manual input to find the location of yishun bus interchange & woodlands temp bus interchange.\nNote: although woodlands regional bus interchange has started operation, there are a few bus services that continue to run from the temp bus interchange [LINK].\n\n\nCode\n#manualbusstop &lt;- tibble(BUS_STOP_N = c('59009','47009'), lat = c(1.4278664,1.4375880), lon = #c(103.8361437,103.7865749), LOC_DESC = c('YISHUN BUS INT','WOODLANDS TEMP BUS INT'), BUS_ROOF_N=c('','')) \n\nmanualbusstop &lt;- read.csv(\"data/aspatial/AdditionalBusStop.csv\") %&gt;%\n  mutate(BUS_STOP_N = sprintf(\"%05d\",BUS_STOP_N))\n\nmanualbusstop_geo2 &lt;- st_as_sf(manualbusstop, coords = c(\"LONG\",\"LAT\"), crs = 4326) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(manualbusstop_geo2)+\n  tm_dots(col=\"red\",\n          size = 0.2)+  \n  tm_layout(main.title = \"Manual Busstop Added\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nThereafter, lets concentrate on the busstop in Singapore, and concatenate the geometry data from LTA and the manual input, and check the difference in the trips missing\n\n\nCode\nbusstop2 &lt;- rbind(busstop,manualbusstop_geo2) \n\nmissing_in_busstop_ORIGIN2 &lt;- data.frame(setdiff(odbus202308$ORIGIN_PT_CODE,busstop2$BUS_STOP_N)) %&gt;% rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_DESTINATION2 &lt;- data.frame(setdiff(odbus202308$DESTINATION_PT_CODE,busstop2$BUS_STOP_N)) %&gt;% \n  rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_combined2 &lt;- rbind(missing_in_busstop_ORIGIN2,missing_in_busstop_DESTINATION2) %&gt;% unique() %&gt;% \n  arrange(BUS_STOP_N)\n\nmissing_in_busstop_trips2 &lt;- left_join(missing_in_busstop_combined2, origin_only\n                                      , by=c(\"BUS_STOP_N\" = \"ORIGIN_PT_CODE\")) %&gt;%\n  arrange(desc(TOTAL_TRIPS))\n\nmissing_in_busstop_total2 &lt;- missing_in_busstop_trips2 %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(BUS_STOP_N))\n\nmissing_stop2 &lt;- missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS)\n\nmissing_stop_diff &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_STOPS) - missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS)\n\nmissing_trip_diff &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_TRIPS) - missing_in_busstop_total2 %&gt;% pull(TOTAL_TRIPS)\n\n\nmissing_stop_ratio2 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS) / origin_total %&gt;% pull(TOTAL_STOPS)*100)\n\nmissing_trip_ratio2 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total2 %&gt;% pull(TOTAL_TRIPS) / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\nmissing_trip_ratio_diff &lt;- sprintf(\"%.1f%%\", missing_trip_diff / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\n\n\n\nCode\nrm(busstop,mpsz,manualbusstop,manualbusstop_geo2, missing_in_busstop_combined, missing_in_busstop_combined2, missing_in_busstop_DESTINATION, missing_in_busstop_DESTINATION2, missing_in_busstop_ORIGIN, missing_in_busstop_ORIGIN2, missing_in_busstop_total, missing_in_busstop_total2, missing_in_busstop_trips, missing_in_busstop_trips2)\ngc()\n\n\n           used  (Mb) gc trigger  (Mb)  max used  (Mb)\nNcells  3545303 189.4    6667947 356.2   6667947 356.2\nVcells 31548710 240.7  100363720 765.8 100363175 765.8\n\n\nAfter the update, there are 30 busstops that are not found with a geometry data point. They made up of 0.1% of trips and 0.6% of bus stops. By just adding 24 stops, we are now accounting for 1.6% more trips.\nNow lets simplify and only look at busstops in Singapore and plot where are the busstops\n\n\nCode\n# Find points that are in Singapore\nsgbusstop &lt;- st_intersection(busstop2, sgp_simple)\n\nsgbusinterchange &lt;- read_csv(\"data/aspatial/sgbusinterchange.csv\") %&gt;%\n  select(BUS_STOP_N)\n\nsgbusstop$Interchange &lt;- ifelse(sgbusstop$BUS_STOP_N %in% sgbusinterchange$BUS_STOP_N,\"Interchange\",\"Busstop\")\n\n# Find points that are not within Singapore\njohorbusstop &lt;- busstop2[!busstop2$BUS_STOP_N %in%\n                          sgbusstop$BUS_STOP_N,]\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(sgbusstop)+\n  tm_dots()+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"blue\",\n          size = 0.3)+\n  tm_layout(main.title = \"Bus Stop & Bus Interchange Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\nrm(sgbusinterchange)\n\n\n\n\nCode\nwrite.csv(sgbusstop, file = 'data/aspatial/sgbusstop.csv')\n\n\n\n\nHexgon that are covering the busstops\n\n\nCode\nbusstop_withhex &lt;- st_intersection(sgbusstop,sgp_hexid)\n\nsgp_hexid_bs_df &lt;- st_intersection(sgp_hexid,sgbusstop) %&gt;%\n  data.frame() %&gt;%\n  select(hex_id,BUS_STOP_N, LOC_DESC)\n\nsgp_hexid_wbs_df &lt;- sgp_hexid_bs_df %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(TOTAL_STOPS = n_distinct(BUS_STOP_N),\n            ALL_STOPS_ID = list(as.factor(BUS_STOP_N)),\n            ALL_STOPS_DESC = list(LOC_DESC))\n\nsgp_hexid_wbs_geo &lt;- left_join(sgp_hexid,sgp_hexid_wbs_df) %&gt;%\n  filter(TOTAL_STOPS &gt; 0) %&gt;%\n  select(-area)\n\n\nThe downloaded data from LTA data mall has some issues where some polygons are not closed. There are 3 stations\n1) Habourfront MRT Station- IMPT this is an interchange between circle and NE line\n2) Upper Thomson MRT Station\n3) BOCC- this seem to be the Seletar Bus Depot which is not essential for commuters\nGiven the importance of Habourfront MRT & Upper Thomson MRT, we have fixed it using QGIS, where we can first check for validity thereafter do a manual cleaning [https://geoscience.blog/polygon-layer-cleaning-with-qgis/]\n\n\nCode\ntrainpolygon_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"mrt_fixed\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  unique() %&gt;%\n  select(STN_NAM_DE, TYP_CD_DES) %&gt;%\n  rename(stn_name = STN_NAM_DE)\n\n\nReading layer `mrt_fixed' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 220 features and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 6068.209 ymin: 27478.44 xmax: 45377.5 ymax: 47913.58\nProjected CRS: SVY21\n\n\nCode\ntrainexitpoint_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Train_Station_Exit_Layer\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  unique()\n\n\nReading layer `Train_Station_Exit_Layer' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 565 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6134.086 ymin: 27499.7 xmax: 45356.36 ymax: 47865.92\nProjected CRS: SVY21\n\n\n\n\nCode\n#map_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(trainpolygon_sf)+\n  tm_polygons()+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col= \"blue\")+\n  tm_layout(main.title = \"Train Station Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\ntrainstationmeta &lt;- read_csv(\"data/aspatial/Train Station Codes and Chinese Names.csv\") %&gt;%\n  select(stn_name, Interchange, Lines) %&gt;%\n  unique() %&gt;%\n  na.exclude()\n\ntrainexitpoint_sf &lt;- left_join(trainexitpoint_sf,trainstationmeta)\ntrainpolygon_sf &lt;- left_join(trainpolygon_sf,trainstationmeta)\n\ntrainexitpoint_sf &lt;- trainexitpoint_sf[!is.na(trainexitpoint_sf$Lines),]\ntrainpolygon_sf &lt;- trainpolygon_sf[!is.na(trainpolygon_sf$Lines),]\n\n\nWhen we look at the maps above, we can see HUGE polygons that are not train staion but depot or control centre. These are not exactly the stations that we want. additionally, we also see there are some train station that are built but not in service yet. For this purpose we can also exclude them. There is a separate dataset from Data.gov.sg called “Train Station Codes and Chinese Names” that only show the active stations, thus we can use that to filter to the relevant station. Do note the below though\n1) Woodlands South & Woodlands North has an extra space in the Train Station Code dataset that we did a simple cleaning before matching for\n2) Teck Lee LRT is missing in the Train Station Code dataset, and it is not in service yet. [LTA]\n3)Marina South MRT Station is missing in the Train Station Code dataset and is not in service yet. Note it is different from Marina South Pier MRT Station!!\nTherefore, we can remove Teck Lee and Marina South\n\n\nCode\n#map_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(trainpolygon_sf)+\n  tm_polygons()+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col= \"blue\")+\n  tm_layout(main.title = \"Train Station Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.2,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(col=\"TOTAL_STOPS\", \n              alpha = 0.2,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")\n              ) +\n  tm_shape(trainpolygon_sf)+\n  tm_polygons(alpha = 0.2)+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col = \"purple\",\n          size= 0.06)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"green\",\n          size = 0.03)+\n  tm_layout(main.title = \"Transport Node Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\ntmap_mode(\"plot\")"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html",
    "title": "Take-home_Ex2",
    "section": "",
    "text": "To visualise and try to understand the flow of commuters in the Weekday Morning Peak"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/Retails.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/Retails.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/Liesure&Recreation.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/Liesure&Recreation.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/F&B.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/F&B.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/data/geospatial/entertn.html",
    "href": "Take-home_Ex/Take-home_Ex2/data/geospatial/entertn.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/data/geospatial/Liesure&Recreation.html",
    "href": "Take-home_Ex/Take-home_Ex2/data/geospatial/Liesure&Recreation.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/data/geospatial/F&B.html",
    "href": "Take-home_Ex/Take-home_Ex2/data/geospatial/F&B.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/data/geospatial/Business.html",
    "href": "Take-home_Ex/Take-home_Ex2/data/geospatial/Business.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/data/geospatial/FinServ.html",
    "href": "Take-home_Ex/Take-home_Ex2/data/geospatial/FinServ.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/data/geospatial/Retails.html",
    "href": "Take-home_Ex/Take-home_Ex2/data/geospatial/Retails.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/Business.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/Business.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/FinServ.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/FinServ.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/MPSZ-2019.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/entertn.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/entertn.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#attributes",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#attributes",
    "title": "Take-home_Ex2",
    "section": "Attributes",
    "text": "Attributes\n\nno. of busstops (push & pull)\nno of MRT exit (push & pull) - kind of proxy for how crowded this place is, e.g. raffles place has X exits because they serve a big population for work\nBUS Interchange - (push & pull)\nMRT Interchange - (push & pull)\nPreschool - pull but likely low, because pre-schoolers usually dont take public transport. it is generally near to home. Otherwise, it could be explaning for proximity to amenities or workplace\nPrimarySchool - pull, but likely low. especially if the kids are in lower primary. can also refer to extract from population census, they generally don’t take bus\nSecondarySchool - pull\nJC - pull\nTetiary Education (don’t think they matter for morning peak) like ITE, Poly, Uni - pull but lower effect due to staggered starting time\nBusiness - pull\nF&B - likely low impact because F&B location generally don’t open so early. apart from hawker centre, which people might go nearby to eat before going to work/school? (push???) seldom do we see people taking public transport to specific F&B before work/school. likely more so it is near to their home/destination\npopulation - push\nfin service - pull\nlanded area - interesting to see if landed matters\nretail - pull? likely not much impact?\n\n\n\nCode\nurl &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n\ncsv &lt;- read_csv(\"data/aspatial/Generalinformationofschools.csv\")\n\n#this is saving the postal_code separately as a list\npostcodes &lt;- csv$`postal_code`\n\n\n#initialisation, empty dataframe\nfound &lt;- data.frame()\nnot_found &lt;- data.frame()\n\n\nfor (postcode in postcodes){\n  query &lt;- list('searchVal'=postcode, 'returnGeom' = 'Y', 'getAddrDetails' = 'Y', 'pageNum' = '1')\n  res &lt;- GET(url, query=query)\n  \n  if((content(res)$found) != 0){\n    found &lt;- rbind(found,data.frame(content(res))[4:13])\n  } else {\n    not_found = data.frame(postcode)\n  }\n}\n\n\n\n\nCode\nmerged = merge(csv, found, by.x = 'postal_code', by.y = 'results.POSTAL', all = TRUE)\nwrite.csv(merged, file = 'data/aspatial/schools.csv')\nwrite.csv(not_found, file = \"data/aspatial/not_found.csv\")\n\n\n\n\nCode\nnewschoolread &lt;- read_csv(\"data/aspatial/schools_updated.csv\") %&gt;%\n  rename(longtitude = results.LONGITUDE,\n         latitude = results.LATITUDE) %&gt;%\n  select(school_name, longtitude, latitude) %&gt;%\n  unique()\n\nschcategory &lt;- read_csv(\"data/aspatial/SchoolCategory.csv\")\n\nnewschoolread2 &lt;- left_join(newschoolread,schcategory)\nrm(newschoolread,schcategory)\n\n\n\n\nCode\nschools_sf &lt;- st_as_sf(newschoolread2,\n                       coords = c(\"longtitude\",\"latitude\"),\n                       crs = 4326\n                       ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\nprisch_sf &lt;- schools_sf %&gt;%\n  filter(level == \"PRIMARY\")\n\nsecjcsch_sf &lt;- schools_sf %&gt;%\n  filter(level != \"PRIMARY\")\n\nrm(newschoolread2)\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(schools_sf)+\n  tm_dots(col =  \"level\")+\n  #tm_shape(prisch_sf)+\n  #tm_dots(col =  \"lightblue\")+\n  #tm_shape(secjcsch_sf)+\n  #tm_dots(col =  \"black\")+\n  tm_layout(main.title = \"Primary, Secondary, JC Schools Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nprivateinstitution_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"PrivateEducationInstitutions\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(NAME_OF_SC,POSTALCODE,STREETNAME) %&gt;%\n  filter(NAME_OF_SC != \"SINGAPORE INSTITUTE OF MANAGEMENT\") %&gt;%\n  unique()\n\n\nReading layer `PrivateEducationInstitutions' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 284 features and 22 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6788 ymin: 1.273068 xmax: 103.9437 ymax: 1.4498\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(privateinstitution_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Private Education Institution Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\ntetiary &lt;- read_csv(\"data/aspatial/TetiaryEducation.csv\")\n\ntetiary_sf &lt;- st_as_sf(tetiary,\n                       coords = c(\"Long\",\"Lat\"),\n                       crs = 4326\n                       ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid() %&gt;%\n  unique()\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(tetiary_sf)+\n  tm_dots(col = \"Type\",\n          size = 0.5)+\n  tm_layout(main.title = \"Tetiary Education Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\nrm(tetiary)\n\n\n\n\nCode\npreschool_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"PreSchoolsLocation-point\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  unique()\n\n\nReading layer `PreSchoolsLocation-point' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2290 features and 5 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(preschool_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"PreSchool Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\nFOOD & ENTERTAINMENT\n\n\nCode\nurl &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n\ncsv &lt;- read_csv(\"data/aspatial/ListofGovernmentMarketsHawkerCentres.csv\")\n\n#this is saving the postal_code separately as a list\npostcodes &lt;- csv$`postalcode`\n\n\n#initialisation, empty dataframe\nfound &lt;- data.frame()\nnot_found &lt;- data.frame()\n\n\nfor (postcode in postcodes){\n  query &lt;- list('searchVal'=postcode, 'returnGeom' = 'Y', 'getAddrDetails' = 'Y', 'pageNum' = '1')\n  res &lt;- GET(url, query=query)\n  \n  if((content(res)$found) != 0){\n    found &lt;- rbind(found,data.frame(content(res))[4:13])\n  } else {\n    not_found = data.frame(postcode)\n  }\n}\n\n\n\n\nCode\nmerged = merge(csv, found, by.x = 'postalcode', by.y = 'results.POSTAL', all = TRUE)\nwrite.csv(merged, file = 'data/aspatial/hawker.csv')\nwrite.csv(not_found, file = \"data/aspatial/hakwer_notfound.csv\")\n\n\n\n\nCode\nnewhawker &lt;- read_csv(\"data/aspatial/hawker_updated.csv\") %&gt;%\n  rename(longtitude = results.LONGITUDE,\n         latitude = results.LATITUDE,\n         postal_code = postalcode) %&gt;%\n  select(name_of_centre,\n         no_of_stalls, \n         no_of_cooked_food_stalls, \n         no_of_mkt_produce_stalls, \n         longtitude, \n         latitude) %&gt;%\n  unique()\n\nhawker_sf &lt;- st_as_sf(newhawker,\n                       coords = c(\"longtitude\",\"latitude\"),\n                       crs = 4326\n                       ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(hawker_sf)+\n  tm_dots(col =  \"no_of_stalls\",\n          palette = \"Reds\",\n          size = 0.2)+\n  tm_layout(main.title = \"Hawker Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\n  rm(newhawker)\n\n\n\n\nCode\nentertainment_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"entertn\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `entertn' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 114 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 10809.34 ymin: 26528.63 xmax: 41600.62 ymax: 46375.77\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(entertainment_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Entertainment Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nfnb_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"F&B\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `F&B' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1919 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6010.495 ymin: 25343.27 xmax: 45462.43 ymax: 48796.21\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(fnb_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"F&B Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\ntourism_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"TOURISM\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(PAGETITLE) %&gt;%\n  unique()\n\n\nReading layer `TOURISM' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 107 features and 19 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -1.797693e+308 ymin: -1.797693e+308 xmax: 43659.54 ymax: 47596.73\nProjected CRS: SVY21\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(tourism_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Toursim Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nsilverszone_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Silverzone_Updated\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(SITENAME) %&gt;%\n  unique()\n\n\nReading layer `Silverzone_Updated' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 20 features and 3 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 15059.67 ymin: 28640.08 xmax: 40994.23 ymax: 46353.94\nProjected CRS: SVY21\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(silverszone_sf)+\n  tm_polygons()+\n  tm_layout(main.title = \"Silverzone Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nleisure_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Liesure&Recreation\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `Liesure&Recreation' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1217 features and 30 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6010.495 ymin: 25134.28 xmax: 48439.77 ymax: 50078.88\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(leisure_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Leisure Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nretail_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Retails\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `Retails' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 37635 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 4737.982 ymin: 25171.88 xmax: 48265.04 ymax: 50135.28\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(retail_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Retail Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nWORK\n\n\nCode\nfinserv_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"FinServ\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `FinServ' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3320 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 4881.527 ymin: 25171.88 xmax: 46526.16 ymax: 49338.02\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(finserv_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Financial Service Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\neldercare_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"ELDERCARE\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(NAME) %&gt;%\n  unique()\n\n\nReading layer `ELDERCARE' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 133 features and 18 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(eldercare_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Eldercare Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nbusiness_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Business\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `Business' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 6550 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3669.148 ymin: 25408.41 xmax: 47034.83 ymax: 50148.54\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(business_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Business Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nRESIDENTIAL\n\n\nCode\nhotel_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"HotelLocations-point\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(Name, TOTALROOMS) %&gt;%\n  unique()\n\n\nReading layer `HotelLocations-point' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 429 features and 9 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 103.6351 ymin: 1.245797 xmax: 103.9891 ymax: 1.419278\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(hotel_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Hotel Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nuradwelling_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"URANoofDwellingUnits\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POSTALCODE,PROJ_NAME,PROP_TYPE,DU) %&gt;%\n  mutate(DU = as.numeric(DU),\n         PROP_TYPE = as.factor(PROP_TYPE),\n         population = round(ifelse(PROP_TYPE== \"Landed\",4.4,3.3) * DU )\n         ) %&gt;%\n  unique()\n\n\nReading layer `URANoofDwellingUnits' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 82766 features and 20 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6894 ymin: 1.238105 xmax: 103.9762 ymax: 1.462102\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(uradwelling_sf)+\n  tm_dots(col=\"population\")+\n  tm_layout(main.title = \"URA Dwelling Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nurl &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n\nhdb_raw &lt;- read_csv(\"data/aspatial/hdb_tofind.csv\") %&gt;%\n  mutate(searchname = paste(blk_no,street, sep = \" \"))\n\n\n#initialisation, empty dataframe\nfound &lt;- data.frame()\nnot_found &lt;- data.frame()\n\n\nfor (searchna in hdb_raw$searchname){\n  query &lt;- list('searchVal'=searchna, 'returnGeom' = 'Y', 'getAddrDetails' = 'Y', 'pageNum' = '1')\n  res &lt;- GET(url, query=query)\n  \n  if((content(res)$found) != 0){\n    found &lt;- rbind(found,data.frame(content(res))[4:13])\n  } else {\n    not_found = data.frame(searchna)\n    found &lt;- rbind(found,\"\")\n  }\n}\n\n\n\n\nCode\nmerged &lt;- cbind(hdb_raw,found)\nwrite.csv(merged, file = 'data/aspatial/hdb_tofind_updated.csv')\nwrite.csv(found, file = 'data/aspatial/hdb_found.csv')\nwrite.csv(not_found, file = \"data/aspatial/hdb_notfound.csv\")\n\n\nthereafter we combine our searched result with prof’s prepared hdb dataset. There’s one block that was not found earlier that was 141A Serangoon North Avenue 2. However that’s a multistorey carpark and is not too critical, even though we have added that in for completeness\n\n\nCode\nnewhdb &lt;- read_csv(\"data/aspatial/hdb_updated.csv\") %&gt;%\n  mutate(population = round(\n           `1room_sold` * 2.1+\n           `2room_sold` * 2.1+\n           `3room_sold` * 2.5+\n           `4room_sold` * 3.3+\n           `5room_sold` * 3.7+\n           `exec_sold` * 3.7+\n           `multigen_sold` * 3.7+\n           `studio_apartment_sold`*2.1+\n           `1room_rental` * 2.1+\n           `2room_rental` * 2.1+\n           `3room_rental` * 2.5+\n           `other_room_rental` * 3.3)) %&gt;%\n  filter(population &gt; 0) %&gt;%\n  select(addr, postal,population, max_floor_lvl, total_dwelling_units, lng, lat) %&gt;%\n  unique()\n\nhdb_sf &lt;- st_as_sf(newhdb,\n                   coords = c(\"lng\",\"lat\"),\n                   crs = 4326\n                   ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(hdb_sf)+\n  tm_dots(col =  \"population\",\n          palette = \"Reds\")+\n  tm_layout(main.title = \"HDB Block Population Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\n  rm(newhdb)\n  gc()\n\n\n           used  (Mb) gc trigger  (Mb)  max used  (Mb)\nNcells  4625441 247.1    9405675 502.4   9405675 502.4\nVcells 11246990  85.9   41181783 314.2 100493010 766.8"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex5/In-class_Ex5.html",
    "href": "In-class_Ex/In-class_Ex5/In-class_Ex5.html",
    "title": "In-Class_Ex5",
    "section": "",
    "text": "each will have a weight matrix. the weight matrix is the same as lesson 2’s spatial weight. We only focus on 1 area of application, which is the spatial interaction. We can apply for geographical regression, it is the same method. We only focus on how we further modify the spatial interaction mode. we have unconstraint, origin, destination, doubly constraint. we have 4, double up with weight version. in that case we can develop a total of 9 models\nModel 1 - Unconstraint Model 2 - Origin Model 3 - Destination\nAll the R packages we use, it is very well documented, it is progressively developed. Most of the library developed are based on certain well-published article or paper. e.g. published in 2008, and wrapped over into the software tools. Facebook Team has developed a very good algorithm for time series forecasting and it has been wrapped over to python, R, C etc. But if we compare the packages with well methodical documentation / papers, R has more.\nfor spflow, it is published on cran, but to publish on cran they need to be consistent with using latest packages. However, packages are developed in parallel, and developers tend to publish the latest development in github. which we will do this time round"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex5/In-class_Ex5.html#setting-up",
    "href": "In-class_Ex/In-class_Ex5/In-class_Ex5.html#setting-up",
    "title": "In-Class_Ex5",
    "section": "Setting Up",
    "text": "Setting Up\n\n\nCode\ndevtools::install_github(\"LukeCe/spflow\")\n\n\nwe use devtools:: because we didn’t load it into the R environment. So we use :: to do it once, w/o the need to load\nNext, we will load spflow and other R packages into R environment\n\n\nCode\npacman::p_load(tmap, sf, spdep, sp, Matrix, spflow, reshape2, knitr, tidyverse)\n\n\nthe main change is changing mask with Matrix. Matrix is a commonly used package for econometrics, and it is updated frequently, so we can just use the cran version\nspdep, we use it to derive spatial weight matrix sp handle spatial polygon knitr for html table tidyverse for handling data attribute table\nfor this exercise, we just need 1 set. whereas for take-home ex2, we need to specify is it for origin or destination. they will automatically look for it in spflow.\nthe MPSZ geographical unit is planning subzone Hexagon created on the fly is 1,2,3,4 it is numerical field, it will be treated as continous variable and will be included in the algorithm as continuous variable. we need to change it to a character or factor field.\n\n\nCode\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414)\n\nbusstop &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\nmpsz$`BUSSTOP_COUNT` &lt;- lengths(\n  st_intersects(\n    mpsz,busstop\n  )\n)\n\nmpsz_busstop &lt;- mpsz %&gt;%\n  filter(BUSSTOP_COUNT &gt; 0)\n\n\nto find out which planning subzone has no busstop. With this information\n\n\nCode\ncentroids &lt;- suppressWarnings({\n  st_point_on_surface(st_geometry(mpsz_busstop))\n})\n\nmpsz_nb &lt;- list(\n  \"by_contiguity\" = poly2nb(mpsz_busstop),\n  \"by_distance\" = dnearneigh(centroids,\n                             d1 = 0, d2 = 5000),\n  \"by_knn\" = knn2nb(knearneigh(centroids,3))\n)\n\n\ncontiguity , we just want to use a list, by default it is a queens method dnearneigh limit is 5000 hexagon we have 6 side, so we can choose 6. but for subzone, we can just use 3\nfor distance based, they will first take the centroid. then use the centroid for the distance.\nShould show out and have a better feel of the neighbour. when we prepare for output discussion, we can zoom in if it is too messy.\nit reduce the processing time. once we save\n\n\nCode\nodbus6_9 &lt;- read_rds(\"data/rds/odbus6_9.rds\")\n\n\nmpsz_nb is neighbour, it is the 1 that gives us the weight (w) mpsz_flow is the origin, destination and trips (flow) mpsz_var is the explanatory variables\n\n\nCode\nmpsz_nb &lt;- read_rds(\"data/rds/mpsz_nb.rds\")\nmpsz_flow &lt;- read_rds(\"data/rds/mpsz_flow.rds\")\nmpsz_var &lt;- read_rds(\"data/rds/mpsz_var.rds\")\n\n\n\ncreating spflow_network-class objects\nspflow_network-class is an S4 class that contains all information on a spatial network which is composed by a set of nodes that are linked by some neighbourhood relation. It can be created by using [spflow_network()]\n\n\nCode\nmpsz_net &lt;- spflow_network(\n  id_net = \"sg\",\n  node_neighborhood = \n    nb2mat(mpsz_nb$by_contiguity),\n  node_data = mpsz_var,\n  node_key_column = \"SZ_CODE\"\n)\n\nmpsz_net\n\n\nSpatial network nodes with id: sg\n--------------------------------------------------\nNumber of nodes: 313\nAverage number of links per node: 6.077\nDensity of the neighborhood matrix: 1.94% (non-zero connections)\n\nData on nodes:\n                SZ_NAME SZ_CODE BUSSTOP_COUNT AGE7_12 AGE13_24 AGE25_64\n1      INSTITUTION HILL  RVSZ05             2     330      360     2260\n2        ROBERTSON QUAY  SRSZ01            10     320      350     2200\n3          FORT CANNING  MUSZ02             6       0       10       30\n4      MARINA EAST (MP)  MPSZ05             2       0        0        0\n5               SENTOSA  SISZ01             1     200      260     1440\n6        CITY TERMINALS  BMSZ17            10       0        0        0\n---                 ---     ---           ---     ---      ---      ---\n308            NEE SOON  YSSZ07            12      90      140      590\n309       UPPER THOMSON  BSSZ01            47    1590     3660    15980\n310          SHANGRI-LA  AMSZ05            12     810     1920     9650\n311          TOWNSVILLE  AMSZ04             9     980     2000    11320\n312           MARYMOUNT  BSSZ02            25    1610     4060    16860\n313 TUAS VIEW EXTENSION  TSSZ06            11       0        0        0\n    SCHOOL_COUNT BUSINESS_COUNT RETAILS_COUNT FINSERV_COUNT ENTERTN_COUNT\n1              1              6            26             3             0\n2              0              4           207            18             6\n3              0              7            17             0             3\n4              0              0             0             0             0\n5              0              1            84            29             2\n6              0             11            14             4             0\n---          ---            ---           ---           ---           ---\n308            0              0             7             0             0\n309            3             21           305            30             0\n310            3              0            53             9             0\n311            1              0            83            11             0\n312            3             19           135             8             0\n313            0             53             3             1             0\n    FB_COUNT LR_COUNT COORD_X COORD_Y\n1          4        3  103.84    1.29\n2         38       11  103.84    1.29\n3          4        7  103.85    1.29\n4          0        0  103.88    1.29\n5         38       20  103.83    1.25\n6         15        0  103.85    1.26\n---      ---      ---     ---     ---\n308        0        0  103.81     1.4\n309        5       11  103.83    1.36\n310        0        0  103.84    1.37\n311        1        1  103.85    1.36\n312        3       11  103.84    1.35\n313        0        0  103.61    1.26\n\n\nid_net, can be anything. prof just called it SG. this is just assigning it an ID name, no specific meaning or variable that it should draw from.\n\n\nCode\nmpsz_net_pairs &lt;- spflow_network_pair(\n  id_orig_net = \"sg\",\n  id_dest_net = \"sg\",\n  pair_data = mpsz_flow,\n  orig_key_column = \"ORIGIN_SZ\",\n  dest_key_column = \"DESTIN_SZ\"\n)\n\nmpsz_net_pairs\n\n\nSpatial network pair with id: sg_sg\n--------------------------------------------------\nOrigin network id: sg (with 313 nodes)\nDestination network id: sg (with 313 nodes)\nNumber of pairs: 97969\nCompleteness of pairs: 100.00% (97969/97969)\n\nData on node-pairs:\n      DESTIN_SZ ORIGIN_SZ DISTANCE TRIPS\n1        RVSZ05    RVSZ05        0    67\n314      SRSZ01    RVSZ05   305.74   251\n627      MUSZ02    RVSZ05   951.83     0\n940      MPSZ05    RVSZ05  5254.07     0\n1253     SISZ01    RVSZ05     4975     0\n1566     BMSZ17    RVSZ05  3176.16     0\n---         ---       ---      ---   ---\n96404    YSSZ07    TSSZ06 26972.97     0\n96717    BSSZ01    TSSZ06 25582.48     0\n97030    AMSZ05    TSSZ06 26714.79     0\n97343    AMSZ04    TSSZ06 27572.74     0\n97656    BSSZ02    TSSZ06  26681.7     0\n97969    TSSZ06    TSSZ06        0   270\n\n\nthe mpsz_net_pair is a structured specifically for this purpose, it help to build the object class specifically. Then we no need to write all the code at the low level.\n\n\nCode\nmpsz_multi_net &lt;- spflow_network_multi(mpsz_net,\n                                       mpsz_net_pairs)\n\nmpsz_multi_net\n\n\nCollection of spatial network nodes and pairs\n--------------------------------------------------\nContains 1 spatial network nodes  \n    With id :  sg\nContains 1 spatial network pairs  \n    With id :  sg_sg\n\nAvailability of origin-destination pair information:\n\n ID_ORIG_NET ID_DEST_NET ID_NET_PAIR COMPLETENESS     C_PAIRS  C_ORIG  C_DEST\n          sg          sg       sg_sg      100.00% 97969/97969 313/313 313/313\n\n\nnote we cannot reverse the order. the syntax has been dictated. network class first then network_pair(flow) class\nthe mpsz_flow must be n by n. 313*313. we need to find out all the administrative boundary with busstop. then we calculate base on that particular layer. if it is not consistent, then it will forever give us error.\nMulticollinearity refer to to a situation in whihc more than 2 explanatory variabels in a multiple regression\n\n\nCode\ncor_formula &lt;- log(1+ TRIPS) ~\n  BUSSTOP_COUNT +\n  AGE7_12 +\n  AGE13_24 +\n  AGE25_64 +\n  SCHOOL_COUNT +\n  BUSINESS_COUNT +\n  RETAILS_COUNT +\n  FINSERV_COUNT +\n  P_(log(DISTANCE + 1))\n\ncor_mat &lt;- pair_cor(\n  mpsz_multi_net,\n  spflow_formula = cor_formula,\n  add_lags_x = FALSE\n)\n\n#for labelling the variable\ncolnames(cor_mat) &lt;- paste0(\n  substr(\n    colnames(cor_mat),1,6\n  ),\"...\"\n)\n\ncor_image(cor_mat)\n\n\n\n\n\nP_(log(DISTANCE+1)), P stand for impedence, translate it run for all origin, destination and intrazonal.\nthe lag is to add neighbourhood, we testing input variable only, so no need to lag\n\n\nBase Model\n\n\nCode\nbase_model &lt;- spflow(\n  spflow_formula = log(1+TRIPS) ~\n    O_(BUSSTOP_COUNT+\n         AGE25_64)+\n    D_(SCHOOL_COUNT +\n         BUSINESS_COUNT +\n         RETAILS_COUNT +\n         FINSERV_COUNT) +\n    P_(log(DISTANCE +1)),\n  spflow_networks = mpsz_multi_net\n)\n\nbase_model\n\n\n--------------------------------------------------\nSpatial interaction model estimated by: MLE  \nSpatial correlation structure: SDM (model_9)\nDependent variable: log(1 + TRIPS)\n\n--------------------------------------------------\nCoefficients:\n                          est     sd   t.stat  p.val\nrho_d                   0.680  0.004  192.554  0.000\nrho_o                   0.678  0.004  187.731  0.000\nrho_w                  -0.396  0.006  -65.590  0.000\n(Intercept)             0.410  0.065    6.266  0.000\n(Intra)                 1.313  0.081   16.263  0.000\nD_SCHOOL_COUNT          0.017  0.002    7.885  0.000\nD_SCHOOL_COUNT.lag1     0.002  0.004    0.551  0.582\nD_BUSINESS_COUNT        0.000  0.000    3.015  0.003\nD_BUSINESS_COUNT.lag1   0.000  0.000   -0.249  0.804\nD_RETAILS_COUNT         0.000  0.000   -0.306  0.759\nD_RETAILS_COUNT.lag1    0.000  0.000    0.152  0.880\nD_FINSERV_COUNT         0.002  0.000    6.787  0.000\nD_FINSERV_COUNT.lag1   -0.002  0.001   -3.767  0.000\nO_BUSSTOP_COUNT         0.002  0.000    6.806  0.000\nO_BUSSTOP_COUNT.lag1   -0.001  0.000   -2.364  0.018\nO_AGE25_64              0.000  0.000    7.336  0.000\nO_AGE25_64.lag1         0.000  0.000   -2.797  0.005\nP_log(DISTANCE + 1)    -0.050  0.007   -6.793  0.000\n\n--------------------------------------------------\nR2_corr: 0.6942942  \nObservations: 97969  \nModel coherence: Validated\n\n\nbusstop count only in origin, but can put in origin too if we want to default is MLE, model 9, rho_d means destination constraint rho_o means origin constraint rho_w is the intrazonal\nD_SCHOOL_COUNT is destination school count, immediate subzone is significant, but school in nearby subzone does not flow over (D_SCHOOL_COUNT.lag1 is insignificant)\nthis is similar for business\nretail, not significant for morning peak\nfinancial institution, itself and immediate neighbour is significant. attractiveness include its neighbour. shelton way, cover 3 planning subzone\nif there’s spatial autocorrelation, then it will not be a horizontal line\n\n\nCode\nold_par &lt;- par(mfrow = c(1,3),\n               mar = c(2,2,2,2))\nspflow_moran_plots(base_model)\n\n\n\n\n\n\n\nCode\npar(old_par)\n\ncorr_residual &lt;- pair_cor(base_model)\ncolnames(corr_residual) &lt;- substr(colnames(corr_residual),1,6)\ncor_image(corr_residual)\n\n\n\n\n\nwhat we interested in this plot is really the residual. Residual or the destination, origin. it allow for spatial autocorrelation in moran scatter plot\n\n\nCode\nspflow_formula &lt;- log(1+TRIPS) ~\n    O_(BUSSTOP_COUNT+\n         AGE25_64)+\n    D_(SCHOOL_COUNT +\n         BUSINESS_COUNT +\n         RETAILS_COUNT +\n         FINSERV_COUNT) +\n    P_(log(DISTANCE +1))\n\nmodel_control &lt;- spflow_control(\n  estimation_method = \"mle\",\n  model = \"model_8\"\n)\n\nmle_model8 &lt;- spflow(\n  spflow_formula,\n  spflow_networks = mpsz_multi_net,\n  estimation_control = model_control\n)\n\nmle_model8\n\n\n--------------------------------------------------\nSpatial interaction model estimated by: MLE  \nSpatial correlation structure: SDM (model_8)\nDependent variable: log(1 + TRIPS)\n\n--------------------------------------------------\nCoefficients:\n                          est     sd    t.stat  p.val\nrho_d                   0.689  0.003   196.831  0.000\nrho_o                   0.687  0.004   192.214  0.000\nrho_w                  -0.473  0.003  -142.468  0.000\n(Intercept)             1.086  0.049    22.275  0.000\n(Intra)                 0.840  0.075    11.254  0.000\nD_SCHOOL_COUNT          0.019  0.002     8.896  0.000\nD_SCHOOL_COUNT.lag1     0.019  0.004     5.130  0.000\nD_BUSINESS_COUNT        0.000  0.000     3.328  0.001\nD_BUSINESS_COUNT.lag1   0.000  0.000     1.664  0.096\nD_RETAILS_COUNT         0.000  0.000    -0.414  0.679\nD_RETAILS_COUNT.lag1    0.000  0.000    -0.171  0.864\nD_FINSERV_COUNT         0.002  0.000     6.150  0.000\nD_FINSERV_COUNT.lag1   -0.003  0.001    -4.601  0.000\nO_BUSSTOP_COUNT         0.003  0.000     7.676  0.000\nO_BUSSTOP_COUNT.lag1    0.000  0.000     0.552  0.581\nO_AGE25_64              0.000  0.000     6.870  0.000\nO_AGE25_64.lag1         0.000  0.000    -0.462  0.644\nP_log(DISTANCE + 1)    -0.125  0.005   -22.865  0.000\n\n--------------------------------------------------\nR2_corr: 0.6965973  \nObservations: 97969  \nModel coherence: Validated\n\n\n\n\nCode\nmodel_control &lt;- spflow_control(\n  estimation_method = \"mle\",\n  model = \"model_1\"\n)\n\nmle_model1 &lt;- spflow(\n  spflow_formula,\n  spflow_networks = mpsz_multi_net,\n  estimation_control = model_control\n)\n\nmle_model1\n\n\n--------------------------------------------------\nSpatial interaction model estimated by: OLS  \nSpatial correlation structure: SLX (model_1)\nDependent variable: log(1 + TRIPS)\n\n--------------------------------------------------\nCoefficients:\n                          est     sd    t.stat  p.val\n(Intercept)            11.384  0.069   164.255  0.000\n(Intra)                -6.006  0.112   -53.393  0.000\nD_SCHOOL_COUNT          0.093  0.003    28.599  0.000\nD_SCHOOL_COUNT.lag1     0.255  0.006    44.905  0.000\nD_BUSINESS_COUNT        0.001  0.000    10.036  0.000\nD_BUSINESS_COUNT.lag1   0.003  0.000    18.274  0.000\nD_RETAILS_COUNT         0.000  0.000    -1.940  0.052\nD_RETAILS_COUNT.lag1    0.000  0.000    -2.581  0.010\nD_FINSERV_COUNT         0.005  0.000    10.979  0.000\nD_FINSERV_COUNT.lag1   -0.016  0.001   -17.134  0.000\nO_BUSSTOP_COUNT         0.014  0.001    25.865  0.000\nO_BUSSTOP_COUNT.lag1    0.015  0.001    21.728  0.000\nO_AGE25_64              0.000  0.000    14.479  0.000\nO_AGE25_64.lag1         0.000  0.000    14.452  0.000\nP_log(DISTANCE + 1)    -1.281  0.008  -165.327  0.000\n\n--------------------------------------------------\nR2_corr: 0.2831458  \nObservations: 97969  \nModel coherence: Validated\n\n\n\n\nCode\nmodel_control &lt;- spflow_control(\n  estimation_method = \"mle\",\n  model = \"model_2\"\n)\n\nmle_model2 &lt;- spflow(\n  spflow_formula,\n  spflow_networks = mpsz_multi_net,\n  estimation_control = model_control\n)\n\nmle_model2\n\n\n--------------------------------------------------\nSpatial interaction model estimated by: MLE  \nSpatial correlation structure: SDM (model_2)\nDependent variable: log(1 + TRIPS)\n\n--------------------------------------------------\nCoefficients:\n                          est     sd   t.stat  p.val\nrho_d                   0.731  0.003  218.602  0.000\n(Intercept)             3.068  0.067   45.899  0.000\n(Intra)                -0.398  0.093   -4.291  0.000\nD_SCHOOL_COUNT          0.063  0.003   24.291  0.000\nD_SCHOOL_COUNT.lag1     0.054  0.005   11.802  0.000\nD_BUSINESS_COUNT        0.001  0.000    8.790  0.000\nD_BUSINESS_COUNT.lag1   0.001  0.000    3.925  0.000\nD_RETAILS_COUNT         0.000  0.000   -1.076  0.282\nD_RETAILS_COUNT.lag1    0.000  0.000    0.251  0.802\nD_FINSERV_COUNT         0.007  0.000   18.054  0.000\nD_FINSERV_COUNT.lag1   -0.009  0.001  -12.691  0.000\nO_BUSSTOP_COUNT         0.003  0.000    8.269  0.000\nO_BUSSTOP_COUNT.lag1    0.004  0.001    7.808  0.000\nO_AGE25_64              0.000  0.000    3.918  0.000\nO_AGE25_64.lag1         0.000  0.000    4.421  0.000\nP_log(DISTANCE + 1)    -0.351  0.007  -47.000  0.000\n\n--------------------------------------------------\nR2_corr: 0.5527887  \nObservations: 97969  \nModel coherence: Validated"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex5/data/geospatial/entertn.html",
    "href": "In-class_Ex/In-class_Ex5/data/geospatial/entertn.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex5/data/geospatial/MPSZ-2019.html",
    "href": "In-class_Ex/In-class_Ex5/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex5/data/geospatial/FinServ.html",
    "href": "In-class_Ex/In-class_Ex5/data/geospatial/FinServ.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex5/data/geospatial/Business.html",
    "href": "In-class_Ex/In-class_Ex5/data/geospatial/Business.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex5/data/geospatial/F&B.html",
    "href": "In-class_Ex/In-class_Ex5/data/geospatial/F&B.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex5/data/geospatial/Liesure&Recreation.html",
    "href": "In-class_Ex/In-class_Ex5/data/geospatial/Liesure&Recreation.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex5/data/geospatial/Retails.html",
    "href": "In-class_Ex/In-class_Ex5/data/geospatial/Retails.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "In-class_Ex/In-class_Ex5/In-class_Ex5.html#my-own-notes",
    "href": "In-class_Ex/In-class_Ex5/In-class_Ex5.html#my-own-notes",
    "title": "In-Class_Ex5",
    "section": "",
    "text": "each will have a weight matrix. the weight matrix is the same as lesson 2’s spatial weight. We only focus on 1 area of application, which is the spatial interaction. We can apply for geographical regression, it is the same method. We only focus on how we further modify the spatial interaction mode. we have unconstraint, origin, destination, doubly constraint. we have 4, double up with weight version. in that case we can develop a total of 9 models\nModel 1 - Unconstraint Model 2 - Origin Model 3 - Destination\nAll the R packages we use, it is very well documented, it is progressively developed. Most of the library developed are based on certain well-published article or paper. e.g. published in 2008, and wrapped over into the software tools. Facebook Team has developed a very good algorithm for time series forecasting and it has been wrapped over to python, R, C etc. But if we compare the packages with well methodical documentation / papers, R has more.\nfor spflow, it is published on cran, but to publish on cran they need to be consistent with using latest packages. However, packages are developed in parallel, and developers tend to publish the latest development in github. which we will do this time round"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/mrt_fixed.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/mrt_fixed.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;  GDM.RapidTransitSystemStation  ENG dataset\n\nGDM.RapidTransitSystemStation\n\nA symbolic polygon representation of the outline of the structure of RTS Stations\nTo locate RTS stations/ lines  Road Inventory, Road Furniture, Road Elements    mailing address\n\n251 North Bridge Road Singapore 179102\n\n  &lt;city&gt;&lt;/city&gt;\n  &lt;administrativearea&gt;&lt;/administrativearea&gt;\n  &lt;postalcode&gt;&lt;/postalcode&gt;\n  &lt;country&gt;&lt;/country&gt;\n&lt;/contactAddress&gt;\n&lt;name&gt;&lt;/name&gt;\n&lt;organization&gt;&lt;/organization&gt;\n&lt;position&gt;&lt;/position&gt;\n&lt;voice&gt;63328915&lt;/voice&gt;\n&lt;fax&gt;&lt;/fax&gt;\n&lt;email&gt;&lt;/email&gt;\n&lt;role&gt;Point of contact&lt;/role&gt;\n      Class 1 The data is for internal use only      0 0     false"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/PrivateEducationInstitutions.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/PrivateEducationInstitutions.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/URANoofDwellingUnits.html",
    "href": "Take-home_Ex/Take-home_Ex2_Test/data/geospatial/URANoofDwellingUnits.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#dataset-used",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#dataset-used",
    "title": "Take-home_Ex2",
    "section": "Dataset Used",
    "text": "Dataset Used"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#basemaps",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#basemaps",
    "title": "Take-home_Ex2",
    "section": "Basemaps",
    "text": "Basemaps\n\nSingapore Outline\nThis is the basemap of Singapore gotten from data.gov.sg. This basemap comprise of small subzones. However, we will want to merge all into 1 singapore map. Upon the first merger the subzones seem to have some small overlap. Given our usecase, actually we don’t need it to be so precise, so we can do a further simplication via st_simplify (note: this come at a cost of precision)\n\n\nCode\n#reading in the subzone\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414)\n\n\nReading layer `MPSZ-2019' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\nCode\n#Merge all the polygons into 1\nsgp &lt;- st_union(mpsz$geometry)\n\n# Simplify the geometry\nsgp_simple &lt;- st_simplify(sgp, dTolerance = 100) %&gt;% \n  st_as_sf() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n  \ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_layout(main.title = \"Singapore Basemap\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCreating Base Hexagon\nIn addition, we know that people could walk to nearby busstops. Research has shown that transport analysis zone would be good to depict this, however that require extensive geographical disection e.g. to separate water body, housing from business etc and it could change from period to period due to changes in landuse. Therefore, we proxy this with analytic hexagon of 375m perpendicular distance between centre of the hexagon to and its edges.\n\n\nCode\n#note we need to use 750m because of the R function st_make_grid\nsgp_hex &lt;- st_make_grid(sgp_simple,\n                       cellsize= 750,\n                       crs= 3414,\n                       what = \"polygons\", \n                       square = FALSE)\n\nsgp_hexid &lt;- sgp_hex %&gt;%\n  st_as_sf() %&gt;%\n  mutate(hex_id = paste0(\"HEX_\",row_number()),\n         area = st_area(.))\n\nsgp_hexid$hex_id &lt;- as.factor(sgp_hexid$hex_id)\n  \nst_geometry(sgp_hexid) &lt;- \"geometry\"\n\nrm(sgp_hex,sgp)\ngc()\n\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 3360540 179.5    5070718 270.9  5070718 270.9\nVcells 4896865  37.4   10146329  77.5  8388607  64.0\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.2,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid)+\n  tm_polygons(col = \"cyan\", \n              alpha = 0.2,\n              border.alpha = 0.1) +\n  tm_borders(alpha = 0.2)+\n  tm_layout(main.title = \"Hexagon Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\n\n\n\nCode\nwrite_rds(sgp_simple, \"data/rds/sgp_simple.rds\")\nwrite_rds(sgp_hexid, \"data/rds/sgp_hexid.rds\")"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#train-station-location",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#train-station-location",
    "title": "Take-home_Ex2",
    "section": "Train Station Location",
    "text": "Train Station Location\nThe downloaded data from LTA data mall has some issues where some polygons are not closed. There are 3 stations\n1) Habourfront MRT Station- IMPT this is an interchange between circle and NE line\n2) Upper Thomson MRT Station\n3) BOCC- this seem to be the Seletar Bus Depot which is not essential for commuters\nGiven the importance of Habourfront MRT & Upper Thomson MRT, we have fixed it using QGIS, where we can first check for validity thereafter do a manual cleaning [https://geoscience.blog/polygon-layer-cleaning-with-qgis/]\n\n\nCode\ntrainpolygon_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"mrt_fixed\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  unique() %&gt;%\n  select(STN_NAM_DE, TYP_CD_DES) %&gt;%\n  rename(stn_name = STN_NAM_DE)\n\n\nReading layer `mrt_fixed' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 220 features and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 6068.209 ymin: 27478.44 xmax: 45377.5 ymax: 47913.58\nProjected CRS: SVY21\n\n\nCode\ntrainexitpoint_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Train_Station_Exit_Layer\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  unique()\n\n\nReading layer `Train_Station_Exit_Layer' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 565 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6134.086 ymin: 27499.7 xmax: 45356.36 ymax: 47865.92\nProjected CRS: SVY21\n\n\nCode\n#map_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(trainpolygon_sf)+\n  tm_polygons()+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col= \"purple\")+\n  tm_layout(main.title = \"Train Station Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\ntrainstationmeta &lt;- read_csv(\"data/aspatial/Train Station Codes and Chinese Names.csv\") %&gt;%\n  select(stn_name, Interchange, Lines) %&gt;%\n  unique() %&gt;%\n  na.exclude()\n\ntrainexitpoint_sf &lt;- left_join(trainexitpoint_sf,trainstationmeta)\ntrainpolygon_sf &lt;- left_join(trainpolygon_sf,trainstationmeta)\n\ntrainexitpoint_sf &lt;- trainexitpoint_sf[!is.na(trainexitpoint_sf$Lines),]\ntrainpolygon_sf &lt;- trainpolygon_sf[!is.na(trainpolygon_sf$Lines),]\n\n\nWhen we look at the maps above, we can see HUGE polygons that are not train staion but depot or control centre. These are not exactly the stations that we want. additionally, we also see there are some train station that are built but not in service yet. For this purpose we can also exclude them. There is a separate dataset from Data.gov.sg called “Train Station Codes and Chinese Names” that only show the active stations, thus we can use that to filter to the relevant station. Do note the below though\n1) Woodlands South & Woodlands North has an extra space in the Train Station Code dataset that we did a simple cleaning before matching for\n2) Teck Lee LRT is missing in the Train Station Code dataset, and it is not in service yet. [LTA]\n3)Marina South MRT Station is missing in the Train Station Code dataset and is not in service yet. Note it is different from Marina South Pier MRT Station!!\nTherefore, we can remove Teck Lee and Marina South\n\n\nCode\n#map_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(trainpolygon_sf)+\n  tm_polygons()+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col= \"purple\")+\n  tm_layout(main.title = \"Train Station Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#bus-data",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#bus-data",
    "title": "Take-home_Ex2",
    "section": "Bus Data",
    "text": "Bus Data\n\nNo. of Trips (Flow Data)\n\n\nCode\nodbus202308 &lt;- read_csv(\"data/aspatial/origin_destination_bus_202308.csv\")\nglimpse(odbus202308)\n\n\nRows: 5,709,512\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2023-08\", \"2023-08\", \"2023-08\", \"2023-08\", \"2023-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKDAY\", \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 17, 7, 17, 14, 10, 10,…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;chr&gt; \"04168\", \"04168\", \"80119\", \"80119\", \"44069\", \"4406…\n$ DESTINATION_PT_CODE &lt;chr&gt; \"10051\", \"10051\", \"90079\", \"90079\", \"17229\", \"1722…\n$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …\n\n\nCode\n# Change all columns to factors\nodbus202308 &lt;- data.frame(lapply(odbus202308, factor))\nodbus202308$TOTAL_TRIPS &lt;- as.numeric(odbus202308$TOTAL_TRIPS)\nodbus202308$TIME_PER_HOUR &lt;- as.numeric(odbus202308$TIME_PER_HOUR)\n\n\nAs per Take Home Exercise 1, we categorised the variables as factor apart from the total trips & time which will remain as numeric.\nThe days are grouped together into 2 category of WEEKDAY or WEEKENDS/HOLIDAY and the timing is consolidated into 0-24, though interestingly Weekday 4am is not present, probably because there were no bus services operating on weekday at 4am. Check if trips data is unique returned TRUE. There are 0 records that are duplicated\n\n\nCode\n# Find the distinct values in each column\ndistinct_values &lt;- odbus202308 %&gt;%\n  select(-TOTAL_TRIPS, -ORIGIN_PT_CODE, -DESTINATION_PT_CODE) %&gt;%\n  distinct() %&gt;%\n  arrange(PT_TYPE, YEAR_MONTH, DAY_TYPE, TIME_PER_HOUR)\n\n#datatable(distinct_values)\nkable(distinct_values)\n\n\n\n\n\nYEAR_MONTH\nDAY_TYPE\nTIME_PER_HOUR\nPT_TYPE\n\n\n\n\n2023-08\nWEEKDAY\n1\nBUS\n\n\n2023-08\nWEEKDAY\n2\nBUS\n\n\n2023-08\nWEEKDAY\n3\nBUS\n\n\n2023-08\nWEEKDAY\n5\nBUS\n\n\n2023-08\nWEEKDAY\n6\nBUS\n\n\n2023-08\nWEEKDAY\n7\nBUS\n\n\n2023-08\nWEEKDAY\n8\nBUS\n\n\n2023-08\nWEEKDAY\n9\nBUS\n\n\n2023-08\nWEEKDAY\n10\nBUS\n\n\n2023-08\nWEEKDAY\n11\nBUS\n\n\n2023-08\nWEEKDAY\n12\nBUS\n\n\n2023-08\nWEEKDAY\n13\nBUS\n\n\n2023-08\nWEEKDAY\n14\nBUS\n\n\n2023-08\nWEEKDAY\n15\nBUS\n\n\n2023-08\nWEEKDAY\n16\nBUS\n\n\n2023-08\nWEEKDAY\n17\nBUS\n\n\n2023-08\nWEEKDAY\n18\nBUS\n\n\n2023-08\nWEEKDAY\n19\nBUS\n\n\n2023-08\nWEEKDAY\n20\nBUS\n\n\n2023-08\nWEEKDAY\n21\nBUS\n\n\n2023-08\nWEEKDAY\n22\nBUS\n\n\n2023-08\nWEEKDAY\n23\nBUS\n\n\n2023-08\nWEEKDAY\n24\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n1\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n2\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n3\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n4\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n5\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n6\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n7\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n8\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n9\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n10\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n11\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n12\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n13\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n14\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n15\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n16\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n17\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n18\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n19\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n20\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n21\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n22\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n23\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n24\nBUS\n\n\n\n\n\nCode\nrm(distinct_values)\n\n\n\n\nCode\nodbus202308_isunique &lt;- isUnique(odbus202308)\nodbus202308_extractduplicatecount &lt;- extractduplicatecount(odbus202308)\n\n\n\n\nBus Stops\nFrom the flow data, we have trips from ORIGIN_PT_CODE to DESTINATION_PT_CODE. however, that is a unique ID tagged to each busstop, but without the busstop metadata, we don’t know where are these busstops. So we need to add in an additional data to plot the geographical location of each busstop.\nWe see that busstop data is a point data with only 1 pair of XY coordinate per feature. BUS_STOP_N in the busstop data is a unique ID matching to that of ORIGIN_PT_CODE & DESTINATION_PT_CODE. Thus lets apply the same transformation to make it into a category to allow matching of the trip data to the busstop location.\nCheck if busstop data is unique returned TRUE. There are 0 records that are duplicated.\n\n\nCode\nbusstop &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\n\nReading layer `BusStop' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2_Test\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 5161 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\nCode\nkable(sample_n(busstop,25))\n\n\n\n\n\n\n\n\n\n\n\nBUS_STOP_N\nBUS_ROOF_N\nLOC_DESC\ngeometry\n\n\n\n\n18109\nB03\nOPP PSB SCIENCE PK BLDG\nPOINT (22810.49 30719.45)\n\n\n99181\nB01\nBEF S’PORE AVIATION AC\nPOINT (45266.77 41082.61)\n\n\n43641\nB04\nOPP HOMETEAMNS\nPOINT (18765.88 38593.3)\n\n\n55221\nB02\nOPP SMRT BUSES AMK DEPOT\nPOINT (29434.47 41081.42)\n\n\n47589\nB05\nBLK 519A CP\nPOINT (23397.82 46291.94)\n\n\n95071\nB06\nCHANGI BEACH CP 4\nPOINT (46015.99 41316.9)\n\n\n60251\nNIL\nBLK 15\nPOINT (31163.24 34093.13)\n\n\n59441\nB01\nNAVAL BASE PR SCH\nPOINT (28684.95 44187.72)\n\n\n77079\nB04\nELIAS MALL\nPOINT (40041.8 40038.95)\n\n\n75369\nB02\nBEF TAMPINES LK\nPOINT (38818.94 39217.41)\n\n\n74039\nB34\nAFT TAMPINES IND AVE 2\nPOINT (38300.31 38795.38)\n\n\n09022\nB01\nBEF ORCHARD STN EXIT B\nPOINT (27891.3 31656.51)\n\n\n04321\nB05\nUE SQ\nPOINT (29084.63 30510.34)\n\n\n96141\nB04\nBLK 120/OPP SIMEI STN\nPOINT (41351.19 36315.69)\n\n\n64201\nB05\nAFT HOUGANG AVE 3\nPOINT (34763.49 38198.91)\n\n\n59581\nB01\nBLK 432C\nPOINT (29417.26 44549.75)\n\n\n59691\nNIL\nBEF BLK 935\nPOINT (28302.29 45174.98)\n\n\n97081\nB01\nSELARANG PK DRUG REH.\nPOINT (44314.05 39258.05)\n\n\n95901\nB09\nBef Simei Rd\nPOINT (42121.61 35645.47)\n\n\n93101\nB02\nAFT COLDSTREAM AVE\nPOINT (37629.9 32771.35)\n\n\n57031\nB03\nNEE SOON DRICLAD CTR\nPOINT (26534.25 43216.95)\n\n\n91099\nB09\nBEF WILKINSON RD\nPOINT (33723.27 31739.27)\n\n\n59169\nB05\nBET BLKS 201/202\nPOINT (28492.77 45796.91)\n\n\n53191\nB07\nBLK 7 IND EST\nPOINT (28643.21 37833.63)\n\n\n28169\nB12\nAFT HONG KAH FLYOVER\nPOINT (15344.14 37581.97)\n\n\n\n\n\nCode\nbusstop$BUS_STOP_N &lt;- as.factor(busstop$BUS_STOP_N)\nbusstop$BUS_ROOF_N &lt;- as.factor(busstop$BUS_ROOF_N)\n\n\n\n\nCode\nbusstop_isunique &lt;- isUnique(busstop)\nbusstop_extractduplicatecount &lt;- extractduplicatecount(busstop)\n\n\n\n\nLayering Busstop with No. Trips\nWe should then first check there are busstops that are found in trips but don’t have a busstop point mapped. This is more important because, it is possible for an existing busstop to have no demand, but not possible to have trips from a missing busstop. a) BUS_STOP_N from geometry data b) ORIGIN_PT_CODE from trips data\n\n\nCode\nmissing_in_busstop_ORIGIN &lt;- data.frame(setdiff(odbus202308$ORIGIN_PT_CODE,busstop$BUS_STOP_N)) %&gt;% rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_DESTINATION &lt;- data.frame(setdiff(odbus202308$DESTINATION_PT_CODE,busstop$BUS_STOP_N)) %&gt;% \n  rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_combined &lt;- rbind(missing_in_busstop_ORIGIN,missing_in_busstop_DESTINATION) %&gt;% unique() %&gt;% \n  arrange(BUS_STOP_N)\n\norigin_daytime &lt;- odbus202308 %&gt;%\n  group_by(DAY_TYPE,TIME_PER_HOUR,ORIGIN_PT_CODE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS))\n\norigin_only &lt;- origin_daytime %&gt;%\n  group_by(ORIGIN_PT_CODE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS))\n\norigin_total &lt;- origin_only %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(ORIGIN_PT_CODE))\n\nmissing_in_busstop_trips &lt;- left_join(missing_in_busstop_combined, origin_only\n                                      , by=c(\"BUS_STOP_N\" = \"ORIGIN_PT_CODE\")) %&gt;%\n  arrange(desc(TOTAL_TRIPS))\n\nmissing_in_busstop_total &lt;- missing_in_busstop_trips %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(BUS_STOP_N))\n\nmissing_stop1 &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_STOPS)\n\nmissing_stop_ratio1 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total %&gt;% pull(TOTAL_STOPS) / origin_total %&gt;% pull(TOTAL_STOPS)*100)\n\nmissing_trip_ratio1 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total %&gt;% pull(TOTAL_TRIPS) / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\n\nUpon inspection, there are 54 busstops that are not found with a geometry data point. They made up of ~1.6% of trips and 1.1% of bus stops. In particular, the top 2 observations 59009 and 47009 are Yishun & Woodlands Temp Interchange respectively and should be included. Thus i have made some manual input to find the location of some of these bussstops.\nNote: although woodlands regional bus interchange has started operation, there are a few bus services that continue to run from the temp bus interchange [LINK].\n\n\nCode\n#manualbusstop &lt;- tibble(BUS_STOP_N = c('59009','47009'), lat = c(1.4278664,1.4375880), lon = #c(103.8361437,103.7865749), LOC_DESC = c('YISHUN BUS INT','WOODLANDS TEMP BUS INT'), BUS_ROOF_N=c('','')) \n\nmanualbusstop &lt;- read.csv(\"data/aspatial/AdditionalBusStop.csv\") %&gt;%\n  mutate(BUS_STOP_N = sprintf(\"%05d\",BUS_STOP_N))\n\nmanualbusstop_geo2 &lt;- st_as_sf(manualbusstop, coords = c(\"LONG\",\"LAT\"), crs = 4326) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(manualbusstop_geo2)+\n  tm_dots(col=\"red\",\n          size = 0.2)+  \n  tm_layout(main.title = \"Manual Busstop Added\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\nbusstop2 &lt;- rbind(busstop,manualbusstop_geo2) \n\nmissing_in_busstop_ORIGIN2 &lt;- data.frame(setdiff(odbus202308$ORIGIN_PT_CODE,busstop2$BUS_STOP_N)) %&gt;% rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_DESTINATION2 &lt;- data.frame(setdiff(odbus202308$DESTINATION_PT_CODE,busstop2$BUS_STOP_N)) %&gt;% \n  rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_combined2 &lt;- rbind(missing_in_busstop_ORIGIN2,missing_in_busstop_DESTINATION2) %&gt;% unique() %&gt;% \n  arrange(BUS_STOP_N)\n\nmissing_in_busstop_trips2 &lt;- left_join(missing_in_busstop_combined2, origin_only\n                                      , by=c(\"BUS_STOP_N\" = \"ORIGIN_PT_CODE\")) %&gt;%\n  arrange(desc(TOTAL_TRIPS))\n\nmissing_in_busstop_total2 &lt;- missing_in_busstop_trips2 %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(BUS_STOP_N))\n\nmissing_stop2 &lt;- missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS)\n\nmissing_stop_diff &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_STOPS) - missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS)\n\nmissing_trip_diff &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_TRIPS) - missing_in_busstop_total2 %&gt;% pull(TOTAL_TRIPS)\n\n\nmissing_stop_ratio2 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS) / origin_total %&gt;% pull(TOTAL_STOPS)*100)\n\nmissing_trip_ratio2 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total2 %&gt;% pull(TOTAL_TRIPS) / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\nmissing_trip_ratio_diff &lt;- sprintf(\"%.1f%%\", missing_trip_diff / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\nrm(busstop,mpsz,manualbusstop,manualbusstop_geo2, missing_in_busstop_combined, missing_in_busstop_combined2, missing_in_busstop_DESTINATION, missing_in_busstop_DESTINATION2, missing_in_busstop_ORIGIN, missing_in_busstop_ORIGIN2, missing_in_busstop_total, missing_in_busstop_total2, missing_in_busstop_trips, missing_in_busstop_trips2)\ngc()\n\n\n           used  (Mb) gc trigger  (Mb)  max used  (Mb)\nNcells  3521050 188.1    6654857 355.5   6654857 355.5\nVcells 31541509 240.7  100541458 767.1 100493010 766.8\n\n\nAfter the update, there are 30 busstops that are not found with a geometry data point. They made up of ~0.1% of trips and 0.6% of bus stops. By just adding 24 stops, we are now accounting for ~1.5% more trips.\nNow lets simplify and only look at busstops in Singapore and plot where are the busstops as well as the bus interchange.\n\n\nCode\n# Find points that are in Singapore\nsgbusstop &lt;- st_intersection(busstop2, sgp_simple)\n\nsgbusinterchange &lt;- read_csv(\"data/aspatial/sgbusinterchange.csv\") %&gt;%\n  select(BUS_STOP_N)\n\nsgbusstop$Interchange &lt;- ifelse(sgbusstop$BUS_STOP_N %in% sgbusinterchange$BUS_STOP_N,\"Interchange\",\"Busstop\")\n\n# Find points that are not within Singapore\njohorbusstop &lt;- busstop2[!busstop2$BUS_STOP_N %in%\n                          sgbusstop$BUS_STOP_N,]\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(sgbusstop)+\n  tm_dots()+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.3)+\n  tm_layout(main.title = \"Bus Stop & Bus Interchange Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\nrm(sgbusinterchange, busstop2)\n\n\n\n\n\n\n\n\nTip\n\n\n\nSave\n\n\nCode\nwrite.csv(sgbusstop, file = 'data/aspatial/sgbusstop.csv')\nwrite_rds(sgbusstop, \"data/rds/sgbusstop.rds\")\n\n\n\n\n\n\nHexgon that are covering the busstops\n\n\nCode\nbusstop_withhex &lt;- st_intersection(sgbusstop,sgp_hexid) %&gt;%\n  select(-area)\n\nsgp_hexid_bs_df &lt;- st_intersection(sgp_hexid,sgbusstop) %&gt;%\n  data.frame() %&gt;%\n  select(hex_id,BUS_STOP_N, LOC_DESC, Interchange)\n\nsgp_hexid_wbs_df &lt;- sgp_hexid_bs_df %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(TOTAL_STOPS = n_distinct(BUS_STOP_N),\n            #TOTAL_INTERCHANGE = n_distinct(Interchange),\n            ALL_STOPS_ID = list(as.factor(BUS_STOP_N)),\n            ALL_STOPS_DESC = list(LOC_DESC))\n\nsgp_hexid_wbs_geo &lt;- left_join(sgp_hexid,sgp_hexid_wbs_df) %&gt;%\n  filter(TOTAL_STOPS &gt; 0) %&gt;%\n  select(-area)\n\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(col=\"TOTAL_STOPS\", \n              alpha = 1,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             #\"Number of Interchange:\" = \"TOTAL_INTERCHANGE\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")) +\n  tm_borders(alpha = 0.2)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.1)+\n  tm_layout(main.title = \"Busstops Distribution + Bus Interchange\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nSave\n\n\nCode\nwrite_rds(sgp_hexid_wbs_geo, \"data/rds/sgp_hexid_wbs_geo.rds\")\n\n\n\n\n\n\nOrigin Destination Trips\nWe will like to analyse the high weekday morning peaks and where are people travelling to and from. Therefore we will filter the trips data to only that of weekday 6am to 9am. We can see that there are very popular origin & destination that have &gt;10,000 trips within the weekday morning peak. However, just by looking at the code, we don’t know what are these locations. Thus we need to join in the data\n\n\nCode\nodbus202308_wdmp &lt;- odbus202308 %&gt;%\n  filter(DAY_TYPE == \"WEEKDAY\") %&gt;%\n  filter( TIME_PER_HOUR &gt;= 6 &\n            TIME_PER_HOUR &lt;= 9\n          ) %&gt;%\n  group_by(ORIGIN_PT_CODE, DESTINATION_PT_CODE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS)) %&gt;%\n  unique()\n\nkable(head(odbus202308_wdmp %&gt;%\n       arrange(-TOTAL_TRIPS)))\n\n\n\n\n\nORIGIN_PT_CODE\nDESTINATION_PT_CODE\nTOTAL_TRIPS\n\n\n\n\n46219\n46109\n14122\n\n\n46109\n45139\n14045\n\n\n46069\n46009\n13971\n\n\n46109\n46521\n12297\n\n\n44629\n44009\n12055\n\n\n21591\n28091\n11704\n\n\n\n\n\nAfter joining the busstop name, we can see that the most popular trips are made from Checkpoint to MRT as well as from various locations to the train station / bus interchange\n\n\nCode\nodbus202308_wdmp_hex &lt;- odbus202308_wdmp %&gt;%\n  inner_join(busstop_withhex %&gt;%\n               data.frame() %&gt;%\n               select(BUS_STOP_N, LOC_DESC, hex_id),\n             by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\")) %&gt;%\n  rename(ORIG_HEX_ID = hex_id,\n         ORIG_BUSSTOPS = LOC_DESC) %&gt;%\n  inner_join(busstop_withhex %&gt;%\n               data.frame() %&gt;%\n               select(BUS_STOP_N, LOC_DESC, hex_id),\n             by = c(\"DESTINATION_PT_CODE\" = \"BUS_STOP_N\")) %&gt;%\n  rename(DEST_HEX_ID = hex_id,\n         DEST_BUSSTOPS = LOC_DESC) %&gt;%\n  select(ORIGIN_PT_CODE, DESTINATION_PT_CODE,TOTAL_TRIPS,ORIG_BUSSTOPS,ORIG_HEX_ID,DEST_BUSSTOPS,DEST_HEX_ID) %&gt;%\n  unique()\n\nodbus202308_wdmp_hex %&gt;%\n  select(ORIG_BUSSTOPS, DEST_BUSSTOPS, TOTAL_TRIPS,ORIGIN_PT_CODE,DESTINATION_PT_CODE) %&gt;%\n  arrange(-TOTAL_TRIPS) %&gt;%\n  filter(TOTAL_TRIPS &gt; 10000) %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\n\n\nORIG_BUSSTOPS\nDEST_BUSSTOPS\nTOTAL_TRIPS\nORIGIN_PT_CODE\nDESTINATION_PT_CODE\n\n\n\n\nW’LANDS CHECKPT\nKRANJI STN\n14045\n46109\n45139\n\n\nWOODLANDS TRAIN CHECKPT\nWOODLANDS REG INT\n13971\n46069\n46009\n\n\nW’LANDS CHECKPT\nMARSILING STN\n12297\n46109\n46521\n\n\nBLK 457\nCHOA CHU KANG INT\n12055\n44629\n44009\n\n\nOPP BLK 117\nLAKESIDE STN\n11704\n21591\n28091\n\n\nBLK 678D\nBOON LAY INT\n11683\n22599\n22009\n\n\nOPP BLK 245\nYISHUN STN EXIT E\n11515\n59181\n59072\n\n\nOPP BLK 666\nOPP YEW TEE STN\n11399\n45421\n45329\n\n\nBLK 953\nPIONEER STN EXIT B\n11333\n27279\n22529\n\n\nBLK 786A CP\nADMIRALTY STN\n11319\n46799\n46779\n\n\nBLK 442\nCHOA CHU KANG INT\n11250\n44509\n44009\n\n\nBLK 12\nWOODLANDS REG INT\n11170\n46189\n46009\n\n\nBLK 456\nKHATIB STN EXIT D\n11162\n59579\n59569\n\n\nBlk 483\nSUN PLAZA/SEMBAWANG STN\n11030\n58351\n58251\n\n\nGEK POH SHOP CTR\nBOON LAY INT\n11020\n27389\n22009\n\n\nW’LANDS CHECKPT\nWoodlands Temp Int\n11014\n46109\n47009\n\n\nBLK 212\nWOODLANDS REG INT\n11001\n46151\n46009\n\n\nBLK 463\nLAKESIDE STN\n10891\n28511\n28091\n\n\nBLK 22\nKOVAN STN EXIT C\n10843\n63059\n63039\n\n\nBLK 755\nBOON LAY INT\n10837\n27379\n22009\n\n\nBLK 27\nTOA PAYOH BUS INT\n10751\n52331\n52009\n\n\nOPP BLK 661\nOPP YEW TEE STN\n10746\n45439\n45329\n\n\nOPP BLK 670\nOPP YEW TEE STN\n10622\n45411\n45329\n\n\nOPP BISHAN NTH SHOP MALL\nBishan Stn\n10606\n53389\n53231\n\n\nBLK 27\nBEDOK STN EXIT A\n10404\n84049\n84039\n\n\nBLK 458\nLAKESIDE STN\n10275\n28399\n28091\n\n\nBLK 32\nWOODLANDS REG INT\n10269\n46141\n46009\n\n\nOPP BLK 739A CP\nADMIRALTY STN\n10266\n46841\n46779\n\n\nBLK 880\nWOODLANDS REG INT\n10250\n46439\n46008\n\n\nOPP WOODSVALE CONDO\nADMIRALTY STN\n10217\n47619\n46779\n\n\nBLK 309\nYISHUN STN EXIT E\n10197\n59171\n59072\n\n\nBET BLKS 701/702\nTAMPINES INT\n10089\n75131\n75009\n\n\nBLK 391\nYISHUN STN EXIT E\n10056\n59601\n59072\n\n\nBLK 263\nBOON LAY INT\n10034\n21379\n22009\n\n\nBLK 504C\nKHATIB STN EXIT D\n10006\n59761\n59569\n\n\n\n\n\n\n\nCode\nrm(odbus202308,odbus202308_wdmp,origin_daytime,origin_only,origin_total)\ngc()\n\n\n          used  (Mb) gc trigger  (Mb)  max used  (Mb)\nNcells 3560813 190.2    6654857 355.5   6654857 355.5\nVcells 6551955  50.0   80433167 613.7 100493010 766.8\n\n\nLets now summarise the data into the analytical hexagons and generate the flow data\n\n\nCode\nhex_trip_df &lt;- odbus202308_wdmp_hex %&gt;%\n  group_by(ORIG_HEX_ID,DEST_HEX_ID) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS)) %&gt;%\n  inner_join(sgp_hexid_wbs_df %&gt;%\n               select(hex_id, TOTAL_STOPS, ALL_STOPS_DESC),\n             by = c(\"ORIG_HEX_ID\" = \"hex_id\")) %&gt;%\n  rename(ORIG_TOTAL_STOPS = TOTAL_STOPS,\n         ORIG_ALL_STOPS_DESC = ALL_STOPS_DESC) %&gt;%\n  inner_join(sgp_hexid_wbs_df %&gt;%\n               select(hex_id, TOTAL_STOPS, ALL_STOPS_DESC),\n             by = c(\"DEST_HEX_ID\" = \"hex_id\")) %&gt;%\n  rename(DEST_TOTAL_STOPS = TOTAL_STOPS,\n         DEST_ALL_STOPS_DESC = ALL_STOPS_DESC) %&gt;%\n  unique() %&gt;%\n  mutate(OD = paste(ORIG_HEX_ID,DEST_HEX_ID,sep = \" to \")) %&gt;%\n  arrange(-TOTAL_TRIPS)\n  #select(OD,TOTAL_TRIPS,everything())\n\nkable(head(hex_trip_df))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nORIG_HEX_ID\nDEST_HEX_ID\nTOTAL_TRIPS\nORIG_TOTAL_STOPS\nORIG_ALL_STOPS_DESC\nDEST_TOTAL_STOPS\nDEST_ALL_STOPS_DESC\nOD\n\n\n\n\nHEX_1995\nHEX_1887\n58093\n10\nOPP BLK 367 , EVANGEL FAMILY CH, BET BLKS 405/406 , BLK 342B , BLK 391 , OPP BLK 406 , OPP BLK 392 , BLK 358 , OPP BLK 382C , BLK 382C\n14\nBLK 763 , YISHUN STN , OPP BLK 757 , BLK 145 , OPP YISHUN STN , OPP YISHUN STN EXIT B, BLK 741 , BET BLKS 201/202 , BLK 154 , OPP BLK 201 , YISHUN STN EXIT E , BEF YISHUN STN , Yishun Int , Yishun Int\nHEX_1995 to HEX_1887\n\n\nHEX_1940\nHEX_1886\n54445\n12\nNAVAL BASE PR SCH , BLK 671 CP , BLK 858 , OPP NAVAL BASE PR SCH , BLK 666 , OPP ORCHID COUNTRY CLUB, ORCHID COUNTRY CLUB , BLK 512A , OPP BLK 512A , BLK 504C , OPP BLK 672C , BLK 672C\n10\nOPP KHATIB STN EXIT D, BLK 790 , Opp Khatib Stn , BLK 608 , BLK 630 , BLK 624 , BLK 846 , BLK 873 , BEF KHATIB STN , KHATIB STN EXIT D\nHEX_1940 to HEX_1886\n\n\nHEX_800\nHEX_826\n50920\n11\nBLK 755 , OPP BLK 755 , BLK 673C , JURONG WEST SUB-STN, BLK 749 , GEK POH SHOP CTR , WEST GROVE PR SCH , BLK 729 , BLK 678D , BLK 745 , BLK 734A CP\n10\nBLK 668D , BLK 664C , BLK 685B , Blk 662A , BLK 691A CP , BLK 662A , BLK 669 CP , BOON LAY INT, BLK 683A , BLK 665A , BLK 670A\nHEX_800 to HEX_826\n\n\nHEX_1914\nHEX_1887\n47115\n7\nBLK 241, BLK 257, BLK 309, BLK 236, BLK 227, BLK 220, BLK 291\n14\nBLK 763 , YISHUN STN , OPP BLK 757 , BLK 145 , OPP YISHUN STN , OPP YISHUN STN EXIT B, BLK 741 , BET BLKS 201/202 , BLK 154 , OPP BLK 201 , YISHUN STN EXIT E , BEF YISHUN STN , Yishun Int , Yishun Int\nHEX_1914 to HEX_1887\n\n\nHEX_718\nHEX_772\n43611\n13\nJUYING PR SCH , BLK 920 , BLK 932 , BLK 962 , OPP BLK 974 , BLK 934 , BLK 974 , BLK 918 , BEF XINGNAN PRI SCH , NTUC HEALTH NURSING HOME, BEF YUNNAN CRES , BLK 953 , BLK 924\n20\nBLK 978 , BEF BLK 717 , BLK 704 , OPP BLK 643 , BLK 643 , BLK 834 , BLK 639 , PIONEER STN EXIT B , BLK 710 , BLK 641 , Blk 711 , BLK 705 , BLK 701 , BLK 715 , BLK 622 , OPP JURONG WEST PR SCH, BLK 624 , OPP BLK 622 , JURONG WEST PR SCH , OPP BLK 717\nHEX_718 to HEX_772\n\n\nHEX_2691\nHEX_2771\n39529\n15\nBLK 604A , OPP BLK 601C , BLK 734 , BET BLKS 701/702 , BLK 863 , POI CHING SCH , BET BLKS 710/713 , BLK 730 , BET BLKS 524B/523D, OPP BLK 721 , OPP BLKS 741/742 , BLK 742A , OPP BLKS 710/713 , BLK 721 , BLK 867A\n9\nBLK 237 , TAMPINES INT , TAMPINES INT , OPP TAMPINES STN/INT, OPP BLK 248 , OPP CENTURY SQ , OPP BLK 237 , TAMPINES STN/INT , BLK 248\nHEX_2691 to HEX_2771\n\n\n\n\n\n\n\nCode\nflowlines &lt;- od2line(flow = hex_trip_df,\n                     zones = sgp_hexid_wbs_geo,\n                     zone_code = \"hex_id\") %&gt;%\n  st_make_valid() %&gt;%\n  select(OD,TOTAL_TRIPS,everything()) %&gt;%\n  arrange(-TOTAL_TRIPS)\n\n\n\n\n\n\n\n\nTip\n\n\n\nSave\n\n\nCode\nwrite_rds(flowlines, \"data/rds/flowlines.rds\")\n\n\n\n\n\n\nVisualising the Data\n\nTransport Nodes\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.2,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(col=\"TOTAL_STOPS\", \n              alpha = 0.2,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")\n              ) +\n  tm_shape(trainpolygon_sf)+\n  tm_polygons(alpha = 0.2)+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col = \"purple\",\n          size= 0.06)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.03)+\n  tm_layout(main.title = \"Transport Node Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\ntmap_mode(\"plot\")"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#transport-flow",
    "href": "Take-home_Ex/Take-home_Ex2_Test/Take-home_Ex2_Test.html#transport-flow",
    "title": "Take-home_Ex2",
    "section": "Transport Flow",
    "text": "Transport Flow\nWe can see a congregation of flow largely towards the MRT station. When we aggregate over a hexagonal area instead of just individual busstop. The largest trip is no longer from Checkpoint to the various nearby MRT station, although still significant\nYishun MRT seem to be a popular location that people are going to in the morning. This is likely due to\n\n\nCode\ntopflow &lt;- flowlines %&gt;%\n  filter(TOTAL_TRIPS &gt; 10000)\n  \n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.1,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(\n              #col=\"TOTAL_STOPS\", \n              alpha = 0.04,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")\n              ) +\n  tm_shape(topflow)+\n  tm_lines(lwd = \"TOTAL_TRIPS\",\n           alpha = 0.4,\n           col = \"green\",\n           scale = c(0.1, 0.5, 1, 3, 5, 7, 9, 13, 17, 19),\n           )+\n  tm_shape(trainpolygon_sf)+\n  tm_polygons(alpha = 0.2)+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col = \"purple\",\n          size= 0.06,\n          alpha = 0.2)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.08,\n          alpha = 0.2)+\n  tm_layout(main.title = \"Bus Trips for Weekdays 6-9AM (2023 Aug)\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\n\n\nCode\ntmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.1,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(\n              #col=\"TOTAL_STOPS\", \n              alpha = 0.04,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")\n              ) +\n  tm_shape(topflow)+\n  tm_lines(lwd = \"TOTAL_TRIPS\",\n           alpha = 0.4,\n           col = \"green\",\n           scale = c(0.1, 0.5, 1, 3, 5, 7, 9, 13, 17, 19),\n           )+\n  tm_shape(trainpolygon_sf)+\n  tm_polygons(alpha = 0.2)+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col = \"purple\",\n          size= 0.06,\n          alpha = 0.2)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.08,\n          alpha = 0.2)+\n  tm_layout(main.title = \"Bus Trips for Weekdays 6-9AM (2023 Aug)\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#objective",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#objective",
    "title": "Take-home_Ex2",
    "section": "",
    "text": "To visualise and try to understand the flow of commuters in the Weekday Morning Peak"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#setting-up-the-environment",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#setting-up-the-environment",
    "title": "Take-home_Ex2",
    "section": "Setting Up the Environment",
    "text": "Setting Up the Environment\n\nPackages\nTo aid us in the analysis, we are using R and the associated packages. We set the stage by loading them into the environment as below\n\ntmap: used for creating thematic maps, such as choropleth and bubble maps\nsf: used for importing, managing, and processing geospatial data\ntidyverse: a collection of packages for data science tasks\nsfdep: used to create spatial weights matrix objects\nhttr: used to make API calls, especially to OneMap API to geocode the address\nggpubr: used to make plots\nperformance: used to compare model performance\nreshape2: used to convert wide to long\nsp: to calculate OD matrix. faster than sf\nstplnar: used to generate line from polygon\n\n\n\nCode\npacman::p_load(tmap, sf, tidyverse, sfdep, knitr, plotly, DT, lubridate, magick, httr, stplanr, sp, reshape2, performance, ggpubr)\n\n\n\n\nReusable Functions\nIn addition, we check for duplicates fairly often, thus we can make it into a function for reuseability\n\n\nCode\n#these procedures will be reused, so easier to keep them as a function\n\n#check if all unique\nisUnique &lt;- function(v){\n  return(!any(duplicated(v)))\n}\n\n\n#extract the number of rows that are not unique\nextractduplicatecount &lt;- function(v){\n  return(v %&gt;%\n    group_by_all() %&gt;%\n    filter(n()&gt;1) %&gt;%\n    ungroup() %&gt;%\n    nrow())\n}\n\n#replace specific value in a column of a dataframe\nreplace_in_dataframe &lt;- function(dataframe, columnname, valuetofind, valuetoreplace){\n  dataframe[[columnname]][dataframe[[columnname]] == valuetofind] &lt;- valuetoreplace\n  dataframe\n}\n\ncalcr2 &lt;- function(v1,v2){\n  cor(v1,v2)^2\n}"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#dataset-used",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#dataset-used",
    "title": "Take-home_Ex2",
    "section": "Dataset Used",
    "text": "Dataset Used\nBasemap\n\n\n\nData\nSource\nRemarks\n\n\n\n\nmpsz\nMaster Plan 2019 Subzone Boundary (No Sea) from data.gov.sg\nSample\nConverted from KML to Shapefile\n\n\nsgp_simple\nDerived\nMerged elements in mpsz\n\n\nsgp_hexid\nGenerated\nUsing st_make_grid. 375m from center of hexagon to edge perpendicularly\n\n\n\nTransport\n\n\n\nData\nSource\nRemarks\n\n\n\n\nodbus202308\nPassenger Volume By Origin Destination Bus Stops from LTA DataMall via Postman\nSample\ntransport flow data for buses\n\n\nbusstop\nBus Stop Location from LTA DataMall\nincludes 5 johor busstops. missing 54 busstops in above trips dataset ~1.6% of trips\n\n\nmanualbusstop\nSourced via GoogleMaps & LTA\nAdded 24 stops to account ~ 1.6% of trips accounted for\n\n\nsgbusinterchange\nDerived\nFiltering busstops to INT\n\n\ntrainpolygon_sf\nTrain Station from LTA DataMall + Edited\nClosed the polygons via QGIS. includes depot\n\n\ntrainexitpoint_sf\nTrain Station Exit Point from LTA DataMall\nincludes station not in service\n\n\ntrainstationmeta\nTrain Station Codes and Chinese Names from LTA DataMall + Edited\nfind if station is interchange (same station name appear more than once) and how many lines go through the station\n\n\n\nEducation\n\n\n\nData\nSource\nRemarks\n\n\n\n\nnewschoolread\nGeneral information of schools from data.gov.sg + geocoded via OneMap API\n\n\n\nschcategory\nSourced via MOE website SchoolFinder\nto distinguish between PRI, SEC, JC due to different travel pattern\n\n\nschools_sf\nDerived from newschoolread & schcategory\n\n\n\nprivateinstitution_sf\nPrivate Education Institutions from data.gov.sg\nremoved SIM, as it has been named as SUSS\n\n\ntetiary_sf\nSourced via MOE website SchoolFinder + GoogleMaps\nadded in SUSS\n\n\npreschool_sf\nPre-Schools Location from data.gov.sg\n\n\n\n\nWork\n\n\n\nData\nSource\nRemarks\n\n\n\n\nfinserv_sf\nfrom Prof Kam\n\n\n\nbusiness_sf\nfrom Prof Kam\n\n\n\n\nF&B, Entertainment, Tourism etc\n\n\n\nData\nSource\nRemarks\n\n\n\n\nhawker_sf\nList of Government Markets Hawker Centres from data.gov.sg + geocoded via OneMap API\ncould have used Hawker Centres from data.gov.sg. Although the list has #stalls\n\n\nentertainment_sf\nfrom Prof Kam\n\n\n\nfnb_sf\nfrom Prof Kam\n\n\n\ntourism_sf\nTourist Attractions from data.gov.sg\n\n\n\nsilverszone_sf\nLTA Silver Zone from data.gov.sg\n\n\n\nleisure_sf\nfrom Prof Kam\n\n\n\nretail_sf\nfrom Prof Kam\n\n\n\neldercare_sf\nEldercare Services from data.gov.sg\n\n\n\n\nResidential\n\n\n\nData\nSource\nRemarks\n\n\n\n\nhotel_sf\nHotels from data.gov.sg\n\n\n\nuradwelling_sf\nURA No of Dwelling Units from data.gov.sg\npopulation derived using population census of av occupancy for each housing type\n\n\nhdb_sf\nHDB Property Information from data.gov.sg + Geocode via OneMap API + from prof kam\npopulation derived using population census of av occupancy for each housing type"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#basemaps",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#basemaps",
    "title": "Take-home_Ex2",
    "section": "Basemaps",
    "text": "Basemaps\n\nSingapore Outline\nThis is the basemap of Singapore gotten from data.gov.sg. This basemap comprise of small subzones. However, we will want to merge all into 1 singapore map. Upon the first merger the subzones seem to have some small overlap. Given our usecase, actually we don’t need it to be so precise, so we can do a further simplication via st_simplify (note: this come at a cost of precision)\n\n\nCode\n#reading in the subzone\nmpsz &lt;- st_read(dsn = \"data/geospatial\", layer = \"MPSZ-2019\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414)\n\n\nReading layer `MPSZ-2019' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 332 features and 6 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 103.6057 ymin: 1.158699 xmax: 104.0885 ymax: 1.470775\nGeodetic CRS:  WGS 84\n\n\nCode\n#Merge all the polygons into 1\nsgp &lt;- st_union(mpsz$geometry)\n\n# Simplify the geometry\nsgp_simple &lt;- st_simplify(sgp, dTolerance = 100) %&gt;% \n  st_as_sf() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n  \ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_layout(main.title = \"Singapore Basemap\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCreating Base Hexagon\nIn addition, we know that people could walk to nearby busstops. Research has shown that transport analysis zone would be good to depict this, however that require extensive geographical disection e.g. to separate water body, housing from business etc and it could change from period to period due to changes in landuse. Therefore, we proxy this with analytic hexagon of 375m perpendicular distance between centre of the hexagon to and its edges.\n\n\nCode\n#note we need to use 750m because of the R function st_make_grid\nsgp_hex &lt;- st_make_grid(sgp_simple,\n                       cellsize= 750,\n                       crs= 3414,\n                       what = \"polygons\", \n                       square = FALSE)\n\nsgp_hexid &lt;- sgp_hex %&gt;%\n  st_as_sf() %&gt;%\n  mutate(hex_id = paste0(\"HEX_\",row_number()),\n         area = st_area(.))\n\nsgp_hexid$hex_id &lt;- as.factor(sgp_hexid$hex_id)\n  \nst_geometry(sgp_hexid) &lt;- \"geometry\"\n\nrm(sgp_hex,sgp)\ngc()\n\n\n          used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells 3439483 183.7    6529148 348.7  4972287 265.6\nVcells 5028514  38.4   10146329  77.5  8388608  64.0\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.2,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid)+\n  tm_polygons(col = \"cyan\", \n              alpha = 0.2,\n              border.alpha = 0.1) +\n  tm_borders(alpha = 0.2)+\n  tm_layout(main.title = \"Hexagon Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\n\n\n\nCode\nwrite_rds(sgp_simple, \"data/rds/sgp_simple.rds\")\nwrite_rds(sgp_hexid, \"data/rds/sgp_hexid.rds\")"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#train-station-location",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#train-station-location",
    "title": "Take-home_Ex2",
    "section": "Train Station Location",
    "text": "Train Station Location\nThe downloaded data from LTA data mall has some issues where some polygons are not closed. There are 3 stations\n1) Habourfront MRT Station- IMPT this is an interchange between circle and NE line\n2) Upper Thomson MRT Station\n3) BOCC- this seem to be the Seletar Bus Depot which is not essential for commuters\nGiven the importance of Habourfront MRT & Upper Thomson MRT, we have fixed it using QGIS, where we can first check for validity thereafter do a manual cleaning [https://geoscience.blog/polygon-layer-cleaning-with-qgis/]\n\n\nCode\ntrainpolygon_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"mrt_fixed\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  unique() %&gt;%\n  select(STN_NAM_DE, TYP_CD_DES) %&gt;%\n  rename(stn_name = STN_NAM_DE) %&gt;%\n  group_by(stn_name, TYP_CD_DES) %&gt;%\n  summarise(geometry = st_union(geometry)) %&gt;%\n  ungroup()\n\n\nReading layer `mrt_fixed' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 220 features and 4 fields\nGeometry type: POLYGON\nDimension:     XY\nBounding box:  xmin: 6068.209 ymin: 27478.44 xmax: 45377.5 ymax: 47913.58\nProjected CRS: SVY21\n\n\nCode\ntrainexitpoint_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Train_Station_Exit_Layer\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  unique()\n\n\nReading layer `Train_Station_Exit_Layer' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 565 features and 2 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6134.086 ymin: 27499.7 xmax: 45356.36 ymax: 47865.92\nProjected CRS: SVY21\n\n\nCode\n#map_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(trainpolygon_sf)+\n  tm_polygons()+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col= \"purple\")+\n  tm_layout(main.title = \"Train Station Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\ntrainstationmeta &lt;- read_csv(\"data/aspatial/Train Station Codes and Chinese Names.csv\") %&gt;%\n  select(stn_name, Interchange, Lines,LRT) %&gt;%\n  unique() %&gt;%\n  na.exclude()\n\ntrainexitpoint_sf &lt;- left_join(trainexitpoint_sf,trainstationmeta)\ntrainpolygon_sf &lt;- left_join(trainpolygon_sf,trainstationmeta)\n\ntrainexitpoint_sf &lt;- trainexitpoint_sf[!is.na(trainexitpoint_sf$Lines),]\ntrainpolygon_sf &lt;- trainpolygon_sf[!is.na(trainpolygon_sf$Lines),]\n\n\nWhen we look at the maps above, we can see HUGE polygons that are not train staion but depot or control centre. These are not exactly the stations that we want. additionally, we also see there are some train station that are built but not in service yet. For this purpose we can also exclude them. There is a separate dataset from Data.gov.sg called “Train Station Codes and Chinese Names” that only show the active stations, thus we can use that to filter to the relevant station. Do note the below though\n1) Woodlands South & Woodlands North has an extra space in the Train Station Code dataset that we did a simple cleaning before matching for\n2) Teck Lee LRT is missing in the Train Station Code dataset, and it is not in service yet. [LTA]\n3)Marina South MRT Station is missing in the Train Station Code dataset and is not in service yet. Note it is different from Marina South Pier MRT Station!!\nTherefore, we can remove Teck Lee and Marina South\n\n\nCode\n#map_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(trainpolygon_sf)+\n  tm_polygons()+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col= \"purple\")+\n  tm_layout(main.title = \"Train Station Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#bus-data",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#bus-data",
    "title": "Take-home_Ex2",
    "section": "Bus Data",
    "text": "Bus Data\n\nNo. of Trips (Flow Data)\n\n\nCode\nodbus202308 &lt;- read_csv(\"data/aspatial/origin_destination_bus_202308.csv\")\nglimpse(odbus202308)\n\n\nRows: 5,709,512\nColumns: 7\n$ YEAR_MONTH          &lt;chr&gt; \"2023-08\", \"2023-08\", \"2023-08\", \"2023-08\", \"2023-…\n$ DAY_TYPE            &lt;chr&gt; \"WEEKDAY\", \"WEEKENDS/HOLIDAY\", \"WEEKENDS/HOLIDAY\",…\n$ TIME_PER_HOUR       &lt;dbl&gt; 16, 16, 14, 14, 17, 17, 17, 17, 7, 17, 14, 10, 10,…\n$ PT_TYPE             &lt;chr&gt; \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"BUS\", \"…\n$ ORIGIN_PT_CODE      &lt;chr&gt; \"04168\", \"04168\", \"80119\", \"80119\", \"44069\", \"4406…\n$ DESTINATION_PT_CODE &lt;chr&gt; \"10051\", \"10051\", \"90079\", \"90079\", \"17229\", \"1722…\n$ TOTAL_TRIPS         &lt;dbl&gt; 7, 2, 3, 10, 5, 4, 3, 22, 3, 3, 7, 1, 3, 1, 3, 1, …\n\n\nCode\n# Change all columns to factors\nodbus202308 &lt;- data.frame(lapply(odbus202308, factor))\nodbus202308$TOTAL_TRIPS &lt;- as.numeric(odbus202308$TOTAL_TRIPS)\nodbus202308$TIME_PER_HOUR &lt;- as.numeric(odbus202308$TIME_PER_HOUR)\n\n\nAs per Take Home Exercise 1, we categorised the variables as factor apart from the total trips & time which will remain as numeric.\nThe days are grouped together into 2 category of WEEKDAY or WEEKENDS/HOLIDAY and the timing is consolidated into 0-24, though interestingly Weekday 4am is not present, probably because there were no bus services operating on weekday at 4am. Check if trips data is unique returned TRUE. There are 0 records that are duplicated\n\n\nCode\n# Find the distinct values in each column\ndistinct_values &lt;- odbus202308 %&gt;%\n  select(-TOTAL_TRIPS, -ORIGIN_PT_CODE, -DESTINATION_PT_CODE) %&gt;%\n  distinct() %&gt;%\n  arrange(PT_TYPE, YEAR_MONTH, DAY_TYPE, TIME_PER_HOUR)\n\n#datatable(distinct_values)\nkable(distinct_values)\n\n\n\n\n\nYEAR_MONTH\nDAY_TYPE\nTIME_PER_HOUR\nPT_TYPE\n\n\n\n\n2023-08\nWEEKDAY\n1\nBUS\n\n\n2023-08\nWEEKDAY\n2\nBUS\n\n\n2023-08\nWEEKDAY\n3\nBUS\n\n\n2023-08\nWEEKDAY\n5\nBUS\n\n\n2023-08\nWEEKDAY\n6\nBUS\n\n\n2023-08\nWEEKDAY\n7\nBUS\n\n\n2023-08\nWEEKDAY\n8\nBUS\n\n\n2023-08\nWEEKDAY\n9\nBUS\n\n\n2023-08\nWEEKDAY\n10\nBUS\n\n\n2023-08\nWEEKDAY\n11\nBUS\n\n\n2023-08\nWEEKDAY\n12\nBUS\n\n\n2023-08\nWEEKDAY\n13\nBUS\n\n\n2023-08\nWEEKDAY\n14\nBUS\n\n\n2023-08\nWEEKDAY\n15\nBUS\n\n\n2023-08\nWEEKDAY\n16\nBUS\n\n\n2023-08\nWEEKDAY\n17\nBUS\n\n\n2023-08\nWEEKDAY\n18\nBUS\n\n\n2023-08\nWEEKDAY\n19\nBUS\n\n\n2023-08\nWEEKDAY\n20\nBUS\n\n\n2023-08\nWEEKDAY\n21\nBUS\n\n\n2023-08\nWEEKDAY\n22\nBUS\n\n\n2023-08\nWEEKDAY\n23\nBUS\n\n\n2023-08\nWEEKDAY\n24\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n1\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n2\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n3\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n4\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n5\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n6\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n7\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n8\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n9\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n10\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n11\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n12\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n13\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n14\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n15\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n16\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n17\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n18\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n19\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n20\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n21\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n22\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n23\nBUS\n\n\n2023-08\nWEEKENDS/HOLIDAY\n24\nBUS\n\n\n\n\n\nCode\nrm(distinct_values)\n\n\n\n\nCode\nodbus202308_isunique &lt;- isUnique(odbus202308)\nodbus202308_extractduplicatecount &lt;- extractduplicatecount(odbus202308)\n\n\n\n\nBus Stops\nFrom the flow data, we have trips from ORIGIN_PT_CODE to DESTINATION_PT_CODE. however, that is a unique ID tagged to each busstop, but without the busstop metadata, we don’t know where are these busstops. So we need to add in an additional data to plot the geographical location of each busstop.\nWe see that busstop data is a point data with only 1 pair of XY coordinate per feature. BUS_STOP_N in the busstop data is a unique ID matching to that of ORIGIN_PT_CODE & DESTINATION_PT_CODE. Thus lets apply the same transformation to make it into a category to allow matching of the trip data to the busstop location.\nCheck if busstop data is unique returned TRUE. There are 0 records that are duplicated.\n\n\nCode\nbusstop &lt;- st_read(dsn = \"data/geospatial\",\n                   layer = \"BusStop\") %&gt;%\n  st_transform(crs = 3414)\n\n\nReading layer `BusStop' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 5161 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3970.122 ymin: 26482.1 xmax: 48284.56 ymax: 52983.82\nProjected CRS: SVY21\n\n\nCode\nkable(sample_n(busstop,25))\n\n\n\n\n\n\n\n\n\n\n\nBUS_STOP_N\nBUS_ROOF_N\nLOC_DESC\ngeometry\n\n\n\n\n74059\nB02\nOPP TAMPINES DORMITORY\nPOINT (38663.27 38680.08)\n\n\n14239\nB08\nOPP KEPPEL DP BLK 519\nPOINT (27317.18 28257.54)\n\n\n59499\nB03\nORCHID PK CONDO\nPOINT (28140.99 43892.81)\n\n\n52401\nB03\nBLK 102\nPOINT (29955.02 34497.2)\n\n\n95141\nB07\nAFT CARGO BLDG D\nPOINT (46344.45 40369.31)\n\n\n96389\nB01A\nOPP CHANGI CITY PT\nPOINT (42347.23 35029.58)\n\n\n80051\nB03\nAFT LOR 1 GEYLANG\nPOINT (32438.02 32754.84)\n\n\n66339\nB04\nBLK 101\nPOINT (32118.41 39257.22)\n\n\n44609\nB02\nBLK 408\nPOINT (20747.34 40442.5)\n\n\n14009\nINT\nHARBOURFRONT INT\nPOINT (26419.23 27742.35)\n\n\n56089\nB34\nAFT SLE\nPOINT (26361.72 41547.02)\n\n\n27321\nB13\nBLK 948\nPOINT (12206.67 36254.41)\n\n\n75099\nB01\nBLK 897\nPOINT (39225.63 36694.81)\n\n\n78209\nB03\nBLK 242\nPOINT (42341.79 39253.55)\n\n\n13011\nB03\nNAPIER STN EXIT 2\nPOINT (26434.46 32090.12)\n\n\n27241\nB13\nSPMS\nPOINT (11010.23 35776.31)\n\n\n65449\nB04\nBLK 315B\nPOINT (34969.54 43321.74)\n\n\n55109\nB35\nSERENITY PK\nPOINT (30957.2 41377.96)\n\n\n18141\nB06\nAFT ANGLO-CHINESE JC\nPOINT (22959.91 31846.44)\n\n\n21671\nB01\nBLK 331\nPOINT (15813.32 35576.36)\n\n\n21271\nB05A\nOPP ASSYAKIRIN MQUE\nPOINT (15325.84 35211.54)\n\n\n54199\nB03\nBEF MAYFLOWER STN EXIT 3\nPOINT (28479.28 39581.28)\n\n\n56099\nB36\nAFT SPRINGLEAF RD\nPOINT (26356.36 42116.65)\n\n\n52381\nB05\nBRADDELL TECH BLDG\nPOINT (30784.68 35783.65)\n\n\n62219\nB01\nBLK 158\nPOINT (33223.3 37114.5)\n\n\n\n\n\nCode\nbusstop$BUS_STOP_N &lt;- as.factor(busstop$BUS_STOP_N)\nbusstop$BUS_ROOF_N &lt;- as.factor(busstop$BUS_ROOF_N)\n\n\n\n\nCode\nbusstop_isunique &lt;- isUnique(busstop)\nbusstop_extractduplicatecount &lt;- extractduplicatecount(busstop)\n\n\n\n\nLayering Busstop with No. Trips\nWe should then first check there are busstops that are found in trips but don’t have a busstop point mapped. This is more important because, it is possible for an existing busstop to have no demand, but not possible to have trips from a missing busstop. a) BUS_STOP_N from geometry data b) ORIGIN_PT_CODE from trips data\n\n\nCode\nmissing_in_busstop_ORIGIN &lt;- data.frame(setdiff(odbus202308$ORIGIN_PT_CODE,busstop$BUS_STOP_N)) %&gt;% rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_DESTINATION &lt;- data.frame(setdiff(odbus202308$DESTINATION_PT_CODE,busstop$BUS_STOP_N)) %&gt;% \n  rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_combined &lt;- rbind(missing_in_busstop_ORIGIN,missing_in_busstop_DESTINATION) %&gt;% unique() \n\norigin_daytime &lt;- odbus202308 %&gt;%\n  group_by(DAY_TYPE,TIME_PER_HOUR,ORIGIN_PT_CODE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS))\n\norigin_only &lt;- origin_daytime %&gt;%\n  group_by(ORIGIN_PT_CODE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS))\n\norigin_total &lt;- origin_only %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(ORIGIN_PT_CODE))\n\nmissing_in_busstop_trips &lt;- left_join(missing_in_busstop_combined, origin_only\n                                      , by=c(\"BUS_STOP_N\" = \"ORIGIN_PT_CODE\"))\n\nmissing_in_busstop_total &lt;- missing_in_busstop_trips %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(BUS_STOP_N))\n\nmissing_stop1 &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_STOPS)\n\nmissing_stop_ratio1 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total %&gt;% pull(TOTAL_STOPS) / origin_total %&gt;% pull(TOTAL_STOPS)*100)\n\nmissing_trip_ratio1 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total %&gt;% pull(TOTAL_TRIPS) / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\n\nUpon inspection, there are 54 busstops that are not found with a geometry data point. They made up of ~1.6% of trips and 1.1% of bus stops. In particular, the top 2 observations 59009 and 47009 are Yishun & Woodlands Temp Interchange respectively and should be included. Thus i have made some manual input to find the location of some of these bussstops.\nNote: although woodlands regional bus interchange has started operation, there are a few bus services that continue to run from the temp bus interchange [LINK].\n\n\nCode\n#manualbusstop &lt;- tibble(BUS_STOP_N = c('59009','47009'), lat = c(1.4278664,1.4375880), lon = #c(103.8361437,103.7865749), LOC_DESC = c('YISHUN BUS INT','WOODLANDS TEMP BUS INT'), BUS_ROOF_N=c('','')) \n\nmanualbusstop &lt;- read.csv(\"data/aspatial/AdditionalBusStop.csv\") %&gt;%\n  mutate(BUS_STOP_N = sprintf(\"%05d\",BUS_STOP_N))\n\nmanualbusstop_geo2 &lt;- st_as_sf(manualbusstop, coords = c(\"LONG\",\"LAT\"), crs = 4326) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(manualbusstop_geo2)+\n  tm_dots(col=\"red\",\n          size = 0.2)+  \n  tm_layout(main.title = \"Manual Busstop Added\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\nbusstop2 &lt;- rbind(busstop,manualbusstop_geo2) \n\nmissing_in_busstop_ORIGIN2 &lt;- data.frame(setdiff(odbus202308$ORIGIN_PT_CODE,busstop2$BUS_STOP_N)) %&gt;% rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_DESTINATION2 &lt;- data.frame(setdiff(odbus202308$DESTINATION_PT_CODE,busstop2$BUS_STOP_N)) %&gt;% \n  rename_at(1, ~'BUS_STOP_N')\nmissing_in_busstop_combined2 &lt;- rbind(missing_in_busstop_ORIGIN2,missing_in_busstop_DESTINATION2) %&gt;% unique()\n\nmissing_in_busstop_trips2 &lt;- left_join(missing_in_busstop_combined2, origin_only\n                                      , by=c(\"BUS_STOP_N\" = \"ORIGIN_PT_CODE\"))\n\nmissing_in_busstop_total2 &lt;- missing_in_busstop_trips2 %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS),\n            TOTAL_STOPS = n_distinct(BUS_STOP_N))\n\nmissing_stop2 &lt;- missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS)\n\nmissing_stop_diff &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_STOPS) - missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS)\n\nmissing_trip_diff &lt;- missing_in_busstop_total %&gt;% pull(TOTAL_TRIPS) - missing_in_busstop_total2 %&gt;% pull(TOTAL_TRIPS)\n\n\nmissing_stop_ratio2 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total2 %&gt;% pull(TOTAL_STOPS) / origin_total %&gt;% pull(TOTAL_STOPS)*100)\n\nmissing_trip_ratio2 &lt;- sprintf(\"%.1f%%\", missing_in_busstop_total2 %&gt;% pull(TOTAL_TRIPS) / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\nmissing_trip_ratio_diff &lt;- sprintf(\"%.1f%%\", missing_trip_diff / origin_total %&gt;% pull(TOTAL_TRIPS)*100)  \n\nrm(busstop,mpsz,manualbusstop,manualbusstop_geo2, missing_in_busstop_combined, missing_in_busstop_combined2, missing_in_busstop_DESTINATION, missing_in_busstop_DESTINATION2, missing_in_busstop_ORIGIN, missing_in_busstop_ORIGIN2, missing_in_busstop_total, missing_in_busstop_total2, missing_in_busstop_trips, missing_in_busstop_trips2)\ngc()\n\n\n           used  (Mb) gc trigger  (Mb)  max used  (Mb)\nNcells  3601680 192.4    6529148 348.7   6529148 348.7\nVcells 31677960 241.7  102106384 779.1 102106384 779.1\n\n\nAfter the update, there are 30 busstops that are not found with a geometry data point. They made up of ~0.1% of trips and 0.6% of bus stops. By just adding 24 stops, we are now accounting for ~1.5% more trips.\nNow lets simplify and only look at busstops in Singapore and plot where are the busstops as well as the bus interchange.\n\n\nCode\n# Find points that are in Singapore\nsgbusstop &lt;- st_intersection(busstop2, sgp_simple)\n\nsgbusinterchange &lt;- read_csv(\"data/aspatial/sgbusinterchange.csv\") %&gt;%\n  select(BUS_STOP_N)\n\nsgbusstop$Interchange &lt;- ifelse(sgbusstop$BUS_STOP_N %in% sgbusinterchange$BUS_STOP_N,\"Interchange\",\"Busstop\")\n\n# Find points that are not within Singapore\njohorbusstop &lt;- busstop2[!busstop2$BUS_STOP_N %in%\n                          sgbusstop$BUS_STOP_N,]\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(sgbusstop)+\n  tm_dots()+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.3)+\n  tm_layout(main.title = \"Bus Stop & Bus Interchange Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\nrm(sgbusinterchange, busstop2)\n\n\n\n\n\n\n\n\nTip\n\n\n\nSave\n\n\nCode\nwrite.csv(sgbusstop, file = 'data/aspatial/sgbusstop.csv')\nwrite_rds(sgbusstop, \"data/rds/sgbusstop.rds\")\n\n\n\n\n\n\nHexgon that are covering the busstops\n\n\nCode\nbusstop_withhex &lt;- st_intersection(sgbusstop,sgp_hexid) %&gt;%\n  select(-area)\n\nsgp_hexid_bs_df &lt;- st_intersection(sgp_hexid,sgbusstop) %&gt;%\n  data.frame() %&gt;%\n  select(hex_id,BUS_STOP_N, LOC_DESC, Interchange)\n\nsgp_hexid_wbs_df &lt;- sgp_hexid_bs_df %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(TOTAL_STOPS = n_distinct(BUS_STOP_N),\n            #TOTAL_INTERCHANGE = n_distinct(Interchange),\n            ALL_STOPS_ID = list(as.factor(BUS_STOP_N)),\n            ALL_STOPS_DESC = list(LOC_DESC))\n\nsgp_hexid_wbs_geo &lt;- left_join(sgp_hexid,sgp_hexid_wbs_df) %&gt;%\n  filter(TOTAL_STOPS &gt; 0) %&gt;%\n  select(-area)\n\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(col=\"TOTAL_STOPS\", \n              alpha = 1,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             #\"Number of Interchange:\" = \"TOTAL_INTERCHANGE\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")) +\n  tm_borders(alpha = 0.2)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.1)+\n  tm_layout(main.title = \"Busstops Distribution + Bus Interchange\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG\",\n             position = c(\"left\",\"bottom\"))\n\n\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nSave\n\n\nCode\n#|eval : false\n\nwrite_rds(sgp_hexid_wbs_geo, \"data/rds/sgp_hexid_wbs_geo.rds\")\n\n\n\n\n\n\nOrigin Destination Trips\nWe will like to analyse the high weekday morning peaks and where are people travelling to and from. Therefore we will filter the trips data to only that of weekday 6am to 9am. We can see that there are very popular origin & destination that have &gt;10,000 trips within the weekday morning peak. However, just by looking at the code, we don’t know what are these locations. Thus we need to join in the data\n\n\nCode\nodbus202308_wdmp &lt;- odbus202308 %&gt;%\n  filter(DAY_TYPE == \"WEEKDAY\") %&gt;%\n  filter( TIME_PER_HOUR &gt;= 6 &\n            TIME_PER_HOUR &lt;= 9\n          ) %&gt;%\n  group_by(ORIGIN_PT_CODE, DESTINATION_PT_CODE) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS)) %&gt;%\n  unique()\n\nkable(head(odbus202308_wdmp %&gt;%\n       arrange(desc(TOTAL_TRIPS))))\n\n\n\n\n\nORIGIN_PT_CODE\nDESTINATION_PT_CODE\nTOTAL_TRIPS\n\n\n\n\n46219\n46109\n14122\n\n\n46109\n45139\n14045\n\n\n46069\n46009\n13971\n\n\n46109\n46521\n12297\n\n\n44629\n44009\n12055\n\n\n21591\n28091\n11704\n\n\n\n\n\nAfter joining the busstop name, we can see that the most popular trips are made from Checkpoint to MRT as well as from various locations to the train station / bus interchange. Do note that after joining the trip data with the busstop data, there is a reduction in no. of records. this is due to the earlier established difference where 0.1% of the trips will not be matched due to a lack of busstop data.\n\n\nCode\nodbus202308_wdmp_hex &lt;- odbus202308_wdmp %&gt;%\n  inner_join(busstop_withhex %&gt;%\n               data.frame() %&gt;%\n               select(BUS_STOP_N, LOC_DESC, hex_id),\n             by = c(\"ORIGIN_PT_CODE\" = \"BUS_STOP_N\")) %&gt;%\n  rename(ORIG_HEX_ID = hex_id,\n         ORIG_BUSSTOPS = LOC_DESC) %&gt;%\n  inner_join(busstop_withhex %&gt;%\n               data.frame() %&gt;%\n               select(BUS_STOP_N, LOC_DESC, hex_id),\n             by = c(\"DESTINATION_PT_CODE\" = \"BUS_STOP_N\")) %&gt;%\n  rename(DEST_HEX_ID = hex_id,\n         DEST_BUSSTOPS = LOC_DESC) %&gt;%\n  select(ORIGIN_PT_CODE, DESTINATION_PT_CODE,TOTAL_TRIPS,ORIG_BUSSTOPS,ORIG_HEX_ID,DEST_BUSSTOPS,DEST_HEX_ID) %&gt;%\n  unique()\n\nodbus202308_wdmp_hex %&gt;%\n  select(ORIG_BUSSTOPS, DEST_BUSSTOPS, TOTAL_TRIPS,ORIGIN_PT_CODE,DESTINATION_PT_CODE) %&gt;%\n  arrange(desc(TOTAL_TRIPS)) %&gt;%\n  filter(TOTAL_TRIPS &gt; 10000) %&gt;%\n  kable()\n\n\n\n\n\n\n\n\n\n\n\n\nORIG_BUSSTOPS\nDEST_BUSSTOPS\nTOTAL_TRIPS\nORIGIN_PT_CODE\nDESTINATION_PT_CODE\n\n\n\n\nW’LANDS CHECKPT\nKRANJI STN\n14045\n46109\n45139\n\n\nWOODLANDS TRAIN CHECKPT\nWOODLANDS REG INT\n13971\n46069\n46009\n\n\nW’LANDS CHECKPT\nMARSILING STN\n12297\n46109\n46521\n\n\nBLK 457\nCHOA CHU KANG INT\n12055\n44629\n44009\n\n\nOPP BLK 117\nLAKESIDE STN\n11704\n21591\n28091\n\n\nBLK 678D\nBOON LAY INT\n11683\n22599\n22009\n\n\nOPP BLK 245\nYISHUN STN EXIT E\n11515\n59181\n59072\n\n\nOPP BLK 666\nOPP YEW TEE STN\n11399\n45421\n45329\n\n\nBLK 953\nPIONEER STN EXIT B\n11333\n27279\n22529\n\n\nBLK 786A CP\nADMIRALTY STN\n11319\n46799\n46779\n\n\nBLK 442\nCHOA CHU KANG INT\n11250\n44509\n44009\n\n\nBLK 12\nWOODLANDS REG INT\n11170\n46189\n46009\n\n\nBLK 456\nKHATIB STN EXIT D\n11162\n59579\n59569\n\n\nBlk 483\nSUN PLAZA/SEMBAWANG STN\n11030\n58351\n58251\n\n\nGEK POH SHOP CTR\nBOON LAY INT\n11020\n27389\n22009\n\n\nW’LANDS CHECKPT\nWoodlands Temp Int\n11014\n46109\n47009\n\n\nBLK 212\nWOODLANDS REG INT\n11001\n46151\n46009\n\n\nBLK 463\nLAKESIDE STN\n10891\n28511\n28091\n\n\nBLK 22\nKOVAN STN EXIT C\n10843\n63059\n63039\n\n\nBLK 755\nBOON LAY INT\n10837\n27379\n22009\n\n\nBLK 27\nTOA PAYOH BUS INT\n10751\n52331\n52009\n\n\nOPP BLK 661\nOPP YEW TEE STN\n10746\n45439\n45329\n\n\nOPP BLK 670\nOPP YEW TEE STN\n10622\n45411\n45329\n\n\nOPP BISHAN NTH SHOP MALL\nBishan Stn\n10606\n53389\n53231\n\n\nBLK 27\nBEDOK STN EXIT A\n10404\n84049\n84039\n\n\nBLK 458\nLAKESIDE STN\n10275\n28399\n28091\n\n\nBLK 32\nWOODLANDS REG INT\n10269\n46141\n46009\n\n\nOPP BLK 739A CP\nADMIRALTY STN\n10266\n46841\n46779\n\n\nBLK 880\nWOODLANDS REG INT\n10250\n46439\n46008\n\n\nOPP WOODSVALE CONDO\nADMIRALTY STN\n10217\n47619\n46779\n\n\nBLK 309\nYISHUN STN EXIT E\n10197\n59171\n59072\n\n\nBET BLKS 701/702\nTAMPINES INT\n10089\n75131\n75009\n\n\nBLK 391\nYISHUN STN EXIT E\n10056\n59601\n59072\n\n\nBLK 263\nBOON LAY INT\n10034\n21379\n22009\n\n\nBLK 504C\nKHATIB STN EXIT D\n10006\n59761\n59569\n\n\n\n\n\n\n\nCode\nrm(odbus202308,odbus202308_wdmp,origin_daytime,origin_only,origin_total)\ngc()\n\n\n          used  (Mb) gc trigger  (Mb)  max used  (Mb)\nNcells 3641224 194.5    6529148 348.7   6529148 348.7\nVcells 6688025  51.1   81685108 623.3 102106384 779.1\n\n\nLets now summarise the data into the analytical hexagons and generate the flow data\n\n\nCode\nhex_trip_df &lt;- odbus202308_wdmp_hex %&gt;%\n  group_by(ORIG_HEX_ID,DEST_HEX_ID) %&gt;%\n  summarise(TOTAL_TRIPS = sum(TOTAL_TRIPS)) %&gt;%\n  inner_join(sgp_hexid_wbs_df %&gt;%\n               select(hex_id, TOTAL_STOPS, ALL_STOPS_DESC),\n             by = c(\"ORIG_HEX_ID\" = \"hex_id\")) %&gt;%\n  rename(ORIG_TOTAL_STOPS = TOTAL_STOPS,\n         ORIG_ALL_STOPS_DESC = ALL_STOPS_DESC) %&gt;%\n  inner_join(sgp_hexid_wbs_df %&gt;%\n               select(hex_id, TOTAL_STOPS, ALL_STOPS_DESC),\n             by = c(\"DEST_HEX_ID\" = \"hex_id\")) %&gt;%\n  rename(DEST_TOTAL_STOPS = TOTAL_STOPS,\n         DEST_ALL_STOPS_DESC = ALL_STOPS_DESC) %&gt;%\n  unique() %&gt;%\n  mutate(OD = paste(ORIG_HEX_ID,DEST_HEX_ID,sep = \" to \")) %&gt;%\n  arrange(desc(TOTAL_TRIPS))\n#%&gt;%\n  #select(OD,TOTAL_TRIPS,everything())\n\nkable(head(hex_trip_df))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nORIG_HEX_ID\nDEST_HEX_ID\nTOTAL_TRIPS\nORIG_TOTAL_STOPS\nORIG_ALL_STOPS_DESC\nDEST_TOTAL_STOPS\nDEST_ALL_STOPS_DESC\nOD\n\n\n\n\nHEX_1995\nHEX_1887\n58093\n10\nOPP BLK 367 , EVANGEL FAMILY CH, BET BLKS 405/406 , BLK 342B , BLK 391 , OPP BLK 406 , OPP BLK 392 , BLK 358 , OPP BLK 382C , BLK 382C\n14\nBLK 763 , YISHUN STN , OPP BLK 757 , BLK 145 , OPP YISHUN STN , OPP YISHUN STN EXIT B, BLK 741 , BET BLKS 201/202 , BLK 154 , OPP BLK 201 , YISHUN STN EXIT E , BEF YISHUN STN , Yishun Int , Yishun Int\nHEX_1995 to HEX_1887\n\n\nHEX_1940\nHEX_1886\n54445\n12\nNAVAL BASE PR SCH , BLK 671 CP , BLK 858 , OPP NAVAL BASE PR SCH , BLK 666 , OPP ORCHID COUNTRY CLUB, ORCHID COUNTRY CLUB , BLK 512A , OPP BLK 512A , BLK 504C , OPP BLK 672C , BLK 672C\n10\nOPP KHATIB STN EXIT D, BLK 790 , Opp Khatib Stn , BLK 608 , BLK 630 , BLK 624 , BLK 846 , BLK 873 , BEF KHATIB STN , KHATIB STN EXIT D\nHEX_1940 to HEX_1886\n\n\nHEX_800\nHEX_826\n50920\n11\nBLK 755 , OPP BLK 755 , BLK 673C , JURONG WEST SUB-STN, BLK 749 , GEK POH SHOP CTR , WEST GROVE PR SCH , BLK 729 , BLK 678D , BLK 745 , BLK 734A CP\n10\nBLK 668D , BLK 664C , BLK 685B , Blk 662A , BLK 691A CP , BLK 662A , BLK 669 CP , BOON LAY INT, BLK 683A , BLK 665A , BLK 670A\nHEX_800 to HEX_826\n\n\nHEX_1914\nHEX_1887\n47115\n7\nBLK 241, BLK 257, BLK 309, BLK 236, BLK 227, BLK 220, BLK 291\n14\nBLK 763 , YISHUN STN , OPP BLK 757 , BLK 145 , OPP YISHUN STN , OPP YISHUN STN EXIT B, BLK 741 , BET BLKS 201/202 , BLK 154 , OPP BLK 201 , YISHUN STN EXIT E , BEF YISHUN STN , Yishun Int , Yishun Int\nHEX_1914 to HEX_1887\n\n\nHEX_718\nHEX_772\n43611\n13\nJUYING PR SCH , BLK 920 , BLK 932 , BLK 962 , OPP BLK 974 , BLK 934 , BLK 974 , BLK 918 , BEF XINGNAN PRI SCH , NTUC HEALTH NURSING HOME, BEF YUNNAN CRES , BLK 953 , BLK 924\n20\nBLK 978 , BEF BLK 717 , BLK 704 , OPP BLK 643 , BLK 643 , BLK 834 , BLK 639 , PIONEER STN EXIT B , BLK 710 , BLK 641 , Blk 711 , BLK 705 , BLK 701 , BLK 715 , BLK 622 , OPP JURONG WEST PR SCH, BLK 624 , OPP BLK 622 , JURONG WEST PR SCH , OPP BLK 717\nHEX_718 to HEX_772\n\n\nHEX_2691\nHEX_2771\n39529\n15\nBLK 604A , OPP BLK 601C , BLK 734 , BET BLKS 701/702 , BLK 863 , POI CHING SCH , BET BLKS 710/713 , BLK 730 , BET BLKS 524B/523D, OPP BLK 721 , OPP BLKS 741/742 , BLK 742A , OPP BLKS 710/713 , BLK 721 , BLK 867A\n9\nBLK 237 , TAMPINES INT , TAMPINES INT , OPP TAMPINES STN/INT, OPP BLK 248 , OPP CENTURY SQ , OPP BLK 237 , TAMPINES STN/INT , BLK 248\nHEX_2691 to HEX_2771\n\n\n\n\n\n\n\nCode\nflowlines &lt;- od2line(flow = hex_trip_df,\n                     zones = sgp_hexid_wbs_geo,\n                     zone_code = \"hex_id\") %&gt;%\n  st_make_valid() %&gt;%\n  select(OD,TOTAL_TRIPS,ORIG_HEX_ID,DEST_HEX_ID)\n\n\n\n\n\n\n\n\nTip\n\n\n\nSave\n\n\nCode\nwrite_rds(flowlines, \"data/rds/flowlines.rds\")\n\n\n\n\n\n\nVisualising the Data\n\nTransport Nodes\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.2,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(col=\"TOTAL_STOPS\", \n              alpha = 0.2,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")\n              ) +\n  tm_shape(trainpolygon_sf)+\n  tm_polygons(alpha = 0.2)+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col = \"purple\",\n          size= 0.06)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.03)+\n  tm_layout(main.title = \"Transport Node Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\n\n\nTransport Flow\nWe can see a congregation of flow largely towards the MRT station. When we aggregate over a hexagonal area instead of just individual busstop. The largest trip is no longer from Checkpoint to the various nearby MRT station, although still significant\nThe biggest trend will be commuters going towards and away from area with MRT. This is especially pronounced in area high in residential and with MRT e.g. Yishun (HEX_1887), Woodlands Area (HEX_1510). Other areas that display similar traits are Chua Chu Kang, Bukit Panjang, Boonlay, Lakeside, Jurong East, Clementi, Serangoon, Tiong Bahru, Ang Mo Kio, Bedok, Tampines, Punggol, Sengkang, Buangkok\nApart from these regional centres, there is a particular long distance link from Compassvale (HEX_2424) to Woodlands (HEX_1510) This could be due to the availability of direct bus service like 161 & 965 and no direct MRT service that allow commuters to cross from northeastern to northern Singapore easily.\n\n\nCode\ntopflow &lt;- flowlines %&gt;%\n  data.frame() %&gt;%\n  filter(TOTAL_TRIPS &gt; 10000) %&gt;%\n  arrange(desc(TOTAL_TRIPS)) %&gt;%\n  st_as_sf()\n\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.1,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(\n              #col=\"TOTAL_STOPS\", \n              alpha = 0.04,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")\n              ) +\n  tm_shape(topflow)+\n  tm_lines(lwd = \"TOTAL_TRIPS\",\n           alpha = 0.4,\n           col = \"green\",\n           scale = c(0.1, 0.5, 1, 3, 5, 7, 9, 13, 17, 19),\n           )+\n  tm_shape(trainpolygon_sf)+\n  tm_polygons(alpha = 0.2)+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col = \"purple\",\n          size= 0.06,\n          alpha = 0.2)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.08,\n          alpha = 0.2)+\n  tm_layout(main.title = \"Bus Trips for Weekdays 6-9AM (2023 Aug)\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\n\n\nCode\ntmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.1,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(\n              #col=\"TOTAL_STOPS\", \n              alpha = 0.04,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")\n              ) +\n  tm_shape(topflow)+\n  tm_lines(lwd = \"TOTAL_TRIPS\",\n           alpha = 0.4,\n           col = \"green\",\n           scale = c(0.1, 0.5, 1, 3, 5, 7, 9, 13, 17, 19),\n           )+\n  tm_shape(trainpolygon_sf)+\n  tm_polygons(alpha = 0.2)+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col = \"purple\",\n          size= 0.06,\n          alpha = 0.2)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.08,\n          alpha = 0.2)+\n  tm_layout(main.title = \"Bus Trips for Weekdays 6-9AM (2023 Aug)\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\n\n\n\nImplication\nDepending on how Singapore intend to grow the Northern / Northeastern sector (e.g. SIT moving to Punggol), if there are sufficient demand with the build up of this regional centre, it could be possible to consider a short north shore MRT line to link up Punggol and Woodlands area to serve the demand that is currently met by Bus."
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#transport-flow",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#transport-flow",
    "title": "Take-home_Ex2",
    "section": "Transport Flow",
    "text": "Transport Flow\nWe can see a congregation of flow largely towards the MRT station. When we aggregate over a hexagonal area instead of just individual busstop. The largest trip is no longer from Checkpoint to the various nearby MRT station, although still significant\nYishun MRT seem to be a popular location that people are going to in the morning. This is likely due to\n\n\nCode\ntopflow &lt;- flowlines %&gt;%\n  filter(TOTAL_TRIPS &gt; 10000)\n\n\n\n\nCode\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.1,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(\n              #col=\"TOTAL_STOPS\", \n              alpha = 0.04,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")\n              ) +\n  tm_shape(topflow)+\n  tm_lines(lwd = \"TOTAL_TRIPS\",\n           alpha = 0.4,\n           col = \"green\",\n           scale = c(0.1, 0.5, 1, 3, 5, 7, 9, 13, 17, 19),\n           )+\n  tm_shape(trainpolygon_sf)+\n  tm_polygons(alpha = 0.2)+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col = \"purple\",\n          size= 0.06,\n          alpha = 0.2)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.08,\n          alpha = 0.2)+\n  tm_layout(main.title = \"Bus Trips for Weekdays 6-9AM (2023 Aug)\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\ntmap_mode(\"plot\")\n\n\n\n\nCode\ntmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.1,\n              border.alpha = 0.4)+\n  tm_shape(sgp_hexid_wbs_geo)+\n  tm_polygons(\n              #col=\"TOTAL_STOPS\", \n              alpha = 0.04,\n              border.alpha = 0.1,\n              title = \"No. of Busstops\",\n              popup.vars = c(\"Number of Busstops: \" = \"TOTAL_STOPS\",\n                             \"Busstops Description:\" = \"ALL_STOPS_DESC\")\n              ) +\n  tm_shape(topflow)+\n  tm_lines(lwd = \"TOTAL_TRIPS\",\n           alpha = 0.4,\n           col = \"green\",\n           scale = c(0.1, 0.5, 1, 3, 5, 7, 9, 13, 17, 19),\n           )+\n  tm_shape(trainpolygon_sf)+\n  tm_polygons(alpha = 0.2)+\n  tm_shape(trainexitpoint_sf)+\n  tm_dots(col = \"purple\",\n          size= 0.06,\n          alpha = 0.2)+\n  tm_shape(sgbusstop %&gt;%\n             filter(Interchange == \"Interchange\"))+\n  tm_dots(col = \"cyan\",\n          size = 0.08,\n          alpha = 0.2)+\n  tm_layout(main.title = \"Bus Trips for Weekdays 6-9AM (2023 Aug)\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\ntmap_mode(\"plot\")"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#attributes",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#attributes",
    "title": "Take-home_Ex2",
    "section": "Attributes",
    "text": "Attributes\n\nno. of busstops (push & pull)\nno of MRT exit (push & pull) - kind of proxy for how crowded this place is, e.g. raffles place has X exits because they serve a big population for work\nBUS Interchange - (push & pull)\nMRT Interchange - (push & pull)\nPreschool - pull but likely low, because pre-schoolers usually dont take public transport. it is generally near to home. Otherwise, it could be explaning for proximity to amenities or workplace\nPrimarySchool - pull, but likely low. especially if the kids are in lower primary. can also refer to extract from population census, they generally don’t take bus\nSecondarySchool - pull\nJC - pull\nTetiary Education (don’t think they matter for morning peak) like ITE, Poly, Uni - pull but lower effect due to staggered starting time\nBusiness - pull\nF&B - likely low impact because F&B location generally don’t open so early. apart from hawker centre, which people might go nearby to eat before going to work/school? (push???) seldom do we see people taking public transport to specific F&B before work/school. likely more so it is near to their home/destination\npopulation - push\nfin service - pull\nlanded area - interesting to see if landed matters\nretail - pull? likely not much impact?\n\n\n\nCode\nurl &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n\ncsv &lt;- read_csv(\"data/aspatial/Generalinformationofschools.csv\")\n\n#this is saving the postal_code separately as a list\npostcodes &lt;- csv$`postal_code`\n\n\n#initialisation, empty dataframe\nfound &lt;- data.frame()\nnot_found &lt;- data.frame()\n\n\nfor (postcode in postcodes){\n  query &lt;- list('searchVal'=postcode, 'returnGeom' = 'Y', 'getAddrDetails' = 'Y', 'pageNum' = '1')\n  res &lt;- GET(url, query=query)\n  \n  if((content(res)$found) != 0){\n    found &lt;- rbind(found,data.frame(content(res))[4:13])\n  } else {\n    not_found = data.frame(postcode)\n  }\n}\n\n\n\n\nCode\nmerged = merge(csv, found, by.x = 'postal_code', by.y = 'results.POSTAL', all = TRUE)\nwrite.csv(merged, file = 'data/aspatial/schools.csv')\nwrite.csv(not_found, file = \"data/aspatial/not_found.csv\")\n\n\n\n\nCode\nnewschoolread &lt;- read_csv(\"data/aspatial/schools_updated.csv\") %&gt;%\n  rename(longtitude = results.LONGITUDE,\n         latitude = results.LATITUDE) %&gt;%\n  select(school_name, longtitude, latitude) %&gt;%\n  unique()\n\nschcategory &lt;- read_csv(\"data/aspatial/SchoolCategory.csv\")\n\nnewschoolread2 &lt;- left_join(newschoolread,schcategory)\nrm(newschoolread,schcategory)\n\n\n\n\nCode\nschools_sf &lt;- st_as_sf(newschoolread2,\n                       coords = c(\"longtitude\",\"latitude\"),\n                       crs = 4326\n                       ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\nprisch_sf &lt;- schools_sf %&gt;%\n  filter(level == \"PRIMARY\")\n\nsecjcsch_sf &lt;- schools_sf %&gt;%\n  filter(level != \"PRIMARY\")\n\nrm(newschoolread2)\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(schools_sf)+\n  tm_dots(col =  \"level\")+\n  #tm_shape(prisch_sf)+\n  #tm_dots(col =  \"lightblue\")+\n  #tm_shape(secjcsch_sf)+\n  #tm_dots(col =  \"black\")+\n  tm_layout(main.title = \"Primary, Secondary, JC Schools Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nprivateinstitution_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"PrivateEducationInstitutions\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(NAME_OF_SC,POSTALCODE,STREETNAME) %&gt;%\n  filter(NAME_OF_SC != \"SINGAPORE INSTITUTE OF MANAGEMENT\") %&gt;%\n  unique()\n\n\nReading layer `PrivateEducationInstitutions' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 284 features and 22 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6788 ymin: 1.273068 xmax: 103.9437 ymax: 1.4498\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(privateinstitution_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Private Education Institution Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\ntetiary &lt;- read_csv(\"data/aspatial/TetiaryEducation.csv\")\n\ntetiary_sf &lt;- st_as_sf(tetiary,\n                       coords = c(\"Long\",\"Lat\"),\n                       crs = 4326\n                       ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid() %&gt;%\n  unique()\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(tetiary_sf)+\n  tm_dots(col = \"Type\",\n          size = 0.5)+\n  tm_layout(main.title = \"Tetiary Education Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\nrm(tetiary)\n\n\n\n\nCode\npreschool_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"PreSchoolsLocation-point\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  unique()\n\n\nReading layer `PreSchoolsLocation-point' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2290 features and 5 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(preschool_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"PreSchool Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\nFOOD & ENTERTAINMENT\n\n\nCode\nurl &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n\ncsv &lt;- read_csv(\"data/aspatial/ListofGovernmentMarketsHawkerCentres.csv\")\n\n#this is saving the postal_code separately as a list\npostcodes &lt;- csv$`postalcode`\n\n\n#initialisation, empty dataframe\nfound &lt;- data.frame()\nnot_found &lt;- data.frame()\n\n\nfor (postcode in postcodes){\n  query &lt;- list('searchVal'=postcode, 'returnGeom' = 'Y', 'getAddrDetails' = 'Y', 'pageNum' = '1')\n  res &lt;- GET(url, query=query)\n  \n  if((content(res)$found) != 0){\n    found &lt;- rbind(found,data.frame(content(res))[4:13])\n  } else {\n    not_found = data.frame(postcode)\n  }\n}\n\n\n\n\nCode\nmerged = merge(csv, found, by.x = 'postalcode', by.y = 'results.POSTAL', all = TRUE)\nwrite.csv(merged, file = 'data/aspatial/hawker.csv')\nwrite.csv(not_found, file = \"data/aspatial/hakwer_notfound.csv\")\n\n\n\n\nCode\nnewhawker &lt;- read_csv(\"data/aspatial/hawker_updated.csv\") %&gt;%\n  rename(longtitude = results.LONGITUDE,\n         latitude = results.LATITUDE,\n         postal_code = postalcode) %&gt;%\n  select(name_of_centre,\n         no_of_stalls, \n         no_of_cooked_food_stalls, \n         no_of_mkt_produce_stalls, \n         longtitude, \n         latitude) %&gt;%\n  unique()\n\nhawker_sf &lt;- st_as_sf(newhawker,\n                       coords = c(\"longtitude\",\"latitude\"),\n                       crs = 4326\n                       ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(hawker_sf)+\n  tm_dots(col =  \"no_of_stalls\",\n          palette = \"Reds\",\n          size = 0.2)+\n  tm_layout(main.title = \"Hawker Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\n  rm(newhawker)\n\n\n\n\nCode\nentertainment_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"entertn\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `entertn' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 114 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 10809.34 ymin: 26528.63 xmax: 41600.62 ymax: 46375.77\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(entertainment_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Entertainment Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nfnb_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"F&B\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `F&B' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1919 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6010.495 ymin: 25343.27 xmax: 45462.43 ymax: 48796.21\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(fnb_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"F&B Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\ntourism_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"TOURISM\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(PAGETITLE) %&gt;%\n  unique()\n\n\nReading layer `TOURISM' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 107 features and 19 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -1.797693e+308 ymin: -1.797693e+308 xmax: 43659.54 ymax: 47596.73\nProjected CRS: SVY21\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(tourism_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Toursim Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nsilverszone_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Silverzone_Updated\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(SITENAME) %&gt;%\n  unique()\n\n\nReading layer `Silverzone_Updated' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 20 features and 3 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 15059.67 ymin: 28640.08 xmax: 40994.23 ymax: 46353.94\nProjected CRS: SVY21\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(silverszone_sf)+\n  tm_polygons()+\n  tm_layout(main.title = \"Silverzone Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nleisure_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Liesure&Recreation\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `Liesure&Recreation' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1217 features and 30 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6010.495 ymin: 25134.28 xmax: 48439.77 ymax: 50078.88\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(leisure_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Leisure Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nretail_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Retails\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `Retails' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 37635 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 4737.982 ymin: 25171.88 xmax: 48265.04 ymax: 50135.28\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(retail_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Retail Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nWORK\n\n\nCode\nfinserv_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"FinServ\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `FinServ' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3320 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 4881.527 ymin: 25171.88 xmax: 46526.16 ymax: 49338.02\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(finserv_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Financial Service Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\neldercare_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"ELDERCARE\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(NAME) %&gt;%\n  unique()\n\n\nReading layer `ELDERCARE' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 133 features and 18 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(eldercare_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Eldercare Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nbusiness_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Business\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `Business' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 6550 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3669.148 ymin: 25408.41 xmax: 47034.83 ymax: 50148.54\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(business_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Business Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nRESIDENTIAL\n\n\nCode\nhotel_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"HotelLocations-point\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(Name, TOTALROOMS) %&gt;%\n  unique()\n\n\nReading layer `HotelLocations-point' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 429 features and 9 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 103.6351 ymin: 1.245797 xmax: 103.9891 ymax: 1.419278\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(hotel_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Hotel Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nuradwelling_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"URANoofDwellingUnits\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POSTALCODE,PROJ_NAME,PROP_TYPE,DU) %&gt;%\n  mutate(DU = as.numeric(DU),\n         PROP_TYPE = as.factor(PROP_TYPE),\n         population = round(ifelse(PROP_TYPE== \"Landed\",4.4,3.3) * DU )\n         ) %&gt;%\n  unique()\n\n\nReading layer `URANoofDwellingUnits' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 82766 features and 20 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6894 ymin: 1.238105 xmax: 103.9762 ymax: 1.462102\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(uradwelling_sf)+\n  tm_dots(col=\"population\")+\n  tm_layout(main.title = \"URA Dwelling Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nurl &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n\nhdb_raw &lt;- read_csv(\"data/aspatial/hdb_tofind.csv\") %&gt;%\n  mutate(searchname = paste(blk_no,street, sep = \" \"))\n\n\n#initialisation, empty dataframe\nfound &lt;- data.frame()\nnot_found &lt;- data.frame()\n\n\nfor (searchna in hdb_raw$searchname){\n  query &lt;- list('searchVal'=searchna, 'returnGeom' = 'Y', 'getAddrDetails' = 'Y', 'pageNum' = '1')\n  res &lt;- GET(url, query=query)\n  \n  if((content(res)$found) != 0){\n    found &lt;- rbind(found,data.frame(content(res))[4:13])\n  } else {\n    not_found = data.frame(searchna)\n    found &lt;- rbind(found,\"\")\n  }\n}\n\n\n\n\nCode\nmerged &lt;- cbind(hdb_raw,found)\nwrite.csv(merged, file = 'data/aspatial/hdb_tofind_updated.csv')\nwrite.csv(found, file = 'data/aspatial/hdb_found.csv')\nwrite.csv(not_found, file = \"data/aspatial/hdb_notfound.csv\")\n\n\nthereafter we combine our searched result with prof’s prepared hdb dataset. There’s one block that was not found earlier that was 141A Serangoon North Avenue 2. However that’s a multistorey carpark and is not too critical, even though we have added that in for completeness\n\n\nCode\nnewhdb &lt;- read_csv(\"data/aspatial/hdb_updated.csv\") %&gt;%\n  mutate(population = round(\n           `1room_sold` * 2.1+\n           `2room_sold` * 2.1+\n           `3room_sold` * 2.5+\n           `4room_sold` * 3.3+\n           `5room_sold` * 3.7+\n           `exec_sold` * 3.7+\n           `multigen_sold` * 3.7+\n           `studio_apartment_sold`*2.1+\n           `1room_rental` * 2.1+\n           `2room_rental` * 2.1+\n           `3room_rental` * 2.5+\n           `other_room_rental` * 3.3)) %&gt;%\n  filter(population &gt; 0) %&gt;%\n  select(addr, postal,population, max_floor_lvl, total_dwelling_units, lng, lat) %&gt;%\n  unique()\n\nhdb_sf &lt;- st_as_sf(newhdb,\n                   coords = c(\"lng\",\"lat\"),\n                   crs = 4326\n                   ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(hdb_sf)+\n  tm_dots(col =  \"population\",\n          palette = \"Reds\")+\n  tm_layout(main.title = \"HDB Block Population Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\n  rm(newhdb)\n  gc()\n\n\n           used  (Mb) gc trigger  (Mb) max used  (Mb)\nNcells  4873138 260.3   10830464 578.5 10830464 578.5\nVcells 11275830  86.1   41181800 314.2 99565412 759.7"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/data/geospatial/URANoofDwellingUnits.html",
    "href": "Take-home_Ex/Take-home_Ex2/data/geospatial/URANoofDwellingUnits.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/data/geospatial/MPSZ-2019.html",
    "href": "Take-home_Ex/Take-home_Ex2/data/geospatial/MPSZ-2019.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n        0 0     false"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2_T2.html",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2_T2.html",
    "title": "Take-home_Ex2",
    "section": "",
    "text": "Code\npacman::p_load(tmap, sf, tidyverse, sfdep, knitr, plotly, DT, lubridate, magick)\n\n\n\ntrainstation &lt;- st_read(dsn = \"data/geospatial\", layer = \"RapidTransitSystemStation\") %&gt;% \n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n  \ntmap_options(check.and.fix = TRUE)\ntm_shape(trainstation)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4)"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/data/geospatial/PrivateEducationInstitutions.html",
    "href": "Take-home_Ex/Take-home_Ex2/data/geospatial/PrivateEducationInstitutions.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;     dataset\n\n\n       GEOGCRS[“WGS 84”,ENSEMBLE[“World Geodetic System 1984 ensemble”,MEMBER[“World Geodetic System 1984 (Transit)”],MEMBER[“World Geodetic System 1984 (G730)”],MEMBER[“World Geodetic System 1984 (G873)”],MEMBER[“World Geodetic System 1984 (G1150)”],MEMBER[“World Geodetic System 1984 (G1674)”],MEMBER[“World Geodetic System 1984 (G1762)”],MEMBER[“World Geodetic System 1984 (G2139)”],ELLIPSOID[“WGS 84”,6378137,298.257223563,LENGTHUNIT[“metre”,1]],ENSEMBLEACCURACY[2.0]],PRIMEM[“Greenwich”,0,ANGLEUNIT[“degree”,0.0174532925199433]],CS[ellipsoidal,2],AXIS[“geodetic latitude (Lat)”,north,ORDER[1],ANGLEUNIT[“degree”,0.0174532925199433]],AXIS[“geodetic longitude (Lon)”,east,ORDER[2],ANGLEUNIT[“degree”,0.0174532925199433]],USAGE[SCOPE[“Horizontal component of 3D system.”],AREA[“World.”],BBOX[-90,-180,90,180]],ID[“EPSG”,4326]] +proj=longlat +datum=WGS84 +no_defs 3452 4326 EPSG:4326 WGS 84 longlat EPSG:7030 true"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/data/geospatial/mrt_fixed.html",
    "href": "Take-home_Ex/Take-home_Ex2/data/geospatial/mrt_fixed.html",
    "title": "ISSS624",
    "section": "",
    "text": "&lt;!DOCTYPE qgis PUBLIC ‘http://mrcc.com/qgis.dtd’ ‘SYSTEM’&gt;  GDM.RapidTransitSystemStation  ENG dataset\n\nGDM.RapidTransitSystemStation\n\nA symbolic polygon representation of the outline of the structure of RTS Stations\nTo locate RTS stations/ lines  Road Inventory, Road Furniture, Road Elements    mailing address\n\n251 North Bridge Road Singapore 179102\n\n  &lt;city&gt;&lt;/city&gt;\n  &lt;administrativearea&gt;&lt;/administrativearea&gt;\n  &lt;postalcode&gt;&lt;/postalcode&gt;\n  &lt;country&gt;&lt;/country&gt;\n&lt;/contactAddress&gt;\n&lt;name&gt;&lt;/name&gt;\n&lt;organization&gt;&lt;/organization&gt;\n&lt;position&gt;&lt;/position&gt;\n&lt;voice&gt;63328915&lt;/voice&gt;\n&lt;fax&gt;&lt;/fax&gt;\n&lt;email&gt;&lt;/email&gt;\n&lt;role&gt;Point of contact&lt;/role&gt;\n      Class 1 The data is for internal use only      0 0     false"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#what-affects-the-morning-peak-trips",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#what-affects-the-morning-peak-trips",
    "title": "Take-home_Ex2",
    "section": "What affects the Morning Peak Trips?",
    "text": "What affects the Morning Peak Trips?\n\nInitial Thinking\n\nno. of busstops (push & pull)\nno of MRT exit (push & pull) - kind of proxy for how crowded this place is, e.g. raffles place has X exits because they serve a big population for work\nBUS Interchange - (push & pull)\nMRT Interchange - (push & pull)\npopulation - push\nPreschool - pull but likely low, because pre-schoolers usually dont take public transport. it is generally near to home. Otherwise, it could be explaning for proximity to amenities or workplace\nPrimarySchool - pull, but likely low. especially if the kids are in lower primary. can also refer to extract from population census, they generally don’t take bus\nSecondarySchool - pull\nJC - pull\nTetiary Education (don’t think they matter for morning peak) like ITE, Poly, Uni - pull but lower effect due to staggered starting time\nretail - pull? likely not much impact?\nBusiness - pull\nF&B - likely low impact because F&B location generally don’t open so early. apart from hawker centre, which people might go nearby to eat before going to work/school? (push???) seldom do we see people taking public transport to specific F&B before work/school. likely more so it is near to their home/destination\nfin service - pull\nlanded area - interesting to see if landed matters\n\n\n\nResidential\n\n\nCode\nhotel_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"HotelLocations-point\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(Name, TOTALROOMS) %&gt;%\n  unique()\n\n\nReading layer `HotelLocations-point' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 429 features and 9 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 103.6351 ymin: 1.245797 xmax: 103.9891 ymax: 1.419278\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(hotel_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Hotel Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nuradwelling_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"URANoofDwellingUnits\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POSTALCODE,PROJ_NAME,PROP_TYPE,DU) %&gt;%\n  mutate(DU = as.numeric(DU),\n         PROP_TYPE = as.factor(PROP_TYPE),\n         population = round(ifelse(PROP_TYPE== \"Landed\",4.4,3.3) * DU )\n         ) %&gt;%\n  unique()\n\n\nReading layer `URANoofDwellingUnits' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 82766 features and 20 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6894 ymin: 1.238105 xmax: 103.9762 ymax: 1.462102\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(uradwelling_sf)+\n  tm_dots(col=\"population\")+\n  tm_layout(main.title = \"URA Dwelling Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nurl &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n\nhdb_raw &lt;- read_csv(\"data/aspatial/hdb_tofind.csv\") %&gt;%\n  mutate(searchname = paste(blk_no,street, sep = \" \"))\n\n\n#initialisation, empty dataframe\nfound &lt;- data.frame()\nnot_found &lt;- data.frame()\n\n\nfor (searchna in hdb_raw$searchname){\n  query &lt;- list('searchVal'=searchna, 'returnGeom' = 'Y', 'getAddrDetails' = 'Y', 'pageNum' = '1')\n  res &lt;- GET(url, query=query)\n  \n  if((content(res)$found) != 0){\n    found &lt;- rbind(found,data.frame(content(res))[4:13])\n  } else {\n    not_found = data.frame(searchna)\n    found &lt;- rbind(found,\"\")\n  }\n}\n\n\n\n\nCode\nmerged &lt;- cbind(hdb_raw,found)\nwrite.csv(merged, file = 'data/aspatial/hdb_tofind_updated.csv')\nwrite.csv(found, file = 'data/aspatial/hdb_found.csv')\nwrite.csv(not_found, file = \"data/aspatial/hdb_notfound.csv\")\n\n\nthereafter we combine our searched result with prof’s prepared hdb dataset. There’s one block that was not found earlier that was 141A Serangoon North Avenue 2. However that’s a multistorey carpark and is not too critical, even though we have added that in for completeness\n\n\nCode\nnewhdb &lt;- read_csv(\"data/aspatial/hdb_updated.csv\") %&gt;%\n  mutate(population = round(\n           `1room_sold` * 2.1+\n           `2room_sold` * 2.1+\n           `3room_sold` * 2.5+\n           `4room_sold` * 3.3+\n           `5room_sold` * 3.7+\n           `exec_sold` * 3.7+\n           `multigen_sold` * 3.7+\n           `studio_apartment_sold`*2.1+\n           `1room_rental` * 2.1+\n           `2room_rental` * 2.1+\n           `3room_rental` * 2.5+\n           `other_room_rental` * 3.3)) %&gt;%\n  filter(population &gt; 0) %&gt;%\n  select(addr, postal,population, max_floor_lvl, total_dwelling_units, lng, lat) %&gt;%\n  unique()\n\nhdb_sf &lt;- st_as_sf(newhdb,\n                   coords = c(\"lng\",\"lat\"),\n                   crs = 4326\n                   ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\n#tmap_mode(\"view\")\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(hdb_sf)+\n  tm_dots(col =  \"population\",\n          palette = \"Reds\")+\n  tm_layout(main.title = \"HDB Block Population Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\n  rm(newhdb)\n  gc()\n\n\n           used  (Mb) gc trigger  (Mb)  max used  (Mb)\nNcells  4490997 239.9    8904178 475.6   8904178 475.6\nVcells 10364162  79.1   41822776 319.1 102106384 779.1\n\n\n\n\nEducation\n\n\nCode\nurl &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n\ncsv &lt;- read_csv(\"data/aspatial/Generalinformationofschools.csv\")\n\n#this is saving the postal_code separately as a list\npostcodes &lt;- csv$`postal_code`\n\n\n#initialisation, empty dataframe\nfound &lt;- data.frame()\nnot_found &lt;- data.frame()\n\n\nfor (postcode in postcodes){\n  query &lt;- list('searchVal'=postcode, 'returnGeom' = 'Y', 'getAddrDetails' = 'Y', 'pageNum' = '1')\n  res &lt;- GET(url, query=query)\n  \n  if((content(res)$found) != 0){\n    found &lt;- rbind(found,data.frame(content(res))[4:13])\n  } else {\n    not_found = data.frame(postcode)\n  }\n}\n\n\n\n\nCode\nmerged = merge(csv, found, by.x = 'postal_code', by.y = 'results.POSTAL', all = TRUE)\nwrite.csv(merged, file = 'data/aspatial/schools.csv')\nwrite.csv(not_found, file = \"data/aspatial/not_found.csv\")\n\n\n\n\nCode\nnewschoolread &lt;- read_csv(\"data/aspatial/schools_updated.csv\") %&gt;%\n  rename(longtitude = results.LONGITUDE,\n         latitude = results.LATITUDE) %&gt;%\n  select(school_name, longtitude, latitude) %&gt;%\n  unique()\n\nschcategory &lt;- read_csv(\"data/aspatial/SchoolCategory.csv\")\n\nnewschoolread2 &lt;- left_join(newschoolread,schcategory)\nrm(newschoolread,schcategory)\n\n\n\n\nCode\nschools_sf &lt;- st_as_sf(newschoolread2,\n                       coords = c(\"longtitude\",\"latitude\"),\n                       crs = 4326\n                       ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\nprisch_sf &lt;- schools_sf %&gt;%\n  filter(level == \"PRIMARY\")\n\nsecjcsch_sf &lt;- schools_sf %&gt;%\n  filter(level != \"PRIMARY\")\n\nrm(newschoolread2)\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(schools_sf)+\n  tm_dots(col =  \"level\")+\n  #tm_shape(prisch_sf)+\n  #tm_dots(col =  \"lightblue\")+\n  #tm_shape(secjcsch_sf)+\n  #tm_dots(col =  \"black\")+\n  tm_layout(main.title = \"Primary, Secondary, JC Schools Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nprivateinstitution_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"PrivateEducationInstitutions\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(NAME_OF_SC,POSTALCODE,STREETNAME) %&gt;%\n  filter(NAME_OF_SC != \"SINGAPORE INSTITUTE OF MANAGEMENT\") %&gt;%\n  unique()\n\n\nReading layer `PrivateEducationInstitutions' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 284 features and 22 fields\nGeometry type: POINT\nDimension:     XYZ\nBounding box:  xmin: 103.6788 ymin: 1.273068 xmax: 103.9437 ymax: 1.4498\nz_range:       zmin: 0 zmax: 0\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(privateinstitution_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Private Education Institution Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\ntetiary &lt;- read_csv(\"data/aspatial/TetiaryEducation.csv\")\n\ntetiary_sf &lt;- st_as_sf(tetiary,\n                       coords = c(\"Long\",\"Lat\"),\n                       crs = 4326\n                       ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid() %&gt;%\n  unique()\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(tetiary_sf)+\n  tm_dots(col = \"Type\",\n          size = 0.5)+\n  tm_layout(main.title = \"Tetiary Education Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\nrm(tetiary)\n\n\n\n\nCode\npreschool_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"PreSchoolsLocation-point\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  unique()\n\n\nReading layer `PreSchoolsLocation-point' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 2290 features and 5 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 103.6878 ymin: 1.247759 xmax: 103.9897 ymax: 1.462134\nGeodetic CRS:  WGS 84\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(preschool_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"PreSchool Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nFood & Entertainment\n\n\nCode\nurl &lt;- \"https://www.onemap.gov.sg/api/common/elastic/search\"\n\ncsv &lt;- read_csv(\"data/aspatial/ListofGovernmentMarketsHawkerCentres.csv\")\n\n#this is saving the postal_code separately as a list\npostcodes &lt;- csv$`postalcode`\n\n\n#initialisation, empty dataframe\nfound &lt;- data.frame()\nnot_found &lt;- data.frame()\n\n\nfor (postcode in postcodes){\n  query &lt;- list('searchVal'=postcode, 'returnGeom' = 'Y', 'getAddrDetails' = 'Y', 'pageNum' = '1')\n  res &lt;- GET(url, query=query)\n  \n  if((content(res)$found) != 0){\n    found &lt;- rbind(found,data.frame(content(res))[4:13])\n  } else {\n    not_found = data.frame(postcode)\n  }\n}\n\n\n\n\nCode\nmerged = merge(csv, found, by.x = 'postalcode', by.y = 'results.POSTAL', all = TRUE)\nwrite.csv(merged, file = 'data/aspatial/hawker.csv')\nwrite.csv(not_found, file = \"data/aspatial/hakwer_notfound.csv\")\n\n\n\n\nCode\nnewhawker &lt;- read_csv(\"data/aspatial/hawker_updated.csv\") %&gt;%\n  rename(longtitude = results.LONGITUDE,\n         latitude = results.LATITUDE,\n         postal_code = postalcode) %&gt;%\n  select(name_of_centre,\n         no_of_stalls, \n         no_of_cooked_food_stalls, \n         no_of_mkt_produce_stalls, \n         longtitude, \n         latitude) %&gt;%\n  unique()\n\nhawker_sf &lt;- st_as_sf(newhawker,\n                       coords = c(\"longtitude\",\"latitude\"),\n                       crs = 4326\n                       ) %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  st_make_valid()\n\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(hawker_sf)+\n  tm_dots(col =  \"no_of_stalls\",\n          palette = \"Reds\",\n          size = 0.2)+\n  tm_layout(main.title = \"Hawker Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\nCode\n  rm(newhawker)\n\n\n\n\nCode\nentertainment_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"entertn\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `entertn' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 114 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 10809.34 ymin: 26528.63 xmax: 41600.62 ymax: 46375.77\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(entertainment_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Entertainment Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nfnb_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"F&B\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `F&B' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1919 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6010.495 ymin: 25343.27 xmax: 45462.43 ymax: 48796.21\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(fnb_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"F&B Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\ntourism_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"TOURISM\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(PAGETITLE) %&gt;%\n  unique()\n\n\nReading layer `TOURISM' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 107 features and 19 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: -1.797693e+308 ymin: -1.797693e+308 xmax: 43659.54 ymax: 47596.73\nProjected CRS: SVY21\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(tourism_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Toursim Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nsilverszone_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Silverzone_Updated\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(SITENAME) %&gt;%\n  unique()\n\n\nReading layer `Silverzone_Updated' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 20 features and 3 fields\nGeometry type: MULTIPOLYGON\nDimension:     XY\nBounding box:  xmin: 15059.67 ymin: 28640.08 xmax: 40994.23 ymax: 46353.94\nProjected CRS: SVY21\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(silverszone_sf)+\n  tm_polygons()+\n  tm_layout(main.title = \"Silverzone Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nleisure_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Liesure&Recreation\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `Liesure&Recreation' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 1217 features and 30 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 6010.495 ymin: 25134.28 xmax: 48439.77 ymax: 50078.88\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(leisure_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Leisure Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nretail_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Retails\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `Retails' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 37635 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 4737.982 ymin: 25171.88 xmax: 48265.04 ymax: 50135.28\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(retail_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Retail Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nWork\n\n\nCode\nfinserv_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"FinServ\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `FinServ' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 3320 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 4881.527 ymin: 25171.88 xmax: 46526.16 ymax: 49338.02\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(finserv_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Financial Service Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\neldercare_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"ELDERCARE\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(NAME) %&gt;%\n  unique()\n\n\nReading layer `ELDERCARE' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 133 features and 18 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 14481.92 ymin: 28218.43 xmax: 41665.14 ymax: 46804.9\nProjected CRS: SVY21\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(eldercare_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Eldercare Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCode\nbusiness_sf &lt;- st_read(dsn = \"data/geospatial\",\n                      layer = \"Business\") %&gt;%\n  st_make_valid() %&gt;%\n  st_transform(crs = 3414) %&gt;%\n  select(POI_NAME) %&gt;%\n  unique()\n\n\nReading layer `Business' from data source \n  `C:\\worksheep\\ISSS624\\Take-home_Ex\\Take-home_Ex2\\data\\geospatial' \n  using driver `ESRI Shapefile'\nSimple feature collection with 6550 features and 3 fields\nGeometry type: POINT\nDimension:     XY\nBounding box:  xmin: 3669.148 ymin: 25408.41 xmax: 47034.83 ymax: 50148.54\nProjected CRS: SVY21 / Singapore TM\n\n\nCode\ntm_shape(sgp_simple)+\n  tm_polygons(col=\"white\", \n              alpha = 0.6,\n              border.alpha = 0.4) +\n  tm_shape(business_sf)+\n  tm_dots()+\n  tm_layout(main.title = \"Business Distribution\",\n            main.title.position = \"center\",\n            main.title.size = 1.2,\n            frame = TRUE) +\n  #tm_borders(alpha = 0.2)+\n  tm_compass(type = \"4star\",\n             size = 2)+\n  tm_scale_bar()+\n  tm_grid(alpha = 0.1)+\n  tm_credits(\"Source: URA, LTA Datamall, DATA.GOV.SG, ONEMAP, TRANSPORT.APP\",\n             position = c(\"left\",\"bottom\"))+\n  tm_view(set.zoom.limits = c(11,16))\n\n\n\n\n\n\n\nCombining the different attributes\n\n\nCode\nsgp_hexid_attr_df &lt;- sgp_hexid_wbs_geo %&gt;%\n  select(hex_id,TOTAL_STOPS) %&gt;%\n  rename(TOTAL_BUS_STOPS = TOTAL_STOPS) %&gt;%\n  mutate(\n    TOTAL_BUS_INT = lengths(st_intersects(.,\n                                          sgbusstop %&gt;%\n                                            filter(Interchange == \"Interchange\")\n                                          )),\n    TOTAL_MRT_INT = lengths(st_intersects(.,\n                                          trainpolygon_sf %&gt;%\n                                            filter(Interchange == 1)\n                                          )),\n    TOTAL_MRT_STN = lengths(st_intersects(.,\n                                          trainpolygon_sf %&gt;%\n                                            filter(TYP_CD_DES == \"MRT\",\n                                                   Interchange == 0)\n                                          )),\n    TOTAL_LRT_STN = lengths(st_intersects(.,\n                                          trainpolygon_sf %&gt;%\n                                            filter(TYP_CD_DES == \"LRT\")\n                                                  )),\n    TOTAL_STN_EXIT = lengths(st_intersects(.,\n                                           trainexitpoint_sf\n                                                  )),    \n    TOTAL_PRE_SCHOOL = lengths(st_intersects(.,\n                                             preschool_sf\n                                                  )),       \n    TOTAL_PRI_SCHOOL = lengths(st_intersects(.,\n                                             prisch_sf\n                                                  )),       \n    TOTAL_SECJC_SCHOOL = lengths(st_intersects(.,\n                                               secjcsch_sf\n                                                  )),       \n    TOTAL_PTE_SCHOOL = lengths(st_intersects(.,\n                                             privateinstitution_sf\n                                                  )),       \n    TOTAL_TET_SCHOOL = lengths(st_intersects(.,\n                                             tetiary_sf\n                                                  )),       \n    TOTAL_FNB = lengths(st_intersects(.,\n                                      fnb_sf\n                                                  )),       \n    TOTAL_ENTERTAINMENT = lengths(st_intersects(.,\n                                                entertainment_sf\n                                                  )),       \n    TOTAL_TOURISM = lengths(st_intersects(.,\n                                          tourism_sf\n                                                  )),       \n    TOTAL_SILVERZONE = lengths(st_intersects(.,\n                                             silverszone_sf\n                                                  )),   \n    TOTAL_LEISURE = lengths(st_intersects(.,\n                                          leisure_sf\n                                                  )),   \n    TOTAL_RETAIL = lengths(st_intersects(.,\n                                         retail_sf\n                                                  )),       \n    TOTAL_FINSERV = lengths(st_intersects(.,\n                                          finserv_sf\n                                                  )),         \n    TOTAL_ELDERCARE = lengths(st_intersects(.,\n                                            eldercare_sf\n                                                  )),         \n    TOTAL_BUSINESS = lengths(st_intersects(.,\n                                           business_sf\n                                                  ))\n  )\n\nhdb_sf_hex &lt;- st_intersection(hdb_sf,sgp_hexid) %&gt;%\n  data.frame() %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(TOTAL_HDB_POP = sum(population),\n            TOTAL_HDB_UNIT = sum(total_dwelling_units))\n\nuradwelling_sf_hex &lt;- st_intersection(uradwelling_sf,sgp_hexid) %&gt;%\n  data.frame() %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(TOTAL_PTE_POP = sum(population),\n            TOTAL_PTE_UNIT = sum(DU))\n\nhotel_sf_hex &lt;- st_intersection(hotel_sf,sgp_hexid) %&gt;%\n  data.frame() %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(TOTAL_HOTEL_ROOM = sum(TOTALROOMS))\n\nhawker_sf_hex &lt;- st_intersection(hawker_sf,sgp_hexid) %&gt;%\n  data.frame() %&gt;%\n  group_by(hex_id) %&gt;%\n  summarise(TOTAL_HAWKER_STALL = sum(no_of_stalls))\n\n\nsgp_hexid_attr_df &lt;- left_join(sgp_hexid_attr_df,hdb_sf_hex)\nsgp_hexid_attr_df &lt;- left_join(sgp_hexid_attr_df,uradwelling_sf_hex)\nsgp_hexid_attr_df &lt;- left_join(sgp_hexid_attr_df,hotel_sf_hex)\nsgp_hexid_attr_df &lt;- left_join(sgp_hexid_attr_df,hawker_sf_hex)\n\nsgp_hexid_attr_df[is.na(sgp_hexid_attr_df)] &lt;- 0\nsgp_hexid_attr_df$TOTAL_BUS_INT &lt;- ifelse(sgp_hexid_attr_df$TOTAL_BUS_INT &gt;1,1,sgp_hexid_attr_df$TOTAL_BUS_INT)\n\n\n\n\n\nCode\nwrite_rds(sgp_hexid_attr_df, \"data/rds/sgp_hexid_attr_df.rds\")\n\n\n\n\n\nDistance\nNext, spDists() of sp package will be used to compute the Euclidean distance between the centroids of the Hexagons\n\n\nCode\nsgp_hexid_wbsclean_matrix &lt;- sgp_hexid_wbs_geo %&gt;%\n  select(hex_id) %&gt;%\n  as(\"Spatial\")\n\ndist_mat &lt;- spDists(sgp_hexid_wbsclean_matrix,\n                    longlat = FALSE)\ncolnames(dist_mat) &lt;- paste0(sgp_hexid_wbsclean_matrix$hex_id)\nrownames(dist_mat) &lt;- paste0(sgp_hexid_wbsclean_matrix$hex_id)\nkable(head(dist_mat, n=c(10,10)))\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nHEX_118\nHEX_146\nHEX_174\nHEX_175\nHEX_200\nHEX_201\nHEX_202\nHEX_203\nHEX_227\nHEX_228\n\n\n\n\nHEX_118\n0.000\n750.000\n2704.163\n3968.627\n1299.038\n2250.000\n3436.932\n4683.748\n1984.313\n3000.000\n\n\nHEX_146\n750.000\n0.000\n1984.313\n3269.174\n750.000\n1500.000\n2704.163\n3968.627\n1299.038\n2250.000\n\n\nHEX_174\n2704.163\n1984.313\n0.000\n1299.038\n1984.313\n750.000\n750.000\n1984.313\n1500.000\n750.000\n\n\nHEX_175\n3968.627\n3269.174\n1299.038\n0.000\n3269.174\n1984.313\n750.000\n750.000\n2704.163\n1500.000\n\n\nHEX_200\n1299.038\n750.000\n1984.313\n3269.174\n0.000\n1299.038\n2598.076\n3897.114\n750.000\n1984.313\n\n\nHEX_201\n2250.000\n1500.000\n750.000\n1984.313\n1299.038\n0.000\n1299.038\n2598.076\n750.000\n750.000\n\n\nHEX_202\n3436.932\n2704.163\n750.000\n750.000\n2598.076\n1299.038\n0.000\n1299.038\n1984.313\n750.000\n\n\nHEX_203\n4683.748\n3968.627\n1984.313\n750.000\n3897.114\n2598.076\n1299.038\n0.000\n3269.174\n1984.313\n\n\nHEX_227\n1984.313\n1299.038\n1500.000\n2704.163\n750.000\n750.000\n1984.313\n3269.174\n0.000\n1299.038\n\n\nHEX_228\n3000.000\n2250.000\n750.000\n1500.000\n1984.313\n750.000\n750.000\n1984.313\n1299.038\n0.000\n\n\n\n\n\nwe see many 750 distance, which is the distance between neighbouring hexagons. This is because we generated the hexagons as such. Thereafter, lets “unpivot” the data. Thereafter, given that commuters can travel within the hexagon as well, we will need to replace the 0 distance with a distance roughly that people will walk ~ 300m\n\n\nCode\ndistPair &lt;- melt(dist_mat) %&gt;%\n  rename(DISTANCE = value,\n         ORIG_HEX_ID = Var1,\n         DEST_HEX_ID = Var2)\n\nkable(head(distPair, 10))\n\n\n\n\n\nORIG_HEX_ID\nDEST_HEX_ID\nDISTANCE\n\n\n\n\nHEX_118\nHEX_118\n0.000\n\n\nHEX_146\nHEX_118\n750.000\n\n\nHEX_174\nHEX_118\n2704.163\n\n\nHEX_175\nHEX_118\n3968.627\n\n\nHEX_200\nHEX_118\n1299.038\n\n\nHEX_201\nHEX_118\n2250.000\n\n\nHEX_202\nHEX_118\n3436.932\n\n\nHEX_203\nHEX_118\n4683.748\n\n\nHEX_227\nHEX_118\n1984.313\n\n\nHEX_228\nHEX_118\n3000.000\n\n\n\n\n\n\n\nCode\ndistPair &lt;- replace_in_dataframe(distPair,\"DISTANCE\",0,300)\nkable(head(distPair, 10))\n\n\n\n\n\nORIG_HEX_ID\nDEST_HEX_ID\nDISTANCE\n\n\n\n\nHEX_118\nHEX_118\n300.000\n\n\nHEX_146\nHEX_118\n750.000\n\n\nHEX_174\nHEX_118\n2704.163\n\n\nHEX_175\nHEX_118\n3968.627\n\n\nHEX_200\nHEX_118\n1299.038\n\n\nHEX_201\nHEX_118\n2250.000\n\n\nHEX_202\nHEX_118\n3436.932\n\n\nHEX_203\nHEX_118\n4683.748\n\n\nHEX_227\nHEX_118\n1984.313\n\n\nHEX_228\nHEX_118\n3000.000\n\n\n\n\n\nCode\nrm(hdb_sf_hex,hotel_sf_hex,uradwelling_sf_hex)\ngc()\n\n\n           used  (Mb) gc trigger  (Mb)  max used  (Mb)\nNcells  4733002 252.8    8904178 475.6   8904178 475.6\nVcells 13002066  99.2   41822776 319.1 102106384 779.1\n\n\n\n\n\nCode\nwrite_rds(distPair, \"data/rds/distPair.rds\")"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#spatial-model",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#spatial-model",
    "title": "Take-home_Ex2",
    "section": "Spatial Model",
    "text": "Spatial Model\n###Replacing 0 We are using a log model, and log(0) is infinity\n\n\nCode\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df,\"TOTAL_BUS_STOPS\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_BUS_INT\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_MRT_INT\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_MRT_STN\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_LRT_STN\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_STN_EXIT\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_PRE_SCHOOL\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_PRI_SCHOOL\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_SECJC_SCHOOL\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_PTE_SCHOOL\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_TET_SCHOOL\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_FNB\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_ENTERTAINMENT\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_TOURISM\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_SILVERZONE\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_LEISURE\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_RETAIL\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_FINSERV\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_ELDERCARE\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_BUSINESS\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_HDB_POP\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_HDB_UNIT\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_PTE_POP\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_PTE_UNIT\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_HOTEL_ROOM\",0,0.5)\nsgp_hexid_attr_df_cali &lt;- replace_in_dataframe(sgp_hexid_attr_df_cali,\"TOTAL_HAWKER_STALL\",0,0.5)\n\n\n\nMerging all\n\n\nCode\nORIGIN_ATTR &lt;- sgp_hexid_attr_df_cali %&gt;%\n  data.frame() %&gt;%\n  select(hex_id,\n         TOTAL_BUS_STOPS,\n         TOTAL_BUS_INT,\n         TOTAL_MRT_INT,\n         TOTAL_MRT_STN,\n         TOTAL_LRT_STN,\n         TOTAL_STN_EXIT,\n         TOTAL_HDB_POP,\n         TOTAL_HOTEL_ROOM,\n         TOTAL_PTE_POP,\n         ) %&gt;%\n  rename(HEX_ID = hex_id) %&gt;%\n  rename_with(~paste(\"ORIG\",.,sep=\"_\"))\n\nDESTINATION_ATTR &lt;- sgp_hexid_attr_df_cali %&gt;%\n  data.frame() %&gt;%\n  select(-c(\n         TOTAL_HDB_POP,\n         TOTAL_HOTEL_ROOM,\n         TOTAL_PTE_POP,\n         TOTAL_HDB_UNIT,\n         TOTAL_PTE_UNIT,\n         geometry)\n         ) %&gt;%\n  rename(HEX_ID = hex_id) %&gt;%\n  rename_with(~paste(\"DEST\",.,sep=\"_\"))\n\n\n\n\nCode\nflowmerge &lt;- flowlines %&gt;%\n  left_join(distPair) %&gt;%\n  left_join(ORIGIN_ATTR) %&gt;%\n  left_join(DESTINATION_ATTR)\n\n\n\n\nCode\nsummary(flowmerge)\n\n\n      OD             TOTAL_TRIPS        ORIG_HEX_ID      DEST_HEX_ID   \n Length:63994       Min.   :    1.0   HEX_1987:  284   HEX_2010:  358  \n Class :character   1st Qu.:    7.0   HEX_2634:  284   HEX_1982:  352  \n Mode  :character   Median :   35.5   HEX_1990:  281   HEX_2009:  339  \n                    Mean   :  341.1   HEX_1849:  271   HEX_1984:  312  \n                    3rd Qu.:  168.0   HEX_2038:  268   HEX_1849:  297  \n                    Max.   :58093.0   HEX_2010:  267   HEX_2634:  292  \n                                      (Other) :62339   (Other) :62044  \n    DISTANCE     ORIG_TOTAL_BUS_STOPS ORIG_TOTAL_BUS_INT ORIG_TOTAL_MRT_INT\n Min.   :  300   Min.   : 1.00        Min.   :0.5000     Min.   :0.5000    \n 1st Qu.: 2704   1st Qu.: 5.00        1st Qu.:0.5000     1st Qu.:0.5000    \n Median : 5250   Median : 8.00        Median :0.5000     Median :0.5000    \n Mean   : 6175   Mean   : 7.89        Mean   :0.5456     Mean   :0.5504    \n 3rd Qu.: 8649   3rd Qu.:10.00        3rd Qu.:0.5000     3rd Qu.:0.5000    \n Max.   :25200   Max.   :20.00        Max.   :1.0000     Max.   :1.0000    \n                                                                           \n ORIG_TOTAL_MRT_STN ORIG_TOTAL_LRT_STN ORIG_TOTAL_STN_EXIT ORIG_TOTAL_HDB_POP\n Min.   :0.5000     Min.   :0.5000     Min.   : 0.500      Min.   :    0.5   \n 1st Qu.:0.5000     1st Qu.:0.5000     1st Qu.: 0.500      1st Qu.:    0.5   \n Median :0.5000     Median :0.5000     Median : 0.500      Median : 3531.0   \n Mean   :0.6802     Mean   :0.5387     Mean   : 1.567      Mean   : 5955.9   \n 3rd Qu.:1.0000     3rd Qu.:0.5000     3rd Qu.: 2.000      3rd Qu.:10908.0   \n Max.   :2.0000     Max.   :3.0000     Max.   :19.000      Max.   :27784.0   \n                                                                             \n ORIG_TOTAL_HOTEL_ROOM ORIG_TOTAL_PTE_POP DEST_TOTAL_BUS_STOPS\n Min.   :   0.5        Min.   :    0.5    Min.   : 1.000      \n 1st Qu.:   0.5        1st Qu.:    0.5    1st Qu.: 5.000      \n Median :   0.5        Median : 1503.0    Median : 8.000      \n Mean   : 181.2        Mean   : 2499.1    Mean   : 7.816      \n 3rd Qu.:   0.5        3rd Qu.: 3926.0    3rd Qu.:10.000      \n Max.   :4594.0        Max.   :18271.0    Max.   :20.000      \n                                                              \n DEST_TOTAL_BUS_INT DEST_TOTAL_MRT_INT DEST_TOTAL_MRT_STN DEST_TOTAL_LRT_STN\n Min.   :0.5000     Min.   :0.5000     Min.   :0.500      Min.   :0.5000    \n 1st Qu.:0.5000     1st Qu.:0.5000     1st Qu.:0.500      1st Qu.:0.5000    \n Median :0.5000     Median :0.5000     Median :0.500      Median :0.5000    \n Mean   :0.5431     Mean   :0.5571     Mean   :0.692      Mean   :0.5342    \n 3rd Qu.:0.5000     3rd Qu.:0.5000     3rd Qu.:1.000      3rd Qu.:0.5000    \n Max.   :1.0000     Max.   :1.0000     Max.   :2.000      Max.   :3.0000    \n                                                                            \n DEST_TOTAL_STN_EXIT DEST_TOTAL_PRE_SCHOOL DEST_TOTAL_PRI_SCHOOL\n Min.   : 0.500      Min.   : 0.500        Min.   :0.5000       \n 1st Qu.: 0.500      1st Qu.: 1.000        1st Qu.:0.5000       \n Median : 0.500      Median : 3.000        Median :0.5000       \n Mean   : 1.705      Mean   : 3.859        Mean   :0.6489       \n 3rd Qu.: 2.000      3rd Qu.: 6.000        3rd Qu.:0.5000       \n Max.   :19.000      Max.   :19.000        Max.   :2.0000       \n                                                                \n DEST_TOTAL_SECJC_SCHOOL DEST_TOTAL_PTE_SCHOOL DEST_TOTAL_TET_SCHOOL\n Min.   :0.5000          Min.   : 0.500        Min.   :0.5000       \n 1st Qu.:0.5000          1st Qu.: 0.500        1st Qu.:0.5000       \n Median :0.5000          Median : 0.500        Median :0.5000       \n Mean   :0.6554          Mean   : 1.215        Mean   :0.5118       \n 3rd Qu.:0.5000          3rd Qu.: 0.500        3rd Qu.:0.5000       \n Max.   :3.0000          Max.   :19.000        Max.   :1.0000       \n                                                                    \n DEST_TOTAL_FNB    DEST_TOTAL_ENTERTAINMENT DEST_TOTAL_TOURISM\n Min.   :  0.500   Min.   : 0.5000          Min.   : 0.5000   \n 1st Qu.:  0.500   1st Qu.: 0.5000          1st Qu.: 0.5000   \n Median :  0.500   Median : 0.5000          Median : 0.5000   \n Mean   :  6.121   Mean   : 0.7633          Mean   : 0.7297   \n 3rd Qu.:  2.000   3rd Qu.: 0.5000          3rd Qu.: 0.5000   \n Max.   :127.000   Max.   :13.0000          Max.   :12.0000   \n                                                              \n DEST_TOTAL_SILVERZONE DEST_TOTAL_LEISURE DEST_TOTAL_RETAIL DEST_TOTAL_FINSERV\n Min.   :0.5000        Min.   : 0.500     Min.   :   0.50   Min.   :  0.50    \n 1st Qu.:0.5000        1st Qu.: 0.500     1st Qu.:   7.00   1st Qu.:  0.50    \n Median :0.5000        Median : 1.000     Median :  29.00   Median :  3.00    \n Mean   :0.5537        Mean   : 2.621     Mean   :  96.74   Mean   :  8.39    \n 3rd Qu.:0.5000        3rd Qu.: 3.000     3rd Qu.:  97.00   3rd Qu.:  8.00    \n Max.   :3.0000        Max.   :35.000     Max.   :1422.00   Max.   :162.00    \n                                                                              \n DEST_TOTAL_ELDERCARE DEST_TOTAL_BUSINESS DEST_TOTAL_HAWKER_STALL\n Min.   :0.500        Min.   :  0.500     Min.   :   0.50        \n 1st Qu.:0.500        1st Qu.:  0.500     1st Qu.:   0.50        \n Median :0.500        Median :  1.000     Median :   0.50        \n Mean   :0.695        Mean   :  7.611     Mean   :  32.84        \n 3rd Qu.:0.500        3rd Qu.:  7.000     3rd Qu.:   0.50        \n Max.   :5.000        Max.   :126.000     Max.   :1084.00        \n                                                                 \n          geometry    \n LINESTRING   :63388  \n POINT        :  606  \n epsg:3414    :    0  \n +proj=tmer...:    0  \n                      \n                      \n                      \n\n\n\n\n\nCode\nwrite_rds(flowmerge, \"data/rds/flowmerge.rds\")\n\n\n\n\n\nInterzonal Analysis\n\nUncontraint\n#|eval: false\nrm(list = ls())\nflowmerge_interzonal &lt;- read_rds(\"data/rds/flowmerge.rds\") %&gt;%\n  filter(ORIG_HEX_ID != DEST_HEX_ID)\n\nunconstraint &lt;- glm(\n  formula = TOTAL_TRIPS ~\n#  ORIG_HEX_ID +\n#  DEST_HEX_ID + \n  log(DISTANCE) +\n  log(ORIG_TOTAL_BUS_STOPS) +\n  log(ORIG_TOTAL_BUS_INT) +\n  log(ORIG_TOTAL_MRT_INT) +\n  log(ORIG_TOTAL_MRT_STN) +\n  log(ORIG_TOTAL_LRT_STN) +\n  log(ORIG_TOTAL_STN_EXIT) +\n  log(ORIG_TOTAL_HDB_POP) +\n  log(ORIG_TOTAL_HOTEL_ROOM) +\n  log(ORIG_TOTAL_PTE_POP) +\n  log(DEST_TOTAL_BUS_STOPS) +\n  log(DEST_TOTAL_BUS_INT) +\n  log(DEST_TOTAL_MRT_INT) +\n  log(DEST_TOTAL_MRT_STN) +\n  log(DEST_TOTAL_LRT_STN) +\n  log(DEST_TOTAL_STN_EXIT) +\n  log(DEST_TOTAL_PRE_SCHOOL) +\n  log(DEST_TOTAL_PRI_SCHOOL) +\n  log(DEST_TOTAL_SECJC_SCHOOL) +\n  log(DEST_TOTAL_PTE_SCHOOL) +\n  log(DEST_TOTAL_TET_SCHOOL) +\n  log(DEST_TOTAL_HAWKER_STALL) +\n  log(DEST_TOTAL_FNB) +\n  log(DEST_TOTAL_ENTERTAINMENT) +\n  log(DEST_TOTAL_TOURISM) +\n  log(DEST_TOTAL_SILVERZONE) +\n  log(DEST_TOTAL_LEISURE) +\n  log(DEST_TOTAL_RETAIL) +\n  log(DEST_TOTAL_FINSERV) +\n  log(DEST_TOTAL_ELDERCARE) +\n  log(DEST_TOTAL_BUSINESS),\n  family = poisson(link = \"log\"),\n  data = flowmerge_interzonal,\n  na.action = na.exclude\n  )\n\nwrite_rds(unconstraint, \"data/rds/unconstraint.rds\")\n\n\nCode\nunconstraint &lt;- read_rds(\"data/rds/unconstraint.rds\")\nsummary(unconstraint)\n\n\n\nCall:\nglm(formula = TOTAL_TRIPS ~ log(DISTANCE) + log(ORIG_TOTAL_BUS_STOPS) + \n    log(ORIG_TOTAL_BUS_INT) + log(ORIG_TOTAL_MRT_INT) + log(ORIG_TOTAL_MRT_STN) + \n    log(ORIG_TOTAL_LRT_STN) + log(ORIG_TOTAL_STN_EXIT) + log(ORIG_TOTAL_HDB_POP) + \n    log(ORIG_TOTAL_HOTEL_ROOM) + log(ORIG_TOTAL_PTE_POP) + log(DEST_TOTAL_BUS_STOPS) + \n    log(DEST_TOTAL_BUS_INT) + log(DEST_TOTAL_MRT_INT) + log(DEST_TOTAL_MRT_STN) + \n    log(DEST_TOTAL_LRT_STN) + log(DEST_TOTAL_STN_EXIT) + log(DEST_TOTAL_PRE_SCHOOL) + \n    log(DEST_TOTAL_PRI_SCHOOL) + log(DEST_TOTAL_SECJC_SCHOOL) + \n    log(DEST_TOTAL_PTE_SCHOOL) + log(DEST_TOTAL_TET_SCHOOL) + \n    log(DEST_TOTAL_HAWKER_STALL) + log(DEST_TOTAL_FNB) + log(DEST_TOTAL_ENTERTAINMENT) + \n    log(DEST_TOTAL_TOURISM) + log(DEST_TOTAL_SILVERZONE) + log(DEST_TOTAL_LEISURE) + \n    log(DEST_TOTAL_RETAIL) + log(DEST_TOTAL_FINSERV) + log(DEST_TOTAL_ELDERCARE) + \n    log(DEST_TOTAL_BUSINESS), family = poisson(link = \"log\"), \n    data = flowmerge_interzonal, na.action = na.exclude)\n\nCoefficients:\n                                Estimate Std. Error  z value Pr(&gt;|z|)    \n(Intercept)                    1.526e+01  3.901e-03  3911.76   &lt;2e-16 ***\nlog(DISTANCE)                 -1.412e+00  2.716e-04 -5199.10   &lt;2e-16 ***\nlog(ORIG_TOTAL_BUS_STOPS)      5.100e-01  5.634e-04   905.14   &lt;2e-16 ***\nlog(ORIG_TOTAL_BUS_INT)        9.648e-01  1.018e-03   948.06   &lt;2e-16 ***\nlog(ORIG_TOTAL_MRT_INT)       -9.740e-01  1.690e-03  -576.46   &lt;2e-16 ***\nlog(ORIG_TOTAL_MRT_STN)       -3.958e-01  1.107e-03  -357.46   &lt;2e-16 ***\nlog(ORIG_TOTAL_LRT_STN)       -1.500e-01  1.028e-03  -145.92   &lt;2e-16 ***\nlog(ORIG_TOTAL_STN_EXIT)       2.434e-01  5.041e-04   482.78   &lt;2e-16 ***\nlog(ORIG_TOTAL_HDB_POP)        1.034e-01  7.500e-05  1378.01   &lt;2e-16 ***\nlog(ORIG_TOTAL_HOTEL_ROOM)    -2.351e-02  1.212e-04  -193.93   &lt;2e-16 ***\nlog(ORIG_TOTAL_PTE_POP)       -9.146e-03  5.856e-05  -156.17   &lt;2e-16 ***\nlog(DEST_TOTAL_BUS_STOPS)      1.742e-01  5.409e-04   322.01   &lt;2e-16 ***\nlog(DEST_TOTAL_BUS_INT)        1.120e+00  9.766e-04  1146.69   &lt;2e-16 ***\nlog(DEST_TOTAL_MRT_INT)       -4.676e-01  1.553e-03  -301.00   &lt;2e-16 ***\nlog(DEST_TOTAL_MRT_STN)       -1.575e-01  1.050e-03  -150.02   &lt;2e-16 ***\nlog(DEST_TOTAL_LRT_STN)       -4.996e-01  1.094e-03  -456.88   &lt;2e-16 ***\nlog(DEST_TOTAL_STN_EXIT)       3.719e-01  5.110e-04   727.84   &lt;2e-16 ***\nlog(DEST_TOTAL_PRE_SCHOOL)    -3.670e-02  3.118e-04  -117.74   &lt;2e-16 ***\nlog(DEST_TOTAL_PRI_SCHOOL)     9.000e-02  6.450e-04   139.55   &lt;2e-16 ***\nlog(DEST_TOTAL_SECJC_SCHOOL)   2.863e-01  6.310e-04   453.73   &lt;2e-16 ***\nlog(DEST_TOTAL_PTE_SCHOOL)     6.588e-03  4.394e-04    14.99   &lt;2e-16 ***\nlog(DEST_TOTAL_TET_SCHOOL)     9.544e-01  1.726e-03   553.02   &lt;2e-16 ***\nlog(DEST_TOTAL_HAWKER_STALL)  -1.631e-03  1.231e-04   -13.25   &lt;2e-16 ***\nlog(DEST_TOTAL_FNB)           -5.877e-02  2.834e-04  -207.38   &lt;2e-16 ***\nlog(DEST_TOTAL_ENTERTAINMENT)  1.110e-02  6.910e-04    16.06   &lt;2e-16 ***\nlog(DEST_TOTAL_TOURISM)       -7.753e-02  8.718e-04   -88.93   &lt;2e-16 ***\nlog(DEST_TOTAL_SILVERZONE)     1.572e-01  9.552e-04   164.60   &lt;2e-16 ***\nlog(DEST_TOTAL_LEISURE)       -6.154e-02  3.041e-04  -202.38   &lt;2e-16 ***\nlog(DEST_TOTAL_RETAIL)         5.545e-02  2.508e-04   221.08   &lt;2e-16 ***\nlog(DEST_TOTAL_FINSERV)        9.260e-02  3.325e-04   278.48   &lt;2e-16 ***\nlog(DEST_TOTAL_ELDERCARE)     -1.255e-01  5.449e-04  -230.34   &lt;2e-16 ***\nlog(DEST_TOTAL_BUSINESS)       8.648e-02  1.870e-04   462.48   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 80303496  on 63387  degrees of freedom\nResidual deviance: 36264100  on 63356  degrees of freedom\nAIC: 36608352\n\nNumber of Fisher Scoring iterations: 6\n\n\n\n\nOrigin Constraint\n#|eval: false\n\nrm(list = ls())\nflowmerge_interzonal &lt;- read_rds(\"data/rds/flowmerge.rds\") %&gt;%\n  filter(ORIG_HEX_ID != DEST_HEX_ID)\n\norigin_cons &lt;- glm(\n  formula = TOTAL_TRIPS ~\n  ORIG_HEX_ID +\n#  DEST_HEX_ID + \n  log(DISTANCE) +\n#  log(ORIG_TOTAL_BUS_STOPS) +\n#  log(ORIG_TOTAL_BUS_INT) +\n#  log(ORIG_TOTAL_MRT_INT) +\n#  log(ORIG_TOTAL_MRT_STN) +\n#  log(ORIG_TOTAL_LRT_STN) +\n#  log(ORIG_TOTAL_STN_EXIT) +\n#  log(ORIG_TOTAL_HDB_POP) +\n#  log(ORIG_TOTAL_HOTEL_ROOM) +\n#  log(ORIG_TOTAL_PTE_POP) +\n  log(DEST_TOTAL_BUS_STOPS) +\n  log(DEST_TOTAL_BUS_INT) +\n  log(DEST_TOTAL_MRT_INT) +\n  log(DEST_TOTAL_MRT_STN) +\n  log(DEST_TOTAL_LRT_STN) +\n  log(DEST_TOTAL_STN_EXIT) +\n  log(DEST_TOTAL_PRE_SCHOOL) +\n  log(DEST_TOTAL_PRI_SCHOOL) +\n  log(DEST_TOTAL_SECJC_SCHOOL) +\n  log(DEST_TOTAL_PTE_SCHOOL) +\n  log(DEST_TOTAL_TET_SCHOOL) +\n  log(DEST_TOTAL_HAWKER_STALL) +\n  log(DEST_TOTAL_FNB) +\n  log(DEST_TOTAL_ENTERTAINMENT) +\n  log(DEST_TOTAL_TOURISM) +\n  log(DEST_TOTAL_SILVERZONE) +\n  log(DEST_TOTAL_LEISURE) +\n  log(DEST_TOTAL_RETAIL) +\n  log(DEST_TOTAL_FINSERV) +\n  log(DEST_TOTAL_ELDERCARE) +\n  log(DEST_TOTAL_BUSINESS),\n  family = poisson(link = \"log\"),\n  data = flowmerge_interzonal,\n  na.action = na.exclude\n  )\n\nwrite_rds(origin_cons, \"data/rds/origin_cons.rds\")\n\n\nCode\norigin_cons &lt;- read_rds(\"data/rds/origin_cons.rds\")\nsummary(origin_cons)\n\n\n\nCall:\nglm(formula = TOTAL_TRIPS ~ ORIG_HEX_ID + log(DISTANCE) + log(DEST_TOTAL_BUS_STOPS) + \n    log(DEST_TOTAL_BUS_INT) + log(DEST_TOTAL_MRT_INT) + log(DEST_TOTAL_MRT_STN) + \n    log(DEST_TOTAL_LRT_STN) + log(DEST_TOTAL_STN_EXIT) + log(DEST_TOTAL_PRE_SCHOOL) + \n    log(DEST_TOTAL_PRI_SCHOOL) + log(DEST_TOTAL_SECJC_SCHOOL) + \n    log(DEST_TOTAL_PTE_SCHOOL) + log(DEST_TOTAL_TET_SCHOOL) + \n    log(DEST_TOTAL_HAWKER_STALL) + log(DEST_TOTAL_FNB) + log(DEST_TOTAL_ENTERTAINMENT) + \n    log(DEST_TOTAL_TOURISM) + log(DEST_TOTAL_SILVERZONE) + log(DEST_TOTAL_LEISURE) + \n    log(DEST_TOTAL_RETAIL) + log(DEST_TOTAL_FINSERV) + log(DEST_TOTAL_ELDERCARE) + \n    log(DEST_TOTAL_BUSINESS), family = poisson(link = \"log\"), \n    data = flowmerge_interzonal, na.action = na.exclude)\n\nCoefficients:\n                                Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)                   13.1553578  0.1250457   105.204  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1014            3.4614394  0.1254773    27.586  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1015            4.2340765  0.1252408    33.807  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1016            4.3421721  0.1251066    34.708  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1042            4.0811315  0.1252947    32.572  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1043            4.6714218  0.1251018    37.341  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1045            1.6414507  0.1314990    12.483  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1067            3.1396749  0.1259071    24.936  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1068            2.0773226  0.1281480    16.210  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1069            1.7981042  0.1268312    14.177  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1070            4.9360751  0.1250578    39.470  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1078            1.1018624  0.1468930     7.501 6.33e-14 ***\nORIG_HEX_IDHEX_1093            1.0941109  0.1356006     8.069 7.11e-16 ***\nORIG_HEX_IDHEX_1094            4.3322563  0.1251750    34.610  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1095            1.0847978  0.1284323     8.446  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1096            4.5731266  0.1250773    36.562  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1097            4.8156156  0.1251129    38.490  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1099            6.1260709  0.1250414    48.992  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1100            2.6036377  0.1321760    19.698  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1122            5.0684102  0.1250722    40.524  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1123            5.4187533  0.1250312    43.339  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1124            4.5622707  0.1250933    36.471  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1125            5.2243177  0.1250771    41.769  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1126            4.3788210  0.1257111    34.832  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1127            5.1159812  0.1250682    40.906  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1128            5.2289531  0.1251320    41.787  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1132           -0.6915801  0.2294824    -3.014 0.002581 ** \nORIG_HEX_IDHEX_1147           -0.0340286  0.1510606    -0.225 0.821774    \nORIG_HEX_IDHEX_1148            3.5821864  0.1253171    28.585  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1149            2.6643816  0.1256625    21.203  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1150            5.3175869  0.1250381    42.528  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1151            4.9083612  0.1250566    39.249  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1152            4.9820490  0.1250818    39.830  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1153            5.8016149  0.1250508    46.394  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1154            5.7142938  0.1250369    45.701  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1155            2.0814083  0.1291740    16.113  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1158            3.5923100  0.1258097    28.554  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1174            1.5478899  0.1315515    11.766  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1175            2.2318717  0.1292443    17.269  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1176            4.0241987  0.1251452    32.156  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1177            2.9244342  0.1254504    23.311  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1178            4.7527582  0.1250706    38.001  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1179            4.3235124  0.1251272    34.553  &lt; 2e-16 ***\nORIG_HEX_IDHEX_118             1.5394214  0.1789381     8.603  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1180            3.7413491  0.1252754    29.865  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1181            4.9938619  0.1250617    39.931  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1182            5.1312728  0.1250935    41.020  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1183            5.7889839  0.1251441    46.259  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1185            2.1980335  0.1277088    17.211  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1201            2.0271580  0.1297477    15.624  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1202            3.8983479  0.1252326    31.129  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1203            2.4412825  0.1262592    19.335  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1205            5.3481612  0.1250352    42.773  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1206            4.6202024  0.1251175    36.927  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1207            4.3917698  0.1251207    35.100  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1209            4.9943519  0.1251505    39.907  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1210            2.3495476  0.1281554    18.334  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1211            1.8843109  0.1285252    14.661  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1212            1.2948065  0.1313636     9.857  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1228            1.2204989  0.1345606     9.070  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1229            2.3596101  0.1262563    18.689  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1230            3.8331943  0.1252161    30.613  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1231            5.0483796  0.1251415    40.341  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1232            5.1419234  0.1250416    41.122  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1233            4.7375841  0.1251567    37.853  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1235            5.0936205  0.1250908    40.719  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1236            3.6573927  0.1253129    29.186  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1237            4.3382999  0.1252129    34.647  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1238            1.6839695  0.1293495    13.019  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1239           -0.0634748  0.1717968    -0.369 0.711773    \nORIG_HEX_IDHEX_1240            0.6457962  0.1712434     3.771 0.000162 ***\nORIG_HEX_IDHEX_1255            3.8079245  0.1257469    30.282  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1256            3.0407968  0.1254638    24.236  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1257            2.3494556  0.1262207    18.614  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1258            4.0347959  0.1252277    32.220  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1259            4.8026371  0.1250709    38.399  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1261            4.7606791  0.1250752    38.063  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1262            4.9738905  0.1250756    39.767  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1263            2.5056556  0.1265199    19.804  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1264            3.4840958  0.1256906    27.720  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1265            1.1623066  0.1303148     8.919  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1266            2.5474039  0.1271014    20.042  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1282            3.8742885  0.1256384    30.837  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1283            4.4219453  0.1250900    35.350  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1284            4.0427488  0.1251673    32.299  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1285            2.6532464  0.1258011    21.091  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1286            4.2544167  0.1251105    34.005  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1287            4.2749901  0.1251794    34.151  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1288            1.6104150  0.1271972    12.661  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1289            4.9832004  0.1250553    39.848  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1293            1.0097877  0.1411938     7.152 8.57e-13 ***\nORIG_HEX_IDHEX_1308            2.8631902  0.1259897    22.726  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1309            5.0280383  0.1250659    40.203  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1310            5.9545848  0.1250172    47.630  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1311            2.5600419  0.1270034    20.157  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1312            2.7928949  0.1258550    22.191  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1314            3.5911716  0.1253185    28.656  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1315            5.3995180  0.1250391    43.183  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1316            4.6676796  0.1252177    37.277  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1318            1.8599662  0.1356288    13.714  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1319            5.6275350  0.1250611    44.998  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1320            4.7183621  0.1253704    37.635  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1335           -0.7068978  0.2325658    -3.040 0.002369 ** \nORIG_HEX_IDHEX_1336            3.6779855  0.1252522    29.365  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1337            4.8961917  0.1250445    39.156  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1338            3.8791856  0.1252682    30.967  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1339            2.2309078  0.1274733    17.501  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1340            2.5763765  0.1258876    20.466  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1341            4.1542617  0.1251624    33.191  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1342            2.8773547  0.1256026    22.908  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1343            5.0499325  0.1250754    40.375  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1347            1.7620584  0.1287614    13.685  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1348            5.8431252  0.1250449    46.728  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1362            3.2935541  0.1253556    26.274  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1363            4.0040559  0.1251663    31.990  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1364            4.2204902  0.1251144    33.733  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1366            4.3080633  0.1251238    34.430  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1367            2.3686429  0.1262107    18.767  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1368            3.2040660  0.1256658    25.497  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1369            5.4491687  0.1250445    43.578  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1370            6.0548474  0.1250656    48.413  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1372            0.6762331  0.2238488     3.021 0.002520 ** \nORIG_HEX_IDHEX_1374            3.9002371  0.1252158    31.148  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1375            5.6882752  0.1250613    45.484  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1389            3.3560866  0.1254028    26.762  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1390            1.5486290  0.1289274    12.012  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1391            2.6623417  0.1255796    21.200  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1392            3.5984328  0.1252416    28.732  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1394            3.6813691  0.1252981    29.381  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1396            4.7409048  0.1252231    37.860  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1397            4.6297577  0.1252560    36.962  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1401            5.1357624  0.1250634    41.065  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1402            5.2733709  0.1250543    42.169  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1416           -1.3058562  0.3042188    -4.292 1.77e-05 ***\nORIG_HEX_IDHEX_1417            2.0410694  0.1274677    16.012  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1418            3.2710979  0.1256518    26.033  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1419            2.7580694  0.1257031    21.941  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1420            4.6274560  0.1250874    36.994  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1422            1.9964215  0.1298053    15.380  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1423            6.9227674  0.1251030    55.337  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1426            3.4766094  0.1264527    27.493  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1428            4.5118060  0.1250996    36.066  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1429            4.5837448  0.1251455    36.627  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1443            2.2586725  0.1260965    17.912  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1444            1.0016015  0.1289388     7.768 7.97e-15 ***\nORIG_HEX_IDHEX_1445            4.3731375  0.1251306    34.949  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1446            2.7174605  0.1256927    21.620  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1447            4.1170063  0.1251316    32.901  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1455            3.9463028  0.1252747    31.501  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1456            4.4863173  0.1251020    35.861  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1457            0.4627392  0.1396471     3.314 0.000921 ***\nORIG_HEX_IDHEX_146             2.2387123  0.1971832    11.353  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1469            4.4988736  0.1251182    35.957  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1470            3.8297231  0.1251806    30.594  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1471            4.6353565  0.1250706    37.062  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1472            2.8287530  0.1255933    22.523  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1480            0.0381688  0.1932993     0.197 0.843468    \nORIG_HEX_IDHEX_1482            4.4360970  0.1250905    35.463  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1483            4.7680674  0.1251253    38.106  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1496            2.6907251  0.1260316    21.350  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1497            0.6974646  0.1384611     5.037 4.72e-07 ***\nORIG_HEX_IDHEX_1498            3.1031812  0.1253028    24.765  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1499            4.4737005  0.1250948    35.762  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1500            1.5876576  0.1281968    12.385  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1501            3.7447978  0.1252282    29.904  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1507            1.2296573  0.1481703     8.299  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1509            3.9062691  0.1252381    31.191  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1510            6.1886945  0.1250161    49.503  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1511            4.3259721  0.1252728    34.532  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1523            1.1592271  0.1348676     8.595  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1524            1.6098990  0.1312361    12.267  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1525            4.6673034  0.1250550    37.322  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1526            2.1499625  0.1261579    17.042  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1527            0.8602647  0.1366539     6.295 3.07e-10 ***\nORIG_HEX_IDHEX_1534            0.2854530  0.1691524     1.688 0.091498 .  \nORIG_HEX_IDHEX_1536            4.8727384  0.1250672    38.961  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1537            4.2257055  0.1251691    33.760  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1550            3.4971465  0.1253956    27.889  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1551            1.7490960  0.1271905    13.752  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1552            1.4726406  0.1275957    11.541  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1553            3.7169976  0.1251589    29.698  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1554            2.5187553  0.1259747    19.994  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1555            2.5298953  0.1258559    20.102  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1562            2.2689579  0.1371134    16.548  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1563            4.5766165  0.1252434    36.542  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1564            5.4109971  0.1250371    43.275  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1565            4.4838784  0.1252619    35.796  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1576            2.7656057  0.1282222    21.569  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1578            2.3967309  0.1255929    19.083  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1579            4.7282077  0.1250571    37.808  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1581            3.7772864  0.1252028    30.169  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1588            1.9643080  0.1610440    12.197  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1590            5.5433165  0.1250445    44.331  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1591            5.2011790  0.1250634    41.588  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1592            2.0939357  0.1278993    16.372  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1604            2.6981623  0.1255384    21.493  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1605            4.0258975  0.1251065    32.180  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1606            3.6343708  0.1251633    29.037  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1607            2.7809970  0.1254200    22.173  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1616            1.9960478  0.1348199    14.805  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1617            4.0272245  0.1253881    32.118  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1618            5.5682692  0.1250404    44.532  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1619            4.3248210  0.1251868    34.547  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1620            2.1692726  0.1278038    16.973  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1630            2.3039596  0.1260498    18.278  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1631            3.0849742  0.1253111    24.619  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1632            4.2949048  0.1251031    34.331  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1633            2.9781336  0.1254066    23.748  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1634            4.1425792  0.1251341    33.105  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1635            2.2777987  0.1260138    18.076  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1642           -0.1911079  0.2514845    -0.760 0.447303    \nORIG_HEX_IDHEX_1644            4.5198254  0.1251773    36.107  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1645            5.0651329  0.1250718    40.498  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1646            3.4528898  0.1255614    27.500  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1647           -1.8475235  0.5153884    -3.585 0.000337 ***\nORIG_HEX_IDHEX_1658            4.6791505  0.1251329    37.393  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1659            4.1470379  0.1250930    33.152  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1660            3.0441698  0.1258224    24.194  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1661            2.5857373  0.1256966    20.571  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1662            3.7140405  0.1252063    29.663  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1669           -0.4841204  0.2795097    -1.732 0.083267 .  \nORIG_HEX_IDHEX_1670            1.3738098  0.1534993     8.950  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1672            4.6579814  0.1253523    37.159  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1673            4.1211190  0.1258261    32.752  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1674            3.5593618  0.1256027    28.338  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1684            4.5225437  0.1250845    36.156  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1685            3.5251236  0.1252112    28.153  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1686            3.9958797  0.1251126    31.938  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1687            1.4208717  0.1274572    11.148  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1688            1.6546742  0.1266585    13.064  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1689            1.5374348  0.1368610    11.234  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1695           -1.5126165  0.3560010    -4.249 2.15e-05 ***\nORIG_HEX_IDHEX_1699            4.2988265  0.1251406    34.352  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1700            0.5467828  0.1428640     3.827 0.000130 ***\nORIG_HEX_IDHEX_1701            2.4337096  0.1287151    18.908  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1712            3.4995268  0.1252546    27.939  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1713            4.5224167  0.1250616    36.162  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1714            1.7930363  0.1269082    14.129  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1716            3.5584462  0.1252091    28.420  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1723            1.7832881  0.1355461    13.156  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1726            1.9907182  0.1290553    15.425  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1727            5.1388204  0.1250802    41.084  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1728            3.0211782  0.1257773    24.020  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1738            2.9359104  0.1253660    23.419  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1739            3.9742883  0.1251004    31.769  &lt; 2e-16 ***\nORIG_HEX_IDHEX_174             1.4208536  0.1971828     7.206 5.77e-13 ***\nORIG_HEX_IDHEX_1740            2.6913274  0.1254630    21.451  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1741            2.8642508  0.1254717    22.828  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1743            1.4363968  0.1313448    10.936  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1744           -0.4704568  0.2188228    -2.150 0.031560 *  \nORIG_HEX_IDHEX_1748           -1.0333945  0.2294827    -4.503 6.70e-06 ***\nORIG_HEX_IDHEX_1749            4.6576251  0.1251698    37.210  &lt; 2e-16 ***\nORIG_HEX_IDHEX_175             0.2224399  0.1696561     1.311 0.189817    \nORIG_HEX_IDHEX_1753            5.5163305  0.1250521    44.112  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1754            4.3397296  0.1251600    34.673  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1764            0.4115215  0.1971835     2.087 0.036888 *  \nORIG_HEX_IDHEX_1765            4.6924264  0.1250819    37.515  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1766            4.6933943  0.1250684    37.527  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1767            4.2161395  0.1250799    33.708  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1768            0.5657432  0.1307026     4.328 1.50e-05 ***\nORIG_HEX_IDHEX_1770            2.2435600  0.1261876    17.780  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1771            0.7887436  0.1365521     5.776 7.64e-09 ***\nORIG_HEX_IDHEX_1776           -0.6564244  0.1932990    -3.396 0.000684 ***\nORIG_HEX_IDHEX_1777            3.4230437  0.1255809    27.258  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1778            1.4120158  0.1299415    10.867  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1780            2.7595709  0.1260962    21.885  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1781            5.1193139  0.1250675    40.932  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1791           -0.2142112  0.3400405    -0.630 0.528722    \nORIG_HEX_IDHEX_1792            4.0432467  0.1251234    32.314  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1793            4.7191694  0.1250470    37.739  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1794            3.4358232  0.1251877    27.445  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1795            2.4589249  0.1255669    19.583  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1796            3.3099525  0.1253986    26.395  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1798           -1.3245012  0.2265824    -5.846 5.05e-09 ***\nORIG_HEX_IDHEX_1800            1.3260872  0.1312357    10.105  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1802            0.5054093  0.1420236     3.559 0.000373 ***\nORIG_HEX_IDHEX_1804           -0.6905143  0.1829821    -3.774 0.000161 ***\nORIG_HEX_IDHEX_1805            3.1024099  0.1255589    24.709  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1806            4.3561195  0.1251474    34.808  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1807            4.4308887  0.1251149    35.415  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1808            2.0856338  0.1292482    16.137  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1820            4.2337027  0.1250931    33.844  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1821            4.7051339  0.1250463    37.627  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1822            2.5500631  0.1254576    20.326  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1823            2.5886124  0.1257264    20.589  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1824            3.9254035  0.1251488    31.366  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1827            3.8079220  0.1252077    30.413  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1828            3.3973216  0.1253896    27.094  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1829            3.1964915  0.1255395    25.462  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1831            2.6105783  0.1265554    20.628  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1833            5.1798344  0.1250501    41.422  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1834            4.1227907  0.1251980    32.930  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1835            4.6998218  0.1251313    37.559  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1846            0.7097285  0.1350932     5.254 1.49e-07 ***\nORIG_HEX_IDHEX_1847            3.6331695  0.1254033    28.972  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1848            3.4006199  0.1251735    27.167  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1849            4.1107490  0.1250826    32.864  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1850            3.2095194  0.1254499    25.584  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1852            0.4032609  0.1354078     2.978 0.002900 ** \nORIG_HEX_IDHEX_1853            3.7678267  0.1252228    30.089  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1854            3.8053225  0.1252247    30.388  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1855            2.8121031  0.1255922    22.391  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1856            1.2399007  0.1408723     8.802  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1857           -0.0961702  0.1866983    -0.515 0.606476    \nORIG_HEX_IDHEX_1858            3.6685345  0.1252872    29.281  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1859            4.2203328  0.1251490    33.722  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1860            4.7330153  0.1250801    37.840  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1861            5.6332709  0.1250711    45.041  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1862            1.7810352  0.1315093    13.543  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1874            3.6528787  0.1251448    29.189  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1875            3.6060347  0.1251279    28.819  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1876            1.2338535  0.1270483     9.712  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1877            3.3775552  0.1252306    26.971  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1878            2.5031132  0.1257588    19.904  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1879            1.8907206  0.1262160    14.980  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1882            4.3723521  0.1251059    34.949  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1883            3.9069035  0.1251953    31.206  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1884            2.9936708  0.1259399    23.771  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1886            5.6846735  0.1250325    45.466  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1887            6.1538444  0.1250181    49.224  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1888            4.0822571  0.1252053    32.605  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1889            1.4887669  0.1392294    10.693  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1890            2.4314363  0.1327009    18.323  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1900            2.4198481  0.1259399    19.214  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1901            3.7529546  0.1251097    29.997  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1902            2.9578894  0.1253082    23.605  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1903            2.4436323  0.1262960    19.348  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1904            2.8367312  0.1254512    22.612  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1905            2.8730247  0.1253196    22.926  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1906            3.0843116  0.1252554    24.624  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1907            3.9204567  0.1251374    31.329  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1908            3.5083280  0.1253103    27.997  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1909            4.7571397  0.1250816    38.032  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1910            3.3696673  0.1253998    26.871  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1912            2.9379504  0.1260473    23.308  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1913            4.2132598  0.1251427    33.668  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1914            5.2336644  0.1250569    41.850  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1916            4.5519941  0.1260333    36.117  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1928            3.4818165  0.1251615    27.819  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1929            3.0649822  0.1252131    24.478  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1930            2.9255148  0.1252361    23.360  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1931            2.9659937  0.1252954    23.672  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1932            3.5114561  0.1251936    28.048  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1933            3.5191231  0.1253256    28.080  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1934            2.1741227  0.1257499    17.289  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1935            4.1711323  0.1251139    33.339  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1936            4.5357508  0.1250866    36.261  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1937            3.9879865  0.1251557    31.864  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1938            0.8130094  0.1355453     5.998 2.00e-09 ***\nORIG_HEX_IDHEX_1940            5.5967363  0.1250475    44.757  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1941            4.7600639  0.1250994    38.050  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1942            4.1510560  0.1253848    33.107  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1954            2.3222557  0.1261559    18.408  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1955            3.5978500  0.1251272    28.754  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1956            2.6439362  0.1253474    21.093  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1958            3.8900545  0.1251218    31.090  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1959            4.3963754  0.1250571    35.155  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1960            4.4359188  0.1251118    35.456  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1961            4.0193153  0.1251109    32.126  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1962            4.6743684  0.1250606    37.377  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1963            3.5823236  0.1251625    28.621  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1964            2.9135913  0.1254779    23.220  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1967            5.9405057  0.1250399    47.509  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1968            5.4191623  0.1250796    43.326  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1982            2.6693479  0.1253950    21.288  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1983            2.7074277  0.1252678    21.613  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1984            3.8176319  0.1250840    30.521  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1985            2.8111422  0.1253499    22.426  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1986            3.9811199  0.1251521    31.810  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1987            5.2166196  0.1250256    41.724  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1988            3.5219685  0.1251481    28.142  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1989            4.2331950  0.1250828    33.843  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1990            5.7043715  0.1250190    45.628  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1991            4.9997252  0.1250553    39.980  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1992            2.7129824  0.1260004    21.532  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1994            4.3171157  0.1252670    34.463  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1995            6.1147205  0.1250421    48.901  &lt; 2e-16 ***\nORIG_HEX_IDHEX_200             1.6212393  0.1517656    10.683  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2009            2.4575797  0.1254608    19.588  &lt; 2e-16 ***\nORIG_HEX_IDHEX_201             2.7857687  0.1278816    21.784  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2010            3.2032662  0.1251547    25.594  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2011            4.0904719  0.1250686    32.706  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2012            3.3374538  0.1252068    26.656  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2013            3.7932514  0.1251122    30.319  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2014            4.1493395  0.1250772    33.174  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2015            4.0220693  0.1251227    32.145  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2016            4.4988268  0.1250737    35.969  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2017            4.2101578  0.1251114    33.651  &lt; 2e-16 ***\nORIG_HEX_IDHEX_202             3.9117274  0.1273183    30.724  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2021            4.5033458  0.1252046    35.968  &lt; 2e-16 ***\nORIG_HEX_IDHEX_203             1.5798286  0.1347478    11.724  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2036           -1.4246448  0.1821281    -7.822 5.19e-15 ***\nORIG_HEX_IDHEX_2037            1.1042563  0.1264809     8.731  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2038            3.4994332  0.1251108    27.971  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2039            4.5870293  0.1251104    36.664  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2040            4.7290530  0.1250545    37.816  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2041            5.2977519  0.1250516    42.365  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2042            4.1647394  0.1250944    33.293  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2043            2.9854869  0.1253369    23.820  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2044            4.9521882  0.1250471    39.603  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2046            3.6065267  0.1254149    28.757  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2049            4.7995999  0.1252062    38.334  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2063            1.1888612  0.1275729     9.319  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2064            1.9337850  0.1257927    15.373  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2065            3.3395523  0.1251384    26.687  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2066            3.5002869  0.1251448    27.970  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2067            4.4566337  0.1250544    35.638  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2068            4.1598475  0.1251031    33.251  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2069            2.4462324  0.1255651    19.482  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2070            5.1356394  0.1250657    41.064  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2071            3.9411253  0.1252159    31.475  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2072            2.5295645  0.1271935    19.888  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2074           -1.0624056  0.2358501    -4.505 6.65e-06 ***\nORIG_HEX_IDHEX_2089            0.6027695  0.1597719     3.773 0.000161 ***\nORIG_HEX_IDHEX_2091            0.6789649  0.1286769     5.277 1.32e-07 ***\nORIG_HEX_IDHEX_2092            2.4655934  0.1254787    19.649  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2093            3.6511320  0.1251162    29.182  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2094            4.3637338  0.1250717    34.890  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2095            5.1561965  0.1251043    41.215  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2096            2.0491135  0.1260174    16.261  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2097            2.3770754  0.1279586    18.577  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2098            3.3777568  0.1252822    26.961  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2100            1.9425436  0.1291215    15.044  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2101            1.2311136  0.1399768     8.795  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2102            1.0891137  0.1358312     8.018 1.07e-15 ***\nORIG_HEX_IDHEX_2116            1.7685031  0.1427875    12.386  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2117           -2.0568473  1.0077828    -2.041 0.041255 *  \nORIG_HEX_IDHEX_2119            3.7923481  0.1251089    30.312  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2120            3.2852311  0.1251924    26.241  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2121            3.6845633  0.1251512    29.441  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2122            1.0621326  0.1341245     7.919 2.39e-15 ***\nORIG_HEX_IDHEX_2123            3.7813213  0.1251365    30.218  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2124            3.3746401  0.1254158    26.908  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2125            3.4044478  0.1253860    27.152  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2126            2.8362224  0.1258532    22.536  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2129            0.2445523  0.1588731     1.539 0.123733    \nORIG_HEX_IDHEX_2146            3.3433658  0.1261749    26.498  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2147            3.8508668  0.1250959    30.783  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2148            4.6390713  0.1250478    37.098  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2149            4.1164245  0.1251231    32.899  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2150            2.7331629  0.1254221    21.792  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2151            3.3594872  0.1252465    26.823  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2152            4.6017108  0.1250903    36.787  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2153            1.7815837  0.1288335    13.829  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2154            4.4706703  0.1251674    35.718  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2155            1.5745940  0.1304532    12.070  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2171           -0.6405547  0.2950506    -2.171 0.029931 *  \nORIG_HEX_IDHEX_2172            4.2158177  0.1255916    33.568  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2174            2.9842039  0.1254963    23.779  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2175            4.5644685  0.1250674    36.496  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2176            4.2559243  0.1250880    34.023  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2177            4.9822026  0.1250372    39.846  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2178            3.8229803  0.1251527    30.547  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2179            4.2827513  0.1251356    34.225  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2180            4.7741026  0.1250899    38.165  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2181            5.0168893  0.1250945    40.105  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2182            1.7547972  0.1371871    12.791  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2200            2.8678558  0.1267059    22.634  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2201            4.4725569  0.1250556    35.765  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2202            2.4003063  0.1262951    19.006  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2203            4.3488407  0.1251162    34.758  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2204            3.5600417  0.1251462    28.447  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2205            3.5995238  0.1251752    28.756  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2206            5.1882310  0.1250382    41.493  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2207            4.1344352  0.1251513    33.035  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2208            5.3631841  0.1250593    42.885  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2209            0.5392248  0.1521321     3.544 0.000393 ***\nORIG_HEX_IDHEX_2227            2.7417724  0.1254622    21.853  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2228            4.3615078  0.1250869    34.868  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2229            3.4950454  0.1251596    27.925  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2230            3.4816695  0.1253514    27.775  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2231            4.0939030  0.1250909    32.727  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2233            5.3544380  0.1250344    42.824  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2234            1.0599126  0.1339806     7.911 2.55e-15 ***\nORIG_HEX_IDHEX_2235            2.6792388  0.1298690    20.630  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2254            2.5982294  0.1263762    20.559  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2255            4.2410967  0.1250830    33.906  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2256            3.5166277  0.1251514    28.099  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2257            2.7863131  0.1255563    22.192  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2258            3.4940619  0.1252139    27.905  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2259            2.6463982  0.1256992    21.053  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2260            5.0632975  0.1250540    40.489  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2261            5.2134379  0.1250610    41.687  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2262            4.7103708  0.1251262    37.645  &lt; 2e-16 ***\nORIG_HEX_IDHEX_227             2.7565954  0.1417379    19.449  &lt; 2e-16 ***\nORIG_HEX_IDHEX_228             2.1356609  0.1294919    16.493  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2281            4.2490771  0.1251060    33.964  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2282            4.0860893  0.1250951    32.664  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2283            4.1338752  0.1250818    33.049  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2284            3.0281921  0.1252931    24.169  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2285            4.9483073  0.1250656    39.566  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2286            3.3047025  0.1252831    26.378  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2287            5.3936152  0.1250391    43.135  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2288            4.1480063  0.1252724    33.112  &lt; 2e-16 ***\nORIG_HEX_IDHEX_229             1.5469606  0.1488660    10.392  &lt; 2e-16 ***\nORIG_HEX_IDHEX_230             4.1355173  0.1257435    32.889  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2308            3.6683364  0.1253448    29.266  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2309            4.3741419  0.1250689    34.974  &lt; 2e-16 ***\nORIG_HEX_IDHEX_231             0.9653011  0.1441523     6.696 2.14e-11 ***\nORIG_HEX_IDHEX_2310            3.7717932  0.1251028    30.150  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2311            3.8897222  0.1251010    31.093  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2312            1.5143604  0.1270343    11.921  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2313            4.1224800  0.1251222    32.948  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2314            5.0682749  0.1250347    40.535  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2315            4.2886753  0.1251449    34.270  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2316            5.5641274  0.1250535    44.494  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2317            5.3441606  0.1253749    42.625  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2335            2.7891948  0.1254771    22.229  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2336            4.2266242  0.1250668    33.795  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2337            3.0214475  0.1252261    24.128  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2338            1.0780012  0.1283711     8.398  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2339            4.4223892  0.1250877    35.354  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2340            4.9081080  0.1250414    39.252  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2341            4.7590981  0.1250565    38.056  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2342            4.7480957  0.1250751    37.962  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2343            4.9676034  0.1251001    39.709  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2362            3.3360493  0.1255510    26.571  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2363            3.6172146  0.1251705    28.898  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2364            0.0612737  0.1317287     0.465 0.641823    \nORIG_HEX_IDHEX_2365            2.3347262  0.1255392    18.598  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2366           -1.3428519  0.2612599    -5.140 2.75e-07 ***\nORIG_HEX_IDHEX_2367            4.1360781  0.1251344    33.053  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2368            4.6988099  0.1250633    37.571  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2369            4.7507198  0.1250697    37.985  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2370            5.3771482  0.1250401    43.003  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2371            5.4715398  0.1250583    43.752  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2389            3.6133851  0.1252211    28.856  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2390            4.0892680  0.1250822    32.693  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2391            3.7614565  0.1251485    30.056  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2392            3.1288754  0.1260595    24.821  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2393            2.6515693  0.1281987    20.683  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2394            3.1904708  0.1253706    25.448  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2395            4.9085949  0.1250557    39.251  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2396            5.2410454  0.1250434    41.914  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2397            4.2299542  0.1251852    33.790  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2398            4.8064217  0.1252266    38.382  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2416            3.7691470  0.1252519    30.093  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2417            3.9868547  0.1252314    31.836  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2418            3.6218646  0.1251363    28.943  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2419            3.4299835  0.1251803    27.400  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2420            2.5881550  0.1280066    20.219  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2422            3.2585220  0.1257223    25.918  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2423            4.5377990  0.1251134    36.269  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2424            5.9199252  0.1250269    47.349  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2425            5.4801285  0.1250484    43.824  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2426            4.9353054  0.1253493    39.372  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2443            4.5048314  0.1250779    36.016  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2444            4.6803267  0.1250495    37.428  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2445            4.7379456  0.1250423    37.891  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2448            1.6538385  0.1294368    12.777  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2449            4.8676450  0.1251249    38.902  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2450            5.0115508  0.1250797    40.067  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2451            6.0741259  0.1250261    48.583  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2452            1.1832150  0.1329329     8.901  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2471            3.8476221  0.1251346    30.748  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2472            3.1460215  0.1260737    24.954  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2473            4.4571594  0.1250923    35.631  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2476            2.5601482  0.1274492    20.088  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2478            4.7630339  0.1251269    38.066  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2479            3.3988016  0.1255825    27.064  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2480            2.2057403  0.1310598    16.830  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2497            4.8665689  0.1250578    38.915  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2498            2.9295632  0.1253891    23.364  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2499            4.7729090  0.1250769    38.160  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2500            0.0550934  0.1397552     0.394 0.693424    \nORIG_HEX_IDHEX_2503           -0.6892904  0.2143089    -3.216 0.001298 ** \nORIG_HEX_IDHEX_2504            3.5745007  0.1255396    28.473  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2505            4.7764404  0.1251342    38.171  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2525            3.4967104  0.1252668    27.914  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2526            4.1293412  0.1251165    33.004  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2527            4.6665185  0.1250647    37.313  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2531           -0.7616066  0.5153884    -1.478 0.139479    \nORIG_HEX_IDHEX_2532            4.8694788  0.1251200    38.918  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2533            5.4688251  0.1251956    43.682  &lt; 2e-16 ***\nORIG_HEX_IDHEX_254             4.3279990  0.1261896    34.298  &lt; 2e-16 ***\nORIG_HEX_IDHEX_255             1.3849207  0.1455365     9.516  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2551            3.8154282  0.1252266    30.468  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2552            2.9618810  0.1257413    23.555  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2553            4.1454268  0.1252576    33.095  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2554            3.1039746  0.1254091    24.751  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2557            2.5747368  0.1276608    20.169  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2559            4.8615039  0.1252342    38.819  &lt; 2e-16 ***\nORIG_HEX_IDHEX_256             2.1224810  0.1359199    15.616  &lt; 2e-16 ***\nORIG_HEX_IDHEX_257             3.8462417  0.1264760    30.411  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2579            3.6771382  0.1252164    29.366  &lt; 2e-16 ***\nORIG_HEX_IDHEX_258             0.7812800  0.1450196     5.387 7.15e-08 ***\nORIG_HEX_IDHEX_2580            4.5126519  0.1250696    36.081  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2581            4.1998421  0.1251451    33.560  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2584            0.9586786  0.1408079     6.808 9.87e-12 ***\nORIG_HEX_IDHEX_259             0.9733793  0.1349414     7.213 5.46e-13 ***\nORIG_HEX_IDHEX_2605            3.8186681  0.1254055    30.451  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2606            3.5653716  0.1260030    28.296  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2607            5.0744196  0.1250447    40.581  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2608            3.6949306  0.1252756    29.494  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2609            3.0282083  0.1258897    24.054  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2610            2.5578590  0.1274521    20.069  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2611            1.0424672  0.1464214     7.120 1.08e-12 ***\nORIG_HEX_IDHEX_2633            3.7783982  0.1252034    30.178  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2634            5.4106933  0.1250272    43.276  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2635            4.7222349  0.1250969    37.749  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2636            4.8717429  0.1250757    38.950  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2637            3.5261055  0.1254102    28.117  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2638            3.3712401  0.1255059    26.861  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2660            3.2277964  0.1252918    25.762  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2661            4.6790862  0.1250557    37.416  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2662            3.7165896  0.1251695    29.692  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2663            5.3633691  0.1250471    42.891  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2664            4.0810593  0.1251720    32.604  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2665            4.8429712  0.1250914    38.715  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2687            3.7400705  0.1252325    29.865  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2688            4.4796933  0.1250685    35.818  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2689            4.7434925  0.1250657    37.928  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2690            4.0420640  0.1251292    32.303  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2691            5.3094583  0.1250414    42.462  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2692            3.1676356  0.1259260    25.155  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2693            5.2291942  0.1250724    41.809  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2714            4.2253590  0.1251190    33.771  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2715            5.1362234  0.1250527    41.072  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2716            1.0873943  0.1277058     8.515  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2717            4.1613070  0.1250842    33.268  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2718            4.8569667  0.1250736    38.833  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2719            5.3147654  0.1250625    42.497  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2742            4.8660347  0.1250607    38.909  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2743            3.6322811  0.1254941    28.944  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2744            4.6968599  0.1250477    37.561  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2745            4.7887228  0.1250540    38.293  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2746            3.6290880  0.1254394    28.931  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2747            4.4783121  0.1251698    35.778  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2768            4.6408479  0.1251046    37.096  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2769            4.9985156  0.1250567    39.970  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2770            3.1198620  0.1253180    24.896  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2771            5.5222942  0.1250242    44.170  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2772            3.7129691  0.1252917    29.635  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2773            4.5824439  0.1250951    36.632  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2795            1.0709050  0.1696567     6.312 2.75e-10 ***\nORIG_HEX_IDHEX_2796            2.2308931  0.1271255    17.549  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2797            3.3065693  0.1252819    26.393  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2798            3.8933743  0.1251258    31.116  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2799            4.4350053  0.1250725    35.459  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2800            4.6386094  0.1251016    37.079  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2801            2.0818656  0.1292136    16.112  &lt; 2e-16 ***\nORIG_HEX_IDHEX_281             3.1299477  0.1336503    23.419  &lt; 2e-16 ***\nORIG_HEX_IDHEX_282             1.5773463  0.1384607    11.392  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2822            2.2282372  0.1264696    17.619  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2823            2.5811128  0.1257145    20.532  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2824            4.2059259  0.1251327    33.612  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2825            4.9076479  0.1250439    39.247  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2826            4.8291302  0.1251060    38.600  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2827            4.9481641  0.1250597    39.566  &lt; 2e-16 ***\nORIG_HEX_IDHEX_284             1.8380885  0.1313743    13.991  &lt; 2e-16 ***\nORIG_HEX_IDHEX_285             2.5705630  0.1271931    20.210  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2850            3.6014757  0.1255281    28.691  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2851            1.8649849  0.1264078    14.754  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2852            4.5669572  0.1250868    36.510  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2853            5.3726084  0.1250317    42.970  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2854            5.1217789  0.1250536    40.957  &lt; 2e-16 ***\nORIG_HEX_IDHEX_286             4.9994157  0.1251464    39.949  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2877            2.4781606  0.1263939    19.607  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2878            3.9878663  0.1251544    31.864  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2879            4.7804905  0.1251314    38.204  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2880            4.8474978  0.1250651    38.760  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2881            5.1182921  0.1250707    40.923  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2905            4.1267515  0.1252356    32.952  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2906            3.5484145  0.1254186    28.293  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2907            4.4799196  0.1250843    35.815  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2908            4.8489191  0.1250869    38.764  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2909            4.2362824  0.1268558    33.394  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2931            0.7036747  0.1346537     5.226 1.73e-07 ***\nORIG_HEX_IDHEX_2932           -0.4053422  0.1503939    -2.695 0.007035 ** \nORIG_HEX_IDHEX_2933            3.0421615  0.1256534    24.211  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2934            4.1191082  0.1251395    32.916  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2959            1.3085161  0.1297366    10.086  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2960            3.3373056  0.1264522    26.392  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2961            3.9459246  0.1252570    31.503  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2962            3.9191171  0.1252886    31.281  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2963            0.7024006  0.1514078     4.639 3.50e-06 ***\nORIG_HEX_IDHEX_2987            1.9656567  0.1320862    14.882  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2988            2.1931052  0.1271386    17.250  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2989            2.3070999  0.1265659    18.228  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2990            1.9455669  0.1319020    14.750  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3015            3.9102796  0.1263786    30.941  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3016            3.5119978  0.1257515    27.928  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3017            1.1421955  0.1317051     8.672  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3040            4.2788384  0.1253621    34.132  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3043            2.5223513  0.1262487    19.979  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3044            2.5812329  0.1265893    20.391  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3068            2.9003470  0.1266467    22.901  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3070            1.6011277  0.1319622    12.133  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3072            1.5639952  0.1358903    11.509  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3092            5.0561346  0.1259590    40.141  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3098            4.0232517  0.1253482    32.097  &lt; 2e-16 ***\nORIG_HEX_IDHEX_312             0.3591814  0.1470150     2.443 0.014559 *  \nORIG_HEX_IDHEX_3123            5.3011400  0.1251756    42.350  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3126           -0.4382714  0.3750004    -1.169 0.242515    \nORIG_HEX_IDHEX_313             1.0579509  0.1347953     7.849 4.21e-15 ***\nORIG_HEX_IDHEX_314             1.5603619  0.1314462    11.871  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3151            3.3281598  0.1262598    26.360  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3152           -0.3563166  0.1821242    -1.956 0.050412 .  \nORIG_HEX_IDHEX_3173            5.1156907  0.1261102    40.565  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3178            2.8110269  0.1275636    22.036  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3179            2.5032181  0.1277808    19.590  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3205            2.6703861  0.1313455    20.331  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3206            4.4602352  0.1254856    35.544  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3232            2.4826628  0.1345836    18.447  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3233            2.0311339  0.1411277    14.392  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3308            3.6655364  0.1331566    27.528  &lt; 2e-16 ***\nORIG_HEX_IDHEX_336             1.9667454  0.1909418    10.300  &lt; 2e-16 ***\nORIG_HEX_IDHEX_338             1.7096782  0.1319754    12.955  &lt; 2e-16 ***\nORIG_HEX_IDHEX_339             4.1383596  0.1252563    33.039  &lt; 2e-16 ***\nORIG_HEX_IDHEX_340             0.1181956  0.2031412     0.582 0.560675    \nORIG_HEX_IDHEX_366             4.6434175  0.1251888    37.091  &lt; 2e-16 ***\nORIG_HEX_IDHEX_367             2.0879887  0.1277300    16.347  &lt; 2e-16 ***\nORIG_HEX_IDHEX_391             1.2592766  0.1591672     7.912 2.54e-15 ***\nORIG_HEX_IDHEX_392             4.5387939  0.1252412    36.240  &lt; 2e-16 ***\nORIG_HEX_IDHEX_393             2.1656909  0.1277008    16.959  &lt; 2e-16 ***\nORIG_HEX_IDHEX_394            -0.4852079  0.2728533    -1.778 0.075359 .  \nORIG_HEX_IDHEX_419             0.3753905  0.1591667     2.358 0.018350 *  \nORIG_HEX_IDHEX_420             2.1973258  0.1289513    17.040  &lt; 2e-16 ***\nORIG_HEX_IDHEX_421             0.8758566  0.1781977     4.915 8.87e-07 ***\nORIG_HEX_IDHEX_445             2.6551869  0.1298159    20.453  &lt; 2e-16 ***\nORIG_HEX_IDHEX_446             3.4103104  0.1256905    27.133  &lt; 2e-16 ***\nORIG_HEX_IDHEX_447             1.2103239  0.1376100     8.795  &lt; 2e-16 ***\nORIG_HEX_IDHEX_472             0.3797572  0.1909413     1.989 0.046716 *  \nORIG_HEX_IDHEX_473             1.0280504  0.1371861     7.494 6.69e-14 ***\nORIG_HEX_IDHEX_474             1.0582965  0.1356012     7.804 5.97e-15 ***\nORIG_HEX_IDHEX_499             1.6053742  0.1325259    12.114  &lt; 2e-16 ***\nORIG_HEX_IDHEX_500             3.5119687  0.1254779    27.989  &lt; 2e-16 ***\nORIG_HEX_IDHEX_526             2.2819532  0.1295686    17.612  &lt; 2e-16 ***\nORIG_HEX_IDHEX_527             1.5736084  0.1376497    11.432  &lt; 2e-16 ***\nORIG_HEX_IDHEX_528             1.9088174  0.1298453    14.701  &lt; 2e-16 ***\nORIG_HEX_IDHEX_552             1.6634841  0.1392793    11.944  &lt; 2e-16 ***\nORIG_HEX_IDHEX_553            -0.7558293  0.2000385    -3.778 0.000158 ***\nORIG_HEX_IDHEX_554             1.7092294  0.1309124    13.056  &lt; 2e-16 ***\nORIG_HEX_IDHEX_555             1.1936685  0.1320740     9.038  &lt; 2e-16 ***\nORIG_HEX_IDHEX_581             1.7471769  0.1294713    13.495  &lt; 2e-16 ***\nORIG_HEX_IDHEX_582             1.2843651  0.1289661     9.959  &lt; 2e-16 ***\nORIG_HEX_IDHEX_607             2.0342838  0.1323737    15.368  &lt; 2e-16 ***\nORIG_HEX_IDHEX_608             1.1934463  0.1324007     9.014  &lt; 2e-16 ***\nORIG_HEX_IDHEX_609             6.1977310  0.1250247    49.572  &lt; 2e-16 ***\nORIG_HEX_IDHEX_610             1.4134760  0.1433577     9.860  &lt; 2e-16 ***\nORIG_HEX_IDHEX_611            -1.0100586  0.4643554    -2.175 0.029616 *  \nORIG_HEX_IDHEX_634             2.5550175  0.1302869    19.611  &lt; 2e-16 ***\nORIG_HEX_IDHEX_635             0.3832417  0.1427830     2.684 0.007273 ** \nORIG_HEX_IDHEX_636             2.5181805  0.1257926    20.019  &lt; 2e-16 ***\nORIG_HEX_IDHEX_638             2.2442532  0.1285014    17.465  &lt; 2e-16 ***\nORIG_HEX_IDHEX_661             1.4276355  0.1436144     9.941  &lt; 2e-16 ***\nORIG_HEX_IDHEX_662             1.8593195  0.1307426    14.221  &lt; 2e-16 ***\nORIG_HEX_IDHEX_663             1.4564449  0.1277461    11.401  &lt; 2e-16 ***\nORIG_HEX_IDHEX_664             1.5150088  0.1395934    10.853  &lt; 2e-16 ***\nORIG_HEX_IDHEX_665             3.4613483  0.1259923    27.473  &lt; 2e-16 ***\nORIG_HEX_IDHEX_689             1.2054785  0.1315732     9.162  &lt; 2e-16 ***\nORIG_HEX_IDHEX_690             1.4636663  0.1292524    11.324  &lt; 2e-16 ***\nORIG_HEX_IDHEX_692             3.6882060  0.1257973    29.319  &lt; 2e-16 ***\nORIG_HEX_IDHEX_693             2.3157242  0.1295075    17.881  &lt; 2e-16 ***\nORIG_HEX_IDHEX_715             1.3422432  0.1383698     9.700  &lt; 2e-16 ***\nORIG_HEX_IDHEX_716             1.8232916  0.1308519    13.934  &lt; 2e-16 ***\nORIG_HEX_IDHEX_717             2.6421812  0.1261786    20.940  &lt; 2e-16 ***\nORIG_HEX_IDHEX_718             5.9166509  0.1250523    47.313  &lt; 2e-16 ***\nORIG_HEX_IDHEX_719             3.1806729  0.1266688    25.110  &lt; 2e-16 ***\nORIG_HEX_IDHEX_720            -0.5574987  0.3042182    -1.833 0.066868 .  \nORIG_HEX_IDHEX_743             2.5944683  0.1274712    20.353  &lt; 2e-16 ***\nORIG_HEX_IDHEX_744             2.0575866  0.1278579    16.093  &lt; 2e-16 ***\nORIG_HEX_IDHEX_745             4.3092409  0.1251407    34.435  &lt; 2e-16 ***\nORIG_HEX_IDHEX_746             5.5216716  0.1250570    44.153  &lt; 2e-16 ***\nORIG_HEX_IDHEX_747             2.3953608  0.1279691    18.718  &lt; 2e-16 ***\nORIG_HEX_IDHEX_748             0.9087770  0.1463067     6.211 5.25e-10 ***\nORIG_HEX_IDHEX_769             1.1358664  0.1431893     7.933 2.15e-15 ***\nORIG_HEX_IDHEX_770             2.1333545  0.1277958    16.693  &lt; 2e-16 ***\nORIG_HEX_IDHEX_771             3.1185251  0.1255299    24.843  &lt; 2e-16 ***\nORIG_HEX_IDHEX_772             5.2271759  0.1250516    41.800  &lt; 2e-16 ***\nORIG_HEX_IDHEX_773             4.3753433  0.1253824    34.896  &lt; 2e-16 ***\nORIG_HEX_IDHEX_774             1.4424559  0.1369673    10.531  &lt; 2e-16 ***\nORIG_HEX_IDHEX_775             2.8136659  0.1279778    21.986  &lt; 2e-16 ***\nORIG_HEX_IDHEX_776             0.4558515  0.2728535     1.671 0.094784 .  \nORIG_HEX_IDHEX_777             0.1140619  0.2795098     0.408 0.683216    \nORIG_HEX_IDHEX_797             1.8173324  0.1307669    13.897  &lt; 2e-16 ***\nORIG_HEX_IDHEX_798             0.5697751  0.1691516     3.368 0.000756 ***\nORIG_HEX_IDHEX_799             4.8157626  0.1250805    38.501  &lt; 2e-16 ***\nORIG_HEX_IDHEX_800             5.5107072  0.1250472    44.069  &lt; 2e-16 ***\nORIG_HEX_IDHEX_802             0.8182286  0.1460808     5.601 2.13e-08 ***\nORIG_HEX_IDHEX_803            -1.0597624  0.2795091    -3.792 0.000150 ***\nORIG_HEX_IDHEX_805             0.7436488  0.1624134     4.579 4.68e-06 ***\nORIG_HEX_IDHEX_806             2.5704723  0.1361337    18.882  &lt; 2e-16 ***\nORIG_HEX_IDHEX_823             1.3314505  0.1388817     9.587  &lt; 2e-16 ***\nORIG_HEX_IDHEX_824             0.9957263  0.1376493     7.234 4.70e-13 ***\nORIG_HEX_IDHEX_825             2.7580664  0.1268507    21.743  &lt; 2e-16 ***\nORIG_HEX_IDHEX_826             6.3257639  0.1250124    50.601  &lt; 2e-16 ***\nORIG_HEX_IDHEX_827             5.4968849  0.1250613    43.954  &lt; 2e-16 ***\nORIG_HEX_IDHEX_832             0.0496278  1.0077828     0.049 0.960724    \nORIG_HEX_IDHEX_833             0.3333318  0.1829821     1.822 0.068506 .  \nORIG_HEX_IDHEX_851             0.0415067  0.1667944     0.249 0.803477    \nORIG_HEX_IDHEX_852             2.9318194  0.1269406    23.096  &lt; 2e-16 ***\nORIG_HEX_IDHEX_853             3.2141431  0.1253545    25.640  &lt; 2e-16 ***\nORIG_HEX_IDHEX_854             4.6557962  0.1250933    37.219  &lt; 2e-16 ***\nORIG_HEX_IDHEX_856            -0.8353963  0.2950490    -2.831 0.004635 ** \nORIG_HEX_IDHEX_861             0.6633919  0.1712424     3.874 0.000107 ***\nORIG_HEX_IDHEX_862             2.3009571  0.1655015    13.903  &lt; 2e-16 ***\nORIG_HEX_IDHEX_878             1.6915495  0.1322659    12.789  &lt; 2e-16 ***\nORIG_HEX_IDHEX_879             1.8632066  0.1277272    14.587  &lt; 2e-16 ***\nORIG_HEX_IDHEX_880             3.8186774  0.1251659    30.509  &lt; 2e-16 ***\nORIG_HEX_IDHEX_881             3.6648488  0.1255036    29.201  &lt; 2e-16 ***\nORIG_HEX_IDHEX_888             1.2361156  0.2238493     5.522 3.35e-08 ***\nORIG_HEX_IDHEX_889             3.0769368  0.1423221    21.620  &lt; 2e-16 ***\nORIG_HEX_IDHEX_905             1.5086596  0.1343368    11.230  &lt; 2e-16 ***\nORIG_HEX_IDHEX_906            -0.8045211  0.1898242    -4.238 2.25e-05 ***\nORIG_HEX_IDHEX_907             1.6685893  0.1279571    13.040  &lt; 2e-16 ***\nORIG_HEX_IDHEX_908             5.5489549  0.1250369    44.379  &lt; 2e-16 ***\nORIG_HEX_IDHEX_910             1.1937021  0.1441526     8.281  &lt; 2e-16 ***\nORIG_HEX_IDHEX_932             2.7539695  0.1263086    21.803  &lt; 2e-16 ***\nORIG_HEX_IDHEX_933             2.9291326  0.1259001    23.266  &lt; 2e-16 ***\nORIG_HEX_IDHEX_934             4.1966606  0.1251489    33.533  &lt; 2e-16 ***\nORIG_HEX_IDHEX_935             5.1632517  0.1250649    41.285  &lt; 2e-16 ***\nORIG_HEX_IDHEX_937             5.4062508  0.1251776    43.189  &lt; 2e-16 ***\nORIG_HEX_IDHEX_959             3.3440448  0.1259963    26.541  &lt; 2e-16 ***\nORIG_HEX_IDHEX_960             3.9931957  0.1251936    31.896  &lt; 2e-16 ***\nORIG_HEX_IDHEX_961             4.9788126  0.1250675    39.809  &lt; 2e-16 ***\nORIG_HEX_IDHEX_962             5.5116562  0.1250449    44.077  &lt; 2e-16 ***\nORIG_HEX_IDHEX_986             0.0719117  0.1564436     0.460 0.645757    \nORIG_HEX_IDHEX_987             5.0893332  0.1250607    40.695  &lt; 2e-16 ***\nORIG_HEX_IDHEX_988             4.1693073  0.1251946    33.303  &lt; 2e-16 ***\nORIG_HEX_IDHEX_989             5.3758815  0.1250463    42.991  &lt; 2e-16 ***\nORIG_HEX_IDHEX_991             2.1446045  0.1295952    16.548  &lt; 2e-16 ***\nlog(DISTANCE)                 -1.4498219  0.0002854 -5079.882  &lt; 2e-16 ***\nlog(DEST_TOTAL_BUS_STOPS)      0.1286984  0.0005491   234.371  &lt; 2e-16 ***\nlog(DEST_TOTAL_BUS_INT)        0.9993061  0.0010211   978.660  &lt; 2e-16 ***\nlog(DEST_TOTAL_MRT_INT)       -0.3184445  0.0016123  -197.514  &lt; 2e-16 ***\nlog(DEST_TOTAL_MRT_STN)       -0.1171151  0.0010788  -108.563  &lt; 2e-16 ***\nlog(DEST_TOTAL_LRT_STN)       -0.6451767  0.0011953  -539.762  &lt; 2e-16 ***\nlog(DEST_TOTAL_STN_EXIT)       0.3994699  0.0005264   758.822  &lt; 2e-16 ***\nlog(DEST_TOTAL_PRE_SCHOOL)    -0.0508793  0.0003221  -157.943  &lt; 2e-16 ***\nlog(DEST_TOTAL_PRI_SCHOOL)     0.0813360  0.0006603   123.185  &lt; 2e-16 ***\nlog(DEST_TOTAL_SECJC_SCHOOL)   0.2810611  0.0006412   438.336  &lt; 2e-16 ***\nlog(DEST_TOTAL_PTE_SCHOOL)     0.0263276  0.0004548    57.894  &lt; 2e-16 ***\nlog(DEST_TOTAL_TET_SCHOOL)     1.0272572  0.0018058   568.879  &lt; 2e-16 ***\nlog(DEST_TOTAL_HAWKER_STALL)   0.0125516  0.0001279    98.123  &lt; 2e-16 ***\nlog(DEST_TOTAL_FNB)           -0.0343522  0.0002930  -117.236  &lt; 2e-16 ***\nlog(DEST_TOTAL_ENTERTAINMENT) -0.0477746  0.0007120   -67.098  &lt; 2e-16 ***\nlog(DEST_TOTAL_TOURISM)       -0.0877957  0.0009036   -97.167  &lt; 2e-16 ***\nlog(DEST_TOTAL_SILVERZONE)     0.1288507  0.0009815   131.283  &lt; 2e-16 ***\nlog(DEST_TOTAL_LEISURE)       -0.0579746  0.0003095  -187.299  &lt; 2e-16 ***\nlog(DEST_TOTAL_RETAIL)         0.0815270  0.0002616   311.660  &lt; 2e-16 ***\nlog(DEST_TOTAL_FINSERV)        0.0897117  0.0003428   261.693  &lt; 2e-16 ***\nlog(DEST_TOTAL_ELDERCARE)     -0.0489052  0.0005593   -87.440  &lt; 2e-16 ***\nlog(DEST_TOTAL_BUSINESS)       0.1074695  0.0001984   541.637  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 80303496  on 63387  degrees of freedom\nResidual deviance: 28194250  on 62544  degrees of freedom\nAIC: 28540126\n\nNumber of Fisher Scoring iterations: 7\n\n\n\n\nDestination Constraint\n#|eval: false\n\nrm(list = ls())\nflowmerge_interzonal &lt;- read_rds(\"data/rds/flowmerge.rds\") %&gt;%\n  filter(ORIG_HEX_ID != DEST_HEX_ID)\n\ndestination_cons &lt;- glm(\n  formula = TOTAL_TRIPS ~\n#  ORIG_HEX_ID +\n  DEST_HEX_ID + \n  log(DISTANCE) +\n  log(ORIG_TOTAL_BUS_STOPS) +\n  log(ORIG_TOTAL_BUS_INT) +\n  log(ORIG_TOTAL_MRT_INT) +\n  log(ORIG_TOTAL_MRT_STN) +\n  log(ORIG_TOTAL_LRT_STN) +\n  log(ORIG_TOTAL_STN_EXIT) +\n  log(ORIG_TOTAL_HDB_POP) +\n  log(ORIG_TOTAL_HOTEL_ROOM) +\n  log(ORIG_TOTAL_PTE_POP),\n  family = poisson(link = \"log\"),\n  data = flowmerge_interzonal,\n  na.action = na.exclude\n  )\n\nwrite_rds(destination_cons, \"data/rds/destination_cons.rds\")\n\n\nCode\ndestination_cons &lt;- read_rds(\"data/rds/destination_cons.rds\")\nsummary(destination_cons)\n\n\n\nCall:\nglm(formula = TOTAL_TRIPS ~ DEST_HEX_ID + log(DISTANCE) + log(ORIG_TOTAL_BUS_STOPS) + \n    log(ORIG_TOTAL_BUS_INT) + log(ORIG_TOTAL_MRT_INT) + log(ORIG_TOTAL_MRT_STN) + \n    log(ORIG_TOTAL_LRT_STN) + log(ORIG_TOTAL_STN_EXIT) + log(ORIG_TOTAL_HDB_POP) + \n    log(ORIG_TOTAL_HOTEL_ROOM) + log(ORIG_TOTAL_PTE_POP), family = poisson(link = \"log\"), \n    data = flowmerge_interzonal, na.action = na.exclude)\n\nCoefficients:\n                             Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)                 1.463e+01  2.095e-02   698.267  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1014        -1.096e+00  2.605e-02   -42.053  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1015        -1.908e+00  3.213e-02   -59.388  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1016         2.399e-01  2.153e-02    11.143  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1042         1.169e+00  2.134e-02    54.774  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1043         5.866e-01  2.145e-02    27.348  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1045        -1.669e+00  3.376e-02   -49.448  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1067         1.611e+00  2.154e-02    74.793  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1068        -1.747e+00  4.079e-02   -42.831  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1069        -1.793e+00  2.895e-02   -61.916  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1070         7.504e-01  2.119e-02    35.406  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1078        -6.024e-01  4.179e-02   -14.415  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1093         8.796e-01  2.332e-02    37.724  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1094        -6.673e-01  2.549e-02   -26.174  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1095        -2.144e+00  3.278e-02   -65.409  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1096         2.023e-01  2.157e-02     9.381  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1097         4.225e-01  2.166e-02    19.510  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1099         7.396e-01  2.164e-02    34.182  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1100        -2.551e+00  5.339e-02   -47.769  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1122         1.677e-01  2.223e-02     7.546 4.49e-14 ***\nDEST_HEX_IDHEX_1123         2.001e+00  2.086e-02    95.933  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1124         7.422e-01  2.122e-02    34.967  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1125         4.796e-02  2.206e-02     2.174 0.029683 *  \nDEST_HEX_IDHEX_1126        -3.741e+00  7.128e-02   -52.484  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1127         8.548e-02  2.189e-02     3.906 9.40e-05 ***\nDEST_HEX_IDHEX_1128         6.831e-01  2.205e-02    30.983  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1132         4.999e-01  2.755e-02    18.146  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1147        -1.459e+00  3.803e-02   -38.361  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1148         2.398e-01  2.221e-02    10.793  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1149        -2.439e-01  2.242e-02   -10.875  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1150         6.168e-01  2.131e-02    28.944  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1151         1.001e-01  2.153e-02     4.647 3.36e-06 ***\nDEST_HEX_IDHEX_1152        -3.483e-02  2.198e-02    -1.584 0.113085    \nDEST_HEX_IDHEX_1153         1.624e-01  2.198e-02     7.391 1.46e-13 ***\nDEST_HEX_IDHEX_1154         2.101e+00  2.086e-02   100.730  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1155        -2.298e+00  4.379e-02   -52.473  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1158        -7.108e-01  3.374e-02   -21.067  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1174         6.694e-01  2.371e-02    28.228  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1175         1.830e+00  2.218e-02    82.508  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1176         8.136e-01  2.131e-02    38.175  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1177         7.359e-01  2.135e-02    34.473  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1178         1.475e-01  2.156e-02     6.841 7.88e-12 ***\nDEST_HEX_IDHEX_1179        -6.713e-01  2.278e-02   -29.473  &lt; 2e-16 ***\nDEST_HEX_IDHEX_118          6.384e-01  5.898e-02    10.825  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1180        -2.239e+00  2.923e-02   -76.611  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1181         8.425e-01  2.116e-02    39.818  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1182         4.454e-01  2.191e-02    20.330  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1183         5.568e-01  2.318e-02    24.023  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1185         4.226e-01  2.498e-02    16.917  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1201        -1.714e-02  2.493e-02    -0.688 0.491765    \nDEST_HEX_IDHEX_1202         3.560e-01  2.207e-02    16.130  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1203         1.350e+00  2.126e-02    63.520  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1205         1.755e+00  2.087e-02    84.118  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1206         6.470e-01  2.137e-02    30.281  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1207         4.200e-01  2.137e-02    19.656  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1209         1.821e+00  2.114e-02    86.138  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1210         2.260e-01  2.494e-02     9.063  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1211         7.809e-02  2.636e-02     2.963 0.003048 ** \nDEST_HEX_IDHEX_1212         1.720e-01  2.591e-02     6.641 3.11e-11 ***\nDEST_HEX_IDHEX_1228         2.744e-01  2.493e-02    11.005  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1229         5.835e-01  2.178e-02    26.788  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1230        -4.014e-01  2.314e-02   -17.346  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1231         1.827e+00  2.137e-02    85.495  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1232         7.376e-01  2.120e-02    34.799  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1233         1.831e+00  2.102e-02    87.127  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1235         8.774e-01  2.129e-02    41.216  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1236        -9.816e-01  2.437e-02   -40.272  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1237         1.375e+00  2.149e-02    63.997  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1238        -1.119e+00  3.168e-02   -35.312  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1239        -7.513e-02  2.610e-02    -2.878 0.003997 ** \nDEST_HEX_IDHEX_1240        -1.542e+00  6.643e-02   -23.206  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1255         9.512e-01  2.298e-02    41.388  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1256        -5.295e-01  2.331e-02   -22.719  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1257         2.440e-01  2.207e-02    11.054  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1258         1.236e+00  2.124e-02    58.176  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1259        -3.336e-02  2.197e-02    -1.518 0.128996    \nDEST_HEX_IDHEX_1261         6.180e-02  2.159e-02     2.862 0.004211 ** \nDEST_HEX_IDHEX_1262         2.572e-01  2.164e-02    11.884  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1263        -8.617e-01  2.699e-02   -31.929  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1264         9.022e-01  2.212e-02    40.791  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1265        -1.475e+00  3.413e-02   -43.211  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1266         5.997e-01  2.416e-02    24.818  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1282        -2.165e-01  2.449e-02    -8.843  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1283         4.487e-01  2.153e-02    20.842  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1284        -5.993e-02  2.250e-02    -2.664 0.007723 ** \nDEST_HEX_IDHEX_1285         7.764e-01  2.159e-02    35.969  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1286        -7.290e-01  2.353e-02   -30.979  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1287        -5.389e-02  2.273e-02    -2.371 0.017725 *  \nDEST_HEX_IDHEX_1288        -2.684e-01  2.243e-02   -11.971  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1289         9.573e-01  2.105e-02    45.483  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1293        -2.240e-01  2.968e-02    -7.546 4.48e-14 ***\nDEST_HEX_IDHEX_1308        -7.624e-01  2.591e-02   -29.430  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1309         1.075e+00  2.128e-02    50.517  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1310         2.139e+00  2.083e-02   102.694  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1311         8.466e-01  2.247e-02    37.672  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1312        -1.578e+00  3.040e-02   -51.897  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1314         8.720e-01  2.142e-02    40.709  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1315         1.972e+00  2.086e-02    94.575  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1316        -4.517e-01  2.331e-02   -19.380  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1318         3.236e-01  2.821e-02    11.471  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1319         1.650e+00  2.130e-02    77.449  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1320        -3.015e-01  2.753e-02   -10.951  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1335        -2.529e+00  9.843e-02   -25.697  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1336         9.125e-01  2.147e-02    42.495  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1337         4.251e-01  2.136e-02    19.906  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1338        -8.288e-01  2.457e-02   -33.734  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1339        -4.690e-01  2.693e-02   -17.416  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1340        -9.518e-01  2.471e-02   -38.515  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1341        -4.351e-01  2.326e-02   -18.703  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1342         9.827e-02  2.198e-02     4.470 7.82e-06 ***\nDEST_HEX_IDHEX_1343        -4.348e-01  2.235e-02   -19.450  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1347         1.457e-01  2.368e-02     6.152 7.67e-10 ***\nDEST_HEX_IDHEX_1348         9.439e-01  2.156e-02    43.782  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1362         4.834e-01  2.184e-02    22.138  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1363         7.881e-01  2.143e-02    36.775  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1364        -1.458e-01  2.215e-02    -6.581 4.66e-11 ***\nDEST_HEX_IDHEX_1366         4.946e-01  2.173e-02    22.758  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1367        -1.885e+00  3.172e-02   -59.413  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1368         9.789e-01  2.179e-02    44.914  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1369         7.296e-01  2.138e-02    34.127  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1370         3.024e-01  2.224e-02    13.594  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1372        -8.397e-02  3.716e-02    -2.260 0.023817 *  \nDEST_HEX_IDHEX_1374         5.117e-01  2.166e-02    23.619  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1375         1.543e+00  2.137e-02    72.204  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1389         7.897e-01  2.179e-02    36.240  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1390         6.594e-01  2.258e-02    29.198  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1391         3.300e-01  2.174e-02    15.178  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1392        -9.129e-01  2.474e-02   -36.904  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1394        -4.409e-01  2.374e-02   -18.572  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1396        -8.287e-01  2.641e-02   -31.375  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1397        -9.133e-02  2.285e-02    -3.997 6.41e-05 ***\nDEST_HEX_IDHEX_1401         1.902e+00  2.096e-02    90.742  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1402         7.732e-01  2.145e-02    36.040  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1416        -5.834e-01  3.673e-02   -15.881  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1417        -2.676e-01  2.385e-02   -11.220  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1418        -6.626e-01  3.065e-02   -21.622  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1419         1.844e+00  2.100e-02    87.801  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1420         1.782e+00  2.097e-02    84.976  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1422        -2.964e-01  2.587e-02   -11.454  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1423         1.036e-02  2.237e-02     0.463 0.643157    \nDEST_HEX_IDHEX_1426         1.270e+00  2.274e-02    55.855  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1428         1.685e-01  2.187e-02     7.706 1.30e-14 ***\nDEST_HEX_IDHEX_1429         9.093e-01  2.169e-02    41.915  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1443         1.271e+00  2.133e-02    59.596  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1444         8.306e-01  2.181e-02    38.084  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1445         9.243e-01  2.140e-02    43.199  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1446        -1.185e+00  2.714e-02   -43.659  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1447         6.738e-01  2.149e-02    31.362  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1455        -5.460e-02  2.273e-02    -2.402 0.016302 *  \nDEST_HEX_IDHEX_1456         4.457e-01  2.176e-02    20.478  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1457        -2.921e+00  7.097e-02   -41.150  &lt; 2e-16 ***\nDEST_HEX_IDHEX_146          1.771e+00  3.120e-02    56.773  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1469         1.063e+00  2.147e-02    49.522  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1470         1.341e+00  2.124e-02    63.141  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1471         8.909e-01  2.134e-02    41.740  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1472        -1.093e-01  2.283e-02    -4.785 1.71e-06 ***\nDEST_HEX_IDHEX_1480        -1.303e+00  4.634e-02   -28.111  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1482         1.387e+00  2.107e-02    65.843  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1483         1.667e+00  2.122e-02    78.568  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1496        -6.412e-01  2.667e-02   -24.043  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1497         1.440e+00  2.214e-02    65.029  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1498         5.675e-01  2.151e-02    26.380  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1499         2.148e-01  2.204e-02     9.746  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1500        -1.881e+00  3.962e-02   -47.481  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1501        -1.200e-01  2.273e-02    -5.279 1.30e-07 ***\nDEST_HEX_IDHEX_1507         1.803e+00  2.258e-02    79.838  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1509        -2.718e-01  2.325e-02   -11.690  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1510         2.627e+00  2.078e-02   126.400  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1511        -3.048e-01  2.662e-02   -11.452  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1523        -9.186e-01  4.273e-02   -21.497  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1524         3.690e-01  2.465e-02    14.967  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1525         1.087e+00  2.109e-02    51.558  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1526        -1.141e+00  2.659e-02   -42.905  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1527        -1.956e+00  4.966e-02   -39.383  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1534        -2.484e+00  9.436e-02   -26.325  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1536         9.688e-01  2.118e-02    45.745  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1537         3.342e-01  2.233e-02    14.965  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1550         1.098e+00  2.151e-02    51.048  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1551         1.173e-01  2.285e-02     5.133 2.85e-07 ***\nDEST_HEX_IDHEX_1552        -1.340e+00  3.063e-02   -43.759  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1553         9.973e-02  2.185e-02     4.565 5.00e-06 ***\nDEST_HEX_IDHEX_1554        -1.174e+00  2.952e-02   -39.779  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1555        -4.537e-01  2.374e-02   -19.108  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1562        -4.026e-01  4.257e-02    -9.456  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1563         7.595e-01  2.165e-02    35.085  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1564         4.630e-01  2.141e-02    21.621  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1565         2.205e+00  2.123e-02   103.848  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1576         4.038e-01  2.292e-02    17.616  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1578        -1.284e+00  2.475e-02   -51.871  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1579         9.970e-01  2.114e-02    47.170  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1581        -3.083e-02  2.261e-02    -1.364 0.172701    \nDEST_HEX_IDHEX_1588        -9.082e-01  5.483e-02   -16.564  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1590         3.788e-01  2.164e-02    17.510  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1591         6.993e-01  2.146e-02    32.583  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1592         1.125e+00  2.208e-02    50.967  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1604         1.483e+00  2.102e-02    70.555  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1605         4.762e-01  2.137e-02    22.280  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1606         3.477e-01  2.144e-02    16.217  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1607        -4.899e-01  2.279e-02   -21.501  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1616        -5.687e-01  3.710e-02   -15.330  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1617        -1.297e-01  2.387e-02    -5.435 5.49e-08 ***\nDEST_HEX_IDHEX_1618         2.207e+00  2.085e-02   105.836  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1619         7.576e-01  2.165e-02    34.989  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1620         1.330e+00  2.194e-02    60.633  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1630        -1.580e+00  2.810e-02   -56.236  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1631        -5.996e-02  2.194e-02    -2.732 0.006287 ** \nDEST_HEX_IDHEX_1632         1.319e-01  2.188e-02     6.028 1.66e-09 ***\nDEST_HEX_IDHEX_1633        -1.601e+00  2.728e-02   -58.699  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1634         3.286e-01  2.194e-02    14.980  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1635         1.402e+00  2.121e-02    66.095  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1642        -6.323e-01  5.111e-02   -12.370  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1644         7.429e-01  2.163e-02    34.351  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1645         8.071e-01  2.135e-02    37.796  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1646         1.279e+00  2.146e-02    59.590  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1647        -6.488e-01  3.490e-02   -18.593  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1658        -1.812e-01  2.335e-02    -7.761 8.40e-15 ***\nDEST_HEX_IDHEX_1659         7.912e-01  2.117e-02    37.371  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1660        -2.501e-01  2.414e-02   -10.364  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1661        -1.874e+00  3.123e-02   -60.001  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1662         1.677e-01  2.220e-02     7.554 4.22e-14 ***\nDEST_HEX_IDHEX_1669        -2.836e+00  1.377e-01   -20.600  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1670         1.404e-01  2.994e-02     4.688 2.76e-06 ***\nDEST_HEX_IDHEX_1672         6.061e-01  2.302e-02    26.330  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1673         1.693e+00  2.138e-02    79.189  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1674         1.250e+00  2.164e-02    57.767  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1684         4.677e-01  2.161e-02    21.642  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1685         3.366e-01  2.209e-02    15.236  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1686         2.774e-01  2.154e-02    12.879  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1687        -3.965e-01  2.334e-02   -16.987  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1688        -2.233e-01  2.300e-02    -9.707  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1689        -1.366e+00  3.465e-02   -39.434  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1695        -1.935e+00  7.455e-02   -25.960  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1699         7.970e-01  2.135e-02    37.328  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1700        -3.770e-01  2.493e-02   -15.119  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1701         1.776e+00  2.218e-02    80.088  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1712        -1.037e+00  2.472e-02   -41.964  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1713         1.125e+00  2.101e-02    53.552  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1714        -6.530e-01  2.424e-02   -26.935  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1716         4.831e-01  2.166e-02    22.301  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1723        -1.907e+00  7.490e-02   -25.455  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1726        -3.608e-01  2.540e-02   -14.205  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1727         4.949e-01  2.172e-02    22.791  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1728         1.411e+00  2.129e-02    66.286  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1738         2.225e-01  2.167e-02    10.268  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1739         1.390e+00  2.094e-02    66.387  &lt; 2e-16 ***\nDEST_HEX_IDHEX_174          1.306e+00  3.660e-02    35.675  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1740        -2.428e-01  2.231e-02   -10.883  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1741         3.730e-01  2.203e-02    16.930  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1743        -1.134e+00  3.467e-02   -32.712  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1744        -2.410e+00  1.205e-01   -20.003  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1748        -3.584e+00  1.213e-01   -29.545  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1749         7.065e-01  2.243e-02    31.500  &lt; 2e-16 ***\nDEST_HEX_IDHEX_175          1.441e+00  2.885e-02    49.953  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1753         1.923e+00  2.093e-02    91.901  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1754         2.705e-01  2.205e-02    12.269  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1764        -1.137e+00  4.861e-02   -23.390  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1765         1.421e+00  2.110e-02    67.351  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1766         5.893e-01  2.144e-02    27.490  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1767         3.307e-01  2.143e-02    15.431  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1768        -1.873e+00  3.237e-02   -57.849  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1770        -6.742e-01  2.480e-02   -27.187  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1771        -2.092e+00  4.153e-02   -50.381  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1776        -3.806e+00  1.189e-01   -32.021  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1777         9.312e-01  2.198e-02    42.371  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1778        -7.406e-01  2.565e-02   -28.873  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1780        -7.039e-02  2.641e-02    -2.665 0.007695 ** \nDEST_HEX_IDHEX_1781         8.125e-01  2.137e-02    38.022  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1791        -9.864e-02  2.871e-02    -3.436 0.000591 ***\nDEST_HEX_IDHEX_1792        -2.035e-01  2.251e-02    -9.042  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1793         7.361e-01  2.118e-02    34.755  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1794         2.209e-01  2.162e-02    10.221  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1795         3.207e-01  2.184e-02    14.682  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1796         1.028e+00  2.162e-02    47.549  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1798        -4.316e+00  1.753e-01   -24.622  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1800        -3.976e-01  2.865e-02   -13.880  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1802        -1.114e+00  3.072e-02   -36.254  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1804        -2.406e+00  4.359e-02   -55.200  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1805        -8.155e-01  2.431e-02   -33.551  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1806        -3.174e-02  2.222e-02    -1.428 0.153242    \nDEST_HEX_IDHEX_1807        -7.434e-01  2.320e-02   -32.041  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1808        -4.415e-01  2.604e-02   -16.958  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1820         2.773e-01  2.166e-02    12.800  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1821         1.237e+00  2.102e-02    58.861  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1822        -5.573e-01  2.326e-02   -23.962  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1823         3.565e-01  2.273e-02    15.685  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1824         1.155e+00  2.125e-02    54.339  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1827        -4.158e-01  2.325e-02   -17.885  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1828         1.723e-02  2.253e-02     0.765 0.444473    \nDEST_HEX_IDHEX_1829         1.110e+00  2.150e-02    51.610  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1831        -1.051e+00  2.761e-02   -38.071  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1833         1.224e+00  2.104e-02    58.186  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1834         1.222e+00  2.110e-02    57.914  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1835        -7.031e-01  2.415e-02   -29.119  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1846        -1.615e+00  3.390e-02   -47.639  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1847        -1.490e+00  3.040e-02   -49.015  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1848        -5.434e-02  2.190e-02    -2.481 0.013116 *  \nDEST_HEX_IDHEX_1849         1.805e+00  2.091e-02    86.330  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1850         1.038e+00  2.236e-02    46.428  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1852        -2.304e+00  3.882e-02   -59.361  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1853         7.153e-01  2.149e-02    33.283  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1854         1.700e-01  2.201e-02     7.723 1.14e-14 ***\nDEST_HEX_IDHEX_1855        -1.532e+00  2.708e-02   -56.570  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1856        -3.328e+00  1.936e-01   -17.195  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1857        -2.096e+00  5.030e-02   -41.662  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1858        -8.814e-01  2.404e-02   -36.669  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1859        -7.846e-02  2.206e-02    -3.557 0.000375 ***\nDEST_HEX_IDHEX_1860         4.021e-01  2.145e-02    18.744  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1861        -4.357e-01  2.377e-02   -18.332  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1862        -7.924e-01  2.914e-02   -27.197  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1874         6.033e-01  2.139e-02    28.202  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1875         6.576e-01  2.131e-02    30.864  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1876        -2.701e-01  2.400e-02   -11.251  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1877         4.300e-01  2.199e-02    19.550  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1878         4.463e-01  2.181e-02    20.469  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1879        -7.560e-01  2.379e-02   -31.773  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1882         7.988e-01  2.133e-02    37.459  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1883        -1.615e-01  2.264e-02    -7.133 9.79e-13 ***\nDEST_HEX_IDHEX_1884        -8.835e-01  2.769e-02   -31.905  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1886         2.326e+00  2.082e-02   111.725  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1887         2.699e+00  2.078e-02   129.923  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1888        -1.293e-01  2.232e-02    -5.794 6.86e-09 ***\nDEST_HEX_IDHEX_1889        -3.380e+00  9.398e-02   -35.969  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1890        -1.142e+00  4.820e-02   -23.684  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1900        -4.904e-02  2.318e-02    -2.116 0.034387 *  \nDEST_HEX_IDHEX_1901         8.507e-01  2.117e-02    40.176  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1902         3.759e-02  2.219e-02     1.694 0.090272 .  \nDEST_HEX_IDHEX_1903         6.862e-01  2.229e-02    30.790  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1904         5.271e-01  2.244e-02    23.492  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1905        -3.708e-02  2.196e-02    -1.689 0.091260 .  \nDEST_HEX_IDHEX_1906         1.727e-01  2.157e-02     8.007 1.17e-15 ***\nDEST_HEX_IDHEX_1907         3.613e-01  2.161e-02    16.716  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1908         1.826e-01  2.198e-02     8.311  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1909         6.156e-02  2.201e-02     2.797 0.005162 ** \nDEST_HEX_IDHEX_1910        -8.749e-01  2.445e-02   -35.779  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1912        -2.703e+00  4.407e-02   -61.342  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1913         6.207e-01  2.120e-02    29.279  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1914         8.441e-01  2.121e-02    39.793  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1916        -9.417e-01  3.778e-02   -24.928  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1928         4.574e-01  2.171e-02    21.069  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1929         4.258e-01  2.163e-02    19.686  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1930         5.587e-01  2.138e-02    26.130  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1931        -2.005e-02  2.238e-02    -0.896 0.370517    \nDEST_HEX_IDHEX_1932         7.608e-01  2.132e-02    35.686  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1933         8.228e-01  2.148e-02    38.297  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1934        -3.685e-01  2.231e-02   -16.520  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1935         2.810e-01  2.163e-02    12.989  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1936         3.164e-01  2.162e-02    14.631  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1937         7.660e-01  2.132e-02    35.939  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1938        -8.190e-01  4.510e-02   -18.158  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1940         2.718e-01  2.182e-02    12.452  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1941        -4.540e-01  2.259e-02   -20.096  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1942         6.450e-01  2.211e-02    29.177  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1954        -2.553e-01  2.488e-02   -10.260  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1955         9.535e-01  2.121e-02    44.961  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1956         1.937e-01  2.194e-02     8.826  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1958         9.403e-01  2.124e-02    44.267  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1959         8.516e-01  2.110e-02    40.362  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1960         9.956e-01  2.130e-02    46.745  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1961         1.473e+00  2.093e-02    70.362  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1962         1.684e-01  2.148e-02     7.841 4.48e-15 ***\nDEST_HEX_IDHEX_1963         4.040e-02  2.154e-02     1.876 0.060721 .  \nDEST_HEX_IDHEX_1964         8.001e-01  2.134e-02    37.501  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1967         7.554e-01  2.139e-02    35.312  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1968         8.325e-01  2.151e-02    38.694  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1982         1.738e+00  2.095e-02    82.938  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1983         8.651e-01  2.124e-02    40.737  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1984         1.254e+00  2.101e-02    59.704  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1985         8.394e-01  2.137e-02    39.279  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1986        -1.298e-01  2.246e-02    -5.780 7.48e-09 ***\nDEST_HEX_IDHEX_1987         1.769e+00  2.085e-02    84.847  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1988         3.866e-02  2.151e-02     1.798 0.072218 .  \nDEST_HEX_IDHEX_1989        -1.288e-01  2.171e-02    -5.932 2.99e-09 ***\nDEST_HEX_IDHEX_1990         2.152e+00  2.080e-02   103.458  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1991         9.993e-01  2.115e-02    47.258  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1992         1.503e+00  2.124e-02    70.744  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1994        -1.657e+00  2.955e-02   -56.068  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1995         3.476e-01  2.211e-02    15.722  &lt; 2e-16 ***\nDEST_HEX_IDHEX_200          8.737e-01  4.186e-02    20.873  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2009         1.761e+00  2.093e-02    84.138  &lt; 2e-16 ***\nDEST_HEX_IDHEX_201          1.482e+00  2.509e-02    59.081  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2010         1.053e+00  2.106e-02    49.980  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2011         9.538e-01  2.113e-02    45.132  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2012         2.447e-01  2.193e-02    11.159  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2013         3.149e-01  2.132e-02    14.770  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2014         4.496e-01  2.119e-02    21.224  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2015         4.301e-01  2.140e-02    20.096  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2016         1.743e-01  2.151e-02     8.107 5.19e-16 ***\nDEST_HEX_IDHEX_2017         5.466e-01  2.134e-02    25.619  &lt; 2e-16 ***\nDEST_HEX_IDHEX_202          7.961e-01  3.243e-02    24.548  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2021        -7.728e-01  2.431e-02   -31.796  &lt; 2e-16 ***\nDEST_HEX_IDHEX_203          1.207e+00  2.945e-02    40.991  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2036        -1.442e+00  3.641e-02   -39.594  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2037        -4.078e-01  2.337e-02   -17.454  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2038         1.426e+00  2.097e-02    68.034  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2039        -1.408e-01  2.216e-02    -6.353 2.10e-10 ***\nDEST_HEX_IDHEX_2040         1.859e-01  2.168e-02     8.574  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2041         5.808e-01  2.160e-02    26.893  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2042         2.229e-01  2.208e-02    10.096  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2043         5.033e-01  2.127e-02    23.664  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2044         2.538e-01  2.145e-02    11.832  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2046        -4.369e-01  2.416e-02   -18.085  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2049        -1.712e+00  3.081e-02   -55.572  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2063         1.883e-01  2.310e-02     8.150 3.63e-16 ***\nDEST_HEX_IDHEX_2064         8.526e-01  2.126e-02    40.099  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2065         1.999e-01  2.155e-02     9.273  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2066         9.451e-02  2.157e-02     4.382 1.18e-05 ***\nDEST_HEX_IDHEX_2067         1.641e-01  2.144e-02     7.654 1.95e-14 ***\nDEST_HEX_IDHEX_2068         3.296e-01  2.137e-02    15.424  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2069        -1.629e+00  2.552e-02   -63.851  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2070         6.801e-01  2.150e-02    31.630  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2071         1.105e+00  2.112e-02    52.312  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2072        -2.331e+00  4.835e-02   -48.204  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2074        -1.679e+00  3.619e-02   -46.412  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2089        -8.452e-01  6.996e-02   -12.082  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2090        -2.001e+00  1.047e-01   -19.116  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2091        -1.164e+00  3.007e-02   -38.712  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2092         3.191e-01  2.171e-02    14.696  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2093         8.972e-01  2.109e-02    42.534  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2094         4.958e-01  2.145e-02    23.111  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2095         7.579e-01  2.183e-02    34.724  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2096        -6.489e-01  2.262e-02   -28.687  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2097        -6.399e-01  3.114e-02   -20.551  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2098         1.870e-01  2.176e-02     8.595  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2100        -1.877e+00  4.929e-02   -38.082  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2101        -4.739e-01  2.623e-02   -18.064  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2102         4.867e-01  2.262e-02    21.522  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2116        -1.460e+00  1.021e-01   -14.292  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2117        -2.378e+00  1.364e-01   -17.428  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2119         4.623e-01  2.143e-02    21.571  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2120         1.099e+00  2.104e-02    52.205  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2121         5.177e-01  2.142e-02    24.175  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2122        -3.128e+00  5.905e-02   -52.968  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2123        -6.062e-01  2.236e-02   -27.114  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2124        -4.320e-01  2.273e-02   -19.002  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2125         1.140e+00  2.111e-02    53.991  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2126        -9.337e-01  2.486e-02   -37.556  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2129        -8.881e-01  2.908e-02   -30.536  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2146        -5.197e-01  2.948e-02   -17.629  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2147         5.434e-01  2.125e-02    25.576  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2148         7.787e-01  2.116e-02    36.799  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2149         2.936e-01  2.165e-02    13.564  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2150        -1.346e+00  2.447e-02   -54.994  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2151        -1.331e+00  2.466e-02   -53.955  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2152         1.185e+00  2.107e-02    56.239  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2153         3.148e-01  2.439e-02    12.910  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2154        -6.907e-01  2.354e-02   -29.342  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2155        -1.139e-01  2.323e-02    -4.903 9.43e-07 ***\nDEST_HEX_IDHEX_2171        -2.404e+00  1.972e-01   -12.188  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2172        -6.268e-01  3.195e-02   -19.617  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2174        -1.219e+00  2.650e-02   -46.005  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2175         1.313e+00  2.098e-02    62.587  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2176         2.977e-01  2.148e-02    13.862  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2177         1.939e+00  2.083e-02    93.089  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2178        -1.171e+00  2.343e-02   -49.966  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2179         6.426e-01  2.124e-02    30.260  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2180        -1.034e-01  2.201e-02    -4.698 2.63e-06 ***\nDEST_HEX_IDHEX_2181         9.244e-01  2.126e-02    43.479  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2182        -3.163e-01  2.757e-02   -11.475  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2200         3.863e-01  2.390e-02    16.160  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2201         4.036e-01  2.136e-02    18.894  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2202         1.259e+00  2.146e-02    58.667  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2203         6.604e-01  2.174e-02    30.374  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2204         7.598e-01  2.115e-02    35.922  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2205        -1.581e-01  2.176e-02    -7.265 3.72e-13 ***\nDEST_HEX_IDHEX_2206         8.026e-01  2.109e-02    38.062  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2207        -2.475e-01  2.187e-02   -11.317  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2208         1.310e-01  2.180e-02     6.010 1.85e-09 ***\nDEST_HEX_IDHEX_2209        -1.497e+00  3.304e-02   -45.320  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2227        -2.637e-01  2.261e-02   -11.662  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2228         2.281e-01  2.159e-02    10.566  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2229         8.059e-01  2.116e-02    38.085  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2230         3.645e-01  2.206e-02    16.523  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2231        -7.470e-02  2.158e-02    -3.462 0.000536 ***\nDEST_HEX_IDHEX_2233         7.140e-01  2.111e-02    33.826  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2234        -4.401e+00  8.761e-02   -50.230  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2235        -2.854e+00  6.742e-02   -42.327  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2254         5.701e-01  2.325e-02    24.517  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2255         2.457e-02  2.204e-02     1.115 0.265061    \nDEST_HEX_IDHEX_2256         2.418e-01  2.159e-02    11.200  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2257         9.736e-02  2.279e-02     4.272 1.94e-05 ***\nDEST_HEX_IDHEX_2258        -7.221e-01  2.293e-02   -31.489  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2259        -8.112e-01  2.314e-02   -35.062  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2260         8.238e-02  2.167e-02     3.801 0.000144 ***\nDEST_HEX_IDHEX_2261         2.391e-01  2.159e-02    11.075  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2262        -8.674e-01  2.336e-02   -37.133  &lt; 2e-16 ***\nDEST_HEX_IDHEX_227         -3.805e-01  4.737e-02    -8.032 9.59e-16 ***\nDEST_HEX_IDHEX_228          8.959e-01  2.732e-02    32.791  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2281        -2.379e-03  2.220e-02    -0.107 0.914650    \nDEST_HEX_IDHEX_2282         1.080e+00  2.110e-02    51.188  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2283         9.294e-02  2.181e-02     4.262 2.03e-05 ***\nDEST_HEX_IDHEX_2284         3.176e-01  2.148e-02    14.789  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2285         5.141e-01  2.160e-02    23.796  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2286        -3.533e-01  2.202e-02   -16.047  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2287         7.540e-01  2.109e-02    35.754  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2288        -1.469e+00  2.586e-02   -56.800  &lt; 2e-16 ***\nDEST_HEX_IDHEX_229         -2.011e+00  1.074e-01   -18.720  &lt; 2e-16 ***\nDEST_HEX_IDHEX_230          2.105e+00  2.375e-02    88.617  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2308         1.253e-01  2.279e-02     5.500 3.80e-08 ***\nDEST_HEX_IDHEX_2309         7.958e-01  2.133e-02    37.316  &lt; 2e-16 ***\nDEST_HEX_IDHEX_231         -6.039e-01  3.944e-02   -15.313  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2310         2.752e-01  2.143e-02    12.845  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2311         1.124e+00  2.102e-02    53.447  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2312        -2.503e-01  2.267e-02   -11.038  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2313         1.377e+00  2.104e-02    65.456  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2314         1.487e+00  2.087e-02    71.238  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2315        -1.616e-01  2.189e-02    -7.380 1.58e-13 ***\nDEST_HEX_IDHEX_2316         2.021e-01  2.154e-02     9.384  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2317        -1.823e+00  3.596e-02   -50.696  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2335        -7.933e-01  2.632e-02   -30.139  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2336         1.250e+00  2.096e-02    59.636  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2337         7.883e-01  2.114e-02    37.293  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2338         3.115e-01  2.190e-02    14.227  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2339         8.472e-01  2.122e-02    39.934  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2340         3.932e-01  2.122e-02    18.530  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2341         6.279e-01  2.111e-02    29.745  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2342        -3.754e-01  2.178e-02   -17.237  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2343        -7.051e-01  2.274e-02   -31.005  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2362         3.292e-03  2.417e-02     0.136 0.891651    \nDEST_HEX_IDHEX_2363         3.215e-01  2.171e-02    14.808  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2364        -4.595e-01  2.333e-02   -19.695  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2365         1.125e+00  2.109e-02    53.367  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2366         8.123e-01  2.399e-02    33.855  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2367         4.746e-01  2.152e-02    22.052  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2368         2.098e-01  2.139e-02     9.810  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2369         1.163e+00  2.095e-02    55.520  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2370         1.801e+00  2.083e-02    86.450  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2371        -1.185e-01  2.190e-02    -5.412 6.24e-08 ***\nDEST_HEX_IDHEX_2389         2.450e-01  2.197e-02    11.151  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2390         1.075e+00  2.107e-02    51.019  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2391         8.903e-01  2.130e-02    41.799  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2392         1.089e+00  2.259e-02    48.202  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2393         2.100e+00  2.195e-02    95.672  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2394        -1.373e+00  2.531e-02   -54.253  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2395         2.319e-01  2.134e-02    10.869  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2396         1.343e-01  2.130e-02     6.307 2.84e-10 ***\nDEST_HEX_IDHEX_2397        -1.197e+00  2.335e-02   -51.263  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2398        -3.936e-01  2.382e-02   -16.527  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2416        -1.557e-02  2.282e-02    -0.683 0.494888    \nDEST_HEX_IDHEX_2417        -6.512e-02  2.346e-02    -2.776 0.005503 ** \nDEST_HEX_IDHEX_2418         3.925e-01  2.148e-02    18.276  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2419         1.171e+00  2.106e-02    55.608  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2420        -1.518e+00  4.551e-02   -33.364  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2422        -1.550e+00  3.302e-02   -46.951  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2423        -8.176e-01  2.271e-02   -36.009  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2424         9.913e-01  2.098e-02    47.257  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2425         1.807e+00  2.086e-02    86.633  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2426        -6.134e-01  2.706e-02   -22.668  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2443         1.445e+00  2.105e-02    68.634  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2444         9.359e-01  2.110e-02    44.352  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2445         1.043e+00  2.107e-02    49.507  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2448         1.056e-01  2.346e-02     4.501 6.76e-06 ***\nDEST_HEX_IDHEX_2449        -9.948e-01  2.433e-02   -40.880  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2450        -4.716e-01  2.218e-02   -21.263  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2451         1.250e+00  2.094e-02    59.709  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2452        -2.267e+00  3.449e-02   -65.719  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2471        -3.408e-02  2.202e-02    -1.548 0.121700    \nDEST_HEX_IDHEX_2472        -1.687e+00  2.903e-02   -58.102  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2473         1.144e+00  2.113e-02    54.126  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2476         1.250e+00  2.206e-02    56.674  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2478        -2.604e-01  2.196e-02   -11.860  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2479        -1.498e+00  2.611e-02   -57.373  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2480        -1.086e+00  3.155e-02   -34.407  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2497         7.253e-01  2.144e-02    33.835  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2498        -1.051e+00  2.604e-02   -40.373  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2499        -2.064e-01  2.252e-02    -9.163  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2500        -7.667e-01  2.673e-02   -28.687  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2503        -1.984e+00  6.189e-02   -32.058  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2504        -5.347e-01  2.286e-02   -23.388  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2505        -1.654e-01  2.202e-02    -7.511 5.87e-14 ***\nDEST_HEX_IDHEX_2525        -2.176e-01  2.286e-02    -9.520  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2526         8.921e-01  2.122e-02    42.047  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2527         1.201e+00  2.107e-02    56.991  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2531        -3.130e+00  1.074e-01   -29.132  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2532        -3.509e-01  2.255e-02   -15.562  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2533        -8.714e-01  2.714e-02   -32.103  &lt; 2e-16 ***\nDEST_HEX_IDHEX_254          1.589e+00  2.859e-02    55.584  &lt; 2e-16 ***\nDEST_HEX_IDHEX_255          1.028e+00  2.856e-02    35.986  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2551         9.996e-01  2.145e-02    46.596  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2552        -3.840e-01  2.435e-02   -15.770  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2553         3.024e-01  2.267e-02    13.338  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2554        -8.965e-01  2.410e-02   -37.192  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2557         1.012e+00  2.266e-02    44.668  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2559        -1.200e+00  2.684e-02   -44.720  &lt; 2e-16 ***\nDEST_HEX_IDHEX_256          2.118e+00  2.442e-02    86.744  &lt; 2e-16 ***\nDEST_HEX_IDHEX_257         -1.595e-02  3.000e-02    -0.532 0.595038    \nDEST_HEX_IDHEX_2579         3.283e-02  2.207e-02     1.488 0.136821    \nDEST_HEX_IDHEX_258          5.959e-01  3.020e-02    19.732  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2580         1.036e+00  2.114e-02    49.016  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2581        -2.120e-01  2.247e-02    -9.435  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2584        -9.608e-01  3.138e-02   -30.620  &lt; 2e-16 ***\nDEST_HEX_IDHEX_259          5.435e-01  2.606e-02    20.860  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2605        -8.017e-01  2.784e-02   -28.794  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2606        -8.185e-01  2.868e-02   -28.543  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2607         4.435e-02  2.188e-02     2.027 0.042655 *  \nDEST_HEX_IDHEX_2608        -3.571e-01  2.316e-02   -15.421  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2609        -2.214e+00  4.237e-02   -52.259  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2610        -1.212e+00  3.458e-02   -35.041  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2611         1.467e+00  2.349e-02    62.480  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2633         3.585e-01  2.188e-02    16.388  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2634         2.337e+00  2.080e-02   112.323  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2635        -6.731e-01  2.367e-02   -28.435  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2636         7.529e-01  2.137e-02    35.232  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2637        -3.363e-01  2.305e-02   -14.589  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2638         1.360e-01  2.204e-02     6.172 6.76e-10 ***\nDEST_HEX_IDHEX_2660         4.861e-01  2.155e-02    22.553  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2661         3.364e-01  2.141e-02    15.714  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2662        -4.959e-01  2.246e-02   -22.076  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2663         9.032e-01  2.129e-02    42.424  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2664         8.087e-02  2.185e-02     3.700 0.000215 ***\nDEST_HEX_IDHEX_2665         1.442e+00  2.101e-02    68.650  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2687        -7.572e-01  2.420e-02   -31.289  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2688         4.517e-01  2.138e-02    21.130  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2689         1.164e+00  2.107e-02    55.224  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2690         9.327e-01  2.117e-02    44.065  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2691         2.830e-01  2.156e-02    13.129  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2692        -2.920e+00  5.093e-02   -57.334  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2693         6.684e-01  2.143e-02    31.182  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2714        -5.306e-01  2.296e-02   -23.105  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2715         1.819e-01  2.189e-02     8.312  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2716        -1.580e+00  2.596e-02   -60.854  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2717         4.895e-01  2.120e-02    23.094  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2718        -3.700e-01  2.243e-02   -16.498  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2719         5.881e-01  2.142e-02    27.458  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2742         7.586e-01  2.131e-02    35.595  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2743         9.470e-01  2.179e-02    43.455  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2744         1.216e+00  2.097e-02    58.010  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2745         1.285e+00  2.095e-02    61.316  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2746        -1.411e+00  2.584e-02   -54.602  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2747        -1.435e-01  2.255e-02    -6.363 1.98e-10 ***\nDEST_HEX_IDHEX_2768         7.571e-01  2.159e-02    35.064  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2769         1.621e+00  2.100e-02    77.213  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2770         1.073e+00  2.112e-02    50.812  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2771         2.359e+00  2.079e-02   113.480  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2772        -2.535e+00  3.657e-02   -69.307  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2773        -5.829e-01  2.249e-02   -25.914  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2795        -1.320e-01  6.953e-02    -1.898 0.057729 .  \nDEST_HEX_IDHEX_2796        -4.145e+00  1.402e-01   -29.562  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2797         7.735e-01  2.136e-02    36.213  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2798        -8.635e-01  2.300e-02   -37.540  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2799        -3.841e-02  2.168e-02    -1.772 0.076456 .  \nDEST_HEX_IDHEX_2800         1.432e+00  2.099e-02    68.203  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2801        -1.999e+00  3.832e-02   -52.169  &lt; 2e-16 ***\nDEST_HEX_IDHEX_281         -1.973e-01  4.917e-02    -4.013 6.00e-05 ***\nDEST_HEX_IDHEX_282          2.842e-01  3.564e-02     7.974 1.53e-15 ***\nDEST_HEX_IDHEX_2822        -7.375e-01  2.515e-02   -29.322  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2823         5.966e-01  2.166e-02    27.540  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2824         1.175e+00  2.121e-02    55.432  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2825         4.391e-01  2.127e-02    20.640  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2826        -4.041e-02  2.244e-02    -1.801 0.071725 .  \nDEST_HEX_IDHEX_2827         1.852e+00  2.087e-02    88.716  &lt; 2e-16 ***\nDEST_HEX_IDHEX_284          1.697e+00  2.290e-02    74.079  &lt; 2e-16 ***\nDEST_HEX_IDHEX_285          6.199e-01  2.417e-02    25.651  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2850        -2.756e-01  2.533e-02   -10.879  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2851         1.194e+00  2.122e-02    56.259  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2852        -5.005e-01  2.292e-02   -21.834  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2853         1.636e+00  2.089e-02    78.317  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2854         4.241e-01  2.142e-02    19.793  &lt; 2e-16 ***\nDEST_HEX_IDHEX_286          9.980e-01  2.318e-02    43.052  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2877         1.638e-01  2.448e-02     6.694 2.17e-11 ***\nDEST_HEX_IDHEX_2878         4.916e-01  2.173e-02    22.620  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2879         2.035e-01  2.221e-02     9.164  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2880        -1.586e-01  2.187e-02    -7.250 4.16e-13 ***\nDEST_HEX_IDHEX_2881        -1.029e-01  2.236e-02    -4.605 4.13e-06 ***\nDEST_HEX_IDHEX_2905         7.134e-01  2.201e-02    32.405  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2906         1.607e-01  2.265e-02     7.096 1.28e-12 ***\nDEST_HEX_IDHEX_2907        -4.467e-01  2.241e-02   -19.930  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2908         6.081e-01  2.144e-02    28.360  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2909        -1.326e+00  4.603e-02   -28.814  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2931         1.232e+00  2.225e-02    55.375  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2932         5.109e-01  2.262e-02    22.588  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2933         1.183e+00  2.138e-02    55.348  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2934        -6.466e-02  2.199e-02    -2.940 0.003277 ** \nDEST_HEX_IDHEX_2959         1.103e+00  2.272e-02    48.564  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2960         2.090e+00  2.180e-02    95.900  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2961         3.377e-01  2.220e-02    15.211  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2962         8.785e-01  2.141e-02    41.032  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2963         7.321e-01  2.390e-02    30.631  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2987         8.357e-01  2.344e-02    35.657  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2988        -1.828e+00  3.405e-02   -53.696  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2989         4.628e-01  2.212e-02    20.919  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2990         1.123e+00  2.442e-02    45.995  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3015        -2.798e-01  2.976e-02    -9.403  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3016         4.493e-01  2.386e-02    18.827  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3017         2.041e-01  2.281e-02     8.949  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3040         1.658e+00  2.146e-02    77.254  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3043         4.895e-02  2.291e-02     2.137 0.032635 *  \nDEST_HEX_IDHEX_3044         3.226e-01  2.281e-02    14.142  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3068         2.024e-01  2.406e-02     8.414  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3070        -2.589e-01  2.831e-02    -9.146  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3072        -3.973e-01  3.216e-02   -12.356  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3092         1.783e+00  2.690e-02    66.283  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3098         7.442e-01  2.222e-02    33.495  &lt; 2e-16 ***\nDEST_HEX_IDHEX_312          1.207e+00  2.409e-02    50.087  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3123         2.922e+00  2.097e-02   139.295  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3126        -2.894e+00  7.385e-02   -39.190  &lt; 2e-16 ***\nDEST_HEX_IDHEX_313          1.530e-01  3.264e-02     4.688 2.76e-06 ***\nDEST_HEX_IDHEX_314          8.152e-01  2.710e-02    30.081  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3151         2.367e+00  2.117e-02   111.808  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3152        -2.909e+00  7.010e-02   -41.507  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3173         1.235e+00  3.316e-02    37.224  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3178         9.413e-01  2.289e-02    41.124  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3179         6.074e-01  2.312e-02    26.269  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3205         1.497e+00  2.396e-02    62.471  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3206         1.960e+00  2.165e-02    90.519  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3232         1.159e+00  3.077e-02    37.681  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3233         4.291e-01  3.017e-02    14.222  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3308         2.123e+00  2.829e-02    75.019  &lt; 2e-16 ***\nDEST_HEX_IDHEX_336         -6.233e-01  4.744e-02   -13.139  &lt; 2e-16 ***\nDEST_HEX_IDHEX_338         -1.291e-01  3.216e-02    -4.015 5.95e-05 ***\nDEST_HEX_IDHEX_339         -9.015e-01  3.257e-02   -27.681  &lt; 2e-16 ***\nDEST_HEX_IDHEX_340         -2.544e+00  2.781e-01    -9.148  &lt; 2e-16 ***\nDEST_HEX_IDHEX_366         -2.728e-02  2.591e-02    -1.053 0.292508    \nDEST_HEX_IDHEX_367          9.613e-01  2.356e-02    40.799  &lt; 2e-16 ***\nDEST_HEX_IDHEX_391          4.237e-01  3.611e-02    11.731  &lt; 2e-16 ***\nDEST_HEX_IDHEX_392          7.288e-02  2.793e-02     2.610 0.009059 ** \nDEST_HEX_IDHEX_393          1.472e+00  2.241e-02    65.689  &lt; 2e-16 ***\nDEST_HEX_IDHEX_394         -1.197e+00  8.295e-02   -14.433  &lt; 2e-16 ***\nDEST_HEX_IDHEX_419          1.541e+00  2.738e-02    56.269  &lt; 2e-16 ***\nDEST_HEX_IDHEX_420          8.909e-01  2.572e-02    34.640  &lt; 2e-16 ***\nDEST_HEX_IDHEX_421          1.105e+00  3.127e-02    35.342  &lt; 2e-16 ***\nDEST_HEX_IDHEX_445          1.847e+00  2.397e-02    77.053  &lt; 2e-16 ***\nDEST_HEX_IDHEX_446         -3.165e-01  2.876e-02   -11.007  &lt; 2e-16 ***\nDEST_HEX_IDHEX_447          3.280e-01  2.711e-02    12.100  &lt; 2e-16 ***\nDEST_HEX_IDHEX_472         -5.372e-01  3.798e-02   -14.145  &lt; 2e-16 ***\nDEST_HEX_IDHEX_473          1.557e+00  2.413e-02    64.529  &lt; 2e-16 ***\nDEST_HEX_IDHEX_474          3.984e-01  2.632e-02    15.138  &lt; 2e-16 ***\nDEST_HEX_IDHEX_499          1.648e+00  2.413e-02    68.323  &lt; 2e-16 ***\nDEST_HEX_IDHEX_500          1.543e-01  2.563e-02     6.018 1.76e-09 ***\nDEST_HEX_IDHEX_526          1.958e+00  2.302e-02    85.052  &lt; 2e-16 ***\nDEST_HEX_IDHEX_527          1.365e+00  2.604e-02    52.435  &lt; 2e-16 ***\nDEST_HEX_IDHEX_528          1.900e+00  2.233e-02    85.079  &lt; 2e-16 ***\nDEST_HEX_IDHEX_552          1.022e+00  2.855e-02    35.806  &lt; 2e-16 ***\nDEST_HEX_IDHEX_553         -1.461e+00  6.237e-02   -23.432  &lt; 2e-16 ***\nDEST_HEX_IDHEX_554          1.468e+00  2.320e-02    63.257  &lt; 2e-16 ***\nDEST_HEX_IDHEX_555          1.489e+00  2.295e-02    64.870  &lt; 2e-16 ***\nDEST_HEX_IDHEX_581          1.795e+00  2.236e-02    80.244  &lt; 2e-16 ***\nDEST_HEX_IDHEX_582          4.303e-01  2.398e-02    17.947  &lt; 2e-16 ***\nDEST_HEX_IDHEX_607          1.147e+00  2.657e-02    43.170  &lt; 2e-16 ***\nDEST_HEX_IDHEX_608          9.713e-01  2.409e-02    40.323  &lt; 2e-16 ***\nDEST_HEX_IDHEX_609          1.623e+00  2.128e-02    76.276  &lt; 2e-16 ***\nDEST_HEX_IDHEX_610          1.316e+00  2.321e-02    56.704  &lt; 2e-16 ***\nDEST_HEX_IDHEX_611         -3.338e-01  3.645e-02    -9.158  &lt; 2e-16 ***\nDEST_HEX_IDHEX_634          1.685e+00  2.489e-02    67.694  &lt; 2e-16 ***\nDEST_HEX_IDHEX_635          1.363e+00  2.317e-02    58.804  &lt; 2e-16 ***\nDEST_HEX_IDHEX_636          3.853e-02  2.367e-02     1.628 0.103504    \nDEST_HEX_IDHEX_638          2.219e+00  2.139e-02   103.759  &lt; 2e-16 ***\nDEST_HEX_IDHEX_661          4.870e-01  2.992e-02    16.278  &lt; 2e-16 ***\nDEST_HEX_IDHEX_662          1.881e+00  2.372e-02    79.276  &lt; 2e-16 ***\nDEST_HEX_IDHEX_663          2.086e-01  2.293e-02     9.094  &lt; 2e-16 ***\nDEST_HEX_IDHEX_664          8.370e-01  2.310e-02    36.235  &lt; 2e-16 ***\nDEST_HEX_IDHEX_665          3.095e-01  2.443e-02    12.670  &lt; 2e-16 ***\nDEST_HEX_IDHEX_689          2.511e-01  2.661e-02     9.437  &lt; 2e-16 ***\nDEST_HEX_IDHEX_690          6.269e-01  2.293e-02    27.336  &lt; 2e-16 ***\nDEST_HEX_IDHEX_692         -1.138e-01  2.521e-02    -4.512 6.43e-06 ***\nDEST_HEX_IDHEX_693         -6.790e-01  3.522e-02   -19.277  &lt; 2e-16 ***\nDEST_HEX_IDHEX_715          1.886e-01  2.952e-02     6.389 1.66e-10 ***\nDEST_HEX_IDHEX_716          1.101e-02  2.643e-02     0.417 0.676961    \nDEST_HEX_IDHEX_717         -1.058e-01  2.343e-02    -4.515 6.33e-06 ***\nDEST_HEX_IDHEX_718          1.435e+00  2.133e-02    67.251  &lt; 2e-16 ***\nDEST_HEX_IDHEX_719         -3.522e-01  2.972e-02   -11.852  &lt; 2e-16 ***\nDEST_HEX_IDHEX_720         -1.957e+00  5.501e-02   -35.574  &lt; 2e-16 ***\nDEST_HEX_IDHEX_743          1.134e+00  2.298e-02    49.356  &lt; 2e-16 ***\nDEST_HEX_IDHEX_744          7.470e-01  2.255e-02    33.124  &lt; 2e-16 ***\nDEST_HEX_IDHEX_745          4.440e-01  2.170e-02    20.458  &lt; 2e-16 ***\nDEST_HEX_IDHEX_746         -1.484e-01  2.291e-02    -6.476 9.40e-11 ***\nDEST_HEX_IDHEX_747          1.070e+00  2.260e-02    47.338  &lt; 2e-16 ***\nDEST_HEX_IDHEX_748         -2.208e-01  2.891e-02    -7.638 2.21e-14 ***\nDEST_HEX_IDHEX_769          2.175e-01  2.616e-02     8.314  &lt; 2e-16 ***\nDEST_HEX_IDHEX_770          1.835e+00  2.178e-02    84.249  &lt; 2e-16 ***\nDEST_HEX_IDHEX_771          5.540e-01  2.192e-02    25.278  &lt; 2e-16 ***\nDEST_HEX_IDHEX_772          1.560e+00  2.100e-02    74.286  &lt; 2e-16 ***\nDEST_HEX_IDHEX_773         -8.967e-01  2.622e-02   -34.203  &lt; 2e-16 ***\nDEST_HEX_IDHEX_774          6.182e-01  2.375e-02    26.033  &lt; 2e-16 ***\nDEST_HEX_IDHEX_775          5.380e-02  2.593e-02     2.074 0.038050 *  \nDEST_HEX_IDHEX_776         -3.853e+00  2.052e-01   -18.778  &lt; 2e-16 ***\nDEST_HEX_IDHEX_777         -8.856e-01  4.794e-02   -18.472  &lt; 2e-16 ***\nDEST_HEX_IDHEX_797         -1.532e-01  2.726e-02    -5.621 1.90e-08 ***\nDEST_HEX_IDHEX_798         -1.254e+00  5.334e-02   -23.508  &lt; 2e-16 ***\nDEST_HEX_IDHEX_799          1.182e+00  2.119e-02    55.763  &lt; 2e-16 ***\nDEST_HEX_IDHEX_800          5.136e-01  2.153e-02    23.852  &lt; 2e-16 ***\nDEST_HEX_IDHEX_802         -2.833e+00  7.944e-02   -35.654  &lt; 2e-16 ***\nDEST_HEX_IDHEX_803         -5.969e-01  3.923e-02   -15.216  &lt; 2e-16 ***\nDEST_HEX_IDHEX_805         -7.441e-01  5.577e-02   -13.343  &lt; 2e-16 ***\nDEST_HEX_IDHEX_806          1.126e+00  2.614e-02    43.079  &lt; 2e-16 ***\nDEST_HEX_IDHEX_823          9.305e-01  2.717e-02    34.245  &lt; 2e-16 ***\nDEST_HEX_IDHEX_824          1.110e+00  2.393e-02    46.384  &lt; 2e-16 ***\nDEST_HEX_IDHEX_825          4.527e-01  2.341e-02    19.336  &lt; 2e-16 ***\nDEST_HEX_IDHEX_826          2.512e+00  2.079e-02   120.801  &lt; 2e-16 ***\nDEST_HEX_IDHEX_827          1.122e+00  2.129e-02    52.704  &lt; 2e-16 ***\nDEST_HEX_IDHEX_832         -3.299e+00  2.095e-01   -15.743  &lt; 2e-16 ***\nDEST_HEX_IDHEX_833         -9.425e-01  5.508e-02   -17.112  &lt; 2e-16 ***\nDEST_HEX_IDHEX_851          2.822e-02  2.899e-02     0.973 0.330371    \nDEST_HEX_IDHEX_852          1.411e+00  2.291e-02    61.579  &lt; 2e-16 ***\nDEST_HEX_IDHEX_853          1.274e-02  2.194e-02     0.581 0.561348    \nDEST_HEX_IDHEX_854          2.753e-01  2.158e-02    12.762  &lt; 2e-16 ***\nDEST_HEX_IDHEX_856         -4.674e+00  2.142e-01   -21.819  &lt; 2e-16 ***\nDEST_HEX_IDHEX_861         -9.568e-01  5.367e-02   -17.828  &lt; 2e-16 ***\nDEST_HEX_IDHEX_862          1.003e-01  4.149e-02     2.417 0.015659 *  \nDEST_HEX_IDHEX_878          1.047e+00  2.409e-02    43.462  &lt; 2e-16 ***\nDEST_HEX_IDHEX_879          9.658e-01  2.189e-02    44.125  &lt; 2e-16 ***\nDEST_HEX_IDHEX_880         -2.084e-01  2.193e-02    -9.503  &lt; 2e-16 ***\nDEST_HEX_IDHEX_881          2.525e-01  2.211e-02    11.418  &lt; 2e-16 ***\nDEST_HEX_IDHEX_888         -1.611e+00  2.246e-01    -7.172 7.39e-13 ***\nDEST_HEX_IDHEX_889         -2.041e-01  5.418e-02    -3.766 0.000166 ***\nDEST_HEX_IDHEX_905          1.542e-01  2.698e-02     5.716 1.09e-08 ***\nDEST_HEX_IDHEX_906         -4.651e-01  2.791e-02   -16.663  &lt; 2e-16 ***\nDEST_HEX_IDHEX_907          9.341e-01  2.166e-02    43.127  &lt; 2e-16 ***\nDEST_HEX_IDHEX_908          5.757e-01  2.145e-02    26.838  &lt; 2e-16 ***\nDEST_HEX_IDHEX_910          9.918e-01  2.407e-02    41.208  &lt; 2e-16 ***\nDEST_HEX_IDHEX_932          8.157e-01  2.244e-02    36.345  &lt; 2e-16 ***\nDEST_HEX_IDHEX_933         -1.495e-01  2.362e-02    -6.331 2.44e-10 ***\nDEST_HEX_IDHEX_934          5.452e-01  2.144e-02    25.435  &lt; 2e-16 ***\nDEST_HEX_IDHEX_935          5.983e-01  2.146e-02    27.875  &lt; 2e-16 ***\nDEST_HEX_IDHEX_937          8.202e-01  2.305e-02    35.578  &lt; 2e-16 ***\nDEST_HEX_IDHEX_959          1.930e+00  2.140e-02    90.156  &lt; 2e-16 ***\nDEST_HEX_IDHEX_960          6.978e-01  2.162e-02    32.284  &lt; 2e-16 ***\nDEST_HEX_IDHEX_961          1.738e-01  2.188e-02     7.944 1.96e-15 ***\nDEST_HEX_IDHEX_962          2.445e+00  2.082e-02   117.400  &lt; 2e-16 ***\nDEST_HEX_IDHEX_986         -4.112e-01  2.763e-02   -14.880  &lt; 2e-16 ***\nDEST_HEX_IDHEX_987          1.114e+00  2.125e-02    52.427  &lt; 2e-16 ***\nDEST_HEX_IDHEX_988         -6.646e-01  2.384e-02   -27.878  &lt; 2e-16 ***\nDEST_HEX_IDHEX_989          7.906e-01  2.127e-02    37.165  &lt; 2e-16 ***\nDEST_HEX_IDHEX_991          5.877e-01  2.322e-02    25.309  &lt; 2e-16 ***\nlog(DISTANCE)              -1.441e+00  2.840e-04 -5073.517  &lt; 2e-16 ***\nlog(ORIG_TOTAL_BUS_STOPS)   4.744e-01  5.728e-04   828.348  &lt; 2e-16 ***\nlog(ORIG_TOTAL_BUS_INT)     8.778e-01  1.057e-03   830.419  &lt; 2e-16 ***\nlog(ORIG_TOTAL_MRT_INT)    -8.290e-01  1.713e-03  -483.850  &lt; 2e-16 ***\nlog(ORIG_TOTAL_MRT_STN)    -3.526e-01  1.130e-03  -312.037  &lt; 2e-16 ***\nlog(ORIG_TOTAL_LRT_STN)    -9.052e-02  1.095e-03   -82.651  &lt; 2e-16 ***\nlog(ORIG_TOTAL_STN_EXIT)    2.501e-01  5.155e-04   485.212  &lt; 2e-16 ***\nlog(ORIG_TOTAL_HDB_POP)     1.135e-01  7.998e-05  1418.768  &lt; 2e-16 ***\nlog(ORIG_TOTAL_HOTEL_ROOM) -1.026e-02  1.271e-04   -80.765  &lt; 2e-16 ***\nlog(ORIG_TOTAL_PTE_POP)     5.429e-03  6.245e-05    86.929  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 80303496  on 63387  degrees of freedom\nResidual deviance: 29111706  on 62555  degrees of freedom\nAIC: 29457560\n\nNumber of Fisher Scoring iterations: 7\n\n\n\n\nDoubly Constraint\n#|eval: false\n\nrm(list = ls())\nflowmerge_interzonal &lt;- read_rds(\"data/rds/flowmerge.rds\") %&gt;%\n  filter(ORIG_HEX_ID != DEST_HEX_ID)\n\ndoubly_constraint &lt;- glm(\n  formula = TOTAL_TRIPS ~\n  ORIG_HEX_ID +\n  DEST_HEX_ID + \n  log(DISTANCE),\n  family = poisson(link = \"log\"),\n  data = flowmerge_interzonal,\n  na.action = na.exclude\n  )\n\nwrite_rds(doubly_constraint, \"data/rds/doubly_constraint.rds\")\n\n\nCode\ndoubly_constraint &lt;- read_rds(\"data/rds/doubly_constraint.rds\")\nsummary(doubly_constraint)\n\n\n\nCall:\nglm(formula = TOTAL_TRIPS ~ ORIG_HEX_ID + DEST_HEX_ID + log(DISTANCE), \n    family = poisson(link = \"log\"), data = flowmerge_interzonal, \n    na.action = na.exclude)\n\nCoefficients:\n                      Estimate Std. Error   z value Pr(&gt;|z|)    \n(Intercept)         11.9732302  0.1268032    94.424  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1014  4.3463499  0.1255425    34.621  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1015  5.0803809  0.1253074    40.543  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1016  5.1545246  0.1251711    41.180  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1042  4.9742655  0.1253643    39.678  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1043  5.5976537  0.1251654    44.722  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1045  2.7953483  0.1315851    21.244  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1067  3.8673580  0.1259719    30.700  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1068  3.0898976  0.1282225    24.098  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1069  2.7136793  0.1268983    21.385  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1070  5.8727594  0.1251223    46.936  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1078  2.4160793  0.1470029    16.436  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1093  1.6335623  0.1356999    12.038  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1094  5.0387911  0.1252390    40.233  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1095  2.1172752  0.1284990    16.477  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1096  5.4993963  0.1251416    43.945  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1097  5.8430614  0.1251837    46.676  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1099  7.4936802  0.1251187    59.893  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1100  3.6517117  0.1323223    27.597  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1122  5.9708160  0.1251336    47.716  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1123  6.3276822  0.1250955    50.583  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1124  5.6133863  0.1251617    44.849  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1125  6.3283102  0.1251490    50.566  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1126  5.5994439  0.1257952    44.512  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1127  6.3617969  0.1251451    50.835  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1128  6.4497146  0.1252239    51.505  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1132  0.8254710  0.2297768     3.592 0.000328 ***\nORIG_HEX_IDHEX_1147  0.5243192  0.1511615     3.469 0.000523 ***\nORIG_HEX_IDHEX_1148  4.3772385  0.1253819    34.911  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1149  3.5523552  0.1257257    28.255  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1150  6.2019470  0.1251037    49.574  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1151  5.9681881  0.1251261    47.697  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1152  6.0560180  0.1251525    48.389  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1153  7.0901804  0.1251286    56.663  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1154  6.9000623  0.1251126    55.151  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1155  3.1071170  0.1292773    24.035  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1158  4.7681038  0.1259836    37.847  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1174  2.2814357  0.1316582    17.328  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1175  2.9491604  0.1293347    22.803  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1176  4.9336613  0.1252098    39.403  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1177  3.6321024  0.1255225    28.936  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1178  5.7635949  0.1251403    46.057  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1179  5.3436963  0.1251997    42.681  &lt; 2e-16 ***\nORIG_HEX_IDHEX_118   0.2924942  0.1797913     1.627 0.103768    \nORIG_HEX_IDHEX_1180  4.8552246  0.1253471    38.734  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1181  6.2498914  0.1251364    49.945  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1182  6.3636609  0.1251855    50.834  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1183  6.6727198  0.1252571    53.272  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1185  3.5230424  0.1278549    27.555  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1201  2.7058967  0.1298630    20.837  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1202  4.7443173  0.1253054    37.862  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1203  3.3315869  0.1263290    26.372  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1205  6.3538924  0.1251055    50.788  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1206  5.6894463  0.1251909    45.446  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1207  5.5256093  0.1251928    44.137  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1209  6.5970385  0.1252499    52.671  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1210  3.3185114  0.1282617    25.873  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1211  3.1412484  0.1286452    24.418  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1212  2.5868742  0.1315195    19.669  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1228  1.8173123  0.1346688    13.495  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1229  2.8371926  0.1263455    22.456  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1230  4.6254610  0.1252866    36.919  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1231  5.8820757  0.1252189    46.974  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1232  6.2143865  0.1251117    49.671  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1233  6.0925019  0.1252375    48.648  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1235  6.3141491  0.1251675    50.446  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1236  4.6904024  0.1253933    37.406  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1237  5.4773375  0.1253025    43.713  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1238  2.6733928  0.1294462    20.653  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1239  0.9147834  0.1718939     5.322 1.03e-07 ***\nORIG_HEX_IDHEX_1240  1.4980997  0.1713109     8.745  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1255  4.5869186  0.1258364    36.451  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1256  3.7941583  0.1255351    30.224  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1257  2.9089349  0.1262978    23.032  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1258  4.9819943  0.1253006    39.760  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1259  5.8126682  0.1251436    46.448  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1261  5.9083597  0.1251483    47.211  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1262  6.1239392  0.1251504    48.933  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1263  3.4782416  0.1266067    27.473  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1264  4.3323834  0.1257934    34.440  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1265  2.1920997  0.1304115    16.809  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1266  3.6920428  0.1272176    29.021  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1282  4.4177877  0.1257519    35.131  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1283  5.0769639  0.1251623    40.563  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1284  4.7226697  0.1252393    37.709  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1285  3.3682774  0.1258799    26.758  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1286  5.3049382  0.1251817    42.378  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1287  5.3406021  0.1252527    42.639  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1288  2.6246655  0.1272694    20.623  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1289  6.1041243  0.1251280    48.783  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1293  1.7250508  0.1412975    12.209  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1308  3.3545084  0.1260679    26.609  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1309  5.7554739  0.1251394    45.992  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1310  6.7678917  0.1250879    54.105  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1311  3.2742161  0.1270796    25.765  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1312  3.5645999  0.1259328    28.306  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1314  4.7152364  0.1253937    37.603  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1315  6.5189971  0.1251113    52.106  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1316  5.7973030  0.1253002    46.267  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1318  2.3156078  0.1357489    17.058  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1319  6.8353732  0.1251461    54.619  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1320  5.6811939  0.1254697    45.279  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1335  0.1987437  0.2326327     0.854 0.392926    \nORIG_HEX_IDHEX_1336  4.2828633  0.1253287    34.173  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1337  5.5480243  0.1251159    44.343  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1338  4.6134556  0.1253427    36.807  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1339  3.0790910  0.1275539    24.140  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1340  3.6143925  0.1259596    28.695  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1341  5.1567160  0.1252355    41.176  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1342  3.8168825  0.1256765    30.371  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1343  6.1137906  0.1251505    48.852  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1347  2.4274900  0.1288510    18.840  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1348  6.8047459  0.1251304    54.381  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1362  3.8252464  0.1254317    30.497  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1363  4.6133740  0.1252419    36.836  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1364  4.9807779  0.1251865    39.787  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1366  5.1868281  0.1251971    41.429  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1367  3.4101740  0.1262826    27.004  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1368  4.2287481  0.1257408    33.631  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1369  6.5681981  0.1251184    52.496  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1370  7.3687231  0.1251480    58.880  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1372 -0.0163736  0.2239962    -0.073 0.941728    \nORIG_HEX_IDHEX_1374  4.8484078  0.1252995    38.695  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1375  6.8584238  0.1251485    54.802  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1389  3.8734498  0.1254811    30.869  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1390  2.2534689  0.1290106    17.467  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1391  3.3582395  0.1256526    26.726  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1392  4.3319028  0.1253145    34.568  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1394  4.5568016  0.1253731    36.346  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1396  5.6373585  0.1253107    44.987  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1397  5.7224051  0.1253425    45.654  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1401  6.2664389  0.1251451    50.073  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1402  6.2652576  0.1251391    50.066  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1416 -0.9263624  0.3043039    -3.044 0.002333 ** \nORIG_HEX_IDHEX_1417  2.5014700  0.1275455    19.612  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1418  4.0579865  0.1257300    32.275  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1419  3.6436887  0.1257753    28.970  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1420  5.5616348  0.1251598    44.436  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1422  2.9016582  0.1298926    22.339  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1423  7.8313504  0.1251825    62.559  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1426  4.0974336  0.1266281    32.358  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1428  5.4677135  0.1251823    43.678  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1429  5.4446257  0.1252337    43.476  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1443  2.6657992  0.1261821    21.127  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1444  1.7062834  0.1290227    13.225  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1445  5.0902196  0.1252051    40.655  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1446  3.4572725  0.1257692    27.489  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1447  4.8613807  0.1252045    38.828  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1455  4.9898836  0.1253631    39.803  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1456  5.5506072  0.1251867    44.339  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1457  1.1343363  0.1397302     8.118 4.74e-16 ***\nORIG_HEX_IDHEX_146   2.2818178  0.1979813    11.525  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1469  4.9760628  0.1252047    39.743  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1470  4.3141290  0.1252647    34.440  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1471  5.3897722  0.1251454    43.068  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1472  3.7160305  0.1256694    29.570  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1480 -0.5316479  0.1934676    -2.748 0.005996 ** \nORIG_HEX_IDHEX_1482  5.4126848  0.1251727    43.242  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1483  5.5972026  0.1252120    44.702  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1496  3.0374234  0.1261119    24.085  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1497  1.1133208  0.1385582     8.035 9.35e-16 ***\nORIG_HEX_IDHEX_1498  3.6354305  0.1253851    28.994  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1499  5.2323834  0.1251711    41.802  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1500  2.5355312  0.1282737    19.767  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1501  4.5883014  0.1253006    36.618  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1507  2.0952239  0.1483284    14.126  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1509  5.0981808  0.1253260    40.679  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1510  7.1868374  0.1250991    57.449  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1511  4.8291347  0.1253674    38.520  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1523  1.1583376  0.1349804     8.582  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1524  2.8689561  0.1313559    21.841  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1525  5.4155107  0.1251310    43.279  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1526  3.0953735  0.1262327    24.521  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1527  1.7016272  0.1367353    12.445  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1534  0.0547523  0.1693591     0.323 0.746475    \nORIG_HEX_IDHEX_1536  5.9467117  0.1251533    47.515  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1537  5.1683864  0.1252537    41.263  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1550  3.9955912  0.1254727    31.844  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1551  2.3583873  0.1272651    18.531  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1552  2.1438487  0.1276956    16.789  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1553  4.4594376  0.1252338    35.609  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1554  3.5078195  0.1260516    27.828  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1555  3.4061948  0.1259286    27.049  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1562  3.2971393  0.1372289    24.027  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1563  5.4998709  0.1253351    43.881  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1564  6.3009493  0.1251227    50.358  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1565  5.1875204  0.1253569    41.382  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1576  2.9639326  0.1283311    23.096  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1578  3.0799133  0.1256741    24.507  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1579  5.6338239  0.1251316    45.023  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1581  4.6128111  0.1252770    36.821  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1588  1.2309134  0.1612825     7.632 2.31e-14 ***\nORIG_HEX_IDHEX_1590  6.4908779  0.1251335    51.872  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1591  5.9375617  0.1251508    47.443  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1592  2.4264157  0.1280001    18.956  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1604  3.2902109  0.1256165    26.193  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1605  4.7116916  0.1251810    37.639  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1606  4.3657854  0.1252377    34.860  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1607  3.5946820  0.1254941    28.644  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1616  2.4789564  0.1349760    18.366  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1617  5.1042994  0.1254844    40.677  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1618  6.5942566  0.1251290    52.700  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1619  4.9647634  0.1252790    39.630  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1620  2.6189478  0.1279113    20.475  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1630  2.6909385  0.1261284    21.335  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1631  3.6087782  0.1253872    28.781  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1632  4.9326540  0.1251787    39.405  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1633  3.7168474  0.1254816    29.621  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1634  5.0690055  0.1252088    40.484  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1635  3.2659384  0.1260881    25.902  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1642  1.1348788  0.2516106     4.510 6.47e-06 ***\nORIG_HEX_IDHEX_1644  5.3965298  0.1252684    43.080  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1645  5.7604632  0.1251628    46.024  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1646  4.0146552  0.1256611    31.948  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1647 -1.6316215  0.5154613    -3.165 0.001549 ** \nORIG_HEX_IDHEX_1658  5.0995951  0.1252143    40.727  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1659  4.8466353  0.1251686    38.721  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1660  3.8191890  0.1259075    30.333  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1661  3.3907552  0.1257720    26.960  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1662  4.5123475  0.1252822    36.017  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1669 -0.2127157  0.2795922    -0.761 0.446772    \nORIG_HEX_IDHEX_1670  2.2739555  0.1535744    14.807  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1672  5.1202139  0.1254490    40.815  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1673  4.7845626  0.1259261    37.995  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1674  4.0486445  0.1257087    32.207  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1684  5.1855689  0.1251600    41.432  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1685  4.0714265  0.1252869    32.497  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1686  4.6878145  0.1251886    37.446  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1687  2.2190824  0.1275314    17.400  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1688  2.4744760  0.1267332    19.525  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1689  2.7027205  0.1369402    19.737  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1695 -0.6306116  0.3560862    -1.771 0.076569 .  \nORIG_HEX_IDHEX_1699  5.1785083  0.1252312    41.352  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1700  1.5074694  0.1429545    10.545  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1701  2.9113315  0.1288481    22.595  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1712  4.0146913  0.1253318    32.033  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1713  5.1597085  0.1251364    41.233  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1714  2.5055405  0.1269878    19.731  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1716  4.4502202  0.1252831    35.521  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1723  2.8282978  0.1357164    20.840  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1726  2.7046582  0.1291405    20.944  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1727  6.0839494  0.1251722    48.605  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1728  3.5503372  0.1258877    28.202  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1738  3.5316639  0.1254422    28.154  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1739  4.6148342  0.1251757    36.867  &lt; 2e-16 ***\nORIG_HEX_IDHEX_174   2.2695784  0.1974325    11.495  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1740  3.3868238  0.1255390    26.978  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1741  3.6851661  0.1255463    29.353  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1743  2.1356227  0.1314231    16.250  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1744  0.6349560  0.2188765     2.901 0.003720 ** \nORIG_HEX_IDHEX_1748 -0.1175356  0.2295451    -0.512 0.608625    \nORIG_HEX_IDHEX_1749  5.7805299  0.1252581    46.149  &lt; 2e-16 ***\nORIG_HEX_IDHEX_175   0.2592129  0.1702246     1.523 0.127816    \nORIG_HEX_IDHEX_1753  6.3378900  0.1251392    50.647  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1754  5.0747273  0.1252528    40.516  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1764  1.0422720  0.1972427     5.284 1.26e-07 ***\nORIG_HEX_IDHEX_1765  5.4430382  0.1251567    43.490  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1766  5.3383416  0.1251458    42.657  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1767  4.8404267  0.1251555    38.675  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1768  1.3380600  0.1307792    10.231  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1770  2.9851096  0.1262640    23.642  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1771  1.6647571  0.1366298    12.184  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1776  0.1423023  0.1933761     0.736 0.461802    \nORIG_HEX_IDHEX_1777  4.5411816  0.1256688    36.136  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1778  2.3682946  0.1300227    18.214  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1780  3.7826935  0.1261877    29.977  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1781  6.1365179  0.1251565    49.031  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1791  0.9237350  0.3429576     2.693 0.007072 ** \nORIG_HEX_IDHEX_1792  4.6640514  0.1252006    37.253  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1793  5.3776299  0.1251224    42.979  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1794  4.1503419  0.1252629    33.133  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1795  3.1799440  0.1256422    25.310  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1796  4.0224451  0.1254764    32.057  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1798 -0.2731486  0.2266317    -1.205 0.228106    \nORIG_HEX_IDHEX_1800  2.3377737  0.1313246    17.801  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1802  1.2297350  0.1421083     8.654  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1804  0.2727023  0.1830521     1.490 0.136289    \nORIG_HEX_IDHEX_1805  4.0875347  0.1256416    32.533  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1806  5.2984740  0.1252312    42.310  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1807  5.4191991  0.1252012    43.284  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1808  2.9424106  0.1293457    22.748  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1820  4.8582053  0.1251684    38.813  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1821  5.4831418  0.1251214    43.823  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1822  3.3207872  0.1255326    26.454  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1823  3.2272986  0.1258046    25.653  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1824  4.6615208  0.1252257    37.225  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1827  4.7541675  0.1252889    37.946  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1828  4.4078315  0.1254698    35.131  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1829  4.3578921  0.1256211    34.691  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1831  3.5511859  0.1266354    28.043  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1833  6.1086501  0.1251326    48.817  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1834  5.2594870  0.1252825    41.981  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1835  5.8048325  0.1252237    46.356  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1846  1.2020518  0.1351656     8.893  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1847  4.1744209  0.1254904    33.265  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1848  4.1179776  0.1252485    32.878  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1849  4.9008473  0.1251572    39.158  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1850  3.9051255  0.1255308    31.109  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1852  1.3487633  0.1354809     9.955  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1853  4.6882104  0.1253003    37.416  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1854  4.7015004  0.1253046    37.521  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1855  3.7897056  0.1256753    30.155  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1856  2.4898348  0.1409785    17.661  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1857  0.6806015  0.1867554     3.644 0.000268 ***\nORIG_HEX_IDHEX_1858  4.5872364  0.1253678    36.590  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1859  5.0275748  0.1252337    40.146  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1860  5.6796742  0.1251648    45.378  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1861  6.8463163  0.1251630    54.699  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1862  2.8431478  0.1316051    21.604  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1874  4.4027037  0.1252195    35.160  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1875  4.3539986  0.1252029    34.776  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1876  1.9862839  0.1271235    15.625  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1877  4.0515599  0.1253068    32.333  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1878  3.2409103  0.1258347    25.755  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1879  2.6615494  0.1262929    21.074  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1882  5.3254458  0.1251860    42.540  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1883  4.9087796  0.1252785    39.183  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1884  3.9262741  0.1260236    31.155  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1886  6.8392029  0.1251122    54.665  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1887  7.2641582  0.1250987    58.067  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1888  5.1227912  0.1252916    40.887  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1889  2.8130591  0.1394290    20.176  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1890  3.8754411  0.1330365    29.131  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1900  3.1637088  0.1260174    25.105  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1901  4.5108181  0.1251841    36.033  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1902  3.8665699  0.1253839    30.838  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1903  3.3005896  0.1263708    26.118  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1904  3.5501173  0.1255289    28.281  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1905  3.6403812  0.1253961    29.031  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1906  3.9779561  0.1253323    31.739  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1907  4.7928650  0.1252149    38.277  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1908  4.4418156  0.1253915    35.424  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1909  5.6987605  0.1251636    45.531  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1910  4.4204877  0.1254839    35.228  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1912  3.7722349  0.1261355    29.906  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1913  5.0771355  0.1252269    40.543  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1914  6.2273992  0.1251431    49.762  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1916  6.1283546  0.1261573    48.577  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1928  4.2620074  0.1252376    34.031  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1929  3.8635489  0.1252877    30.837  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1930  3.7643258  0.1253096    30.040  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1931  3.6917707  0.1253708    29.447  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1932  4.2976317  0.1252698    34.307  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1933  4.3831209  0.1254104    34.950  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1934  2.9854618  0.1258262    23.727  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1935  4.9848010  0.1251918    39.817  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1936  5.4279737  0.1251660    43.366  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1937  4.9091766  0.1252357    39.199  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1938  1.4722937  0.1356324    10.855  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1940  6.5976842  0.1251339    52.725  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1941  5.6862731  0.1251854    45.423  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1942  5.2237655  0.1254749    41.632  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1954  3.1702375  0.1262348    25.114  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1955  4.3626094  0.1252023    34.844  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1956  3.5252456  0.1254220    28.107  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1958  4.7253061  0.1251977    37.743  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1959  5.2149230  0.1251330    41.675  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1960  5.2936322  0.1251941    42.283  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1961  5.0280356  0.1251888    40.164  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1962  5.5171845  0.1251388    44.089  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1963  4.4443908  0.1252411    35.487  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1964  3.8177321  0.1255589    30.406  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1967  7.0089049  0.1251257    56.015  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1968  6.5329630  0.1251694    52.193  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1982  3.4769078  0.1254725    27.711  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1983  3.5323861  0.1253415    28.182  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1984  4.6917114  0.1251579    37.486  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1985  3.7312446  0.1254252    29.749  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1986  4.6751594  0.1252296    37.333  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1987  6.0191789  0.1251023    48.114  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1988  4.3702353  0.1252257    34.899  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1989  5.0892870  0.1251607    40.662  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1990  6.6363938  0.1250963    53.050  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1991  5.8544196  0.1251352    46.785  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1992  3.7097810  0.1260822    29.424  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1994  5.4409069  0.1253545    43.404  &lt; 2e-16 ***\nORIG_HEX_IDHEX_1995  7.2653424  0.1251303    58.062  &lt; 2e-16 ***\nORIG_HEX_IDHEX_200  -0.2430942  0.1529863    -1.589 0.112062    \nORIG_HEX_IDHEX_2009  3.2930775  0.1255399    26.231  &lt; 2e-16 ***\nORIG_HEX_IDHEX_201   2.0741449  0.1285623    16.133  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2010  4.0497919  0.1252289    32.339  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2011  4.9918641  0.1251432    39.889  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2012  4.2031240  0.1252834    33.549  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2013  4.5844273  0.1251890    36.620  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2014  5.0032147  0.1251547    39.976  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2015  4.8122683  0.1252009    38.436  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2016  5.3422264  0.1251519    42.686  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2017  5.0199041  0.1251914    40.098  &lt; 2e-16 ***\nORIG_HEX_IDHEX_202   3.5892116  0.1277705    28.091  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2021  5.6982843  0.1252914    45.480  &lt; 2e-16 ***\nORIG_HEX_IDHEX_203   0.9430722  0.1351682     6.977 3.01e-12 ***\nORIG_HEX_IDHEX_2036 -0.8396511  0.1821860    -4.609 4.05e-06 ***\nORIG_HEX_IDHEX_2037  2.0010916  0.1265548    15.812  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2038  4.4488990  0.1251849    35.539  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2039  5.4000370  0.1251899    43.135  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2040  5.5405799  0.1251308    44.278  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2041  6.0870780  0.1251337    48.645  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2042  5.1181148  0.1251720    40.889  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2043  3.8751327  0.1254149    30.899  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2044  5.7157697  0.1251259    45.680  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2046  4.4348596  0.1254993    35.338  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2049  5.9835833  0.1252942    47.756  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2063  2.0675859  0.1276804    16.193  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2064  2.7996647  0.1258673    22.243  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2065  4.2504460  0.1252133    33.946  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2066  4.3934215  0.1252209    35.085  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2067  5.2671210  0.1251307    42.093  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2068  4.9852819  0.1251811    39.825  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2069  3.4009997  0.1256427    27.069  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2070  6.0021762  0.1251461    47.961  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2071  4.7665317  0.1252974    38.042  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2072  3.3456295  0.1272785    26.286  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2074 -0.2390884  0.2359042    -1.013 0.310822    \nORIG_HEX_IDHEX_2089  1.5281301  0.1639424     9.321  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2091  1.6345706  0.1287515    12.696  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2092  3.3273478  0.1255537    26.501  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2093  4.5826464  0.1251917    36.605  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2094  5.1568672  0.1251484    41.206  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2095  5.9372999  0.1251928    47.425  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2096  2.9444933  0.1260944    23.351  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2097  3.0457541  0.1280486    23.786  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2098  4.1157308  0.1253622    32.831  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2100  3.0559913  0.1292043    23.652  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2101  2.1857230  0.1400649    15.605  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2102  2.3725975  0.1359153    17.456  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2116  2.1673969  0.1465647    14.788  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2117 -1.1580677  1.0134869    -1.143 0.253181    \nORIG_HEX_IDHEX_2119  4.6849469  0.1251841    37.424  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2120  4.1826091  0.1252686    33.389  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2121  4.4552681  0.1252288    35.577  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2122  1.9258876  0.1342031    14.351  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2123  4.6496559  0.1252140    37.134  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2124  4.2057080  0.1255017    33.511  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2125  4.2450454  0.1254701    33.833  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2126  3.8635523  0.1259330    30.679  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2129  1.2579100  0.1589538     7.914 2.50e-15 ***\nORIG_HEX_IDHEX_2146  4.2169711  0.1263094    33.386  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2147  4.7555443  0.1251718    37.992  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2148  5.4975974  0.1251251    43.937  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2149  4.9576500  0.1252019    39.597  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2150  3.5619307  0.1255001    28.382  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2151  4.2759636  0.1253252    34.119  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2152  5.5587428  0.1251689    44.410  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2153  2.7518735  0.1289169    21.346  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2154  5.4469931  0.1252502    43.489  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2155  2.5342825  0.1305443    19.413  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2171  0.2450781  0.2953912     0.830 0.406724    \nORIG_HEX_IDHEX_2172  5.1066711  0.1257444    40.612  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2174  3.7570615  0.1255751    29.919  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2175  5.3696763  0.1251452    42.908  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2176  5.0785512  0.1251663    40.574  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2177  5.9489391  0.1251145    47.548  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2178  4.7302406  0.1252312    37.772  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2179  5.0734991  0.1252169    40.518  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2180  5.8252716  0.1251698    46.539  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2181  6.1719440  0.1251767    49.306  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2182  2.7327950  0.1372855    19.906  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2200  3.7956494  0.1268505    29.922  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2201  5.3776436  0.1251318    42.976  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2202  3.1579473  0.1263779    24.988  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2203  5.2145788  0.1251961    41.651  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2204  4.4531072  0.1252241    35.561  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2205  4.5219487  0.1252533    36.102  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2206  6.0972549  0.1251164    48.733  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2207  4.9936510  0.1252310    39.876  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2208  6.4322889  0.1251412    51.400  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2209  1.3549824  0.1522128     8.902  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2227  3.6272724  0.1255418    28.893  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2228  5.1884399  0.1251660    41.452  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2229  4.3235984  0.1252376    34.523  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2230  4.2813343  0.1254317    34.133  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2231  4.9564279  0.1251691    39.598  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2233  6.2370801  0.1251135    49.851  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2234  1.9254008  0.1340562    14.363  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2235  3.7123172  0.1299717    28.562  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2254  3.6043941  0.1264741    28.499  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2255  5.1569279  0.1251599    41.203  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2256  4.3860308  0.1252296    35.024  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2257  3.5309304  0.1256379    28.104  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2258  4.3498380  0.1252927    34.717  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2259  3.6047705  0.1257774    28.660  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2260  5.9093582  0.1251327    47.225  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2261  6.1362463  0.1251412    49.035  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2262  5.8000547  0.1252074    46.324  &lt; 2e-16 ***\nORIG_HEX_IDHEX_227   2.6591987  0.1423287    18.684  &lt; 2e-16 ***\nORIG_HEX_IDHEX_228   1.5938054  0.1299411    12.266  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2281  5.1012214  0.1251854    40.749  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2282  5.0530543  0.1251735    40.368  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2283  4.9517974  0.1251602    39.564  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2284  3.9039668  0.1253720    31.139  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2285  5.8825056  0.1251472    47.005  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2286  4.2544363  0.1253627    33.937  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2287  6.2814408  0.1251192    50.204  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2288  5.1913688  0.1253538    41.414  &lt; 2e-16 ***\nORIG_HEX_IDHEX_229   2.4841824  0.1496371    16.601  &lt; 2e-16 ***\nORIG_HEX_IDHEX_230   4.3393287  0.1261754    34.391  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2308  4.5390953  0.1254291    36.189  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2309  5.3093700  0.1251461    42.425  &lt; 2e-16 ***\nORIG_HEX_IDHEX_231   0.9783075  0.1444464     6.773 1.26e-11 ***\nORIG_HEX_IDHEX_2310  4.6609706  0.1251804    37.234  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2311  4.6818602  0.1251806    37.401  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2312  2.3191949  0.1271132    18.245  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2313  5.1098822  0.1252021    40.813  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2314  6.0287799  0.1251126    48.187  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2315  5.1455666  0.1252248    41.091  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2316  6.5774745  0.1251345    52.563  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2317  6.4534033  0.1254835    51.428  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2335  3.7060053  0.1255558    29.517  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2336  5.1343821  0.1251443    41.028  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2337  3.9333498  0.1253045    31.390  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2338  1.8238872  0.1284499    14.199  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2339  5.3045875  0.1251670    42.380  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2340  5.8690889  0.1251203    46.908  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2341  5.7169013  0.1251353    45.686  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2342  5.6528322  0.1251545    45.167  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2343  5.8796058  0.1251818    46.969  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2362  4.1132474  0.1256329    32.740  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2363  4.5474808  0.1252496    36.307  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2364  0.9968501  0.1318065     7.563 3.94e-14 ***\nORIG_HEX_IDHEX_2365  3.0640848  0.1256221    24.391  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2366 -1.8230309  0.2613614    -6.975 3.06e-12 ***\nORIG_HEX_IDHEX_2367  5.0612384  0.1252140    40.421  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2368  5.5466765  0.1251424    44.323  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2369  5.7468199  0.1251490    45.920  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2370  6.3655318  0.1251190    50.876  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2371  6.4366335  0.1251400    51.435  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2389  4.3969729  0.1253002    35.092  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2390  4.9844276  0.1251600    39.824  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2391  4.5425326  0.1252282    36.274  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2392  3.3306954  0.1261791    26.397  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2393  3.4742709  0.1282998    27.079  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2394  4.1044484  0.1254534    32.717  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2395  5.9407140  0.1251346    47.475  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2396  6.1421244  0.1251225    49.089  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2397  5.0776172  0.1252673    40.534  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2398  5.7831556  0.1253287    46.144  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2416  4.5037443  0.1253319    35.935  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2417  4.8369316  0.1253151    38.598  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2418  4.4860214  0.1252156    35.826  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2419  4.1317270  0.1252630    32.984  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2420  3.2546722  0.1280900    25.409  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2422  4.7176988  0.1258105    37.498  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2423  5.4856649  0.1251933    43.818  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2424  6.8270273  0.1251065    54.570  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2425  6.4953569  0.1251291    51.909  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2426  6.1319265  0.1254675    48.873  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2443  5.3838295  0.1251566    43.017  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2444  5.5121779  0.1251275    44.052  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2445  5.5744363  0.1251218    44.552  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2448  2.3533922  0.1295490    18.166  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2449  6.0169613  0.1252065    48.056  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2450  6.0723174  0.1251606    48.516  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2451  7.0321492  0.1251063    56.209  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2452  2.2240097  0.1330350    16.717  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2471  4.6843888  0.1252138    37.411  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2472  3.8132766  0.1261605    30.226  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2473  5.2124114  0.1251734    41.642  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2476  3.5969894  0.1275616    28.198  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2478  5.6793983  0.1252090    45.359  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2479  4.3444402  0.1256686    34.571  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2480  3.3676605  0.1312098    25.666  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2497  5.6594272  0.1251369    45.226  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2498  3.8251425  0.1254683    30.487  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2499  5.5975755  0.1251580    44.724  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2500  0.8419424  0.1398345     6.021 1.73e-09 ***\nORIG_HEX_IDHEX_2503 -0.2424450  0.2144428    -1.131 0.258231    \nORIG_HEX_IDHEX_2504  4.6447134  0.1256205    36.974  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2505  5.6799370  0.1252164    45.361  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2525  4.3598861  0.1253467    34.783  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2526  4.9646267  0.1251959    39.655  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2527  5.5665203  0.1251446    44.481  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2531 -1.1093022  0.5154535    -2.152 0.031390 *  \nORIG_HEX_IDHEX_2532  5.8156760  0.1252005    46.451  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2533  6.6864278  0.1252897    53.368  &lt; 2e-16 ***\nORIG_HEX_IDHEX_254   4.5331286  0.1270666    35.675  &lt; 2e-16 ***\nORIG_HEX_IDHEX_255   1.2160445  0.1460327     8.327  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2551  4.6206353  0.1253058    36.875  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2552  3.7140231  0.1258265    29.517  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2553  4.9061997  0.1253422    39.142  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2554  3.9245315  0.1254891    31.274  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2557  3.4309431  0.1277746    26.852  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2559  6.0090322  0.1253188    47.950  &lt; 2e-16 ***\nORIG_HEX_IDHEX_256   2.4176969  0.1364232    17.722  &lt; 2e-16 ***\nORIG_HEX_IDHEX_257   3.8949479  0.1269018    30.693  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2579  4.4688451  0.1252970    35.666  &lt; 2e-16 ***\nORIG_HEX_IDHEX_258   0.5782497  0.1453002     3.980 6.90e-05 ***\nORIG_HEX_IDHEX_2580  5.3217643  0.1251494    42.523  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2581  5.0181809  0.1252263    40.073  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2584  1.2528955  0.1409386     8.890  &lt; 2e-16 ***\nORIG_HEX_IDHEX_259   1.1364862  0.1351440     8.409  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2605  4.5951934  0.1254872    36.619  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2606  4.5915870  0.1261053    36.411  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2607  5.8427319  0.1251261    46.695  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2608  4.5055864  0.1253559    35.942  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2609  3.7066098  0.1259766    29.423  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2610  3.1900558  0.1275533    25.010  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2611  1.2225428  0.1465832     8.340  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2633  4.5982681  0.1252829    36.703  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2634  6.1962731  0.1251064    49.528  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2635  5.6058298  0.1251797    44.782  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2636  5.5969661  0.1251572    44.720  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2637  4.1003406  0.1254936    32.674  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2638  3.6815097  0.1256077    29.310  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2660  3.9605701  0.1253720    31.591  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2661  5.4239710  0.1251363    43.345  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2662  4.4924132  0.1252507    35.867  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2663  6.0622688  0.1251308    48.447  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2664  4.6871915  0.1252565    37.421  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2665  5.5334684  0.1251735    44.206  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2687  4.5163620  0.1253124    36.041  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2688  5.1700655  0.1251490    41.311  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2689  5.5042956  0.1251475    43.982  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2690  4.7297348  0.1252108    37.774  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2691  5.9474150  0.1251243    47.532  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2692  3.9135368  0.1260120    31.057  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2693  5.8043514  0.1251552    46.377  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2714  4.9533226  0.1251998    39.563  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2715  5.8292885  0.1251348    46.584  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2716  1.6806155  0.1277872    13.152  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2717  4.8145218  0.1251653    38.465  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2718  5.5725467  0.1251566    44.525  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2719  5.8476131  0.1251462    46.726  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2742  5.4406761  0.1251424    43.476  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2743  4.1561179  0.1255816    33.095  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2744  5.3349603  0.1251286    42.636  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2745  5.3750103  0.1251358    42.953  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2746  4.5428819  0.1255249    36.191  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2747  5.1412014  0.1252546    41.046  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2768  5.4277530  0.1251854    43.358  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2769  5.5600644  0.1251389    44.431  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2770  3.6797206  0.1254011    29.344  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2771  6.1132563  0.1251055    48.865  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2772  4.5062566  0.1253770    35.942  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2773  5.1479628  0.1251786    41.125  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2795  1.9382699  0.1697317    11.420  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2796  2.6425026  0.1272125    20.772  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2797  3.7431993  0.1253661    29.858  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2798  4.4396580  0.1252082    35.458  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2799  4.9963834  0.1251551    39.922  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2800  5.1051525  0.1251845    40.781  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2801  2.3766203  0.1293075    18.380  &lt; 2e-16 ***\nORIG_HEX_IDHEX_281   2.6442182  0.1342922    19.690  &lt; 2e-16 ***\nORIG_HEX_IDHEX_282   1.8873414  0.1389711    13.581  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2822  2.9777788  0.1265518    23.530  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2823  3.0468097  0.1257990    24.220  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2824  4.6661293  0.1252179    37.264  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2825  5.4839275  0.1251257    43.827  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2826  5.4875229  0.1251910    43.833  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2827  5.7077194  0.1251432    45.610  &lt; 2e-16 ***\nORIG_HEX_IDHEX_284   2.0916856  0.1316934    15.883  &lt; 2e-16 ***\nORIG_HEX_IDHEX_285   3.1171902  0.1275346    24.442  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2850  4.2399960  0.1256132    33.754  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2851  2.3538420  0.1264941    18.608  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2852  5.0262737  0.1251717    40.155  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2853  5.9472697  0.1251147    47.535  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2854  5.6776413  0.1251371    45.371  &lt; 2e-16 ***\nORIG_HEX_IDHEX_286   5.4732628  0.1253561    43.662  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2877  2.8013083  0.1264960    22.145  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2878  4.4000605  0.1252423    35.132  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2879  5.3692968  0.1252161    42.880  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2880  5.4093525  0.1251478    43.224  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2881  5.4886246  0.1251579    43.854  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2905  4.3156371  0.1253433    34.431  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2906  3.9758172  0.1255061    31.678  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2907  4.9651651  0.1251685    39.668  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2908  5.3273410  0.1251738    42.560  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2909  4.2034366  0.1269655    33.107  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2931  1.1449819  0.1347785     8.495  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2932 -0.0233164  0.1504944    -0.155 0.876875    \nORIG_HEX_IDHEX_2933  3.0857295  0.1257680    24.535  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2934  4.5624093  0.1252240    36.434  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2959  1.7542960  0.1298445    13.511  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2960  3.8780078  0.1265678    30.640  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2961  4.4507226  0.1253570    35.504  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2962  4.3299967  0.1253783    34.535  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2963  1.0686727  0.1515039     7.054 1.74e-12 ***\nORIG_HEX_IDHEX_2987  2.4372502  0.1322302    18.432  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2988  2.6181787  0.1272374    20.577  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2989  2.5369724  0.1266650    20.029  &lt; 2e-16 ***\nORIG_HEX_IDHEX_2990  2.2645026  0.1320801    17.145  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3015  4.3800616  0.1265064    34.623  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3016  4.1854365  0.1258608    33.254  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3017  1.1106383  0.1318224     8.425  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3040  4.7013279  0.1254488    37.476  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3043  2.7331232  0.1263456    21.632  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3044  2.8284414  0.1266925    22.325  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3068  2.7827253  0.1267409    21.956  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3070  2.0503553  0.1320904    15.522  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3072  1.8472783  0.1360321    13.580  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3092  5.0610124  0.1262737    40.080  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3098  4.1411443  0.1254519    33.010  &lt; 2e-16 ***\nORIG_HEX_IDHEX_312   0.9365779  0.1473254     6.357 2.05e-10 ***\nORIG_HEX_IDHEX_3123  5.9935778  0.1252587    47.850  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3126 -2.0757846  0.3750497    -5.535 3.12e-08 ***\nORIG_HEX_IDHEX_313   1.3715966  0.1350181    10.159  &lt; 2e-16 ***\nORIG_HEX_IDHEX_314   1.8228434  0.1316539    13.846  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3151  3.3041411  0.1263814    26.144  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3152 -1.1785999  0.1822136    -6.468 9.92e-11 ***\nORIG_HEX_IDHEX_3173  4.6465702  0.1266204    36.697  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3178  2.1832358  0.1276780    17.100  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3179  1.7537289  0.1278973    13.712  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3205  2.0054256  0.1320857    15.183  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3206  4.4240628  0.1255985    35.224  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3232  1.9125459  0.1350069    14.166  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3233  1.2516351  0.1415984     8.839  &lt; 2e-16 ***\nORIG_HEX_IDHEX_3308  3.8571283  0.1335536    28.881  &lt; 2e-16 ***\nORIG_HEX_IDHEX_336   2.9240064  0.1912943    15.285  &lt; 2e-16 ***\nORIG_HEX_IDHEX_338   1.9730326  0.1323333    14.910  &lt; 2e-16 ***\nORIG_HEX_IDHEX_339   4.5385934  0.1254589    36.176  &lt; 2e-16 ***\nORIG_HEX_IDHEX_340  -0.2465716  0.2033588    -1.212 0.225323    \nORIG_HEX_IDHEX_366   5.3181510  0.1254097    42.406  &lt; 2e-16 ***\nORIG_HEX_IDHEX_367   2.7641539  0.1279380    21.605  &lt; 2e-16 ***\nORIG_HEX_IDHEX_391   2.7734504  0.1595457    17.383  &lt; 2e-16 ***\nORIG_HEX_IDHEX_392   5.1617625  0.1254590    41.143  &lt; 2e-16 ***\nORIG_HEX_IDHEX_393   3.0138996  0.1279120    23.562  &lt; 2e-16 ***\nORIG_HEX_IDHEX_394   0.1932014  0.2734279     0.707 0.479821    \nORIG_HEX_IDHEX_419   1.1334770  0.1600499     7.082 1.42e-12 ***\nORIG_HEX_IDHEX_420   3.5076977  0.1291703    27.156  &lt; 2e-16 ***\nORIG_HEX_IDHEX_421   1.0183639  0.1783814     5.709 1.14e-08 ***\nORIG_HEX_IDHEX_445   2.1868099  0.1302880    16.784  &lt; 2e-16 ***\nORIG_HEX_IDHEX_446   4.0194613  0.1258928    31.928  &lt; 2e-16 ***\nORIG_HEX_IDHEX_447   1.8016664  0.1378177    13.073  &lt; 2e-16 ***\nORIG_HEX_IDHEX_472  -0.2645484  0.1914170    -1.382 0.166956    \nORIG_HEX_IDHEX_473   1.1267456  0.1375148     8.194 2.53e-16 ***\nORIG_HEX_IDHEX_474   2.0112437  0.1357932    14.811  &lt; 2e-16 ***\nORIG_HEX_IDHEX_499   0.6909573  0.1328118     5.203 1.97e-07 ***\nORIG_HEX_IDHEX_500   4.0176031  0.1256610    31.972  &lt; 2e-16 ***\nORIG_HEX_IDHEX_526   2.0024775  0.1299546    15.409  &lt; 2e-16 ***\nORIG_HEX_IDHEX_527   1.9959989  0.1379410    14.470  &lt; 2e-16 ***\nORIG_HEX_IDHEX_528   2.8329208  0.1299914    21.793  &lt; 2e-16 ***\nORIG_HEX_IDHEX_552   0.5512841  0.1396370     3.948 7.88e-05 ***\nORIG_HEX_IDHEX_553  -1.6706000  0.2002418    -8.343  &lt; 2e-16 ***\nORIG_HEX_IDHEX_554   1.8764520  0.1311148    14.312  &lt; 2e-16 ***\nORIG_HEX_IDHEX_555   1.9202088  0.1322106    14.524  &lt; 2e-16 ***\nORIG_HEX_IDHEX_581   1.5621892  0.1296790    12.047  &lt; 2e-16 ***\nORIG_HEX_IDHEX_582   1.9832304  0.1291009    15.362  &lt; 2e-16 ***\nORIG_HEX_IDHEX_607   1.5671097  0.1327507    11.805  &lt; 2e-16 ***\nORIG_HEX_IDHEX_608   1.2646532  0.1325877     9.538  &lt; 2e-16 ***\nORIG_HEX_IDHEX_609   6.6935509  0.1251510    53.484  &lt; 2e-16 ***\nORIG_HEX_IDHEX_610   1.9579192  0.1435017    13.644  &lt; 2e-16 ***\nORIG_HEX_IDHEX_611  -0.5231099  0.4643764    -1.126 0.259963    \nORIG_HEX_IDHEX_634   2.6255359  0.1307272    20.084  &lt; 2e-16 ***\nORIG_HEX_IDHEX_635   0.1558190  0.1429697     1.090 0.275769    \nORIG_HEX_IDHEX_636   2.9654693  0.1259214    23.550  &lt; 2e-16 ***\nORIG_HEX_IDHEX_638   2.7756462  0.1286422    21.576  &lt; 2e-16 ***\nORIG_HEX_IDHEX_661   1.8645264  0.1440574    12.943  &lt; 2e-16 ***\nORIG_HEX_IDHEX_662   2.6270722  0.1309319    20.064  &lt; 2e-16 ***\nORIG_HEX_IDHEX_663   2.4298986  0.1278381    19.008  &lt; 2e-16 ***\nORIG_HEX_IDHEX_664   2.3787873  0.1396878    17.029  &lt; 2e-16 ***\nORIG_HEX_IDHEX_665   3.6686418  0.1261116    29.090  &lt; 2e-16 ***\nORIG_HEX_IDHEX_689   1.1362977  0.1317361     8.626  &lt; 2e-16 ***\nORIG_HEX_IDHEX_690   2.4714201  0.1293598    19.105  &lt; 2e-16 ***\nORIG_HEX_IDHEX_692   3.8379093  0.1259118    30.481  &lt; 2e-16 ***\nORIG_HEX_IDHEX_693   2.7579947  0.1296298    21.276  &lt; 2e-16 ***\nORIG_HEX_IDHEX_715   1.0296674  0.1385568     7.431 1.07e-13 ***\nORIG_HEX_IDHEX_716   2.0890665  0.1310198    15.945  &lt; 2e-16 ***\nORIG_HEX_IDHEX_717   3.6198073  0.1262620    28.669  &lt; 2e-16 ***\nORIG_HEX_IDHEX_718   6.8430605  0.1251291    54.688  &lt; 2e-16 ***\nORIG_HEX_IDHEX_719   3.5846539  0.1267824    28.274  &lt; 2e-16 ***\nORIG_HEX_IDHEX_720   0.0249751  0.3042512     0.082 0.934577    \nORIG_HEX_IDHEX_743   2.4611727  0.1276341    19.283  &lt; 2e-16 ***\nORIG_HEX_IDHEX_744   3.0710000  0.1279507    24.001  &lt; 2e-16 ***\nORIG_HEX_IDHEX_745   5.0657632  0.1252194    40.455  &lt; 2e-16 ***\nORIG_HEX_IDHEX_746   6.2675481  0.1251347    50.086  &lt; 2e-16 ***\nORIG_HEX_IDHEX_747   3.1733796  0.1280786    24.777  &lt; 2e-16 ***\nORIG_HEX_IDHEX_748   1.6522187  0.1464368    11.283  &lt; 2e-16 ***\nORIG_HEX_IDHEX_769   0.9872224  0.1434116     6.884 5.83e-12 ***\nORIG_HEX_IDHEX_770   2.3836743  0.1279468    18.630  &lt; 2e-16 ***\nORIG_HEX_IDHEX_771   3.8201389  0.1256171    30.411  &lt; 2e-16 ***\nORIG_HEX_IDHEX_772   5.9747914  0.1251260    47.750  &lt; 2e-16 ***\nORIG_HEX_IDHEX_773   5.0969815  0.1254589    40.627  &lt; 2e-16 ***\nORIG_HEX_IDHEX_774   2.1244451  0.1370870    15.497  &lt; 2e-16 ***\nORIG_HEX_IDHEX_775   3.9878636  0.1281328    31.123  &lt; 2e-16 ***\nORIG_HEX_IDHEX_776   1.8072302  0.2733176     6.612 3.79e-11 ***\nORIG_HEX_IDHEX_777   1.3177736  0.2795851     4.713 2.44e-06 ***\nORIG_HEX_IDHEX_797   1.4083347  0.1309258    10.757  &lt; 2e-16 ***\nORIG_HEX_IDHEX_798   0.5181301  0.1693363     3.060 0.002215 ** \nORIG_HEX_IDHEX_799   5.5206308  0.1251577    44.109  &lt; 2e-16 ***\nORIG_HEX_IDHEX_800   6.2737459  0.1251202    50.142  &lt; 2e-16 ***\nORIG_HEX_IDHEX_802   1.5981623  0.1462167    10.930  &lt; 2e-16 ***\nORIG_HEX_IDHEX_803   0.4794150  0.2797401     1.714 0.086568 .  \nORIG_HEX_IDHEX_805   1.8647980  0.1628331    11.452  &lt; 2e-16 ***\nORIG_HEX_IDHEX_806   4.0433018  0.1364229    29.638  &lt; 2e-16 ***\nORIG_HEX_IDHEX_823   1.3680418  0.1391524     9.831  &lt; 2e-16 ***\nORIG_HEX_IDHEX_824   0.6391389  0.1377872     4.639 3.51e-06 ***\nORIG_HEX_IDHEX_825   3.7054177  0.1269334    29.192  &lt; 2e-16 ***\nORIG_HEX_IDHEX_826   7.1746670  0.1250801    57.361  &lt; 2e-16 ***\nORIG_HEX_IDHEX_827   6.4417826  0.1251358    51.478  &lt; 2e-16 ***\nORIG_HEX_IDHEX_832   0.8788790  1.0090403     0.871 0.383752    \nORIG_HEX_IDHEX_833   0.8731642  0.1835045     4.758 1.95e-06 ***\nORIG_HEX_IDHEX_851  -0.4179632  0.1669411    -2.504 0.012292 *  \nORIG_HEX_IDHEX_852   2.7567481  0.1270947    21.691  &lt; 2e-16 ***\nORIG_HEX_IDHEX_853   3.8283194  0.1254275    30.522  &lt; 2e-16 ***\nORIG_HEX_IDHEX_854   5.4663546  0.1251638    43.674  &lt; 2e-16 ***\nORIG_HEX_IDHEX_856  -0.0471922  0.2951138    -0.160 0.872950    \nORIG_HEX_IDHEX_861   1.6252978  0.1717098     9.465  &lt; 2e-16 ***\nORIG_HEX_IDHEX_862   3.5873467  0.1655704    21.667  &lt; 2e-16 ***\nORIG_HEX_IDHEX_878   1.5760848  0.1324238    11.902  &lt; 2e-16 ***\nORIG_HEX_IDHEX_879   2.4164993  0.1278094    18.907  &lt; 2e-16 ***\nORIG_HEX_IDHEX_880   4.5088736  0.1252305    36.005  &lt; 2e-16 ***\nORIG_HEX_IDHEX_881   4.5550267  0.1255759    36.273  &lt; 2e-16 ***\nORIG_HEX_IDHEX_888   2.6684606  0.2239103    11.918  &lt; 2e-16 ***\nORIG_HEX_IDHEX_889   4.4313632  0.1423970    31.120  &lt; 2e-16 ***\nORIG_HEX_IDHEX_905   1.6758101  0.1343404    12.474  &lt; 2e-16 ***\nORIG_HEX_IDHEX_906  -0.2128350  0.1898777    -1.121 0.262328    \nORIG_HEX_IDHEX_907   2.4337067  0.1280151    19.011  &lt; 2e-16 ***\nORIG_HEX_IDHEX_908   6.3510021  0.1251045    50.766  &lt; 2e-16 ***\nORIG_HEX_IDHEX_910   2.1646369  0.1442294    15.008  &lt; 2e-16 ***\nORIG_HEX_IDHEX_932   3.2704804  0.1263287    25.889  &lt; 2e-16 ***\nORIG_HEX_IDHEX_933   3.5944362  0.1259549    28.537  &lt; 2e-16 ***\nORIG_HEX_IDHEX_934   4.9981717  0.1252110    39.918  &lt; 2e-16 ***\nORIG_HEX_IDHEX_935   5.9097596  0.1251333    47.228  &lt; 2e-16 ***\nORIG_HEX_IDHEX_937   6.5837755  0.1252823    52.552  &lt; 2e-16 ***\nORIG_HEX_IDHEX_959   4.0763629  0.1260743    32.333  &lt; 2e-16 ***\nORIG_HEX_IDHEX_960   4.8728433  0.1252380    38.909  &lt; 2e-16 ***\nORIG_HEX_IDHEX_961   5.8679645  0.1251258    46.897  &lt; 2e-16 ***\nORIG_HEX_IDHEX_962   6.5229547  0.1251073    52.139  &lt; 2e-16 ***\nORIG_HEX_IDHEX_986   0.2591053  0.1564533     1.656 0.097698 .  \nORIG_HEX_IDHEX_987   6.0734227  0.1251140    48.543  &lt; 2e-16 ***\nORIG_HEX_IDHEX_988   4.9298367  0.1252625    39.356  &lt; 2e-16 ***\nORIG_HEX_IDHEX_989   6.1941750  0.1251111    49.509  &lt; 2e-16 ***\nORIG_HEX_IDHEX_991   3.2185729  0.1296988    24.816  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1014 -1.1126877  0.0261742   -42.511  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1015 -2.0282062  0.0322525   -62.885  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1016  0.0138170  0.0217018     0.637 0.524337    \nDEST_HEX_IDHEX_1042  1.0608821  0.0215221    49.293  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1043  0.4242517  0.0216208    19.622  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1045 -2.6596604  0.0339438   -78.355  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1067  1.7351438  0.0216398    80.183  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1068 -1.7821398  0.0408535   -43.623  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1069 -1.9041249  0.0290741   -65.492  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1070  0.6110475  0.0213689    28.595  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1078 -0.7621030  0.0419624   -18.162  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1093  1.1105028  0.0233401    47.579  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1094 -0.5312982  0.0255669   -20.781  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1095 -2.1883870  0.0328662   -66.585  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1096  0.0539860  0.0217344     2.484 0.012995 *  \nDEST_HEX_IDHEX_1097  0.1217010  0.0218488     5.570 2.55e-08 ***\nDEST_HEX_IDHEX_1099  0.2087371  0.0218807     9.540  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1100 -3.0930964  0.0535291   -57.784  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1122  0.3760082  0.0223377    16.833  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1123  2.0079400  0.0210111    95.566  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1124  0.5408720  0.0214051    25.268  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1125 -0.2832446  0.0222531   -12.728  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1126 -4.6811841  0.0713622   -65.598  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1127 -0.6179931  0.0221185   -27.940  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1128  0.1101758  0.0223587     4.928 8.32e-07 ***\nDEST_HEX_IDHEX_1132  0.1057758  0.0280233     3.775 0.000160 ***\nDEST_HEX_IDHEX_1147 -1.1948764  0.0380787   -31.379  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1148  0.3321641  0.0223043    14.892  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1149 -0.2122143  0.0225372    -9.416  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1150  0.5877201  0.0214738    27.369  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1151 -0.1135321  0.0217188    -5.227 1.72e-07 ***\nDEST_HEX_IDHEX_1152 -0.2257539  0.0221726   -10.182  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1153 -0.4033662  0.0222124   -18.160  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1154  1.5519561  0.0210997    73.553  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1155 -2.9308342  0.0439836   -66.635  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1158 -0.7021698  0.0340111   -20.645  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1174  1.0205714  0.0238447    42.801  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1175  1.9680900  0.0224074    87.832  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1176  0.9201338  0.0214309    42.935  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1177  0.5947263  0.0215155    27.642  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1178  0.0191813  0.0217416     0.882 0.377646    \nDEST_HEX_IDHEX_1179 -1.0360540  0.0229634   -45.118  &lt; 2e-16 ***\nDEST_HEX_IDHEX_118   1.5977864  0.0596258    26.797  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1180 -2.7415946  0.0293838   -93.303  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1181  0.2930654  0.0213829    13.706  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1182 -0.1370028  0.0222094    -6.169 6.89e-10 ***\nDEST_HEX_IDHEX_1183 -0.0821669  0.0235854    -3.484 0.000494 ***\nDEST_HEX_IDHEX_1185  0.1965660  0.0253823     7.744 9.62e-15 ***\nDEST_HEX_IDHEX_1201  0.2766535  0.0250406    11.048  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1202  0.4878137  0.0222001    21.973  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1203  1.4020225  0.0214238    65.442  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1205  1.5580063  0.0210587    73.984  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1206  0.2805729  0.0215709    13.007  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1207 -0.0762444  0.0215783    -3.533 0.000410 ***\nDEST_HEX_IDHEX_1209  1.2381846  0.0215107    57.561  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1210 -0.0121338  0.0252425    -0.481 0.630738    \nDEST_HEX_IDHEX_1211 -0.2468277  0.0266422    -9.265  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1212 -0.0638395  0.0263080    -2.427 0.015240 *  \nDEST_HEX_IDHEX_1228  0.4543640  0.0250661    18.127  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1229  0.7782871  0.0219484    35.460  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1230 -0.2089198  0.0232740    -8.977  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1231  2.0219323  0.0215735    93.723  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1232  0.7423323  0.0213782    34.724  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1233  1.5596442  0.0212395    73.431  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1235  0.5839975  0.0215034    27.158  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1236 -1.4644180  0.0246061   -59.514  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1237  1.2083621  0.0217094    55.661  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1238 -1.5191364  0.0318699   -47.667  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1239 -0.3399413  0.0264263   -12.864  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1240 -1.3326084  0.0668024   -19.949  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1255  1.3601862  0.0232784    58.431  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1256 -0.4360573  0.0234570   -18.590  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1257  0.1889878  0.0222576     8.491  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1258  1.2265145  0.0214350    57.220  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1259 -0.1785051  0.0221691    -8.052 8.15e-16 ***\nDEST_HEX_IDHEX_1261 -0.2625878  0.0217911   -12.050  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1262 -0.0775625  0.0218611    -3.548 0.000388 ***\nDEST_HEX_IDHEX_1263 -1.1322163  0.0271775   -41.660  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1264  0.5796930  0.0223717    25.912  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1265 -2.2082163  0.0343299   -64.323  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1266  0.2512284  0.0244519    10.274  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1282 -0.0609348  0.0247018    -2.467 0.013632 *  \nDEST_HEX_IDHEX_1283  0.5838421  0.0216951    26.911  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1284 -0.0836029  0.0226675    -3.688 0.000226 ***\nDEST_HEX_IDHEX_1285  0.7833142  0.0217923    35.945  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1286 -0.7941187  0.0237005   -33.506  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1287 -0.1163463  0.0229149    -5.077 3.83e-07 ***\nDEST_HEX_IDHEX_1288 -0.4188296  0.0226107   -18.523  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1289  0.5807149  0.0212593    27.316  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1293 -1.6623135  0.0299548   -55.494  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1308 -0.4162567  0.0260696   -15.967  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1309  1.4782407  0.0214512    68.912  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1310  2.4704303  0.0210004   117.637  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1311  0.8824585  0.0226517    38.958  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1312 -1.5840416  0.0305562   -51.840  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1314  0.8313228  0.0216187    38.454  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1315  1.6005781  0.0210667    75.977  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1316 -1.0233940  0.0235572   -43.443  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1318  0.1903342  0.0286126     6.652 2.89e-11 ***\nDEST_HEX_IDHEX_1319  1.4442002  0.0215561    66.997  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1320 -1.4646943  0.0277669   -52.750  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1335 -1.9392234  0.0985595   -19.676  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1336  1.2494343  0.0216544    57.699  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1337  0.6414801  0.0215258    29.801  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1338 -0.6806047  0.0247374   -27.513  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1339 -0.3756530  0.0271198   -13.852  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1340 -0.9415423  0.0248762   -37.849  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1341 -0.5143156  0.0234431   -21.939  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1342 -0.0791678  0.0221791    -3.569 0.000358 ***\nDEST_HEX_IDHEX_1343 -0.8459680  0.0225833   -37.460  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1347 -0.5275289  0.0239661   -22.011  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1348  0.3577993  0.0218569    16.370  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1362  0.9566536  0.0220113    43.462  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1363  1.1314060  0.0216089    52.358  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1364  0.0579857  0.0223326     2.596 0.009419 ** \nDEST_HEX_IDHEX_1366  0.5723047  0.0219184    26.111  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1367 -1.9656346  0.0318503   -61.715  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1368  0.6905193  0.0220412    31.329  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1369  0.4933132  0.0216171    22.821  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1370  0.0913898  0.0225075     4.060 4.90e-05 ***\nDEST_HEX_IDHEX_1372 -0.2428654  0.0373844    -6.496 8.22e-11 ***\nDEST_HEX_IDHEX_1374 -0.0866394  0.0219214    -3.952 7.74e-05 ***\nDEST_HEX_IDHEX_1375  0.8231547  0.0216646    37.995  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1389  1.2914192  0.0219629    58.800  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1390  1.1196787  0.0228083    49.091  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1391  0.6766354  0.0219268    30.859  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1392 -0.6467852  0.0249064   -25.969  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1394 -0.3927714  0.0239212   -16.419  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1396 -1.2122134  0.0266154   -45.546  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1397 -0.7339512  0.0231153   -31.752  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1401  1.6038827  0.0212065    75.632  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1402  0.1439018  0.0217296     6.622 3.53e-11 ***\nDEST_HEX_IDHEX_1416  0.1684735  0.0370390     4.549 5.40e-06 ***\nDEST_HEX_IDHEX_1417  0.1795061  0.0240429     7.466 8.26e-14 ***\nDEST_HEX_IDHEX_1418 -0.2173264  0.0308419    -7.046 1.84e-12 ***\nDEST_HEX_IDHEX_1419  2.1037316  0.0211908    99.276  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1420  1.9289510  0.0211607    91.157  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1422 -0.6732725  0.0261145   -25.782  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1423 -0.3671981  0.0225963   -16.250  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1426  1.1157911  0.0229971    48.519  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1428 -0.2353229  0.0221201   -10.638  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1429  0.1615407  0.0219881     7.347 2.03e-13 ***\nDEST_HEX_IDHEX_1443  1.7471636  0.0215179    81.196  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1444  1.3030920  0.0219949    59.245  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1445  1.3238370  0.0215938    61.306  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1446 -0.8315902  0.0273010   -30.460  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1447  0.8860898  0.0216678    40.894  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1455 -0.2750722  0.0229965   -11.961  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1456 -0.0793461  0.0220267    -3.602 0.000315 ***\nDEST_HEX_IDHEX_1457 -3.8140157  0.0710690   -53.666  &lt; 2e-16 ***\nDEST_HEX_IDHEX_146   3.0479806  0.0326307    93.408  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1469  1.8040857  0.0216529    83.318  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1470  1.9293734  0.0214349    90.011  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1471  1.3180518  0.0215458    61.174  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1472  0.2963728  0.0230244    12.872  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1480 -1.6474513  0.0465469   -35.393  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1482  0.9937385  0.0213456    46.555  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1483  1.1170485  0.0215096    51.932  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1496 -0.2398131  0.0268376    -8.936  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1497  2.0025792  0.0225133    88.951  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1498  1.1234310  0.0217190    51.726  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1499  0.6412148  0.0222393    28.832  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1500 -1.5111175  0.0397404   -38.025  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1501  0.1284402  0.0229030     5.608 2.05e-08 ***\nDEST_HEX_IDHEX_1507  2.2127885  0.0229692    96.337  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1509 -0.4692253  0.0235054   -19.962  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1510  2.4537110  0.0210444   116.597  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1511 -0.9983238  0.0268637   -37.163  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1523 -0.6825307  0.0429797   -15.880  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1524  1.6598428  0.0250546    66.249  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1525  1.6705841  0.0212892    78.471  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1526 -0.6293541  0.0267556   -23.522  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1527 -1.3463726  0.0497900   -27.041  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1534 -3.1163389  0.0944322   -33.001  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1536  0.6501846  0.0214606    30.297  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1537 -0.1602717  0.0225992    -7.092 1.32e-12 ***\nDEST_HEX_IDHEX_1550  1.7496761  0.0217025    80.621  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1551  0.7054821  0.0230396    30.620  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1552 -0.9181287  0.0308226   -29.788  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1553  0.5379820  0.0220456    24.403  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1554 -0.7475872  0.0296816   -25.187  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1555 -0.1944724  0.0239140    -8.132 4.22e-16 ***\nDEST_HEX_IDHEX_1562 -0.7047505  0.0427904   -16.470  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1563  0.4595336  0.0219496    20.936  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1564  0.1499758  0.0216876     6.915 4.67e-12 ***\nDEST_HEX_IDHEX_1565  1.7918881  0.0215154    83.284  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1576  1.2839687  0.0231392    55.489  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1578 -0.5927009  0.0249153   -23.789  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1579  1.7310105  0.0213335    81.140  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1581  0.3324820  0.0227851    14.592  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1588 -1.1648570  0.0549572   -21.196  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1590  0.1475013  0.0219244     6.728 1.72e-11 ***\nDEST_HEX_IDHEX_1591  0.4683891  0.0217413    21.544  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1592  0.8885342  0.0223795    39.703  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1604  2.1485667  0.0212212   101.246  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1605  1.2383360  0.0215685    57.414  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1606  0.9986849  0.0216337    46.163  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1607 -0.0282630  0.0229733    -1.230 0.218601    \nDEST_HEX_IDHEX_1616 -0.9542257  0.0372541   -25.614  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1617 -0.4356983  0.0241872   -18.014  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1618  1.9963540  0.0211399    94.436  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1619  0.5851174  0.0219399    26.669  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1620  1.2612359  0.0222333    56.727  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1630 -1.0052056  0.0282559   -35.575  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1631  0.6453189  0.0221470    29.138  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1632  0.9038440  0.0220848    40.926  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1633 -1.0371468  0.0274388   -37.799  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1634  0.9434682  0.0221296    42.634  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1635  1.7079718  0.0214004    79.810  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1642 -0.5807559  0.0513481   -11.310  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1644  0.4300957  0.0219285    19.614  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1645  0.6299061  0.0216423    29.105  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1646  1.2631253  0.0217351    58.114  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1647 -0.2115894  0.0353015    -5.994 2.05e-09 ***\nDEST_HEX_IDHEX_1658  0.6127835  0.0235821    25.985  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1659  1.5377054  0.0213772    71.932  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1660  0.6073749  0.0243618    24.931  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1661 -1.3457720  0.0313726   -42.896  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1662  0.5651297  0.0223898    25.241  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1669 -3.0687774  0.1378104   -22.268  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1670 -0.1644487  0.0301926    -5.447 5.13e-08 ***\nDEST_HEX_IDHEX_1672  0.1482932  0.0233433     6.353 2.12e-10 ***\nDEST_HEX_IDHEX_1673  1.5112543  0.0217100    69.611  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1674  1.2815432  0.0219180    58.470  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1684  1.1330845  0.0218117    51.948  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1685  1.0753885  0.0223070    48.209  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1686  1.0941858  0.0217470    50.314  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1687  0.1862078  0.0235217     7.916 2.44e-15 ***\nDEST_HEX_IDHEX_1688  0.2267831  0.0231983     9.776  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1689 -1.0559375  0.0348052   -30.338  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1695 -2.5408235  0.0747872   -33.974  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1699  0.7513210  0.0216365    34.725  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1700 -0.4409936  0.0252266   -17.481  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1701  1.9447906  0.0225175    86.368  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1712 -0.4057195  0.0249202   -16.281  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1713  1.8816346  0.0212174    88.684  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1714  0.2299006  0.0244527     9.402  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1716  0.9847155  0.0218552    45.056  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1723 -2.5348358  0.0751473   -33.732  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1726 -0.5781256  0.0256331   -22.554  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1727  0.5588839  0.0220146    25.387  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1728  1.3878324  0.0215681    64.346  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1738  0.7462149  0.0218740    34.114  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1739  2.0270220  0.0211425    95.874  &lt; 2e-16 ***\nDEST_HEX_IDHEX_174   1.3690564  0.0371808    36.822  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1740  0.5853036  0.0225119    26.000  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1741  1.0088483  0.0222167    45.410  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1743 -0.5376171  0.0348142   -15.442  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1744 -2.3971111  0.1205360   -19.887  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1748 -3.9410734  0.1213588   -32.475  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1749  0.7444062  0.0227001    32.793  &lt; 2e-16 ***\nDEST_HEX_IDHEX_175   1.7240380  0.0299201    57.621  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1753  1.6604356  0.0212131    78.274  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1754  0.1686776  0.0223317     7.553 4.24e-14 ***\nDEST_HEX_IDHEX_1764 -0.3778298  0.0491283    -7.691 1.46e-14 ***\nDEST_HEX_IDHEX_1765  2.1703308  0.0213014   101.887  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1766  1.3303110  0.0216622    61.412  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1767  1.0678037  0.0216408    49.342  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1768 -1.0157818  0.0325229   -31.233  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1770 -0.2488426  0.0249789    -9.962  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1771 -1.6409329  0.0416351   -39.412  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1776 -4.3780243  0.1189242   -36.814  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1777  0.6356325  0.0222449    28.574  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1778 -1.0592976  0.0258597   -40.963  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1780 -0.3515739  0.0266542   -13.190  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1781  0.8151618  0.0216826    37.595  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1791  0.6700862  0.0289141    23.175  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1792  0.3635611  0.0227136    16.006  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1793  1.4204675  0.0213927    66.400  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1794  0.9592948  0.0218206    43.963  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1795  0.9286953  0.0220343    42.148  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1796  1.3976530  0.0218289    64.028  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1798 -3.9503306  0.1753356   -22.530  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1800  0.2035944  0.0289074     7.043 1.88e-12 ***\nDEST_HEX_IDHEX_1802 -1.1758829  0.0309022   -38.052  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1804 -2.8121335  0.0437151   -64.329  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1805 -1.1245818  0.0245301   -45.845  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1806 -0.2292675  0.0224707   -10.203  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1807 -0.9973639  0.0234687   -42.498  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1808 -0.4437927  0.0263400   -16.849  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1820  0.8951204  0.0218717    40.926  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1821  2.0187388  0.0212339    95.072  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1822  0.1553361  0.0234499     6.624 3.49e-11 ***\nDEST_HEX_IDHEX_1823  0.7362042  0.0229326    32.103  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1824  1.5699181  0.0214451    73.206  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1827  0.0128863  0.0234572     0.549 0.582764    \nDEST_HEX_IDHEX_1828  0.4198978  0.0227600    18.449  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1829  1.2992560  0.0217429    59.755  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1831 -1.0583457  0.0277970   -38.074  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1833  0.9318109  0.0212962    43.755  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1834  0.9425366  0.0213884    44.068  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1835 -0.9981267  0.0244555   -40.814  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1846 -1.0157499  0.0340527   -29.829  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1847 -0.9021224  0.0305877   -29.493  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1848  0.6380743  0.0221032    28.868  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1849  2.3775408  0.0211002   112.678  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1850  1.1063691  0.0225734    49.012  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1852 -1.8152251  0.0389317   -46.626  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1853  1.2113932  0.0217121    55.794  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1854  0.5037540  0.0222392    22.652  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1855 -1.2567893  0.0272804   -46.069  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1856 -3.5412495  0.1936653   -18.285  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1857 -2.2273970  0.0504116   -44.184  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1858 -1.1227717  0.0242577   -46.285  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1859 -0.5347179  0.0223111   -23.966  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1860  0.0495689  0.0217164     2.283 0.022457 *  \nDEST_HEX_IDHEX_1861 -0.5690138  0.0240369   -23.673  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1862 -0.8619268  0.0294048   -29.312  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1874  1.2140760  0.0215933    56.225  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1875  1.3191160  0.0215128    61.318  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1876  0.3488044  0.0241825    14.424  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1877  0.8177393  0.0221958    36.842  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1878  0.9316532  0.0220032    42.342  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1879 -0.2156215  0.0239885    -8.989  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1882  1.0885247  0.0215688    50.468  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1883  0.0028834  0.0228718     0.126 0.899677    \nDEST_HEX_IDHEX_1884 -0.6480460  0.0278836   -23.241  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1886  2.1173708  0.0210815   100.437  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1887  2.4103418  0.0210387   114.567  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1888 -0.5686212  0.0225973   -25.163  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1889 -3.9768939  0.0943209   -42.163  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1890 -1.1747563  0.0484005   -24.272  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1900  0.6659155  0.0233723    28.492  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1901  1.5580423  0.0213744    72.893  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1902  0.8815230  0.0223949    39.363  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1903  0.8988181  0.0224894    39.966  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1904  0.8586219  0.0226349    37.934  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1905  0.4602500  0.0221603    20.769  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1906  0.7447295  0.0217813    34.191  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1907  0.7611870  0.0218275    34.873  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1908  0.5529651  0.0222116    24.895  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1909  0.3089660  0.0222461    13.889  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1910 -0.5662924  0.0246689   -22.956  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1912 -3.2264634  0.0442067   -72.986  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1913  0.1199605  0.0214614     5.590 2.28e-08 ***\nDEST_HEX_IDHEX_1914  0.3309457  0.0214865    15.402  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1916 -0.8212623  0.0385192   -21.321  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1928  1.1725338  0.0219121    53.511  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1929  1.1482094  0.0218257    52.608  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1930  1.1277150  0.0215748    52.270  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1931  0.3769317  0.0225796    16.693  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1932  1.2324856  0.0215312    57.242  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1933  1.3672410  0.0217375    62.898  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1934  0.0829570  0.0225088     3.686 0.000228 ***\nDEST_HEX_IDHEX_1935  0.6051820  0.0218551    27.691  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1936  0.5965230  0.0218604    27.288  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1937  0.9479082  0.0215550    43.976  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1938 -1.0737643  0.0453028   -23.702  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1940 -0.2750857  0.0220944   -12.450  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1941 -1.1715820  0.0228599   -51.251  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1942  0.1729685  0.0224148     7.717 1.19e-14 ***\nDEST_HEX_IDHEX_1954  0.4696015  0.0250767    18.727  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1955  1.6171981  0.0214059    75.549  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1956  0.8967461  0.0221396    40.504  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1958  1.4357892  0.0214593    66.907  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1959  1.3579986  0.0213082    63.731  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1960  1.5633713  0.0215430    72.570  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1961  1.9227561  0.0211577    90.877  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1962  0.4984511  0.0217064    22.963  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1963  0.1775038  0.0217666     8.155 3.50e-16 ***\nDEST_HEX_IDHEX_1964  0.9867253  0.0215703    45.745  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1967  0.1459632  0.0216847     6.731 1.68e-11 ***\nDEST_HEX_IDHEX_1968  0.1230543  0.0218118     5.642 1.68e-08 ***\nDEST_HEX_IDHEX_1982  2.3426429  0.0211490   110.768  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1983  1.5166248  0.0214339    70.758  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1984  1.8254909  0.0212066    86.081  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1985  1.2591538  0.0215762    58.358  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1986  0.3267107  0.0226728    14.410  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1987  2.1648937  0.0210684   102.756  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1988  0.4648622  0.0217212    21.401  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1989  0.2015677  0.0219285     9.192  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1990  2.4317692  0.0210308   115.629  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1991  1.2772190  0.0213773    59.746  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1992  1.6169305  0.0214793    75.278  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1994 -2.3744289  0.0297584   -79.790  &lt; 2e-16 ***\nDEST_HEX_IDHEX_1995 -0.3806148  0.0224038   -16.989  &lt; 2e-16 ***\nDEST_HEX_IDHEX_200   2.0899051  0.0430655    48.529  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2009  2.4008777  0.0211294   113.627  &lt; 2e-16 ***\nDEST_HEX_IDHEX_201   2.0547980  0.0271567    75.664  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2010  1.6667468  0.0212615    78.393  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2011  1.5656631  0.0213360    73.381  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2012  0.6180792  0.0221514    27.902  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2013  0.6682051  0.0215369    31.026  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2014  0.8646364  0.0214063    40.392  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2015  0.8231941  0.0216235    38.069  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2016  0.4936205  0.0217288    22.717  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2017  0.6791146  0.0215690    31.486  &lt; 2e-16 ***\nDEST_HEX_IDHEX_202   1.4192627  0.0333203    42.595  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2021 -1.5638712  0.0245693   -63.651  &lt; 2e-16 ***\nDEST_HEX_IDHEX_203   1.0698264  0.0312914    34.189  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2036 -0.6429543  0.0365547   -17.589  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2037  0.3837705  0.0235511    16.295  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2038  2.0446409  0.0211706    96.579  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2039  0.4855324  0.0223601    21.714  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2040  0.7135829  0.0218923    32.595  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2041  0.9932805  0.0218629    45.432  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2042  0.7488927  0.0222981    33.585  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2043  0.7841357  0.0214960    36.478  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2044  0.4741538  0.0216791    21.871  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2046 -0.3608875  0.0243652   -14.812  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2049 -2.4420647  0.0310248   -78.713  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2063  0.8367273  0.0232792    35.943  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2064  1.4775681  0.0214580    68.859  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2065  0.8191855  0.0217530    37.658  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2066  0.5844005  0.0217819    26.830  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2067  0.4654089  0.0216556    21.491  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2068  0.6804360  0.0216003    31.501  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2069 -1.1881158  0.0257030   -46.225  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2070  0.9891942  0.0217381    45.505  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2071  1.3324031  0.0213511    62.405  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2072 -2.3635416  0.0484690   -48.764  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2074 -2.0192200  0.0363433   -55.560  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2089  0.6047168  0.0770702     7.846 4.28e-15 ***\nDEST_HEX_IDHEX_2090 -0.6219415  0.1050660    -5.920 3.23e-09 ***\nDEST_HEX_IDHEX_2091 -0.3867793  0.0302142   -12.801  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2092  1.0195187  0.0219128    46.526  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2093  1.4813751  0.0213070    69.525  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2094  0.9484004  0.0216694    43.767  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2095  1.0677769  0.0221059    48.303  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2096 -0.1266770  0.0228297    -5.549 2.88e-08 ***\nDEST_HEX_IDHEX_2097 -0.0339324  0.0314105    -1.080 0.280013    \nDEST_HEX_IDHEX_2098  0.3452661  0.0219945    15.698  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2100 -1.8291316  0.0494170   -37.014  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2101 -0.7235307  0.0264452   -27.360  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2102  0.2073092  0.0228682     9.065  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2116  0.2491147  0.1093141     2.279 0.022674 *  \nDEST_HEX_IDHEX_2117 -0.9420190  0.1368045    -6.886 5.74e-12 ***\nDEST_HEX_IDHEX_2119  1.1160815  0.0216378    51.580  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2120  1.6002433  0.0212566    75.282  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2121  0.8070613  0.0216428    37.290  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2122 -2.6369594  0.0591512   -44.580  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2123 -0.1896966  0.0225686    -8.405  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2124 -0.1644764  0.0229641    -7.162 7.93e-13 ***\nDEST_HEX_IDHEX_2125  1.3775142  0.0213464    64.531  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2126 -0.9586973  0.0250772   -38.230  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2129 -1.2206799  0.0292900   -41.676  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2146 -0.3292546  0.0299761   -10.984  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2147  1.0448159  0.0214566    48.694  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2148  1.2746116  0.0213753    59.630  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2149  0.6480526  0.0218770    29.623  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2150 -0.8015162  0.0246628   -32.499  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2151 -0.9572315  0.0248604   -38.504  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2152  1.4317949  0.0213049    67.205  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2153  0.6007984  0.0246323    24.391  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2154 -0.8089115  0.0237732   -34.026  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2155 -0.3590330  0.0234668   -15.300  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2171 -0.9938694  0.1973983    -5.035 4.78e-07 ***\nDEST_HEX_IDHEX_2172 -0.2412234  0.0323994    -7.445 9.67e-14 ***\nDEST_HEX_IDHEX_2174 -0.7025202  0.0266881   -26.323  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2175  1.7571492  0.0212039    82.869  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2176  0.8512485  0.0216959    39.236  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2177  2.3624864  0.0210472   112.247  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2178 -0.9733345  0.0236349   -41.182  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2179  0.7107330  0.0214713    33.102  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2180 -0.0867713  0.0222492    -3.900 9.62e-05 ***\nDEST_HEX_IDHEX_2181  0.9080827  0.0215058    42.225  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2182 -0.4299566  0.0277919   -15.471  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2200  0.5709876  0.0244291    23.373  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2201  0.9224932  0.0215739    42.760  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2202  1.5036680  0.0217093    69.264  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2203  1.2405246  0.0219664    56.474  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2204  1.2342154  0.0213775    57.734  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2205  0.1445587  0.0219832     6.576 4.84e-11 ***\nDEST_HEX_IDHEX_2206  0.9622288  0.0213150    45.143  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2207 -0.2549044  0.0221011   -11.534  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2208  0.0599101  0.0220485     2.717 0.006584 ** \nDEST_HEX_IDHEX_2209 -1.8887574  0.0332190   -56.858  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2227  0.1377740  0.0228339     6.034 1.60e-09 ***\nDEST_HEX_IDHEX_2228  0.6860633  0.0218044    31.464  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2229  1.2415559  0.0213780    58.076  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2230  0.9503228  0.0222883    42.638  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2231  0.2671259  0.0217989    12.254  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2233  0.8007546  0.0213407    37.522  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2234 -4.6231623  0.0876824   -52.726  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2235 -3.0553670  0.0675353   -45.241  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2254  0.7263584  0.0235952    30.784  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2255  0.4328379  0.0222566    19.448  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2256  0.6427646  0.0218086    29.473  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2257  0.4047288  0.0230059    17.592  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2258 -0.3695564  0.0231432   -15.968  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2259 -0.5354679  0.0233517   -22.931  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2260  0.1750095  0.0219009     7.991 1.34e-15 ***\nDEST_HEX_IDHEX_2261  0.3287293  0.0218196    15.066  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2262 -0.9039257  0.0235915   -38.316  &lt; 2e-16 ***\nDEST_HEX_IDHEX_227  -0.2066625  0.0509093    -4.059 4.92e-05 ***\nDEST_HEX_IDHEX_228   1.2894487  0.0285066    45.233  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2281  0.4378936  0.0224251    19.527  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2282  1.5206375  0.0213183    71.330  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2283  0.5610374  0.0220218    25.476  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2284  0.7577320  0.0216964    34.924  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2285  0.8775795  0.0218382    40.186  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2286 -0.1812366  0.0222384    -8.150 3.65e-16 ***\nDEST_HEX_IDHEX_2287  0.8950898  0.0213227    41.978  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2288 -1.4732037  0.0260753   -56.498  &lt; 2e-16 ***\nDEST_HEX_IDHEX_229  -1.3637898  0.1076222   -12.672  &lt; 2e-16 ***\nDEST_HEX_IDHEX_230   2.6783945  0.0246434   108.686  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2308  0.5286833  0.0230161    22.970  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2309  1.1889764  0.0215484    55.177  &lt; 2e-16 ***\nDEST_HEX_IDHEX_231  -0.4700576  0.0398842   -11.786  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2310  0.7166325  0.0216423    33.113  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2311  1.6315689  0.0212445    76.800  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2312 -0.0402576  0.0228914    -1.759 0.078640 .  \nDEST_HEX_IDHEX_2313  1.4558158  0.0212778    68.419  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2314  1.5873156  0.0211029    75.218  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2315 -0.1052564  0.0221257    -4.757 1.96e-06 ***\nDEST_HEX_IDHEX_2316  0.2373631  0.0217767    10.900  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2317 -1.9599588  0.0361741   -54.181  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2335 -0.5118439  0.0265226   -19.298  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2336  1.7441931  0.0211736    82.376  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2337  1.2808385  0.0213572    59.972  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2338  0.6668555  0.0221141    30.155  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2339  1.0961554  0.0214454    51.114  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2340  0.6454902  0.0214443    30.101  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2341  0.7440578  0.0213415    34.864  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2342 -0.4257969  0.0220097   -19.346  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2343 -0.7637214  0.0229727   -33.245  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2362  0.2242713  0.0244065     9.189  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2363  0.6627416  0.0219306    30.220  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2364  0.0844128  0.0235553     3.584 0.000339 ***\nDEST_HEX_IDHEX_2365  1.6054801  0.0213100    75.339  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2366  1.3538485  0.0242705    55.782  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2367  0.7385810  0.0217528    33.953  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2368  0.2892472  0.0216185    13.380  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2369  1.2021351  0.0211825    56.751  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2370  1.7102830  0.0210774    81.143  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2371 -0.2997959  0.0221857   -13.513  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2389  0.5845021  0.0221991    26.330  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2390  1.4746326  0.0212898    69.265  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2391  1.3504248  0.0215301    62.723  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2392  1.6471360  0.0228586    72.058  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2393  2.7612144  0.0222149   124.295  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2394 -1.1559708  0.0255147   -45.306  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2395  0.3210119  0.0215758    14.878  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2396  0.1504995  0.0215269     6.991 2.73e-12 ***\nDEST_HEX_IDHEX_2397 -1.4373528  0.0235742   -60.971  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2398 -0.5913545  0.0242024   -24.434  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2416  0.3198135  0.0230375    13.882  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2417  0.1623125  0.0236933     6.851 7.36e-12 ***\nDEST_HEX_IDHEX_2418  0.7679737  0.0217008    35.389  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2419  1.6035769  0.0212879    75.328  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2420 -1.0063198  0.0457715   -21.986  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2422 -1.1218704  0.0332049   -33.786  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2423 -0.9042218  0.0229291   -39.435  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2424  0.9665129  0.0212170    45.554  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2425  1.6733042  0.0211152    79.246  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2426 -0.1644627  0.0276162    -5.955 2.60e-09 ***\nDEST_HEX_IDHEX_2443  1.7124871  0.0212870    80.448  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2444  1.3206058  0.0213239    61.931  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2445  1.4610427  0.0212997    68.594  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2448  0.4907558  0.0236911    20.715  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2449 -0.9360791  0.0245445   -38.138  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2450 -0.5787199  0.0224108   -25.823  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2451  1.2112324  0.0211889    57.164  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2452 -2.2225065  0.0347717   -63.917  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2471  0.2225757  0.0222453    10.006  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2472 -1.5008262  0.0292106   -51.380  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2473  1.5800386  0.0213677    73.945  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2476  1.6903271  0.0223271    75.707  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2478 -0.5045710  0.0222021   -22.726  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2479 -1.8509789  0.0263515   -70.242  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2480 -1.0462620  0.0321911   -32.502  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2497  1.0556650  0.0216649    48.727  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2498 -0.9424550  0.0262378   -35.920  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2499  0.0724524  0.0227554     3.184 0.001453 ** \nDEST_HEX_IDHEX_2500 -0.4315802  0.0269518   -16.013  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2503 -1.7681373  0.0620551   -28.493  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2504 -0.6281630  0.0230893   -27.206  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2505 -0.4554572  0.0222930   -20.431  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2525  0.0301221  0.0230871     1.305 0.191989    \nDEST_HEX_IDHEX_2526  1.1418072  0.0214536    53.222  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2527  1.5694057  0.0213121    73.639  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2531 -2.7196540  0.1075305   -25.292  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2532 -0.4898033  0.0228107   -21.473  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2533 -0.8580761  0.0273893   -31.329  &lt; 2e-16 ***\nDEST_HEX_IDHEX_254   3.2608801  0.0304589   107.058  &lt; 2e-16 ***\nDEST_HEX_IDHEX_255   1.5380110  0.0293976    52.318  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2551  1.2392567  0.0216923    57.129  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2552 -0.2708163  0.0246000   -11.009  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2553  0.4256417  0.0229244    18.567  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2554 -0.5726644  0.0243225   -23.545  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2557  1.5589040  0.0229325    67.978  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2559 -1.2497285  0.0270471   -46.206  &lt; 2e-16 ***\nDEST_HEX_IDHEX_256   2.4276436  0.0259345    93.607  &lt; 2e-16 ***\nDEST_HEX_IDHEX_257   0.2883411  0.0311965     9.243  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2579  0.3396430  0.0223023    15.229  &lt; 2e-16 ***\nDEST_HEX_IDHEX_258   1.0516470  0.0314313    33.459  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2580  1.2918209  0.0213754    60.435  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2581  0.0415285  0.0227079     1.829 0.067428 .  \nDEST_HEX_IDHEX_2584 -0.5392593  0.0316245   -17.052  &lt; 2e-16 ***\nDEST_HEX_IDHEX_259   0.3963017  0.0268016    14.786  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2605 -0.5648748  0.0280598   -20.131  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2606 -0.6816576  0.0289066   -23.581  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2607  0.2491939  0.0221194    11.266  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2608 -0.0612702  0.0233944    -2.619 0.008818 ** \nDEST_HEX_IDHEX_2609 -1.9968419  0.0425281   -46.953  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2610 -0.8792592  0.0347710   -25.287  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2611  1.8556329  0.0238586    77.776  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2633  0.7074744  0.0221040    32.007  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2634  2.6163396  0.0210374   124.366  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2635 -0.4141303  0.0239025   -17.326  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2636  1.0650144  0.0216198    49.261  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2637 -0.1601689  0.0232996    -6.874 6.23e-12 ***\nDEST_HEX_IDHEX_2638  0.3424906  0.0222793    15.373  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2660  0.6893589  0.0217936    31.631  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2661  0.4773640  0.0216461    22.053  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2662 -0.2529079  0.0226969   -11.143  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2663  1.1762045  0.0215515    54.576  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2664  0.2882857  0.0220992    13.045  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2665  1.6681655  0.0212573    78.475  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2687 -0.4595408  0.0244101   -18.826  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2688  0.6654152  0.0216166    30.783  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2689  1.3319737  0.0213171    62.484  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2690  1.1274818  0.0214157    52.647  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2691  0.5625922  0.0218089    25.796  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2692 -2.6566420  0.0510514   -52.039  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2693  0.8828157  0.0216837    40.713  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2714 -0.2780981  0.0231883   -11.993  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2715  0.3689275  0.0221296    16.671  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2716 -1.2969753  0.0261582   -49.582  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2717  0.7639581  0.0214412    35.630  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2718 -0.0847864  0.0226680    -3.740 0.000184 ***\nDEST_HEX_IDHEX_2719  0.8131506  0.0216759    37.514  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2742  0.9599362  0.0215574    44.529  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2743  1.2277395  0.0220560    55.665  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2744  1.5684430  0.0212088    73.952  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2745  1.5577517  0.0211990    73.482  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2746 -0.9638807  0.0260682   -36.975  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2747  0.0822780  0.0228043     3.608 0.000309 ***\nDEST_HEX_IDHEX_2768  0.9749101  0.0218304    44.658  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2769  1.9345082  0.0212459    91.053  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2770  1.4594781  0.0213638    68.315  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2771  2.7326511  0.0210319   129.929  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2772 -2.0814638  0.0367351   -56.662  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2773 -0.2710582  0.0227314   -11.924  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2795 -0.2628013  0.0696634    -3.772 0.000162 ***\nDEST_HEX_IDHEX_2796 -3.9266496  0.1402882   -27.990  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2797  1.1632357  0.0216076    53.835  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2798 -0.5100353  0.0232316   -21.954  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2799  0.2653659  0.0219291    12.101  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2800  1.6258629  0.0212459    76.526  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2801 -1.6849896  0.0385224   -43.741  &lt; 2e-16 ***\nDEST_HEX_IDHEX_281  -0.2543009  0.0527851    -4.818 1.45e-06 ***\nDEST_HEX_IDHEX_282   0.6725629  0.0362374    18.560  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2822 -0.5190053  0.0253657   -20.461  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2823  0.8882758  0.0219113    40.540  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2824  1.7379706  0.0214660    80.964  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2825  0.7877974  0.0215223    36.604  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2826  0.2943098  0.0226887    12.972  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2827  2.3005993  0.0211269   108.894  &lt; 2e-16 ***\nDEST_HEX_IDHEX_284   1.9978123  0.0240496    83.071  &lt; 2e-16 ***\nDEST_HEX_IDHEX_285   0.8533103  0.0248075    34.397  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2850 -0.0598311  0.0255490    -2.342 0.019190 *  \nDEST_HEX_IDHEX_2851  1.6835953  0.0214684    78.422  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2852  0.0255556  0.0231624     1.103 0.269886    \nDEST_HEX_IDHEX_2853  1.9994624  0.0211440    94.564  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2854  0.8265031  0.0216783    38.126  &lt; 2e-16 ***\nDEST_HEX_IDHEX_286   1.6998888  0.0237400    71.605  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2877  0.5509572  0.0247334    22.276  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2878  0.9911302  0.0219851    45.082  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2879  0.4851032  0.0224632    21.595  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2880  0.1637133  0.0221144     7.403 1.33e-13 ***\nDEST_HEX_IDHEX_2881  0.2253246  0.0226206     9.961  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2905  1.4595492  0.0222774    65.517  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2906  0.8356920  0.0229040    36.487  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2907 -0.0584619  0.0226539    -2.581 0.009861 ** \nDEST_HEX_IDHEX_2908  0.9844310  0.0217020    45.361  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2909 -1.2892338  0.0462463   -27.878  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2931  1.7445488  0.0225834    77.249  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2932  1.1409897  0.0228922    49.842  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2933  1.6764613  0.0216633    77.387  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2934  0.2899588  0.0222340    13.041  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2959  1.9053299  0.0230872    82.527  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2960  2.8656365  0.0221256   129.517  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2961  0.9352908  0.0225091    41.552  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2962  1.3436267  0.0216667    62.014  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2963  1.3320343  0.0242780    54.866  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2987  1.4160712  0.0237948    59.512  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2988 -1.3265339  0.0342443   -38.737  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2989  0.9180257  0.0223705    41.037  &lt; 2e-16 ***\nDEST_HEX_IDHEX_2990  1.7772184  0.0247582    71.783  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3015  0.2168926  0.0300938     7.207 5.71e-13 ***\nDEST_HEX_IDHEX_3016  1.1951679  0.0241537    49.482  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3017  0.6811733  0.0230486    29.554  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3040  2.0083031  0.0216972    92.560  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3043  0.5695251  0.0231613    24.589  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3044  0.9239485  0.0230597    40.068  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3068  0.3206609  0.0243167    13.187  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3070  0.3236326  0.0286517    11.295  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3072  0.5029354  0.0325949    15.430  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3092  1.7561276  0.0284862    61.648  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3098  1.3486382  0.0224670    60.027  &lt; 2e-16 ***\nDEST_HEX_IDHEX_312   1.2916477  0.0250141    51.637  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3123  3.3227430  0.0212107   156.654  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3126 -2.3275530  0.0739453   -31.477  &lt; 2e-16 ***\nDEST_HEX_IDHEX_313  -0.0919784  0.0336443    -2.734 0.006260 ** \nDEST_HEX_IDHEX_314   0.3871627  0.0278863    13.884  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3151  2.9332956  0.0214388   136.822  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3152 -2.3756642  0.0702287   -33.828  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3173  0.7729971  0.0350892    22.029  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3178  1.4350202  0.0231518    61.983  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3179  1.1513361  0.0234563    49.084  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3205  2.0358390  0.0243684    83.544  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3206  2.6788299  0.0219185   122.218  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3232  1.9655117  0.0320156    61.392  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3233  0.9894318  0.0304930    32.448  &lt; 2e-16 ***\nDEST_HEX_IDHEX_3308  1.8870178  0.0296773    63.584  &lt; 2e-16 ***\nDEST_HEX_IDHEX_336   0.1388410  0.0483844     2.870 0.004111 ** \nDEST_HEX_IDHEX_338  -0.4632318  0.0331132   -13.989  &lt; 2e-16 ***\nDEST_HEX_IDHEX_339  -0.7915449  0.0331017   -23.913  &lt; 2e-16 ***\nDEST_HEX_IDHEX_340  -3.3356826  0.2781746   -11.991  &lt; 2e-16 ***\nDEST_HEX_IDHEX_366   0.1724975  0.0266063     6.483 8.97e-11 ***\nDEST_HEX_IDHEX_367   0.9408873  0.0241982    38.882  &lt; 2e-16 ***\nDEST_HEX_IDHEX_391   1.0601088  0.0367833    28.820  &lt; 2e-16 ***\nDEST_HEX_IDHEX_392   0.2271562  0.0288360     7.878 3.34e-15 ***\nDEST_HEX_IDHEX_393   1.4040625  0.0232488    60.393  &lt; 2e-16 ***\nDEST_HEX_IDHEX_394  -1.3118579  0.0833697   -15.735  &lt; 2e-16 ***\nDEST_HEX_IDHEX_419   1.7982047  0.0279469    64.344  &lt; 2e-16 ***\nDEST_HEX_IDHEX_420   1.0245660  0.0262319    39.058  &lt; 2e-16 ***\nDEST_HEX_IDHEX_421   0.5487243  0.0317815    17.266  &lt; 2e-16 ***\nDEST_HEX_IDHEX_445   2.6280246  0.0245930   106.861  &lt; 2e-16 ***\nDEST_HEX_IDHEX_446  -0.4226960  0.0292858   -14.433  &lt; 2e-16 ***\nDEST_HEX_IDHEX_447   0.3611863  0.0274590    13.154  &lt; 2e-16 ***\nDEST_HEX_IDHEX_472   0.6639744  0.0386504    17.179  &lt; 2e-16 ***\nDEST_HEX_IDHEX_473   1.2777231  0.0249039    51.306  &lt; 2e-16 ***\nDEST_HEX_IDHEX_474   0.7775060  0.0268605    28.946  &lt; 2e-16 ***\nDEST_HEX_IDHEX_499   2.3261291  0.0248885    93.462  &lt; 2e-16 ***\nDEST_HEX_IDHEX_500   0.3537355  0.0260369    13.586  &lt; 2e-16 ***\nDEST_HEX_IDHEX_526   2.9948600  0.0236779   126.483  &lt; 2e-16 ***\nDEST_HEX_IDHEX_527   1.1914820  0.0266860    44.648  &lt; 2e-16 ***\nDEST_HEX_IDHEX_528   1.6121806  0.0227833    70.762  &lt; 2e-16 ***\nDEST_HEX_IDHEX_552   1.8081907  0.0292408    61.838  &lt; 2e-16 ***\nDEST_HEX_IDHEX_553  -1.2404915  0.0626060   -19.814  &lt; 2e-16 ***\nDEST_HEX_IDHEX_554   1.4817634  0.0238451    62.141  &lt; 2e-16 ***\nDEST_HEX_IDHEX_555   0.6027738  0.0234300    25.727  &lt; 2e-16 ***\nDEST_HEX_IDHEX_581   2.1196787  0.0229563    92.335  &lt; 2e-16 ***\nDEST_HEX_IDHEX_582   0.0213304  0.0243811     0.875 0.381641    \nDEST_HEX_IDHEX_607   1.4862884  0.0273323    54.378  &lt; 2e-16 ***\nDEST_HEX_IDHEX_608   1.0450389  0.0246518    42.392  &lt; 2e-16 ***\nDEST_HEX_IDHEX_609   1.8979224  0.0214969    88.288  &lt; 2e-16 ***\nDEST_HEX_IDHEX_610   1.3028898  0.0234721    55.508  &lt; 2e-16 ***\nDEST_HEX_IDHEX_611  -0.4288592  0.0366614   -11.698  &lt; 2e-16 ***\nDEST_HEX_IDHEX_634   2.2349604  0.0255523    87.466  &lt; 2e-16 ***\nDEST_HEX_IDHEX_635   2.0007825  0.0238198    83.997  &lt; 2e-16 ***\nDEST_HEX_IDHEX_636  -0.0279017  0.0240288    -1.161 0.245569    \nDEST_HEX_IDHEX_638   2.1434878  0.0216686    98.922  &lt; 2e-16 ***\nDEST_HEX_IDHEX_661   1.0085422  0.0301098    33.496  &lt; 2e-16 ***\nDEST_HEX_IDHEX_662   1.4635658  0.0242967    60.237  &lt; 2e-16 ***\nDEST_HEX_IDHEX_663  -0.1496584  0.0231938    -6.453 1.10e-10 ***\nDEST_HEX_IDHEX_664   0.8002410  0.0233620    34.254  &lt; 2e-16 ***\nDEST_HEX_IDHEX_665   0.2360852  0.0246891     9.562  &lt; 2e-16 ***\nDEST_HEX_IDHEX_689   0.5595035  0.0268823    20.813  &lt; 2e-16 ***\nDEST_HEX_IDHEX_690   0.6100718  0.0232098    26.285  &lt; 2e-16 ***\nDEST_HEX_IDHEX_692  -0.2855705  0.0254720   -11.211  &lt; 2e-16 ***\nDEST_HEX_IDHEX_693  -0.7707882  0.0354606   -21.736  &lt; 2e-16 ***\nDEST_HEX_IDHEX_715   0.8957454  0.0298545    30.004  &lt; 2e-16 ***\nDEST_HEX_IDHEX_716   0.2725808  0.0266992    10.209  &lt; 2e-16 ***\nDEST_HEX_IDHEX_717  -0.2956912  0.0236364   -12.510  &lt; 2e-16 ***\nDEST_HEX_IDHEX_718   1.2776482  0.0215459    59.299  &lt; 2e-16 ***\nDEST_HEX_IDHEX_719  -0.5283356  0.0299344   -17.650  &lt; 2e-16 ***\nDEST_HEX_IDHEX_720  -2.1706133  0.0551256   -39.376  &lt; 2e-16 ***\nDEST_HEX_IDHEX_743   2.0067323  0.0232727    86.227  &lt; 2e-16 ***\nDEST_HEX_IDHEX_744   0.8437916  0.0227860    37.031  &lt; 2e-16 ***\nDEST_HEX_IDHEX_745   0.1527134  0.0219154     6.968 3.21e-12 ***\nDEST_HEX_IDHEX_746  -0.5292574  0.0231354   -22.877  &lt; 2e-16 ***\nDEST_HEX_IDHEX_747   0.8064676  0.0228417    35.307  &lt; 2e-16 ***\nDEST_HEX_IDHEX_748  -0.4733989  0.0291801   -16.223  &lt; 2e-16 ***\nDEST_HEX_IDHEX_769   1.2236061  0.0264678    46.230  &lt; 2e-16 ***\nDEST_HEX_IDHEX_770   2.4135351  0.0220406   109.504  &lt; 2e-16 ***\nDEST_HEX_IDHEX_771   0.5429250  0.0221268    24.537  &lt; 2e-16 ***\nDEST_HEX_IDHEX_772   1.1199997  0.0212092    52.807  &lt; 2e-16 ***\nDEST_HEX_IDHEX_773  -1.3582390  0.0264067   -51.435  &lt; 2e-16 ***\nDEST_HEX_IDHEX_774   0.3987657  0.0239888    16.623  &lt; 2e-16 ***\nDEST_HEX_IDHEX_775  -0.0390194  0.0261691    -1.491 0.135948    \nDEST_HEX_IDHEX_776  -3.2202740  0.2053351   -15.683  &lt; 2e-16 ***\nDEST_HEX_IDHEX_777  -1.1739962  0.0481938   -24.360  &lt; 2e-16 ***\nDEST_HEX_IDHEX_797   0.7460033  0.0275184    27.109  &lt; 2e-16 ***\nDEST_HEX_IDHEX_798  -1.4566647  0.0534338   -27.261  &lt; 2e-16 ***\nDEST_HEX_IDHEX_799   0.9726191  0.0213936    45.463  &lt; 2e-16 ***\nDEST_HEX_IDHEX_800   0.1196954  0.0217347     5.507 3.65e-08 ***\nDEST_HEX_IDHEX_802  -3.3848712  0.0795107   -42.571  &lt; 2e-16 ***\nDEST_HEX_IDHEX_803  -1.1363322  0.0395568   -28.727  &lt; 2e-16 ***\nDEST_HEX_IDHEX_805  -1.2476127  0.0559239   -22.309  &lt; 2e-16 ***\nDEST_HEX_IDHEX_806   1.1285136  0.0264692    42.635  &lt; 2e-16 ***\nDEST_HEX_IDHEX_823   1.4826189  0.0273785    54.153  &lt; 2e-16 ***\nDEST_HEX_IDHEX_824   1.6130430  0.0241843    66.698  &lt; 2e-16 ***\nDEST_HEX_IDHEX_825   0.3607715  0.0236306    15.267  &lt; 2e-16 ***\nDEST_HEX_IDHEX_826   2.4313046  0.0209824   115.874  &lt; 2e-16 ***\nDEST_HEX_IDHEX_827   0.8792155  0.0214948    40.904  &lt; 2e-16 ***\nDEST_HEX_IDHEX_832  -3.2063924  0.2097255   -15.289  &lt; 2e-16 ***\nDEST_HEX_IDHEX_833  -1.1232814  0.0552673   -20.325  &lt; 2e-16 ***\nDEST_HEX_IDHEX_851   0.8578175  0.0292389    29.338  &lt; 2e-16 ***\nDEST_HEX_IDHEX_852   1.6832329  0.0231202    72.804  &lt; 2e-16 ***\nDEST_HEX_IDHEX_853  -0.2105453  0.0221083    -9.523  &lt; 2e-16 ***\nDEST_HEX_IDHEX_854  -0.0749291  0.0217580    -3.444 0.000574 ***\nDEST_HEX_IDHEX_856  -5.0486267  0.2142255   -23.567  &lt; 2e-16 ***\nDEST_HEX_IDHEX_861  -1.0716258  0.0540471   -19.828  &lt; 2e-16 ***\nDEST_HEX_IDHEX_862  -0.1557660  0.0417494    -3.731 0.000191 ***\nDEST_HEX_IDHEX_878   1.5806798  0.0243480    64.920  &lt; 2e-16 ***\nDEST_HEX_IDHEX_879   1.0358368  0.0220725    46.929  &lt; 2e-16 ***\nDEST_HEX_IDHEX_880  -0.4004705  0.0220866   -18.132  &lt; 2e-16 ***\nDEST_HEX_IDHEX_881  -0.1446173  0.0223082    -6.483 9.01e-11 ***\nDEST_HEX_IDHEX_888  -1.6399868  0.2246294    -7.301 2.86e-13 ***\nDEST_HEX_IDHEX_889  -0.0643158  0.0543731    -1.183 0.236865    \nDEST_HEX_IDHEX_905   0.1556124  0.0272110     5.719 1.07e-08 ***\nDEST_HEX_IDHEX_906  -0.6476741  0.0280729   -23.071  &lt; 2e-16 ***\nDEST_HEX_IDHEX_907   0.7772644  0.0218294    35.606  &lt; 2e-16 ***\nDEST_HEX_IDHEX_908   0.3880963  0.0216279    17.944  &lt; 2e-16 ***\nDEST_HEX_IDHEX_910  -0.1930592  0.0245468    -7.865 3.69e-15 ***\nDEST_HEX_IDHEX_932   0.7975982  0.0226008    35.291  &lt; 2e-16 ***\nDEST_HEX_IDHEX_933  -0.2870162  0.0237822   -12.069  &lt; 2e-16 ***\nDEST_HEX_IDHEX_934   0.3480994  0.0216088    16.109  &lt; 2e-16 ***\nDEST_HEX_IDHEX_935   0.3182998  0.0216448    14.706  &lt; 2e-16 ***\nDEST_HEX_IDHEX_937   0.4317723  0.0232774    18.549  &lt; 2e-16 ***\nDEST_HEX_IDHEX_959   2.0471621  0.0215239    95.111  &lt; 2e-16 ***\nDEST_HEX_IDHEX_960   0.7459167  0.0217700    34.264  &lt; 2e-16 ***\nDEST_HEX_IDHEX_961   0.1631160  0.0220498     7.398 1.39e-13 ***\nDEST_HEX_IDHEX_962   2.2889457  0.0210079   108.956  &lt; 2e-16 ***\nDEST_HEX_IDHEX_986  -0.5600464  0.0277895   -20.153  &lt; 2e-16 ***\nDEST_HEX_IDHEX_987   1.1241076  0.0214066    52.512  &lt; 2e-16 ***\nDEST_HEX_IDHEX_988  -0.8508668  0.0240076   -35.442  &lt; 2e-16 ***\nDEST_HEX_IDHEX_989   0.6203022  0.0214513    28.917  &lt; 2e-16 ***\nDEST_HEX_IDHEX_991  -0.3785166  0.0235414   -16.079  &lt; 2e-16 ***\nlog(DISTANCE)       -1.5432685  0.0003123 -4941.437  &lt; 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for poisson family taken to be 1)\n\n    Null deviance: 80303496  on 63387  degrees of freedom\nResidual deviance: 21026076  on 61743  degrees of freedom\nAIC: 21373554\n\nNumber of Fisher Scoring iterations: 7\n\n\n\n\n\nCoefficient Discussion\nI included a lot of other variables to explain the situation. However i am fairly surprise that they are all significant, given the possibility of repeated variables such as MRT/LRT STN with MRT/LRT Exit.\n\nORIGIN_TOTAL_PTE_POP, it is negative instead of positive, i will expect higher population correlate to higher trips. A possibility is people living in Condo / Landed could be using more of private transport instead of public transport\nORIGIN_HOTEL_ROOMS, it is negative instead of positive. i will expect more hotel room correlated to higher tourist. Thus higher trips. A possibility is they don’t go out so early for tourist location, or they are living near to their destination thus no need for further transport. Since most hotels are centrally located\nORIGIN_MRT / LRT. it is negative. Not unexpected, since commuters may prefer MRT if they are nearer to MRT than buses\nDESTINATION MRT / LRT. it is negative. Likewise to above, commuters may prefer to take the MRT to this location if the destination is near to MRT.\nDESTINATION PRE SCHOOl. negative, perhaps due to the fact that most people will prefer a pre school that is near their house for convinence\nDESTINATION TETIARY SCHOOL. positive. i thought it may not be that significant since Tetiary Education have staggered timetable for different students. However, it seems that a big part still go to school early. One possibility is the data is Aug23, which conincide with starting of school term for most tetiary schools. Will be interesting to see if it is positive throughout the year, especially during school break\nDESTINATION HAWKER. negative. perhaps i should put it as ORIGIN instead of DESTINATION, because we may tend to eat nearby before going to work, instead of going to a hawker via bus in the morning peak hour\n\n\n\nModel Comparison\nThe Doubly Constrained model has the lowest Root Mean Square Error, i.e. giving the highest prediction accuracy. However given that i have included many variables in trying to explain the transport flow. I could be overfitting, e.g. on station exit and MRT/LRT Station, they are kind of the same thing. Which resulted in a lower AIC / BIC despite having a lower R^2 and higher RMSE\n\n\nCode\nunconstraint_r2 &lt;- calcr2(unconstraint$data$TOTAL_TRIPS, unconstraint$fitted.values)\norigin_cons_r2 &lt;- calcr2(origin_cons$data$TOTAL_TRIPS, origin_cons$fitted.values)\ndestination_cons_r2 &lt;- calcr2(destination_cons$data$TOTAL_TRIPS, destination_cons$fitted.values)\ndoubly_constraint_r2 &lt;- calcr2(doubly_constraint$data$TOTAL_TRIPS, doubly_constraint$fitted.values)\n\n\n\n\n\nModel\nR2\n\n\n\n\nUnconstraint\n0.34\n\n\nOrigin Constraint\n0.46\n\n\nDestination Constraint\n0.43\n\n\nDoubly Constraint\n0.59\n\n\n\n\n\nCode\nmodel_list &lt;- list(\n  Unconstrained = unconstraint,\n  Origin_Constrained = origin_cons,\n  Destination_Constrained = destination_cons,\n  Doubly_Constrained = doubly_constraint)\n\ncompare_performance(model_list,\n                    metrics = c(\"RMSE\",\"AIC\",\"BIC\"))\n\n\n# Comparison of Model Performance Indices\n\nName                    | Model |   AIC (weights) |   BIC (weights) |     RMSE\n------------------------------------------------------------------------------\nUnconstrained           |   glm | 3.7e+07 (&lt;.001) | 3.7e+07 (&lt;.001) | 1176.854\nOrigin_Constrained      |   glm | 2.9e+07 (&lt;.001) | 2.9e+07 (&lt;.001) | 1066.803\nDestination_Constrained |   glm | 2.9e+07 (&lt;.001) | 2.9e+07 (&lt;.001) | 1093.939\nDoubly_Constrained      |   glm | 2.1e+07 (&gt;.999) | 2.1e+07 (&gt;.999) |  929.562\n\n\n\n\nCode\nunconstraint_fv &lt;- as.data.frame(unconstraint$fitted.values) %&gt;%\n  round(digits = 0)\ncolnames(unconstraint_fv)[1] &lt;- \"unconstraint_trips\"\n\norigin_cons_fv &lt;- as.data.frame(origin_cons$fitted.values) %&gt;%\n  round(digits = 0) \ncolnames(origin_cons_fv)[1] &lt;- \"origin_cons_trips\"\n\ndestination_cons_fv &lt;- as.data.frame(destination_cons$fitted.values) %&gt;%\n  round(digits = 0)\ncolnames(destination_cons_fv)[1] &lt;- \"destination_cons_trips\"\n\ndoubly_constraint_fv &lt;- as.data.frame(doubly_constraint$fitted.values) %&gt;%\n  round(digits = 0)\ncolnames(doubly_constraint_fv)[1] &lt;- \"doubly_constraint_trips\"\n\nflowmerge_interzonal &lt;- read_rds(\"data/rds/flowmerge.rds\") %&gt;%\n  filter(ORIG_HEX_ID != DEST_HEX_ID) %&gt;%\n  cbind(unconstraint_fv,origin_cons_fv,destination_cons_fv,doubly_constraint_fv)\n\nuncon_p &lt;- ggplot(data = flowmerge_interzonal,\n                aes(x = unconstraint_trips,\n                    y = TOTAL_TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm) +\n  coord_cartesian(xlim=c(0,60000),\n                  ylim=c(0,60000))\n\norig_p &lt;- ggplot(data = flowmerge_interzonal,\n                aes(x = origin_cons_trips,\n                    y = TOTAL_TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm) +\n  coord_cartesian(xlim=c(0,60000),\n                  ylim=c(0,60000))\n\ndest_p &lt;- ggplot(data = flowmerge_interzonal,\n                aes(x = destination_cons_trips,\n                    y = TOTAL_TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm) +\n  coord_cartesian(xlim=c(0,60000),\n                  ylim=c(0,60000))\n\ndocon_p &lt;- ggplot(data = flowmerge_interzonal,\n                aes(x = doubly_constraint_trips,\n                    y = TOTAL_TRIPS)) +\n  geom_point() +\n  geom_smooth(method = lm) +\n  coord_cartesian(xlim=c(0,60000),\n                  ylim=c(0,60000))\n\n\nggarrange(uncon_p, orig_p,dest_p,docon_p,\n          ncol = 2,\n          nrow = 2)"
  },
  {
    "objectID": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#conclusion",
    "href": "Take-home_Ex/Take-home_Ex2/Take-home_Ex2.html#conclusion",
    "title": "Take-home_Ex2",
    "section": "Conclusion",
    "text": "Conclusion\nThere seem to be some unexplained variables that are still being captured by the “location”, given that the best model is the unconstraint model. Despite the addition of multiple variables, it doesn’t seem to carry much gravity in explaning the transport pattern of commuters much more than the “location” itself. It will seem that commuters have different reasons for going to places and BUS journey serve the last mile & door-to-door depending on the commuters’ choice, thus making it more heterogenous than perhaps MRT journey.\nDistance is a key factor for bus trips, however this could largely be due to the current model that Singapore is pursuing. We are expanding our MRT lines and intend to make our commuters within 10-15mins away from a MRT. This will eventually make buses more of the “short distance” transport that carries our commuters to the MRT instead. An example is the recent intention to cancel the bus service 167. [https://www.channelnewsasia.com/singapore/bus-service-167-ridership-falls-lta-commuters-unhappy-3928596] If we go back to 1980s [https://www.youtube.com/watch?v=DnfsYldEE7M], where the govt was reviewing the need for MRT immediately, and if we should expand express bus services, things could turn out quite differently."
  }
]